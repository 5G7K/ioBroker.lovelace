{"version":3,"sources":["webpack:///./node_modules/@polymer/iron-icon/iron-icon.js","webpack:///./src/common/string/compare.ts","webpack:///./src/common/util/debounce.ts","webpack:///./src/components/ha-icon.ts","webpack:///./src/data/config_entries.ts","webpack:///./src/dialogs/config-flow/show-dialog-config-flow.ts","webpack:///./src/onboarding/integration-badge.ts","webpack:///./src/onboarding/onboarding-integrations.ts"],"names":["Polymer","_template","html","is","properties","icon","type","String","theme","src","_meta","value","Base","create","observers","_DEFAULT_ICONSET","_iconChanged","parts","split","_iconName","pop","_iconsetName","_updateIcon","_srcChanged","_usesIconset","_img","parentNode","dom","root","removeChild","_iconset","removeIcon","byKey","applyIcon","unlisten","window","listen","document","createElement","style","width","height","draggable","appendChild","compare","a","b","caseInsensitiveCompare","toLowerCase","debounce","func","wait","immediate","timeout","args","context","later","apply","callNow","clearTimeout","setTimeout","ironIconClass","customElements","get","loaded","HaIcon","node","eventName","methodName","define","createConfigFlow","hass","handler","callApi","fetchConfigFlow","flowId","handleConfigFlowStep","data","deleteConfigFlow","getConfigFlowsInProgress","getConfigFlowHandlers","fetchConfigFlowInProgress","conn","sendMessagePromise","subscribeConfigFlowInProgressUpdates","store","subscribeEvents","then","flows","setState","subscribeConfigFlowInProgress","onChange","createCollection","connection","getConfigEntries","localizeConfigFlowTitle","localize","flow","placeholders","title_placeholders","placeholderKeys","Object","keys","length","forEach","key","push","loadConfigFlowDialog","showConfigFlowDialog","element","dialogParams","fireEvent","dialogTag","dialogImport","IntegrationBadge","customElement","property","Boolean","reflect","badgeIcon","title","css","LitElement","OnboardingIntegrations","_loadData","unsub","_unsubEvents","_entries","_discovered","entries","map","entry","domain","discovered","flow_id","_continueFlow","content","sort","item","onboardingLocalize","_createFlow","_finish","changedProps","dialogClosedCallback","ev","continueFlowId","currentTarget","Promise","all","onboardIntegrationStep","client_id","genClientId","result"],"mappings":"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","file":"onboarding-integrations.chunk.js","sourcesContent":["/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\nimport '@polymer/iron-flex-layout/iron-flex-layout.js';\n\nimport {IronMeta} from '@polymer/iron-meta/iron-meta.js';\nimport {Polymer} from '@polymer/polymer/lib/legacy/polymer-fn.js';\nimport {dom} from '@polymer/polymer/lib/legacy/polymer.dom.js';\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\nimport {Base} from '@polymer/polymer/polymer-legacy.js';\n\n/**\n\nThe `iron-icon` element displays an icon. By default an icon renders as a 24px\nsquare.\n\nExample using src:\n\n    <iron-icon src=\"star.png\"></iron-icon>\n\nExample setting size to 32px x 32px:\n\n    <iron-icon class=\"big\" src=\"big_star.png\"></iron-icon>\n\n    <style is=\"custom-style\">\n      .big {\n        --iron-icon-height: 32px;\n        --iron-icon-width: 32px;\n      }\n    </style>\n\nThe iron elements include several sets of icons. To use the default set of\nicons, import `iron-icons.js` and use the `icon` attribute to specify an icon:\n\n    <script type=\"module\">\n      import \"@polymer/iron-icons/iron-icons.js\";\n    </script>\n\n    <iron-icon icon=\"menu\"></iron-icon>\n\nTo use a different built-in set of icons, import the specific\n`iron-icons/<iconset>-icons.js`, and specify the icon as `<iconset>:<icon>`.\nFor example, to use a communication icon, you would use:\n\n    <script type=\"module\">\n      import \"@polymer/iron-icons/communication-icons.js\";\n    </script>\n\n    <iron-icon icon=\"communication:email\"></iron-icon>\n\nYou can also create custom icon sets of bitmap or SVG icons.\n\nExample of using an icon named `cherry` from a custom iconset with the ID\n`fruit`:\n\n    <iron-icon icon=\"fruit:cherry\"></iron-icon>\n\nSee `<iron-iconset>` and `<iron-iconset-svg>` for more information about how to\ncreate a custom iconset.\n\nSee the `iron-icons` demo to see the icons available in the various iconsets.\n\n### Styling\n\nThe following custom properties are available for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--iron-icon` | Mixin applied to the icon | {}\n`--iron-icon-width` | Width of the icon | `24px`\n`--iron-icon-height` | Height of the icon | `24px`\n`--iron-icon-fill-color` | Fill color of the svg icon | `currentcolor`\n`--iron-icon-stroke-color` | Stroke color of the svg icon | none\n\n@group Iron Elements\n@element iron-icon\n@demo demo/index.html\n@hero hero.svg\n@homepage polymer.github.io\n*/\nPolymer({\n  _template: html`\n    <style>\n      :host {\n        @apply --layout-inline;\n        @apply --layout-center-center;\n        position: relative;\n\n        vertical-align: middle;\n\n        fill: var(--iron-icon-fill-color, currentcolor);\n        stroke: var(--iron-icon-stroke-color, none);\n\n        width: var(--iron-icon-width, 24px);\n        height: var(--iron-icon-height, 24px);\n        @apply --iron-icon;\n      }\n\n      :host([hidden]) {\n        display: none;\n      }\n    </style>\n`,\n\n  is: 'iron-icon',\n\n  properties: {\n\n    /**\n     * The name of the icon to use. The name should be of the form:\n     * `iconset_name:icon_name`.\n     */\n    icon: {type: String},\n\n    /**\n     * The name of the theme to used, if one is specified by the\n     * iconset.\n     */\n    theme: {type: String},\n\n    /**\n     * If using iron-icon without an iconset, you can set the src to be\n     * the URL of an individual icon image file. Note that this will take\n     * precedence over a given icon attribute.\n     */\n    src: {type: String},\n\n    /**\n     * @type {!IronMeta}\n     */\n    _meta: {value: Base.create('iron-meta', {type: 'iconset'})}\n\n  },\n\n  observers: [\n    '_updateIcon(_meta, isAttached)',\n    '_updateIcon(theme, isAttached)',\n    '_srcChanged(src, isAttached)',\n    '_iconChanged(icon, isAttached)'\n  ],\n\n  _DEFAULT_ICONSET: 'icons',\n\n  _iconChanged: function(icon) {\n    var parts = (icon || '').split(':');\n    this._iconName = parts.pop();\n    this._iconsetName = parts.pop() || this._DEFAULT_ICONSET;\n    this._updateIcon();\n  },\n\n  _srcChanged: function(src) {\n    this._updateIcon();\n  },\n\n  _usesIconset: function() {\n    return this.icon || !this.src;\n  },\n\n  /** @suppress {visibility} */\n  _updateIcon: function() {\n    if (this._usesIconset()) {\n      if (this._img && this._img.parentNode) {\n        dom(this.root).removeChild(this._img);\n      }\n      if (this._iconName === '') {\n        if (this._iconset) {\n          this._iconset.removeIcon(this);\n        }\n      } else if (this._iconsetName && this._meta) {\n        this._iconset = /** @type {?Polymer.Iconset} */ (\n            this._meta.byKey(this._iconsetName));\n        if (this._iconset) {\n          this._iconset.applyIcon(this, this._iconName, this.theme);\n          this.unlisten(window, 'iron-iconset-added', '_updateIcon');\n        } else {\n          this.listen(window, 'iron-iconset-added', '_updateIcon');\n        }\n      }\n    } else {\n      if (this._iconset) {\n        this._iconset.removeIcon(this);\n      }\n      if (!this._img) {\n        this._img = document.createElement('img');\n        this._img.style.width = '100%';\n        this._img.style.height = '100%';\n        this._img.draggable = false;\n      }\n      this._img.src = this.src;\n      dom(this.root).appendChild(this._img);\n    }\n  }\n});\n","export const compare = (a: string, b: string) => {\n  if (a < b) {\n    return -1;\n  }\n  if (a > b) {\n    return 1;\n  }\n\n  return 0;\n};\n\nexport const caseInsensitiveCompare = (a: string, b: string) =>\n  compare(a.toLowerCase(), b.toLowerCase());\n","// From: https://davidwalsh.name/javascript-debounce-function\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// tslint:disable-next-line: ban-types\nexport const debounce = <T extends Function>(\n  func: T,\n  wait,\n  immediate = false\n): T => {\n  let timeout;\n  // @ts-ignore\n  return function(...args) {\n    // tslint:disable:no-this-assignment\n    // @ts-ignore\n    const context = this;\n    const later = () => {\n      timeout = null;\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n};\n","import { Constructor } from \"lit-element\";\nimport \"@polymer/iron-icon/iron-icon\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { IronIconElement } from \"@polymer/iron-icon/iron-icon\";\n\nconst ironIconClass = customElements.get(\"iron-icon\") as Constructor<\n  IronIconElement\n>;\n\nlet loaded = false;\n\nexport class HaIcon extends ironIconClass {\n  private _iconsetName?: string;\n\n  public listen(\n    node: EventTarget | null,\n    eventName: string,\n    methodName: string\n  ): void {\n    super.listen(node, eventName, methodName);\n\n    if (!loaded && this._iconsetName === \"mdi\") {\n      loaded = true;\n      import(/* webpackChunkName: \"mdi-icons\" */ \"../resources/mdi-icons\");\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-icon\": HaIcon;\n  }\n}\n\ncustomElements.define(\"ha-icon\", HaIcon);\n","import { HomeAssistant } from \"../types\";\nimport { createCollection } from \"home-assistant-js-websocket\";\nimport { debounce } from \"../common/util/debounce\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\n\nexport interface DataEntryFlowProgressedEvent {\n  type: \"data_entry_flow_progressed\";\n  data: {\n    handler: string;\n    flow_id: string;\n    refresh: boolean;\n  };\n}\n\nexport interface ConfigEntry {\n  entry_id: string;\n  domain: string;\n  title: string;\n  source: string;\n  state: string;\n  connection_class: string;\n  supports_options: boolean;\n}\n\nexport interface FieldSchema {\n  name: string;\n  default?: any;\n  optional: boolean;\n}\n\nexport interface ConfigFlowProgress {\n  flow_id: string;\n  handler: string;\n  context: {\n    title_placeholders: { [key: string]: string };\n    [key: string]: any;\n  };\n}\n\nexport interface ConfigFlowStepForm {\n  type: \"form\";\n  flow_id: string;\n  handler: string;\n  step_id: string;\n  data_schema: FieldSchema[];\n  errors: { [key: string]: string };\n  description_placeholders: { [key: string]: string };\n}\n\nexport interface ConfigFlowStepExternal {\n  type: \"external\";\n  flow_id: string;\n  handler: string;\n  step_id: string;\n  url: string;\n  description_placeholders: { [key: string]: string };\n}\n\nexport interface ConfigFlowStepCreateEntry {\n  type: \"create_entry\";\n  version: number;\n  flow_id: string;\n  handler: string;\n  title: string;\n  // Config entry ID\n  result: string;\n  description: string;\n  description_placeholders: { [key: string]: string };\n}\n\nexport interface ConfigFlowStepAbort {\n  type: \"abort\";\n  flow_id: string;\n  handler: string;\n  reason: string;\n  description_placeholders: { [key: string]: string };\n}\n\nexport type ConfigFlowStep =\n  | ConfigFlowStepForm\n  | ConfigFlowStepExternal\n  | ConfigFlowStepCreateEntry\n  | ConfigFlowStepAbort;\n\nexport const createConfigFlow = (hass: HomeAssistant, handler: string) =>\n  hass.callApi<ConfigFlowStep>(\"POST\", \"config/config_entries/flow\", {\n    handler,\n  });\n\nexport const fetchConfigFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callApi<ConfigFlowStep>(\"GET\", `config/config_entries/flow/${flowId}`);\n\nexport const handleConfigFlowStep = (\n  hass: HomeAssistant,\n  flowId: string,\n  data: { [key: string]: any }\n) =>\n  hass.callApi<ConfigFlowStep>(\n    \"POST\",\n    `config/config_entries/flow/${flowId}`,\n    data\n  );\n\nexport const deleteConfigFlow = (hass: HomeAssistant, flowId: string) =>\n  hass.callApi(\"DELETE\", `config/config_entries/flow/${flowId}`);\n\nexport const getConfigFlowsInProgress = (hass: HomeAssistant) =>\n  hass.callApi<ConfigFlowProgress[]>(\"GET\", \"config/config_entries/flow\");\n\nexport const getConfigFlowHandlers = (hass: HomeAssistant) =>\n  hass.callApi<string[]>(\"GET\", \"config/config_entries/flow_handlers\");\n\nconst fetchConfigFlowInProgress = (conn) =>\n  conn.sendMessagePromise({\n    type: \"config/entity_registry/list\",\n  });\n\nconst subscribeConfigFlowInProgressUpdates = (conn, store) =>\n  debounce(\n    conn.subscribeEvents(\n      () =>\n        fetchConfigFlowInProgress(conn).then((flows) =>\n          store.setState(flows, true)\n        ),\n      500,\n      true\n    ),\n    \"config_entry_discovered\"\n  );\n\nexport const subscribeConfigFlowInProgress = (\n  hass: HomeAssistant,\n  onChange: (flows: ConfigFlowProgress[]) => void\n) =>\n  createCollection<ConfigFlowProgress[]>(\n    \"_configFlowProgress\",\n    fetchConfigFlowInProgress,\n    subscribeConfigFlowInProgressUpdates,\n    hass.connection,\n    onChange\n  );\n\nexport const getConfigEntries = (hass: HomeAssistant) =>\n  hass.callApi<ConfigEntry[]>(\"GET\", \"config/config_entries/entry\");\n\nexport const localizeConfigFlowTitle = (\n  localize: LocalizeFunc,\n  flow: ConfigFlowProgress\n) => {\n  const placeholders = flow.context.title_placeholders || {};\n  const placeholderKeys = Object.keys(placeholders);\n  if (placeholderKeys.length === 0) {\n    return localize(`component.${flow.handler}.config.title`);\n  }\n  const args: string[] = [];\n  placeholderKeys.forEach((key) => {\n    args.push(key);\n    args.push(placeholders[key]);\n  });\n  return localize(`component.${flow.handler}.config.flow_title`, ...args);\n};\n","import { fireEvent } from \"../../common/dom/fire_event\";\n\nexport interface HaConfigFlowParams {\n  continueFlowId?: string;\n  dialogClosedCallback: (params: { flowFinished: boolean }) => void;\n}\n\nexport const loadConfigFlowDialog = () =>\n  import(/* webpackChunkName: \"dialog-config-flow\" */ \"./dialog-config-flow\");\n\nexport const showConfigFlowDialog = (\n  element: HTMLElement,\n  dialogParams: HaConfigFlowParams\n): void => {\n  fireEvent(element, \"show-dialog\", {\n    dialogTag: \"dialog-config-flow\",\n    dialogImport: loadConfigFlowDialog,\n    dialogParams,\n  });\n};\n","import {\n  LitElement,\n  TemplateResult,\n  html,\n  customElement,\n  property,\n  CSSResult,\n  css,\n} from \"lit-element\";\nimport \"../components/ha-icon\";\n\n@customElement(\"integration-badge\")\nclass IntegrationBadge extends LitElement {\n  @property() public icon!: string;\n  @property() public title!: string;\n  @property() public badgeIcon?: string;\n  @property({ type: Boolean, reflect: true }) public clickable = false;\n\n  protected render(): TemplateResult | void {\n    return html`\n      <div class=\"icon\">\n        <iron-icon .icon=${this.icon}></iron-icon>\n        ${this.badgeIcon\n          ? html`\n              <ha-icon class=\"badge\" .icon=${this.badgeIcon}></ha-icon>\n            `\n          : \"\"}\n      </div>\n      <div class=\"title\">${this.title}</div>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: inline-flex;\n        flex-direction: column;\n        text-align: center;\n        color: var(--primary-text-color);\n      }\n\n      :host([clickable]) {\n        color: var(--primary-text-color);\n      }\n\n      .icon {\n        position: relative;\n        margin: 0 auto 8px;\n        height: 40px;\n        width: 40px;\n        border-radius: 50%;\n        border: 1px solid var(--secondary-text-color);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n\n      :host([clickable]) .icon {\n        border-color: var(--primary-color);\n        border-width: 2px;\n      }\n\n      .badge {\n        position: absolute;\n        color: var(--primary-color);\n        bottom: -5px;\n        right: -5px;\n        background-color: white;\n        border-radius: 50%;\n        width: 18px;\n        display: block;\n        height: 18px;\n      }\n\n      .title {\n        min-height: 2.3em;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"integration-badge\": IntegrationBadge;\n  }\n}\n","import {\n  LitElement,\n  TemplateResult,\n  html,\n  customElement,\n  PropertyValues,\n  property,\n  CSSResult,\n  css,\n} from \"lit-element\";\nimport \"@material/mwc-button/mwc-button\";\nimport {\n  loadConfigFlowDialog,\n  showConfigFlowDialog,\n} from \"../dialogs/config-flow/show-dialog-config-flow\";\nimport { HomeAssistant } from \"../types\";\nimport {\n  getConfigFlowsInProgress,\n  getConfigEntries,\n  ConfigEntry,\n  ConfigFlowProgress,\n  localizeConfigFlowTitle,\n} from \"../data/config_entries\";\nimport { compare } from \"../common/string/compare\";\nimport \"./integration-badge\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\nimport { debounce } from \"../common/util/debounce\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { onboardIntegrationStep } from \"../data/onboarding\";\nimport { genClientId } from \"home-assistant-js-websocket\";\n\n@customElement(\"onboarding-integrations\")\nclass OnboardingIntegrations extends LitElement {\n  @property() public hass!: HomeAssistant;\n  @property() public onboardingLocalize!: LocalizeFunc;\n  @property() private _entries?: ConfigEntry[];\n  @property() private _discovered?: ConfigFlowProgress[];\n  private _unsubEvents?: () => void;\n\n  public connectedCallback() {\n    super.connectedCallback();\n    this.hass.connection\n      .subscribeEvents(\n        debounce(() => this._loadData(), 500),\n        \"config_entry_discovered\"\n      )\n      .then((unsub) => {\n        this._unsubEvents = unsub;\n      });\n  }\n\n  public disconnectedCallback() {\n    super.disconnectedCallback();\n    if (this._unsubEvents) {\n      this._unsubEvents();\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._entries || !this._discovered) {\n      return html``;\n    }\n    // Render discovered and existing entries together sorted by localized title.\n    const entries: Array<[string, TemplateResult]> = this._entries.map(\n      (entry) => {\n        const title = this.hass.localize(\n          `component.${entry.domain}.config.title`\n        );\n        return [\n          title,\n          html`\n            <integration-badge\n              .title=${title}\n              icon=\"hass:check\"\n            ></integration-badge>\n          `,\n        ];\n      }\n    );\n    const discovered: Array<[string, TemplateResult]> = this._discovered.map(\n      (flow) => {\n        const title = localizeConfigFlowTitle(this.hass.localize, flow);\n        return [\n          title,\n          html`\n            <button .flowId=${flow.flow_id} @click=${this._continueFlow}>\n              <integration-badge\n                clickable\n                .title=${title}\n                icon=\"hass:plus\"\n              ></integration-badge>\n            </button>\n          `,\n        ];\n      }\n    );\n    const content = [...entries, ...discovered]\n      .sort((a, b) => compare(a[0], b[0]))\n      .map((item) => item[1]);\n\n    return html`\n      <p>\n        ${this.onboardingLocalize(\"ui.panel.page-onboarding.integration.intro\")}\n      </p>\n      <div class=\"badges\">\n        ${content}\n        <button @click=${this._createFlow}>\n          <integration-badge\n            clickable\n            title=${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.integration.more_integrations\"\n            )}\n            icon=\"hass:dots-horizontal\"\n          ></integration-badge>\n        </button>\n      </div>\n      <div class=\"footer\">\n        <mwc-button @click=${this._finish}>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.integration.finish\"\n          )}\n        </mwc-button>\n      </div>\n    `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues) {\n    super.firstUpdated(changedProps);\n    loadConfigFlowDialog();\n    this._loadData();\n    /* polyfill for paper-dropdown */\n    import(/* webpackChunkName: \"polyfill-web-animations-next\" */ \"web-animations-js/web-animations-next-lite.min\");\n  }\n\n  private _createFlow() {\n    showConfigFlowDialog(this, {\n      dialogClosedCallback: () => this._loadData(),\n    });\n  }\n\n  private _continueFlow(ev) {\n    showConfigFlowDialog(this, {\n      continueFlowId: ev.currentTarget.flowId,\n      dialogClosedCallback: () => this._loadData(),\n    });\n  }\n\n  private async _loadData() {\n    const [discovered, entries] = await Promise.all([\n      getConfigFlowsInProgress(this.hass!),\n      getConfigEntries(this.hass!),\n    ]);\n    this._discovered = discovered;\n    this._entries = entries;\n  }\n\n  private async _finish() {\n    const result = await onboardIntegrationStep(this.hass, {\n      client_id: genClientId(),\n    });\n    fireEvent(this, \"onboarding-step\", {\n      type: \"integration\",\n      result,\n    });\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .badges {\n        margin-top: 24px;\n      }\n      .badges > * {\n        width: 24%;\n        min-width: 90px;\n        margin-bottom: 24px;\n      }\n      button {\n        display: inline-block;\n        cursor: pointer;\n        padding: 0;\n        border: 0;\n        background: 0;\n        font: inherit;\n      }\n      .footer {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"onboarding-integrations\": OnboardingIntegrations;\n  }\n}\n"],"sourceRoot":""}