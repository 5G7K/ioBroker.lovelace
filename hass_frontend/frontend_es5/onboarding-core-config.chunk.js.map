{"version":3,"sources":["webpack:///./src/common/dom/setup-leaflet-map.ts","webpack:///./src/components/map/ha-location-editor.ts","webpack:///./src/components/timezone-datalist.ts","webpack:///./src/data/core.ts","webpack:///./src/onboarding/onboarding-core-config.ts"],"names":["setupLeafletMap","mapElement","parentNode","Error","Leaflet","Icon","Default","imagePath","map","style","document","createElement","setAttribute","appendChild","setView","tileLayer","Browser","retina","attribution","subdomains","minZoom","maxZoom","addTo","LocationEditor","customElement","property","_leafletMap","location","fitZoom","html","changedProps","_initMap","_updateMarker","_ignoreFitToMap","fitMap","undefined","shadowRoot","querySelector","_mapEl","addEventListener","ev","_updateLocation","latlng","invalidateSize","lat","lng","fireEvent","bubbles","_locationMarker","remove","setLatLng","marker","draggable","target","getLatLng","addLayer","css","LitElement","createTimezoneListEl","list","id","Object","keys","timezones","forEach","key","option","value","innerHTML","saveCoreConfig","hass","values","callWS","type","detectCoreConfig","amsterdam","OnboardingCoreConfig","onboardingLocalize","user","name","_working","_nameValue","_handleChange","_detect","_locationValue","_locationChanged","localize","_timeZoneValue","_elevationValue","_unitSystemValue","_unitSystemChanged","_save","setTimeout","focus","keyCode","input","inputElement","_name","_location","_elevation","_timeZone","_unitSystem","currentTarget","detail","latitude","longitude","Number","elevation","String","unit_system","time_zone","alert","message","preventDefault","location_name","onboardCoreConfigStep","result"],"mappings":"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","file":"onboarding-core-config.chunk.js","sourcesContent":["import { Map } from \"leaflet\";\n\n// Sets up a Leaflet map on the provided DOM element\nexport type LeafletModuleType = typeof import(\"leaflet\");\n\nexport const setupLeafletMap = async (\n  mapElement: HTMLElement\n): Promise<[Map, LeafletModuleType]> => {\n  if (!mapElement.parentNode) {\n    throw new Error(\"Cannot setup Leaflet map on disconnected element\");\n  }\n  // tslint:disable-next-line\n  const Leaflet = (await import(/* webpackChunkName: \"leaflet\" */ \"leaflet\")) as LeafletModuleType;\n  Leaflet.Icon.Default.imagePath = \"/static/images/leaflet/images/\";\n\n  const map = Leaflet.map(mapElement);\n  const style = document.createElement(\"link\");\n  style.setAttribute(\"href\", \"/static/images/leaflet/leaflet.css\");\n  style.setAttribute(\"rel\", \"stylesheet\");\n  mapElement.parentNode.appendChild(style);\n  map.setView([52.3731339, 4.8903147], 13);\n  Leaflet.tileLayer(\n    `https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}${\n      Leaflet.Browser.retina ? \"@2x.png\" : \".png\"\n    }`,\n    {\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: \"abcd\",\n      minZoom: 0,\n      maxZoom: 20,\n    }\n  ).addTo(map);\n\n  return [map, Leaflet];\n};\n","import {\n  LitElement,\n  property,\n  TemplateResult,\n  html,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport { Marker, Map, LeafletMouseEvent, DragEndEvent, LatLng } from \"leaflet\";\nimport {\n  setupLeafletMap,\n  LeafletModuleType,\n} from \"../../common/dom/setup-leaflet-map\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\n\n@customElement(\"ha-location-editor\")\nclass LocationEditor extends LitElement {\n  @property() public location?: [number, number];\n  public fitZoom = 16;\n\n  private _ignoreFitToMap?: [number, number];\n\n  // tslint:disable-next-line\n  private Leaflet?: LeafletModuleType;\n  private _leafletMap?: Map;\n  private _locationMarker?: Marker;\n\n  public fitMap(): void {\n    if (!this._leafletMap || !this.location) {\n      return;\n    }\n    this._leafletMap.setView(this.location, this.fitZoom);\n  }\n\n  protected render(): TemplateResult | void {\n    return html`\n      <div id=\"map\"></div>\n    `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues): void {\n    super.firstUpdated(changedProps);\n    this._initMap();\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    // Still loading.\n    if (!this.Leaflet) {\n      return;\n    }\n\n    this._updateMarker();\n    if (!this._ignoreFitToMap || this._ignoreFitToMap !== this.location) {\n      this.fitMap();\n    }\n    this._ignoreFitToMap = undefined;\n  }\n\n  private get _mapEl(): HTMLDivElement {\n    return this.shadowRoot!.querySelector(\"div\")!;\n  }\n\n  private async _initMap(): Promise<void> {\n    [this._leafletMap, this.Leaflet] = await setupLeafletMap(this._mapEl);\n    this._leafletMap.addEventListener(\n      \"click\",\n      // @ts-ignore\n      (ev: LeafletMouseEvent) => this._updateLocation(ev.latlng)\n    );\n    this._updateMarker();\n    this.fitMap();\n    this._leafletMap.invalidateSize();\n  }\n\n  private _updateLocation(latlng: LatLng) {\n    this.location = this._ignoreFitToMap = [latlng.lat, latlng.lng];\n    fireEvent(this, \"change\", undefined, { bubbles: false });\n  }\n\n  private _updateMarker(): void {\n    if (!this.location) {\n      if (this._locationMarker) {\n        this._locationMarker.remove();\n        this._locationMarker = undefined;\n      }\n      return;\n    }\n\n    if (this._locationMarker) {\n      this._locationMarker.setLatLng(this.location);\n      return;\n    }\n    this._locationMarker = this.Leaflet!.marker(this.location, {\n      draggable: true,\n    });\n    this._locationMarker.addEventListener(\n      \"dragend\",\n      // @ts-ignore\n      (ev: DragEndEvent) => this._updateLocation(ev.target.getLatLng())\n    );\n    this._leafletMap!.addLayer(this._locationMarker);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        height: 300px;\n      }\n      #map {\n        height: 100%;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-location-editor\": LocationEditor;\n  }\n}\n","import timezones from \"google-timezones-json\";\n\nexport const createTimezoneListEl = () => {\n  const list = document.createElement(\"datalist\");\n  list.id = \"timezones\";\n  Object.keys(timezones).forEach((key) => {\n    const option = document.createElement(\"option\");\n    option.value = key;\n    option.innerHTML = timezones[key];\n    list.appendChild(option);\n  });\n  return list;\n};\n","import { HomeAssistant } from \"../types\";\nimport { HassConfig } from \"home-assistant-js-websocket\";\n\nexport interface ConfigUpdateValues {\n  location_name: string;\n  latitude: number;\n  longitude: number;\n  elevation: number;\n  unit_system: \"metric\" | \"imperial\";\n  time_zone: string;\n}\n\nexport const saveCoreConfig = (\n  hass: HomeAssistant,\n  values: Partial<ConfigUpdateValues>\n) =>\n  hass.callWS<HassConfig>({\n    type: \"config/core/update\",\n    ...values,\n  });\n\nexport const detectCoreConfig = (hass: HomeAssistant) =>\n  hass.callWS<Partial<ConfigUpdateValues>>({\n    type: \"config/core/detect\",\n  });\n","import {\n  LitElement,\n  customElement,\n  property,\n  TemplateResult,\n  html,\n  CSSResult,\n  css,\n} from \"lit-element\";\nimport \"@material/mwc-button/mwc-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-radio-group/paper-radio-group\";\nimport \"@polymer/paper-radio-button/paper-radio-button\";\n// tslint:disable-next-line: no-duplicate-imports\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\nimport { HomeAssistant } from \"../types\";\nimport {\n  ConfigUpdateValues,\n  detectCoreConfig,\n  saveCoreConfig,\n} from \"../data/core\";\nimport { PolymerChangedEvent } from \"../polymer-types\";\nimport { onboardCoreConfigStep } from \"../data/onboarding\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\nimport { createTimezoneListEl } from \"../components/timezone-datalist\";\nimport \"../components/map/ha-location-editor\";\n\nconst amsterdam = [52.3731339, 4.8903147];\n\n@customElement(\"onboarding-core-config\")\nclass OnboardingCoreConfig extends LitElement {\n  @property() public hass!: HomeAssistant;\n  @property() public onboardingLocalize!: LocalizeFunc;\n\n  @property() private _working = false;\n\n  @property() private _name!: ConfigUpdateValues[\"location_name\"];\n  @property() private _location!: [number, number];\n  @property() private _elevation!: string;\n  @property() private _unitSystem!: ConfigUpdateValues[\"unit_system\"];\n  @property() private _timeZone!: string;\n\n  protected render(): TemplateResult | void {\n    return html`\n      <p>\n        ${this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.intro\",\n          \"name\",\n          this.hass.user!.name\n        )}\n      </p>\n\n      <paper-input\n        .label=${this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.location_name\"\n        )}\n        name=\"name\"\n        .disabled=${this._working}\n        .value=${this._nameValue}\n        @value-changed=${this._handleChange}\n      ></paper-input>\n\n      <div class=\"middle-text\">\n        <p>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.core-config.intro_location\"\n          )}\n        </p>\n\n        <div class=\"row\">\n          <div>\n            ${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.core-config.intro_location_detect\"\n            )}\n          </div>\n          <mwc-button @click=${this._detect}>\n            ${this.onboardingLocalize(\n              \"ui.panel.page-onboarding.core-config.button_detect\"\n            )}\n          </mwc-button>\n        </div>\n      </div>\n\n      <div class=\"row\">\n        <ha-location-editor\n          class=\"flex\"\n          .location=${this._locationValue}\n          .fitZoom=${14}\n          @change=${this._locationChanged}\n        ></ha-location-editor>\n      </div>\n\n      <div class=\"row\">\n        <paper-input\n          class=\"flex\"\n          .label=${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.time_zone\"\n          )}\n          name=\"timeZone\"\n          list=\"timezones\"\n          .disabled=${this._working}\n          .value=${this._timeZoneValue}\n          @value-changed=${this._handleChange}\n        ></paper-input>\n\n        <paper-input\n          class=\"flex\"\n          .label=${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.elevation\"\n          )}\n          name=\"elevation\"\n          type=\"number\"\n          .disabled=${this._working}\n          .value=${this._elevationValue}\n          @value-changed=${this._handleChange}\n        >\n          <span slot=\"suffix\">\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.elevation_meters\"\n            )}\n          </span>\n        </paper-input>\n      </div>\n\n      <div class=\"row\">\n        <div class=\"flex\">\n          ${this.hass.localize(\n            \"ui.panel.config.core.section.core.core_config.unit_system\"\n          )}\n        </div>\n        <paper-radio-group\n          class=\"flex\"\n          .selected=${this._unitSystemValue}\n          @selected-changed=${this._unitSystemChanged}\n        >\n          <paper-radio-button name=\"metric\" .disabled=${this._working}>\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.unit_system_metric\"\n            )}\n            <div class=\"secondary\">\n              ${this.hass.localize(\n                \"ui.panel.config.core.section.core.core_config.metric_example\"\n              )}\n            </div>\n          </paper-radio-button>\n          <paper-radio-button name=\"imperial\" .disabled=${this._working}>\n            ${this.hass.localize(\n              \"ui.panel.config.core.section.core.core_config.unit_system_imperial\"\n            )}\n            <div class=\"secondary\">\n              ${this.hass.localize(\n                \"ui.panel.config.core.section.core.core_config.imperial_example\"\n              )}\n            </div>\n          </paper-radio-button>\n        </paper-radio-group>\n      </div>\n\n      <div class=\"footer\">\n        <mwc-button @click=${this._save} .disabled=${this._working}>\n          ${this.onboardingLocalize(\n            \"ui.panel.page-onboarding.core-config.finish\"\n          )}\n        </mwc-button>\n      </div>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    setTimeout(\n      () => this.shadowRoot!.querySelector(\"paper-input\")!.focus(),\n      100\n    );\n    this.addEventListener(\"keypress\", (ev) => {\n      if (ev.keyCode === 13) {\n        this._save(ev);\n      }\n    });\n    const input = this.shadowRoot!.querySelector(\n      \"[name=timeZone]\"\n    ) as PaperInputElement;\n    input.inputElement.appendChild(createTimezoneListEl());\n  }\n\n  private get _nameValue() {\n    return this._name !== undefined\n      ? this._name\n      : this.onboardingLocalize(\n          \"ui.panel.page-onboarding.core-config.location_name_default\"\n        );\n  }\n\n  private get _locationValue() {\n    return this._location || amsterdam;\n  }\n\n  private get _elevationValue() {\n    return this._elevation !== undefined ? this._elevation : 0;\n  }\n\n  private get _timeZoneValue() {\n    return this._timeZone;\n  }\n\n  private get _unitSystemValue() {\n    return this._unitSystem !== undefined ? this._unitSystem : \"metric\";\n  }\n\n  private _handleChange(ev: PolymerChangedEvent<string>) {\n    const target = ev.currentTarget as PaperInputElement;\n    this[`_${target.name}`] = target.value;\n  }\n\n  private _locationChanged(ev) {\n    this._location = ev.currentTarget.location;\n  }\n\n  private _unitSystemChanged(\n    ev: PolymerChangedEvent<ConfigUpdateValues[\"unit_system\"]>\n  ) {\n    this._unitSystem = ev.detail.value;\n  }\n\n  private async _detect() {\n    this._working = true;\n    try {\n      const values = await detectCoreConfig(this.hass);\n      if (values.latitude && values.longitude) {\n        this._location = [Number(values.latitude), Number(values.longitude)];\n      }\n      if (values.elevation) {\n        this._elevation = String(values.elevation);\n      }\n      if (values.unit_system) {\n        this._unitSystem = values.unit_system;\n      }\n      if (values.time_zone) {\n        this._timeZone = values.time_zone;\n      }\n    } catch (err) {\n      alert(`Failed to detect location information: ${err.message}`);\n    } finally {\n      this._working = false;\n    }\n  }\n\n  private async _save(ev) {\n    ev.preventDefault();\n    this._working = true;\n    try {\n      const location = this._locationValue;\n      await saveCoreConfig(this.hass, {\n        location_name: this._nameValue,\n        latitude: location[0],\n        longitude: location[1],\n        elevation: Number(this._elevationValue),\n        unit_system: this._unitSystemValue,\n        time_zone: this._timeZoneValue || \"UTC\",\n      });\n      const result = await onboardCoreConfigStep(this.hass);\n      fireEvent(this, \"onboarding-step\", {\n        type: \"core_config\",\n        result,\n      });\n    } catch (err) {\n      this._working = false;\n      alert(\"FAIL\");\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .row {\n        display: flex;\n        flex-direction: row;\n        margin: 0 -8px;\n        align-items: center;\n      }\n\n      .secondary {\n        color: var(--secondary-text-color);\n      }\n\n      .flex {\n        flex: 1;\n      }\n\n      .middle-text {\n        margin: 24px 0;\n      }\n\n      .row > * {\n        margin: 0 8px;\n      }\n      .footer {\n        margin-top: 16px;\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"onboarding-core-config\": OnboardingCoreConfig;\n  }\n}\n"],"sourceRoot":""}