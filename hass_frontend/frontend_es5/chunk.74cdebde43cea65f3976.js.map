{"version":3,"sources":["webpack:///./src/mixins/events-mixin.js","webpack:///./src/common/util/subscribe-one.ts","webpack:///./src/data/lovelace.ts","webpack:///./src/components/ha-markdown.js","webpack:///./src/mixins/localize-mixin.js","webpack:///./src/common/entity/compute_state_name.ts","webpack:///./src/components/ha-icon.ts","webpack:///./src/panels/lovelace/common/has-changed.ts","webpack:///./src/components/ha-card.ts","webpack:///./src/panels/lovelace/components/hui-warning.ts","webpack:///./src/common/entity/compute_state_domain.ts","webpack:///./src/components/entity/state-badge.ts","webpack:///./src/common/entity/supports-feature.ts","webpack:///./src/common/util/debounce.ts","webpack:///./src/common/entity/compute_state_display.ts","webpack:///./src/common/entity/domain_icon.ts","webpack:///./src/components/ha-relative-time.js","webpack:///./src/util/cover-model.js","webpack:///./src/common/datetime/format_date_time.ts","webpack:///./src/components/ha-paper-dropdown-menu.ts","webpack:///./src/common/entity/sensor_icon.ts","webpack:///./src/common/entity/state_icon.ts","webpack:///./src/common/entity/binary_sensor_icon.ts","webpack:///./src/common/entity/cover_icon.ts","webpack:///./src/common/entity/input_dateteime_icon.ts","webpack:///./src/components/entity/ha-entity-toggle.ts","webpack:///./src/common/datetime/format_time.ts","webpack:///./src/panels/lovelace/editor/config-util.ts","webpack:///./src/common/datetime/relative_time.ts","webpack:///./src/panels/lovelace/common/process-config-entities.ts","webpack:///./src/data/history.ts","webpack:///./src/common/config/is_component_loaded.ts","webpack:///./src/panels/lovelace/cards/hui-error-card.ts","webpack:///./src/common/string/compare.ts","webpack:///./src/common/entity/compute_object_id.ts","webpack:///./src/common/datetime/seconds_to_duration.ts","webpack:///./src/panels/lovelace/common/compute-card-size.ts","webpack:///./src/components/ha-cover-tilt-controls.js","webpack:///./src/common/datetime/format_date.ts","webpack:///./src/common/util/time-cache-function-promise.ts","webpack:///./src/util/hass-media-player-model.js","webpack:///./src/data/camera.ts","webpack:///./src/data/area_registry.ts","webpack:///./src/data/device_registry.ts","webpack:///./src/panels/lovelace/cards/hui-alarm-panel-card.ts","webpack:///./src/data/alarm_control_panel.ts","webpack:///./src/panels/lovelace/common/validate-condition.ts","webpack:///./src/panels/lovelace/cards/hui-conditional-card.ts","webpack:///./src/panels/lovelace/common/directives/long-press-directive.ts","webpack:///./src/panels/lovelace/common/entity/toggle-entity.ts","webpack:///./src/panels/lovelace/common/entity/turn-on-off-entity.ts","webpack:///./src/panels/lovelace/common/handle-click.ts","webpack:///./src/panels/lovelace/cards/hui-entity-button-card.ts","webpack:///./src/panels/lovelace/cards/hui-entity-filter-card.ts","webpack:///./src/panels/lovelace/components/hui-warning-element.ts","webpack:///./src/panels/lovelace/cards/hui-glance-card.ts","webpack:///./src/panels/lovelace/cards/hui-history-graph-card.js","webpack:///./src/panels/lovelace/cards/hui-stack-card.ts","webpack:///./src/panels/lovelace/cards/hui-horizontal-stack-card.ts","webpack:///./src/panels/lovelace/cards/hui-iframe-card.ts","webpack:///./src/resources/jquery.roundslider.ondemand.ts","webpack:///./src/panels/lovelace/cards/hui-light-card.ts","webpack:///./src/panels/map/ha-entity-marker.js","webpack:///./src/common/util/parse-aspect-ratio.ts","webpack:///./src/panels/lovelace/cards/hui-map-card.ts","webpack:///./src/panels/lovelace/cards/hui-markdown-card.ts","webpack:///./src/cards/ha-media_player-card.js","webpack:///./src/panels/lovelace/cards/hui-legacy-wrapper-card.js","webpack:///./src/panels/lovelace/cards/hui-media-control-card.js","webpack:///./src/panels/lovelace/cards/hui-picture-card.ts","webpack:///./src/panels/lovelace/elements/hui-conditional-element.ts","webpack:///./src/panels/lovelace/common/compute-tooltip.ts","webpack:///./src/panels/lovelace/elements/hui-icon-element.ts","webpack:///./src/panels/lovelace/components/hui-image.ts","webpack:///./src/panels/lovelace/elements/hui-image-element.ts","webpack:///./src/components/buttons/ha-progress-button.js","webpack:///./src/components/buttons/ha-call-service-button.js","webpack:///./src/panels/lovelace/elements/hui-service-button-element.ts","webpack:///./src/panels/lovelace/elements/hui-state-badge-element.ts","webpack:///./src/panels/lovelace/elements/hui-state-icon-element.ts","webpack:///./src/panels/lovelace/elements/hui-state-label-element.ts","webpack:///./src/panels/lovelace/common/create-hui-element.ts","webpack:///./src/panels/lovelace/cards/picture-elements/create-styled-hui-element.ts","webpack:///./src/panels/lovelace/cards/hui-picture-elements-card.ts","webpack:///./src/panels/lovelace/cards/hui-picture-entity-card.ts","webpack:///./src/data/entity.ts","webpack:///./src/panels/lovelace/cards/hui-picture-glance-card.ts","webpack:///./src/panels/lovelace/cards/hui-plant-status-card.ts","webpack:///./src/panels/lovelace/cards/hui-sensor-card.ts","webpack:///./src/panels/lovelace/cards/hui-vertical-stack-card.ts","webpack:///./src/data/shopping-list.ts","webpack:///./src/panels/lovelace/cards/hui-shopping-list-card.ts","webpack:///./src/panels/lovelace/cards/hui-thermostat-card.ts","webpack:///./src/cards/ha-weather-card.js","webpack:///./src/panels/lovelace/cards/hui-weather-forecast-card.js","webpack:///./src/panels/lovelace/cards/hui-gauge-card.ts","webpack:///./src/panels/lovelace/common/create-card-element.ts","webpack:///./src/components/entity/ha-chart-base.js","webpack:///./src/components/state-history-chart-line.js","webpack:///./src/components/state-history-chart-timeline.js","webpack:///./src/components/state-history-charts.js","webpack:///./src/data/cached-history.ts","webpack:///./src/data/ha-state-history-data.js","webpack:///./src/common/entity/timer_time_remaining.ts","webpack:///./src/common/datetime/duration_to_seconds.ts","webpack:///./src/components/entity/ha-state-label-badge.ts","webpack:///./src/common/entity/valid_entity_id.ts","webpack:///./src/components/ha-climate-state.js","webpack:///./src/components/ha-cover-controls.js","webpack:///./src/components/paper-time-input.js","webpack:///./src/components/ha-slider.js","webpack:///./src/data/input-select.ts","webpack:///./src/common/dom/stop_propagation.ts","webpack:///./src/common/dom/setup-leaflet-map.ts","webpack:///./src/data/entity_registry.ts","webpack:///./src/components/ha-label-badge.ts","webpack:///./src/data/media-player.ts","webpack:///./src/panels/lovelace/editor/card-editor/show-edit-card-dialog.ts","webpack:///./src/common/util/render-status.ts","webpack:///./src/panels/lovelace/components/hui-entities-toggle.ts","webpack:///./src/panels/lovelace/common/entity/turn-on-off-entities.ts","webpack:///./src/panels/lovelace/components/hui-generic-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-climate-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-cover-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-group-entity-row.ts","webpack:///./src/components/ha-date-input.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-datetime-entity-row.ts","webpack:///./src/data/input_datetime.ts","webpack:///./src/data/input_text.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-number-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-select-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-text-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-lock-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-media-player-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-scene-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-script-entity-row.ts","webpack:///./src/panels/lovelace/components/hui-timestamp-display.ts","webpack:///./src/panels/lovelace/entity-rows/hui-sensor-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-text-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-timer-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-toggle-entity-row.ts","webpack:///./src/panels/lovelace/special-rows/hui-call-service-row.ts","webpack:///./src/panels/lovelace/common/call-service.ts","webpack:///./src/panels/lovelace/special-rows/hui-divider-row.ts","webpack:///./src/panels/lovelace/special-rows/hui-section-row.ts","webpack:///./src/panels/lovelace/special-rows/hui-weblink-row.ts","webpack:///./src/panels/lovelace/common/create-row-element.ts","webpack:///./src/panels/lovelace/cards/hui-entities-card.ts","webpack:///./src/layouts/ha-app-layout.js","webpack:///./src/components/ha-start-voice-button.js","webpack:///./src/components/ha-paper-icon-button-arrow-next.ts","webpack:///./src/data/ws-notifications.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notification-item-template.ts","webpack:///./src/panels/lovelace/components/notifications/hui-configurator-notification-item.ts","webpack:///./src/panels/lovelace/components/notifications/hui-persistent-notification-item.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notification-item.ts","webpack:///./src/components/ha-paper-icon-button-next.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notification-drawer.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notifications-button.ts","webpack:///./src/panels/lovelace/hui-view.ts","webpack:///./src/panels/lovelace/editor/view-editor/show-edit-view-dialog.ts","webpack:///./src/panels/lovelace/editor/lovelace-editor/show-edit-lovelace-dialog.ts","webpack:///./src/panels/lovelace/hui-root.ts","webpack:///./src/panels/lovelace/common/compute-notifications.ts","webpack:///./src/common/dom/scroll-to-target.ts","webpack:///./src/panels/lovelace/editor/show-save-config-dialog.ts","webpack:///./src/common/entity/extract_views.ts","webpack:///./src/common/entity/get_view_entities.ts","webpack:///./src/common/entity/get_group_entities.ts","webpack:///./src/panels/lovelace/common/generate-lovelace-config.ts","webpack:///./src/common/entity/split_by_groups.ts","webpack:///./src/panels/lovelace/ha-panel-lovelace.ts","webpack:///./src/data/auth.ts","webpack:///./src/common/dom/load_resource.ts"],"names":["EventsMixin","dedupingMixin","superClass","_superClass","_class","_classCallCheck","this","_possibleConstructorReturn","_getPrototypeOf","apply","arguments","_inherits","key","value","type","detail","options","fireEvent","node","subscribeOne","_ref","regeneratorRuntime","mark","_callee","conn","subscribe","wrap","_context","prev","next","abrupt","Promise","resolve","unsub","items","stop","_x","_x2","__webpack_require__","d","__webpack_exports__","fetchConfig","saveConfig","subscribeLovelaceUpdates","force","sendMessagePromise","hass","config","callWS","onChange","subscribeEvents","loaded","svgWhiteList","HaMarkdown","PolymerElement","content","String","observer","allowSvg","Boolean","_this","_get","prototype","call","_scriptLoaded","_renderScheduled","_resize","fire","all","e","then","bind","marked","filterXSS","_render","_this2","innerHTML","gfm","tables","breaks","onIgnoreTag","tag","html","indexOf","walker","document","createTreeWalker","nextNode","currentNode","tagName","host","location","target","addEventListener","innerText","customElements","define","get","Object","localize","Function","computed","_compute_object_id__WEBPACK_IMPORTED_MODULE_0__","stateObj","undefined","attributes","friendly_name","computeObjectId","entity_id","replace","ironIconClass","HaIcon","_ironIconClass","_getPrototypeOf2","_len","length","args","Array","_key","concat","_assertThisInitialized","eventName","methodName","_iconsetName","hasConfigOrEntityChanged","element","changedProps","has","oldHass","states","_config","entity","HaCard","property","css","_templateObject","_templateObject2","header","_templateObject3","_templateObject4","LitElement","_decorate","customElement","_initialize","_LitElement","F","_LitElement2","HuiWarning","kind","static","computeStateDomain","_compute_domain__WEBPACK_IMPORTED_MODULE_0__","computeDomain","StateBadge","query","state","overrideIcon","stateIcon","iconStyle","color","filter","hostStyle","backgroundImage","entity_picture","display","hs_color","hue","sat","brightness","errorMessage","_typeof","console","warn","assign","_icon","style","supportsFeature","feature","supported_features","debounce","func","wait","timeout","immediate","context","callNow","clearTimeout","setTimeout","_compute_state_domain__WEBPACK_IMPORTED_MODULE_0__","_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_1__","_datetime_format_date__WEBPACK_IMPORTED_MODULE_2__","_datetime_format_time__WEBPACK_IMPORTED_MODULE_3__","language","domain","device_class","unit_of_measurement","includes","date","has_time","has_date","Date","year","month","day","hour","minute","formatDateTime","now","getFullYear","getMonth","getDay","formatTime","formatDate","query_stage","domainIcon","_const__WEBPACK_IMPORTED_MODULE_0__","fixedIcons","alert","alexa","automation","calendar","camera","climate","configurator","conversation","device_tracker","fan","google_assistant","group","history_graph","homeassistant","homekit","image_processing","input_boolean","input_datetime","input_number","input_select","input_text","light","mailbox","notify","person","plant","proximity","remote","scene","script","sensor","simple_alarm","sun","switch","timer","updater","vacuum","water_heater","weather","weblink","DEFAULT_DOMAIN_ICON","HaRelativeTime","updateRelative","LocalizeMixin","datetime","datetimeObj","parsedDateTime","updateInterval","setInterval","clearInterval","newVal","root","dom","relativeTime","CoverEntity","_attr","_feat","callService","position","tiltPosition","tilt_position","service","data","current_position","current_tilt_position","supportsCover","supportsOpen","supportsClose","supportsStop","supportsOpenTilt","supportsCloseTilt","supportsStopTilt","isTiltOnly","fecha__WEBPACK_IMPORTED_MODULE_0__","toLocaleStringSupportsOptions","toLocaleString","name","dateObj","locales","fecha","format","paperDropdownClass","HaPaperDropdownClass","_paperDropdownClass","window","getComputedStyle","direction","textAlign","fixedDeviceClassIcons","humidity","illuminance","temperature","pressure","power","signal_strength","domainIcons","binary_sensor","activated","cover","open","dclass","battery","Number","isNaN","batteryRound","Math","round","unit","UNIT_C","UNIT_F","icon","isOn","STATES_OFF","HaEntityToggle","assumed_state","computeStateName","_turnOff","_isOn","_turnOn","_toggleChanged","ev","stopPropagation","checked","_callService","_callee2","turnOn","stateDomain","serviceDomain","currentState","_context2","forwardHaptic","_asyncToGenerator","toLocaleTimeStringSupportsOptions","toLocaleTimeString","addCard","path","cardConfig","viewIndex","_slicedToArray","views","forEach","viewConf","index","cards","_toConsumableArray","push","replaceCard","_path2","cardIndex","map","origConf","ind","deleteCard","_path3","_origConf","swapCard","path1","path2","card1","card2","origView1","newView1","origCard","origView2","newView2","origView","moveCard","fromPath","toPath","Error","fromView","card","toView","addView","viewConfig","replaceView","swapView","view1","view2","deleteView","_origView","tests","langKey","timeDesc","delta","compareTime","getTime","tense","abs","i","floor","includeTense","processConfigEntities","entities","isArray","entityConf","isValidEntityId","fetchRecent","fetchDate","computeHistory","_common_entity_compute_state_name__WEBPACK_IMPORTED_MODULE_0__","_common_entity_compute_state_domain__WEBPACK_IMPORTED_MODULE_1__","_common_entity_compute_state_display__WEBPACK_IMPORTED_MODULE_2__","DOMAINS_USE_LAST_UPDATED","LINE_ATTRIBUTES_TO_KEEP","entityId","startTime","endTime","skipInitialState","url","toISOString","callApi","equalState","obj1","obj2","every","attr","stateHistory","lineChartDevices","timelineDevices","stateInfo","stateWithUnit","find","unit_system","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","state_localize","computeStateDisplay","last_changed","err","processTimelineEntity","line","keys","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","last","processedStates","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","processedState","last_updated","_i","_LINE_ATTRIBUTES_TO_K","identifier","join","processLineChartEntities","timeline","isComponentLoaded","component","components","createErrorCardElement","el","createElement","setConfig","createErrorCardConfig","error","origConfig","HuiErrorCard","decorators","_toStr","JSON","stringify","compare","caseInsensitiveCompare","a","b","toLowerCase","substr","secondsToDuration","leftPad","num","h","m","s","computeCardSize","getCardSize","HaCoverTiltControls","entityObj","assumedState","isFullyOpenTilt","isFullyClosedTilt","openCoverTilt","closeCoverTilt","stopCoverTilt","toLocaleDateStringSupportsOptions","toLocaleDateString","timeCachePromiseFunc","cacheKey","cacheTime","cache","lastResult","result","_args","_x3","_x4","_x5","MediaPlayerEntity","volume","volume_level","isOff","turnOff","mute","supportsVolumeMute","is_volume_muted","source","soundMode","sound_mode","media_content_type","isPlaying","isPaused","progress","media_position","media_position_updated_at","media_title","isMusic","media_artist","isTVShow","text","media_series_title","media_season","media_episode","app_name","source_list","sound_mode_list","CAMERA_SUPPORT_STREAM","computeMJPEGStreamUrl","fetchThumbnailUrlWithCache","fetchStreamUrl","fetchCameraPrefs","updateCameraPrefs","_common_util_time_cache_function_promise__WEBPACK_IMPORTED_MODULE_0__","_auth__WEBPACK_IMPORTED_MODULE_1__","access_token","fetchThumbnailUrl","getSignedPath","prefs","createAreaRegistryEntry","subscribeAreaRegistry","home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_0__","_common_string_compare__WEBPACK_IMPORTED_MODULE_1__","_common_util_debounce__WEBPACK_IMPORTED_MODULE_2__","values","fetchAreaRegistry","areas","sort","ent1","ent2","subscribeAreaRegistryUpdates","store","setState","createCollection","updateDeviceRegistryEntry","subscribeDeviceRegistry","_common_util_debounce__WEBPACK_IMPORTED_MODULE_1__","deviceId","updates","device_id","fetchDeviceRegistry","subscribeDeviceRegistryUpdates","devices","ICONS","armed_away","armed_custom_bypass","armed_home","armed_night","disarmed","pending","triggered","BUTTONS","code_format","split","_code","_label","classMap","_stateIconLabel","_handleActionClick","_templateObject6","_templateObject5","_templateObject7","_templateObject8","_templateObject9","_templateObject10","_handlePadClick","stateLabel","pop","val","currentTarget","action","code","_templateObject11","checkConditionsMet","conditions","c","state_not","validateConditionalConfig","HuiConditionalCard","HTMLElement","_card","parentElement","removeChild","createCardElement","update","_hass","visible","appendChild","setProperty","isTouch","navigator","maxTouchPoints","msMaxTouchPoints","LongPress","long_press_directive_classCallCheck","long_press_directive_getPrototypeOf","long_press_directive_defineProperty","long_press_directive_assertThisInitialized","holdTime","ripple","held","cooldownStart","cooldownEnd","borderRadius","width","height","transform","pointerEvents","stopAnimation","passive","_this3","longPress","event","preventDefault","cancelBubble","returnValue","clickStart","x","y","touches","pageX","pageY","startAnimation","clickEnd","dispatchEvent","Event","left","top","holdDown","simulatedRipple","longPressBind","longpress","body","querySelector","getLongPress","directive","part","committer","toggleEntity","turnOnOffEntity","handleClick","hold","actionConfig","hold_action","tap_action","camera_image","navigation_path","navigate","_actionConfig$service2","service_data","HuiEntityButtonCard","show_icon","show_name","theme","DOMAINS_TOGGLE","hui_entity_button_card_templateObject","hui_entity_button_card_templateObject3","_handleTap","_handleHold","hui_entity_button_card_templateObject4","styleMap","_computeBrightness","_computeColor","icon_height","hui_entity_button_card_templateObject5","hui_entity_button_card_templateObject2","hui_entity_button_card_getPrototypeOf","themes","applyThemesOnElement","hui_entity_button_card_templateObject6","_stateObj$attributes$","hui_entity_button_card_slicedToArray","EntityFilterCard","_element","state_filter","_configEntities","_baseCardConfig","lastChild","entitiesList","show_empty","_cardElement","isPanel","hui_warning_element_decorate","HuiWarningElement","hui_warning_element_classCallCheck","hui_warning_element_getPrototypeOf","hui_warning_element_assertThisInitialized","hui_warning_element_inherits","hui_warning_element_templateObject","label","hui_warning_element_templateObject2","hui_glance_card_decorate","HuiGlanceCard","hui_glance_card_classCallCheck","hui_glance_card_getPrototypeOf","hui_glance_card_assertThisInitialized","hui_glance_card_inherits","_getConfigElement","title","ceil","columns","min","requestUpdate","hui_glance_card_templateObject","hui_glance_card_templateObject2","no-header","renderEntity","changedProperties","hui_glance_card_get","hui_glance_card_templateObject3","hui_glance_card_templateObject5","hui_glance_card_templateObject6","hui_glance_card_templateObject7","show_state","hui_glance_card_templateObject8","hui_glance_card_templateObject4","HuiHistoryGraphCard","hui_history_graph_card_templateObject","_names","_entities","_stateHistory","_stateHistoryLoading","_cacheConfig","setProperties","hoursToShow","hours_to_show","refresh","refresh_interval","HuiStackCard","hui_stack_card_classCallCheck","hui_stack_card_getPrototypeOf","hui_stack_card_defineProperty","hui_stack_card_assertThisInitialized","hui_stack_card_inherits","_cards","_createCardElement","hui_stack_card_templateObject2","renderStyle","hui_stack_card_templateObject","_rebuildCard","once","cardElToReplace","newCardEl","replaceChild","curCardEl","set","HuiHorizontalStackCard","totalSize","elementSize","hui_horizontal_stack_card_templateObject","hui_iframe_card_decorate","HuiIframeCard","hui_iframe_card_classCallCheck","hui_iframe_card_getPrototypeOf","hui_iframe_card_assertThisInitialized","hui_iframe_card_inherits","aspect_ratio","hui_iframe_card_templateObject","aspectRatio","hui_iframe_card_templateObject2","padding-top","hui_iframe_card_templateObject3","loadRoundslider","lightConfig","radius","step","circleShape","startAngle","max","sliderType","lineCap","handleSize","showTooltip","animation","hui_light_card_decorate","HuiLightCard","hui_light_card_classCallCheck","hui_light_card_getPrototypeOf","hui_light_card_assertThisInitialized","hui_light_card_inherits","hui_light_card_asyncToGenerator","hui_light_card_templateObject","hui_light_card_templateObject3","_handleMoreInfo","hui_light_card_templateObject2","_firstUpdated","sent","_roundSliderStyle","roundSliderStyle","_jQuery","jQuery","shadowRoot","roundSlider","change","_setBrightness","drag","_dragEvent","start","_showBrightness","_hideBrightness","hui_light_card_get","attrs","hui_light_card_templateObject4","_brightnessTimout","classList","add","remove","brightness_pct","hui_light_card_slicedToArray","HaEntityMarker","ha_entity_marker_templateObject","entityName","entityPicture","ha_entity_marker_get","ha_entity_marker_getPrototypeOf","badgeTap","parseOrThrow","parsed","parseFloat","parseAspectRatio","input","endsWith","w","arr","HuiMapCard","reflect","_leafletMap","invalidateSize","geo_location_sources","ratio","ar","toFixed","hui_map_card_get","hui_map_card_getPrototypeOf","_connected","hasUpdated","loadMap","_attachObserver","Leaflet","_resizeObserver","unobserve","_mapEl","removeEventListener","_debouncedResizeListener","hui_map_card_templateObject2","_fitMap","hui_map_card_templateObject","getElementById","paddingBottom","_drawEntities","_ref2","setupLeafletMap","dark_mode","hui_map_card_slicedToArray","zoom","default_zoom","_mapItems","bounds","latLngBounds","item","getLatLng","fitBounds","pad","getZoom","setZoom","setView","LatLng","latitude","longitude","marker","mapItems","allEntities","includesAll","_i2","_Object$keys","_stateObj$attributes","gpsAccuracy","gps_accuracy","divIcon","iconSize","className","circle","interactive","addLayer","ResizeObserver","observe","hui_map_card_templateObject3","hui_markdown_card_decorate","HuiMarkdownCard","hui_markdown_card_classCallCheck","hui_markdown_card_getPrototypeOf","hui_markdown_card_assertThisInitialized","hui_markdown_card_inherits","hui_markdown_card_templateObject2","hui_markdown_card_templateObject","hui_markdown_card_templateObject3","HaMediaPlayerCard","playerObj","oldPlayerObj","showProgress","_positionTracking","updatePlaybackPosition","picture","oldPicture","$","_coverShowing","_coverLoadError","fetchMediaPlayerThumbnailWithCache","contentType","content_type","playbackPosition","currentProgress","coverShowing","coverLoadError","cls","isIdle","supportsTurnOn","supportsTurnOff","HassMediaPlayerEntity","primaryTitle","supportsPause","hasMediaControl","supportsPlay","nextTrack","mediaPlayPause","previousTrack","togglePower","ha_media_player_card_templateObject","playbackControlIcon","LegacyWrapperCard","hui_legacy_wrapper_card_classCallCheck","hui_legacy_wrapper_card_possibleConstructorReturn","hui_legacy_wrapper_card_getPrototypeOf","_tag","toUpperCase","_domain","_ensureElement","HuiMediaControlCard","hui_media_control_card_classCallCheck","hui_media_control_card_possibleConstructorReturn","hui_media_control_card_getPrototypeOf","hui_picture_card_decorate","HuiPictureCard","hui_picture_card_classCallCheck","hui_picture_card_getPrototypeOf","hui_picture_card_assertThisInitialized","hui_picture_card_inherits","image","hui_picture_card_templateObject2","clickable","hui_picture_card_templateObject","hui_picture_card_templateObject3","HuiConditionalElement","elements","_elements","elementConfig","createStyledHuiElement","updateElements","computeTooltip","stateName","tapTooltip","computeActionTooltip","holdTooltip","isHold","tooltip","hui_icon_element_decorate","HuiIconElement","hui_icon_element_classCallCheck","hui_icon_element_getPrototypeOf","hui_icon_element_assertThisInitialized","hui_icon_element_inherits","hui_icon_element_templateObject2","hui_icon_element_templateObject","hui_icon_element_templateObject3","hui_image_decorate","HuiImage","hui_image_classCallCheck","hui_image_getPrototypeOf","hui_image_assertThisInitialized","hui_image_inherits","hui_image_get","_attached","cameraImage","cameraView","_startUpdateCameraInterval","_stopUpdateCameraInterval","imageSrc","cameraObj","imageFallback","stateImage","_cameraImageSrc","stateFilter","hui_image_templateObject","hui_image_templateObject2","hui_image_templateObject3","_onImageError","_onImageLoad","_loadError","_lastImageHeight","_updateCameraImageSrc","_cameraUpdater","_onImageLoad2","hui_image_asyncToGenerator","updateComplete","_image","offsetHeight","_updateCameraImageSrc2","hui_image_templateObject4","hui_image_element_decorate","HuiImageElement","hui_image_element_classCallCheck","hui_image_element_getPrototypeOf","hui_image_element_assertThisInitialized","hui_image_element_inherits","toggle","hui_image_element_templateObject2","state_image","hui_image_element_templateObject","hui_image_element_templateObject3","HaProgressButton","ha_progress_button_templateObject","disabled","container","ha_progress_button_get","ha_progress_button_getPrototypeOf","buttonTapped","tempClass","HaCallServiceButton","ha_call_service_button_templateObject","serviceData","eventData","actionSuccess","success","actionError","hui_service_button_element_decorate","HuiServiceButtonElement","hui_service_button_element_classCallCheck","hui_service_button_element_getPrototypeOf","hui_service_button_element_assertThisInitialized","hui_service_button_element_inherits","_config$service$split2","hui_service_button_element_slicedToArray","_service","hui_service_button_element_templateObject2","hui_service_button_element_templateObject","hui_service_button_element_templateObject3","hui_state_badge_element_decorate","HuiStateBadgeElement","hui_state_badge_element_classCallCheck","hui_state_badge_element_getPrototypeOf","hui_state_badge_element_assertThisInitialized","hui_state_badge_element_inherits","hui_state_badge_element_templateObject","hui_state_badge_element_templateObject3","hui_state_badge_element_templateObject2","hui_state_icon_element_decorate","HuiStateIconElement","hui_state_icon_element_classCallCheck","hui_state_icon_element_getPrototypeOf","hui_state_icon_element_assertThisInitialized","hui_state_icon_element_inherits","hui_state_icon_element_templateObject","hui_state_icon_element_templateObject3","_handleClick","hui_state_icon_element_templateObject2","hui_state_icon_element_templateObject4","hui_state_label_element_templateObject","hui_state_label_element_templateObject3","prefix","suffix","hui_state_label_element_templateObject2","hui_state_label_element_templateObject4","ELEMENT_TYPES","Set","TIMEOUT","_createElement","deepClone","_createErrorElement","message","createHuiElement","create_hui_element_typeof","startsWith","_hideErrorElement","whenDefined","prop","querySelectorAll","hui_picture_elements_card_templateObject2","camera_view","hui_picture_elements_card_templateObject","hui_picture_elements_card_templateObject3","hui_picture_entity_card_templateObject","hui_picture_entity_card_templateObject2","footer","hui_picture_entity_card_templateObject3","hui_picture_entity_card_templateObject4","hui_picture_entity_card_templateObject5","hui_picture_entity_card_templateObject6","hui_picture_entity_card_templateObject7","_entitiesDialog","_entitiesToggle","force_dialog","hui_picture_glance_card_templateObject2","hui_picture_glance_card_templateObject3","hui_picture_glance_card_templateObject","dialog","hui_picture_glance_card_templateObject5","_openDialog","state-on","hui_picture_glance_card_templateObject4","hui_picture_glance_card_templateObject6","SENSORS","moisture","conductivity","hui_plant_status_card_templateObject","hui_plant_status_card_templateObject3","computeAttributes","hui_plant_status_card_templateObject4","computeIcon","problem","unit_of_measurement_dict","hui_plant_status_card_templateObject2","hui_plant_status_card_templateObject5","batLvl","sensors","getPath","coords","Z","_Ax","_Ay","_Bx","_By","calcPoints","history","hours","yRatio","xRatio","isFinite","getCoords","offset","depth","subItem","average","reduce","sum","entry","margin","coordinates","res","point","age","toString","HuiSensorCard","hui_sensor_card_templateObject","graph","hui_sensor_card_templateObject2","hui_sensor_card_templateObject3","_history","svg","hui_sensor_card_templateObject5","hui_sensor_card_templateObject4","hui_sensor_card_templateObject6","_date","hui_sensor_card_get","hui_sensor_card_getPrototypeOf","_getHistory","setHours","getHours","hui_sensor_card_templateObject7","HuiVerticalStackCard","hui_vertical_stack_card_templateObject","updateItem","itemId","item_id","HuiShoppingListCard","_uncheckedItems","_checkedItems","_fetchData","hui_shopping_list_card_get","hui_shopping_list_card_getPrototypeOf","_unsubEvents","connection","hui_shopping_list_card_templateObject2","_addItem","_addKeyPress","repeat","id","hui_shopping_list_card_templateObject3","complete","_completeItem","_saveEdit","hui_shopping_list_card_templateObject4","_clearItems","hui_shopping_list_card_templateObject5","hui_shopping_list_card_templateObject","hui_shopping_list_card_templateObject6","checkedItems","uncheckedItems","_this4","_this5","blur","_this6","_this7","newItem","_newItem","focus","keyCode","thermostatConfig","modeIcons","auto","manual","heat","cool","off","fan_only","eco","dry","idle","hui_thermostat_card_decorate","HuiThermostatCard","hui_thermostat_card_classCallCheck","hui_thermostat_card_getPrototypeOf","hui_thermostat_card_assertThisInitialized","hui_thermostat_card_inherits","hui_thermostat_card_asyncToGenerator","hui_thermostat_card_get","_updated","_loaded","_initialLoad","_classMap","hui_thermostat_card_templateObject","hui_thermostat_card_templateObject2","mode","operation_mode","hui_thermostat_card_templateObject3","hui_thermostat_card_defineProperty","_broadCard","current_temperature","hui_thermostat_card_templateObject4","operation_list","modeItem","_renderIcon","isConnected","_this$_genSliderValue2","hui_thermostat_card_slicedToArray","_genSliderValue","sliderValue","uiValue","_updateSetTemp","target_temp_step","_initialLoad2","_sliderType","_this$_genSliderValue3","_this$_genSliderValue4","clientWidth","target_temp_low","target_temp_high","min_temp","max_temp","_setTemperature","_stepSize","formatTemp","handle","currentMode","hui_thermostat_card_templateObject6","selected-icon","_handleModeClick","hui_thermostat_card_templateObject5","temps","spaceStepSize","stepSize","hui_thermostat_card_templateObject7","HaWeatherCard","ha_weather_card_classCallCheck","ha_weather_card_possibleConstructorReturn","ha_weather_card_getPrototypeOf","cardinalDirections","weatherIcons","clear-night","cloudy","fog","hail","lightning","lightning-rainy","partlycloudy","pouring","rainy","snowy","snowy-rainy","sunny","windy","windy-variant","ha_weather_card_templateObject","forecast","rtl","reflectToAttribute","_onClick","ha_weather_card_get","slice","measure","lengthUnit","condition","degree","degreenum","parseInt","speed","getUnit","bearing","cardinalDirection","windBearingToText","weekday","computeRTL","HuiWeatherForecastCard","hui_weather_forecast_card_classCallCheck","hui_weather_forecast_card_possibleConstructorReturn","hui_weather_forecast_card_getPrototypeOf","severityMap","red","green","yellow","normal","HuiGaugeCard","hui_gauge_card_get","hui_gauge_card_getPrototypeOf","_setBaseUnit","hui_gauge_card_templateObject","hui_gauge_card_templateObject2","hui_gauge_card_templateObject3","hui_gauge_card_templateObject4","--base-unit","_baseUnit","_translateTurn","background-color","_computeSeverity","baseUnit","_computeBaseUnit","numberValue","sections","severity","sortable","hui_gauge_card_templateObject5","CARD_TYPES","create_card_element_typeof","scriptsLoaded","HaChartBase","mixinBehaviors","IronResizableBehavior","count","processL","h1","loopI","Color","hsl","staticColors","startIndex","palette","getColorIndex","idx","colorDict","colorIndex","c1","__","ret","name1","rendered","readOnly","metas","opacity","xPadding","yPadding","_isAttached","onPropsChange","_resizeListener","_debouncer","Debouncer","timeOut","after","resizeChart","resizeObserver","entries","chartTarget","ChartModule","ChartClass","_resizeTimer","drawChart","yAlign","bodyLines","n","lines","colors","labelColors","borderColor","bgColor","backgroundColor","parentWidth","positionX","caretX","positionY","_chart","canvas","offsetTop","caretY","offsetLeft","srcElement","nodeName","model","itemsIndex","meta","getDatasetMeta","hidden","datasets","isDatasetVisible","chart","preserveVisibility","_oldIdentifier","updateNeeded","ctx","chartCanvas","cnt","constructor","getColorList","rgbString","alpha","rgbaString","_customTooltips","duration","isTimeline","scales","yAxes","gridLines","legend","_drawLegend","plugins","afterRender","_setRendered","responsive","maintainAspectRatio","hover","animationDuration","responsiveAnimationDuration","tooltips","enabled","custom","spanGaps","font","ticks","fontFamily","Chart","helpers","merge","xAxes","callback","_formatTickValue","_colorFunc","getColorGenerator","staticColorIndex","colorFunction","chartData","_resizeChart","areaTop","chartArea","areaBot","bottom","height1","clientHeight","_axisHeight","resize","targetHeight","StateHistoryChartLine","state_history_chart_line_templateObject","names","isSingleDevice","state_history_chart_line_get","state_history_chart_line_getPrototypeOf","animateHeight","requestAnimationFrame","scrollHeight","deviceStates","devSts","prevValues","pushData","timestamp","datavalues","addColumn","nameY","fill","dataFill","dataStep","steppedLine","pointRadius","unitText","hasTargetRange","some","hasHeat","hasCool","curTemp","safeParseFloat","series","targetHigh","targetLow","lastValue","lastDate","lastNullDate","dateTime","lastNullDateTime","lastDateTime","chartOptions","major","fontStyle","maxTicksLimit","callbacks","datasetIndex","layout","padding","tension","borderWidth","hitRadius","filler","propagate","labels","StateHistoryChartTimeline","state_history_chart_timeline_templateObject","noSingle","state_history_chart_timeline_get","state_history_chart_timeline_getPrototypeOf","minTime","maxTime","newLastChanged","prevState","locState","prevLastChanged","entityDisplay","dataRow","newState","end","afterSetDimensions","yaxe","maxWidth","_computeRTL","on","unavailable","unknown","StateHistoryCharts","state_history_charts_templateObject","historyData","isLoadingData","upToNow","historyDataEmpty","isLoading","RECENT_CACHE","stateHistoryCache","getRecentWithCache","cacheConfig","toFetchStartTime","appendingToCache","prom","getEmptyCache","curCacheProm","genProm","fetchedHistory","results","t0","mergeLine","mergeTimeline","pruneStartTime","historyLines","cacheLines","oldLine","cacheLine","oldEntity","cacheEntity","historyTimelines","cacheTimelines","oldTimeline","cacheTimeline","pruneArray","originalStartTime","changedAfterStartTime","findIndex","updateIndex","cacheData","HaStateHistoryData","filterType","filterChangedDebouncer","_refreshTimeoutId","newHass","_madeFirstCall","_debounceFilterChanged","filterChanged","dateHistory","getRecentWithCacheRefresh","created","getRecent","_setIsLoading","_setData","timerTimeRemaining","parts","timeRemaining","remaining","madeActive","HaStateLabelBadge","startInterval","_defineProperty","_computeValue","_computeIcon","_computeLabel","_timerTimeRemaining","_clearInterval","_updateRemaining","calculateTimerRemaining","validEntityId","test","HaClimateState","currentStatus","current_humidity","target_humidity_low","target_humidity_high","HaCoverControls","isFullyOpen","isOpening","isFullyClosed","isClosing","openCover","closeCover","stopCover","PaperTimeInput","_PolymerElement","autoValidate","hideLabel","amPm","valid","validate","dropdown","n1","n2","subTemplate","PaperSliderClass","HaSlider","template","cloneNode","createTextNode","numSteps","stepStr","stepPointAt","precision","pow","setInputSelectOption","option","mapElement","darkMode","parentNode","t","Icon","Default","imagePath","setAttribute","tileLayer","Browser","retina","attribution","subdomains","minZoom","maxZoom","addTo","updateEntityRegistryEntry","subscribeEntityRegistry","fetchEntityRegistry","subscribeEntityRegistryUpdates","HaLabelBadge","description","big","SUPPORT_PAUSE","SUPPORT_NEXT_TRACK","SUPPORTS_PLAY","OFF_STATES","fetchMediaPlayerThumbnail","showEditCardDialog","_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_0__","registeredDialog","editCardDialogParams","dialogShowEvent","dialogTag","dialogImport","registerEditCardDialog","afterNextRender","cb","HuiEntitiesToggle","_toggleEntities","entityIds","domainsToCall","turnOnOffEntities","HuiGenericEntityRow","hui_generic_entity_row_templateObject","hui_generic_entity_row_templateObject3","showSecondary","secondary_info","hui_generic_entity_row_templateObject2","hui_generic_entity_row_get","hui_generic_entity_row_getPrototypeOf","toggleAttribute","hui_climate_entity_row_templateObject","hui_climate_entity_row_templateObject3","hui_climate_entity_row_templateObject2","hui_climate_entity_row_templateObject4","hui_cover_entity_row_templateObject","hui_cover_entity_row_templateObject3","hui_cover_entity_row_templateObject4","hui_cover_entity_row_templateObject5","hui_cover_entity_row_templateObject2","hui_cover_entity_row_templateObject6","hui_group_entity_row_templateObject","hui_group_entity_row_templateObject3","_computeCanToggle","hui_group_entity_row_templateObject4","hui_group_entity_row_templateObject5","hui_group_entity_row_templateObject2","ha_date_input_decorate","HaDateInput","ha_date_input_classCallCheck","ha_date_input_getPrototypeOf","ha_date_input_assertThisInitialized","ha_date_input_inherits","ha_date_input_templateObject","ha_date_input_templateObject2","_formatYear","_formatMonth","_formatDay","yearElement","monthElement","dayElement","hui_input_datetime_entity_row_templateObject","hui_input_datetime_entity_row_templateObject3","hui_input_datetime_entity_row_templateObject4","_selectedValueChanged","_stopEventPropagation","hui_input_datetime_entity_row_templateObject5","hui_input_datetime_entity_row_templateObject2","time","_timeInputEl","trim","_dateInputEl","param","setInputDateTimeValue","setValue","HuiInputNumberEntityRow","hui_input_number_entity_row_get","hui_input_number_entity_row_getPrototypeOf","hui_input_number_entity_row_templateObject","hui_input_number_entity_row_templateObject3","hui_input_number_entity_row_templateObject4","computeRTLDirection","hui_input_number_entity_row_templateObject5","hui_input_number_entity_row_templateObject2","hui_input_number_entity_row_templateObject6","_inputElement","HuiInputSelectEntityRow","hui_input_select_entity_row_templateObject","hui_input_select_entity_row_templateObject3","_selectedChanged","hui_input_select_entity_row_templateObject4","hui_input_select_entity_row_templateObject2","hui_input_select_entity_row_get","hui_input_select_entity_row_getPrototypeOf","selected","hui_input_select_entity_row_templateObject5","selectedItem","hui_input_text_entity_row_templateObject","hui_input_text_entity_row_templateObject3","pattern","hui_input_text_entity_row_templateObject2","_inputEl","hui_lock_entity_row_templateObject","hui_lock_entity_row_templateObject3","hui_lock_entity_row_templateObject2","hui_lock_entity_row_templateObject4","hui_media_player_entity_row_templateObject","hui_media_player_entity_row_templateObject3","hui_media_player_entity_row_templateObject4","hui_media_player_entity_row_templateObject5","hui_media_player_entity_row_templateObject6","_computeControlIcon","_playPause","_nextTrack","_computeMediaTitle","hui_media_player_entity_row_templateObject2","hui_scene_entity_row_templateObject","hui_scene_entity_row_templateObject3","can_cancel","hui_scene_entity_row_templateObject4","hui_scene_entity_row_templateObject5","hui_scene_entity_row_templateObject2","hui_scene_entity_row_templateObject6","hui_script_entity_row_templateObject","hui_script_entity_row_templateObject3","hui_script_entity_row_templateObject4","hui_script_entity_row_templateObject5","hui_script_entity_row_templateObject2","hui_script_entity_row_templateObject6","FORMATS","format_date","format_date_time","format_time","INTERVAL_FORMAT","HuiTimestampDisplay","hui_timestamp_display_get","hui_timestamp_display_getPrototypeOf","_startInterval","ts","hui_timestamp_display_templateObject","hui_timestamp_display_templateObject2","_format","hui_timestamp_display_templateObject3","_relative","hui_timestamp_display_templateObject4","hui_timestamp_display_templateObject5","_updateRelative","_interval","hui_sensor_entity_row_templateObject","hui_sensor_entity_row_templateObject3","hui_sensor_entity_row_templateObject4","hui_sensor_entity_row_templateObject2","hui_sensor_entity_row_templateObject5","hui_text_entity_row_templateObject","hui_text_entity_row_templateObject3","hui_text_entity_row_templateObject2","hui_text_entity_row_templateObject4","HuiTimerEntityRow","hui_timer_entity_row_get","hui_timer_entity_row_getPrototypeOf","hui_timer_entity_row_templateObject","hui_timer_entity_row_templateObject3","_computeDisplay","hui_timer_entity_row_templateObject2","_calculateRemaining","_timeRemaining","hui_toggle_entity_row_templateObject","hui_toggle_entity_row_templateObject3","hui_toggle_entity_row_templateObject4","hui_toggle_entity_row_templateObject5","hui_toggle_entity_row_templateObject2","action_name","hui_call_service_row_templateObject2","hui_call_service_row_templateObject","hui_call_service_row_templateObject3","hui_divider_row_templateObject","hui_divider_row_templateObject2","hui_section_row_templateObject2","hui_section_row_templateObject3","hui_section_row_templateObject4","hui_section_row_templateObject","hui_section_row_templateObject5","hui_weblink_row_templateObject2","hui_weblink_row_templateObject","hui_weblink_row_templateObject3","SPECIAL_TYPES","DOMAIN_TO_ELEMENT_TYPE","lock","media_player","createRowElement","create_row_element_typeof","HuiEntitiesCard","entitiesToggle","hui_entities_card_get","hui_entities_card_getPrototypeOf","hui_entities_card_templateObject","_this$_config","show_header_toggle","hui_entities_card_templateObject2","hui_entities_card_templateObject4","hui_entities_card_templateObject5","hui_entities_card_templateObject6","conf","hui_entities_card_templateObject3","hui_entities_card_templateObject7","DOMAINS_HIDE_MORE_INFO","hui_entities_card_templateObject8","HaAppLayout","HaStartVoiceButton","ha_start_voice_button_templateObject","canListen","paperIconButtonClass","HaPaperIconButtonArrowNext","_paperIconButtonClass","ha_paper_icon_button_arrow_next_classCallCheck","ha_paper_icon_button_arrow_next_possibleConstructorReturn","ha_paper_icon_button_arrow_next_getPrototypeOf","ha_paper_icon_button_arrow_next_inherits","fetchNotifications","subscribeUpdates","ntf","HuiNotificationItemTemplate","hui_notification_item_template_classCallCheck","hui_notification_item_template_getPrototypeOf","hui_notification_item_template_assertThisInitialized","hui_notification_item_template_inherits","hui_notification_item_template_templateObject","hui_configurator_notification_item_decorate","HuiConfiguratorNotificationItem","hui_configurator_notification_item_classCallCheck","hui_configurator_notification_item_getPrototypeOf","hui_configurator_notification_item_assertThisInitialized","hui_configurator_notification_item_inherits","notification","hui_configurator_notification_item_templateObject2","hui_configurator_notification_item_templateObject","hui_persistent_notification_item_decorate","HuiPersistentNotificationItem","hui_persistent_notification_item_classCallCheck","hui_persistent_notification_item_getPrototypeOf","hui_persistent_notification_item_assertThisInitialized","hui_persistent_notification_item_inherits","hui_persistent_notification_item_templateObject2","_computeTitle","created_at","_computeTooltip","_handleDismiss","hui_persistent_notification_item_templateObject","notification_id","hui_notification_item_decorate","HuiNotificationItem","hui_notification_item_classCallCheck","hui_notification_item_getPrototypeOf","hui_notification_item_assertThisInitialized","hui_notification_item_inherits","hui_notification_item_templateObject2","hui_notification_item_templateObject3","hui_notification_item_templateObject","HaPaperIconButtonNext","ha_paper_icon_button_next_classCallCheck","ha_paper_icon_button_next_possibleConstructorReturn","ha_paper_icon_button_next_getPrototypeOf","ha_paper_icon_button_next_inherits","ha_paper_icon_button_next_get","HuiNotificationDrawer","_EventsMixin","hui_notification_drawer_classCallCheck","hui_notification_drawer_possibleConstructorReturn","hui_notification_drawer_getPrototypeOf","hui_notification_drawer_inherits","hui_notification_drawer_templateObject","narrow","notifications","_openTimer","HuiNotificationsButton","hui_notifications_button_templateObject","_clicked","hui_notifications_button_templateObject2","hui_notifications_button_templateObject3","opened","editCodeLoaded","HUIView","hui_view_decorate","hui_view_classCallCheck","hui_view_getPrototypeOf","hui_view_assertThisInitialized","_badges","hui_view_inherits","lovelace","editMode","hui_view_templateObject","renderStyles","hui_view_templateObject2","_addCard","hui_view_templateObject3","hui_view_get","editModeChanged","configChanged","oldLovelace","_createBadges","badge","_createCards","badges","elementsToAppend","wrapper","columnEntityCount","cardSize","size","minIndex","getColumnIndex","column","columnEl","showEditViewDialog","editViewDialogParams","registerEditViewDialog","showEditLovelaceDialog","registerEditLovelaceDialog","CSS_CACHE","JS_CACHE","HUIRoot","hui_root_classCallCheck","hui_root_getPrototypeOf","hui_root_assertThisInitialized","_debouncedConfigChanged","_selectView","_curView","hui_root_get","_unsubNotifications","_persistentNotifications","hui_root_templateObject","route","_routeData","_routeDataChanged","_notifications","_notificationsOpen","_handleNotificationsOpenChanged","edit-mode","_editMode","hui_root_templateObject2","_editModeDisable","_editLovelace","_handleHelp","_deselect","enableFullEditMode","_hideToolbar","hui_root_templateObject3","_yamlMode","_handleRefresh","_handleUnusedEntities","_editModeEnable","_handleViewSelected","view","_moveViewLeft","_editView","_moveViewRight","_addView","tabs-hidden","haStyle","_templateObject12","newSelectView","huiView","_viewRoot","selectedView","selectedViewInt","_loadResources","resources","_updateNotifications","hideToolbar","search","persistent","computeNotifications","setEditMode","oldIndex","newIndex","scroller","animationId","currentScrollTop","deltaScrollTop","_layout","scrollTarget","random","scrollTop","_currentAnimationId","updateFrame","elapsedTime","_viewCache","unusedEntities","background","append","panel","resource","loadCSS","loadJS","loadModule","importHref","extractViews","DEFAULT_VIEW_ENTITY_ID","order","getViewEntities","viewEntities","groupEntities","getGroupEntities","grEntityId","grEntity","DOMAINS_BADGES","HIDE_DOMAIN","subscribedRegistries","computeCards","entityCardOptions","_step3$value","unshift","generateDefaultViewConfig","registries","_ref3","computeDefaultViewStates","groupOrders","splittedByAreas","areasWithEntities","_loop","area","areaEntities","areaDevices","device","area_id","otherEntities","splitByAreas","generateViewConfig","areaCards","splitted","groups","ungrouped","splitByGroups","gr1","gr2","badgeEntities","ungroupedEntitites","coll","groupEntity","control","generateLovelaceConfig","_ref4","_ref5","_ref6","viewEntity","location_name","editorLoaded","LovelacePanel","ha_panel_lovelace_classCallCheck","ha_panel_lovelace_getPrototypeOf","ha_panel_lovelace_assertThisInitialized","_closeEditor","_state","ha_panel_lovelace_templateObject","_columns","_forceFetchConfig","ha_panel_lovelace_templateObject2","_errorMsg","ha_panel_lovelace_templateObject3","ha_panel_lovelace_templateObject4","ha_panel_lovelace_get","_updateColumns","dockedSidebar","_fetchConfig","_lovelaceChanged","mqls","mql","matchMedia","addListener","_setLovelaceConfig","_regenerateConfig","matchColumns","cols","matches","_saving","showToast","dismissable","forceDiskRefresh","confMode","confProm","llWindow","llConfProm","log","saveDialogParams","_updateLovelace","_saveConfig2","ha_panel_lovelace_asyncToGenerator","_callee3","newConfig","previousConfig","previousMode","_context3","props","hassUrl","fetchAuthProviders","protocol","fetch","credentials","_load","reject","parent","onload","onerror","async","rel"],"mappings":"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","file":"chunk.74cdebde43cea65f3976.js","sourcesContent":["import { dedupingMixin } from \"@polymer/polymer/lib/utils/mixin\";\n\nimport { fireEvent } from \"../common/dom/fire_event\";\n\n// Polymer legacy event helpers used courtesy of the Polymer project.\n//\n// Copyright (c) 2017 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n//    * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n//    * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n//    * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\n/* @polymerMixin */\nexport const EventsMixin = dedupingMixin(\n  (superClass) =>\n    class extends superClass {\n      /**\n   * Dispatches a custom event with an optional detail value.\n   *\n   * @param {string} type Name of event type.\n   * @param {*=} detail Detail value containing event-specific\n   *   payload.\n   * @param {{ bubbles: (boolean|undefined),\n               cancelable: (boolean|undefined),\n                composed: (boolean|undefined) }=}\n    *  options Object specifying options.  These may include:\n    *  `bubbles` (boolean, defaults to `true`),\n    *  `cancelable` (boolean, defaults to false), and\n    *  `node` on which to fire the event (HTMLElement, defaults to `this`).\n    * @return {Event} The new event that was fired.\n    */\n      fire(type, detail, options) {\n        options = options || {};\n        return fireEvent(options.node || this, type, detail, options);\n      }\n    }\n);\n","import { UnsubscribeFunc, Connection } from \"home-assistant-js-websocket\";\n\nexport const subscribeOne = async <T>(\n  conn: Connection,\n  subscribe: (conn: Connection, onChange: (items: T) => void) => UnsubscribeFunc\n) =>\n  new Promise<T>((resolve) => {\n    const unsub = subscribe(conn, (items) => {\n      unsub();\n      resolve(items);\n    });\n  });\n","import { HomeAssistant } from \"../types\";\nimport { Connection } from \"home-assistant-js-websocket\";\n\nexport interface LovelaceConfig {\n  title?: string;\n  hideToolbar?: boolean; // IoB\n  views: LovelaceViewConfig[];\n  background?: string;\n  resources?: Array<{ type: \"css\" | \"js\" | \"module\" | \"html\"; url: string }>;\n}\n\nexport interface LovelaceViewConfig {\n  index?: number;\n  title?: string;\n  badges?: string[];\n  cards?: LovelaceCardConfig[];\n  path?: string;\n  icon?: string;\n  theme?: string;\n  panel?: boolean;\n  background?: string;\n}\n\nexport interface LovelaceCardConfig {\n  index?: number;\n  view_index?: number;\n  type: string;\n  [key: string]: any;\n}\n\nexport interface ToggleActionConfig {\n  action: \"toggle\";\n}\n\nexport interface CallServiceActionConfig {\n  action: \"call-service\";\n  service: string;\n  service_data?: {\n    entity_id?: string | [string];\n    [key: string]: any;\n  };\n}\n\nexport interface NavigateActionConfig {\n  action: \"navigate\";\n  navigation_path: string;\n}\n\nexport interface MoreInfoActionConfig {\n  action: \"more-info\";\n}\n\nexport interface NoActionConfig {\n  action: \"none\";\n}\n\nexport type ActionConfig =\n  | ToggleActionConfig\n  | CallServiceActionConfig\n  | NavigateActionConfig\n  | MoreInfoActionConfig\n  | NoActionConfig;\n\nexport const fetchConfig = (\n  conn: Connection,\n  force: boolean\n): Promise<LovelaceConfig> =>\n  conn.sendMessagePromise({\n    type: \"lovelace/config\",\n    force,\n  });\n\nexport const saveConfig = (\n  hass: HomeAssistant,\n  config: LovelaceConfig\n): Promise<void> =>\n  hass.callWS({\n    type: \"lovelace/config/save\",\n    config,\n  });\n\nexport const subscribeLovelaceUpdates = (\n  conn: Connection,\n  onChange: () => void\n) => conn.subscribeEvents(onChange, \"lovelace_updated\");\n\nexport interface WindowWithLovelaceProm extends Window {\n  llConfProm?: Promise<LovelaceConfig>;\n}\n","import { PolymerElement } from \"@polymer/polymer/polymer-element\";\nimport { EventsMixin } from \"../mixins/events-mixin\";\n\nlet loaded = null;\n\n/**\n * White list allowed svg tag.\n * Only put in the tag used in QR code, can be extend in future.\n */\nconst svgWhiteList = [\"svg\", \"path\"];\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaMarkdown extends EventsMixin(PolymerElement) {\n  static get properties() {\n    return {\n      content: {\n        type: String,\n        observer: \"_render\",\n      },\n      allowSvg: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    // 0 = not loaded, 1 = success, 2 = error\n    this._scriptLoaded = 0;\n    this._renderScheduled = false;\n    this._resize = () => this.fire(\"iron-resize\");\n\n    if (!loaded) {\n      loaded = import(/* webpackChunkName: \"load_markdown\" */ \"../resources/load_markdown\");\n    }\n    loaded\n      .then(\n        ({ marked, filterXSS }) => {\n          this.marked = marked;\n          this.filterXSS = filterXSS;\n          this._scriptLoaded = 1;\n        },\n        () => {\n          this._scriptLoaded = 2;\n        }\n      )\n      .then(() => this._render());\n  }\n\n  _render() {\n    if (this._scriptLoaded === 0 || this._renderScheduled) return;\n\n    this._renderScheduled = true;\n\n    // debounce it to next microtask.\n    Promise.resolve().then(() => {\n      this._renderScheduled = false;\n\n      if (this._scriptLoaded === 1) {\n        this.innerHTML = this.filterXSS(\n          this.marked(this.content, {\n            gfm: true,\n            tables: true,\n            breaks: true,\n          }),\n          {\n            onIgnoreTag: this.allowSvg\n              ? (tag, html) => (svgWhiteList.indexOf(tag) >= 0 ? html : null)\n              : null,\n          }\n        );\n        this._resize();\n\n        const walker = document.createTreeWalker(\n          this,\n          1 /* SHOW_ELEMENT */,\n          null,\n          false\n        );\n\n        while (walker.nextNode()) {\n          const node = walker.currentNode;\n\n          // Open external links in a new window\n          if (node.tagName === \"A\" && node.host !== document.location.host) {\n            node.target = \"_blank\";\n\n            // Fire a resize event when images loaded to notify content resized\n          } else if (node.tagName === \"IMG\") {\n            node.addEventListener(\"load\", this._resize);\n          }\n        }\n      } else if (this._scriptLoaded === 2) {\n        this.innerText = this.content;\n      }\n    });\n  }\n}\n\ncustomElements.define(\"ha-markdown\", HaMarkdown);\n","import { dedupingMixin } from \"@polymer/polymer/lib/utils/mixin\";\n/**\n * Polymer Mixin to enable a localize function powered by language/resources from hass object.\n *\n * @polymerMixin\n */\nexport default dedupingMixin(\n  (superClass) =>\n    class extends superClass {\n      static get properties() {\n        return {\n          hass: Object,\n\n          /**\n           * Translates a string to the current `language`. Any parameters to the\n           * string should be passed in order, as follows:\n           * `localize(stringKey, param1Name, param1Value, param2Name, param2Value)`\n           */\n          localize: {\n            type: Function,\n            computed: \"__computeLocalize(hass.localize)\",\n          },\n        };\n      }\n\n      __computeLocalize(localize) {\n        return localize;\n      }\n    }\n);\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport computeObjectId from \"./compute_object_id\";\n\nexport default (stateObj: HassEntity): string =>\n  stateObj.attributes.friendly_name === undefined\n    ? computeObjectId(stateObj.entity_id).replace(/_/g, \" \")\n    : stateObj.attributes.friendly_name || \"\";\n","import { Constructor } from \"lit-element\";\nimport \"@polymer/iron-icon/iron-icon\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { IronIconElement } from \"@polymer/iron-icon/iron-icon\";\n\nconst ironIconClass = customElements.get(\"iron-icon\") as Constructor<\n  IronIconElement\n>;\n\nlet loaded = false;\n\nexport class HaIcon extends ironIconClass {\n  private _iconsetName?: string;\n\n  public listen(\n    node: EventTarget | null,\n    eventName: string,\n    methodName: string\n  ): void {\n    super.listen(node, eventName, methodName);\n\n    if (!loaded && this._iconsetName === \"mdi\") {\n      loaded = true;\n      import(/* webpackChunkName: \"mdi-icons\" */ \"../resources/mdi-icons\");\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-icon\": HaIcon;\n  }\n}\n\ncustomElements.define(\"ha-icon\", HaIcon);\n","import { HomeAssistant } from \"../../../types\";\nimport { PropertyValues } from \"lit-element\";\n\n// Check if config or Entity changed\nexport function hasConfigOrEntityChanged(\n  element: any,\n  changedProps: PropertyValues\n): boolean {\n  if (changedProps.has(\"_config\")) {\n    return true;\n  }\n\n  const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n  if (oldHass) {\n    return (\n      oldHass.states[element._config!.entity] !==\n      element.hass!.states[element._config!.entity]\n    );\n  }\n\n  return true;\n}\n","import {\n  css,\n  CSSResult,\n  html,\n  LitElement,\n  property,\n  TemplateResult,\n} from \"lit-element\";\n\nclass HaCard extends LitElement {\n  @property() public header?: string;\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        background: var(\n          --ha-card-background,\n          var(--paper-card-background-color, white)\n        );\n        border-radius: var(--ha-card-border-radius, 2px);\n        box-shadow: var(\n          --ha-card-box-shadow,\n          0 2px 2px 0 rgba(0, 0, 0, 0.14),\n          0 1px 5px 0 rgba(0, 0, 0, 0.12),\n          0 3px 1px -2px rgba(0, 0, 0, 0.2)\n        );\n        color: var(--primary-text-color);\n        display: block;\n        transition: all 0.3s ease-out;\n        position: relative;\n      }\n\n      .card-header,\n      :host ::slotted(.card-header) {\n        color: var(--ha-card-header-color, --primary-text-color);\n        font-family: var(--ha-card-header-font-family, inherit);\n        font-size: var(--ha-card-header-font-size, 24px);\n        letter-spacing: -0.012em;\n        line-height: 32px;\n        padding: 24px 16px 16px;\n        display: block;\n      }\n\n      :host ::slotted(.card-content:not(:first-child)),\n      slot:not(:first-child)::slotted(.card-content) {\n        padding-top: 0px;\n        margin-top: -8px;\n      }\n\n      :host ::slotted(.card-content) {\n        padding: 16px;\n      }\n\n      :host ::slotted(.card-actions) {\n        border-top: 1px solid #e8e8e8;\n        padding: 5px 16px;\n      }\n    `;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      ${this.header\n        ? html`\n            <div class=\"card-header\">${this.header}</div>\n          `\n        : html``}\n      <slot></slot>\n    `;\n  }\n}\n\ncustomElements.define(\"ha-card\", HaCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResult,\n  css,\n  customElement,\n} from \"lit-element\";\n\n@customElement(\"hui-warning\")\nexport class HuiWarning extends LitElement {\n  protected render(): TemplateResult | void {\n    return html`\n      <slot></slot>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        color: black;\n        background-color: #fce588;\n        padding: 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-warning\": HuiWarning;\n  }\n}\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport computeDomain from \"./compute_domain\";\n\nexport default function computeStateDomain(stateObj: HassEntity) {\n  return computeDomain(stateObj.entity_id);\n}\n","import {\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  html,\n  property,\n  PropertyValues,\n  query,\n} from \"lit-element\";\nimport \"../ha-icon\";\nimport computeStateDomain from \"../../common/entity/compute_state_domain\";\nimport stateIcon from \"../../common/entity/state_icon\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { HaIcon } from \"../ha-icon\";\n\nclass StateBadge extends LitElement {\n  @property() public stateObj?: HassEntity;\n  @property() public overrideIcon?: string;\n  @query(\"ha-icon\") private _icon!: HaIcon;\n\n  protected render(): TemplateResult | void {\n    const stateObj = this.stateObj;\n\n    if (!stateObj) {\n      return html``;\n    }\n\n    return html`\n      <ha-icon\n        id=\"icon\"\n        data-domain=${computeStateDomain(stateObj)}\n        data-state=${stateObj.state}\n        .icon=${this.overrideIcon || stateIcon(stateObj)}\n      ></ha-icon>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    if (!changedProps.has(\"stateObj\") || !this.stateObj) {\n      return;\n    }\n    const stateObj = this.stateObj;\n\n    const iconStyle: Partial<CSSStyleDeclaration> = {\n      color: \"\",\n      filter: \"\",\n    };\n    const hostStyle: Partial<CSSStyleDeclaration> = {\n      backgroundImage: \"\",\n    };\n    if (stateObj) {\n      // hide icon if we have entity picture\n      if (stateObj.attributes.entity_picture && !this.overrideIcon) {\n        hostStyle.backgroundImage =\n          \"url(\" + stateObj.attributes.entity_picture + \")\";\n        iconStyle.display = \"none\";\n      } else {\n        if (stateObj.attributes.hs_color) {\n          const hue = stateObj.attributes.hs_color[0];\n          const sat = stateObj.attributes.hs_color[1];\n          if (sat > 10) {\n            iconStyle.color = `hsl(${hue}, 100%, ${100 - sat / 2}%)`;\n          }\n        }\n        if (stateObj.attributes.brightness) {\n          const brightness = stateObj.attributes.brightness;\n          if (typeof brightness !== \"number\") {\n            const errorMessage = `Type error: state-badge expected number, but type of ${\n              stateObj.entity_id\n            }.attributes.brightness is ${typeof brightness} (${brightness})`;\n            // tslint:disable-next-line\n            console.warn(errorMessage);\n          }\n          // lowest brighntess will be around 50% (that's pretty dark)\n          iconStyle.filter = `brightness(${(brightness + 245) / 5}%)`;\n        }\n      }\n    }\n    Object.assign(this._icon.style, iconStyle);\n    Object.assign(this.style, hostStyle);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        position: relative;\n        display: inline-block;\n        width: 40px;\n        color: var(--paper-item-icon-color, #44739e);\n        border-radius: 50%;\n        height: 40px;\n        text-align: center;\n        background-size: cover;\n        line-height: 40px;\n      }\n\n      ha-icon {\n        transition: color 0.3s ease-in-out, filter 0.3s ease-in-out;\n      }\n\n      /* Color the icon if light or sun is on */\n      ha-icon[data-domain=\"light\"][data-state=\"on\"],\n      ha-icon[data-domain=\"switch\"][data-state=\"on\"],\n      ha-icon[data-domain=\"binary_sensor\"][data-state=\"on\"],\n      ha-icon[data-domain=\"fan\"][data-state=\"on\"],\n      ha-icon[data-domain=\"sun\"][data-state=\"above_horizon\"] {\n        color: var(--paper-item-icon-active-color, #fdd835);\n      }\n\n      /* Color the icon if unavailable */\n      ha-icon[data-state=\"unavailable\"] {\n        color: var(--state-icon-unavailable-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"state-badge\": StateBadge;\n  }\n}\n\ncustomElements.define(\"state-badge\", StateBadge);\n","import { HassEntity } from \"home-assistant-js-websocket\";\n\nexport const supportsFeature = (\n  stateObj: HassEntity,\n  feature: number\n): boolean => {\n  // tslint:disable-next-line:no-bitwise\n  return (stateObj.attributes.supported_features! & feature) !== 0;\n};\n","// From: https://davidwalsh.name/javascript-debounce-function\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// tslint:disable-next-line: ban-types\nexport const debounce = <T extends Function>(\n  func: T,\n  wait,\n  immediate = false\n): T => {\n  let timeout;\n  // @ts-ignore\n  return function(...args) {\n    // tslint:disable:no-this-assignment\n    // @ts-ignore\n    const context = this;\n    const later = () => {\n      timeout = null;\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n};\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport computeStateDomain from \"./compute_state_domain\";\nimport formatDateTime from \"../datetime/format_date_time\";\nimport formatDate from \"../datetime/format_date\";\nimport formatTime from \"../datetime/format_time\";\nimport { LocalizeFunc } from \"../translations/localize\";\n\nexport default (\n  localize: LocalizeFunc,\n  stateObj: HassEntity,\n  language: string\n): string => {\n  let display: string | undefined;\n  const domain = computeStateDomain(stateObj);\n\n  if (domain === \"binary_sensor\") {\n    // Try device class translation, then default binary sensor translation\n    if (stateObj.attributes.device_class) {\n      display = localize(\n        `state.${domain}.${stateObj.attributes.device_class}.${stateObj.state}`\n      );\n    }\n\n    if (!display) {\n      display = localize(`state.${domain}.default.${stateObj.state}`);\n    }\n  } else if (\n    stateObj.attributes.unit_of_measurement &&\n    ![\"unknown\", \"unavailable\"].includes(stateObj.state)\n  ) {\n    display = stateObj.state + \" \" + stateObj.attributes.unit_of_measurement;\n  } else if (domain === \"input_datetime\") {\n    let date: Date;\n    if (!stateObj.attributes.has_time) {\n      date = new Date(\n        stateObj.attributes.year,\n        stateObj.attributes.month - 1,\n        stateObj.attributes.day\n      );\n      display = formatDate(date, language);\n    } else if (!stateObj.attributes.has_date) {\n      const now = new Date();\n      date = new Date(\n        // Due to bugs.chromium.org/p/chromium/issues/detail?id=797548\n        // don't use artificial 1970 year.\n        now.getFullYear(),\n        now.getMonth(),\n        now.getDay(),\n        stateObj.attributes.hour,\n        stateObj.attributes.minute\n      );\n      display = formatTime(date, language);\n    } else {\n      date = new Date(\n        stateObj.attributes.year,\n        stateObj.attributes.month - 1,\n        stateObj.attributes.day,\n        stateObj.attributes.hour,\n        stateObj.attributes.minute\n      );\n      display = formatDateTime(date, language);\n    }\n  } else if (domain === \"zwave\") {\n    if ([\"initializing\", \"dead\"].includes(stateObj.state)) {\n      display = localize(\n        `state.zwave.query_stage.${stateObj.state}`,\n        \"query_stage\",\n        stateObj.attributes.query_stage\n      );\n    } else {\n      display = localize(`state.zwave.default.${stateObj.state}`);\n    }\n  } else {\n    display = localize(`state.${domain}.${stateObj.state}`);\n  }\n\n  // Fall back to default, component backend translation, or raw state if nothing else matches.\n  if (!display) {\n    display =\n      localize(`state.default.${stateObj.state}`) ||\n      localize(`component.${domain}.state.${stateObj.state}`) ||\n      stateObj.state;\n  }\n\n  return display;\n};\n","/**\n * Return the icon to be used for a domain.\n *\n * Optionally pass in a state to influence the domain icon.\n */\nimport { DEFAULT_DOMAIN_ICON } from \"../const\";\n\nconst fixedIcons = {\n  alert: \"hass:alert\",\n  alexa: \"hass:amazon-alexa\",\n  automation: \"hass:playlist-play\",\n  calendar: \"hass:calendar\",\n  camera: \"hass:video\",\n  climate: \"hass:thermostat\",\n  configurator: \"hass:settings\",\n  conversation: \"hass:text-to-speech\",\n  device_tracker: \"hass:account\",\n  fan: \"hass:fan\",\n  google_assistant: \"hass:google-assistant\",\n  group: \"hass:google-circles-communities\",\n  history_graph: \"hass:chart-line\",\n  homeassistant: \"hass:home-assistant\",\n  homekit: \"hass:home-automation\",\n  image_processing: \"hass:image-filter-frames\",\n  input_boolean: \"hass:drawing\",\n  input_datetime: \"hass:calendar-clock\",\n  input_number: \"hass:ray-vertex\",\n  input_select: \"hass:format-list-bulleted\",\n  input_text: \"hass:textbox\",\n  light: \"hass:lightbulb\",\n  mailbox: \"hass:mailbox\",\n  notify: \"hass:comment-alert\",\n  person: \"hass:account\",\n  plant: \"hass:flower\",\n  proximity: \"hass:apple-safari\",\n  remote: \"hass:remote\",\n  scene: \"hass:google-pages\",\n  script: \"hass:file-document\",\n  sensor: \"hass:eye\",\n  simple_alarm: \"hass:bell\",\n  sun: \"hass:white-balance-sunny\",\n  switch: \"hass:flash\",\n  timer: \"hass:timer\",\n  updater: \"hass:cloud-upload\",\n  vacuum: \"hass:robot-vacuum\",\n  water_heater: \"hass:thermometer\",\n  weather: \"hass:weather-cloudy\",\n  weblink: \"hass:open-in-new\",\n};\n\nexport default function domainIcon(domain: string, state?: string): string {\n  if (domain in fixedIcons) {\n    return fixedIcons[domain];\n  }\n\n  switch (domain) {\n    case \"alarm_control_panel\":\n      switch (state) {\n        case \"armed_home\":\n          return \"hass:bell-plus\";\n        case \"armed_night\":\n          return \"hass:bell-sleep\";\n        case \"disarmed\":\n          return \"hass:bell-outline\";\n        case \"triggered\":\n          return \"hass:bell-ring\";\n        default:\n          return \"hass:bell\";\n      }\n\n    case \"binary_sensor\":\n      return state && state === \"off\"\n        ? \"hass:radiobox-blank\"\n        : \"hass:checkbox-marked-circle\";\n\n    case \"cover\":\n      return state === \"closed\" ? \"hass:window-closed\" : \"hass:window-open\";\n\n    case \"lock\":\n      return state && state === \"unlocked\" ? \"hass:lock-open\" : \"hass:lock\";\n\n    case \"media_player\":\n      return state && state !== \"off\" && state !== \"idle\"\n        ? \"hass:cast-connected\"\n        : \"hass:cast\";\n\n    case \"zwave\":\n      switch (state) {\n        case \"dead\":\n          return \"hass:emoticon-dead\";\n        case \"sleeping\":\n          return \"hass:sleep\";\n        case \"initializing\":\n          return \"hass:timer-sand\";\n        default:\n          return \"hass:z-wave\";\n      }\n\n    default:\n      // tslint:disable-next-line\n      console.warn(\n        \"Unable to find icon for domain \" + domain + \" (\" + state + \")\"\n      );\n      return DEFAULT_DOMAIN_ICON;\n  }\n}\n","import { dom } from \"@polymer/polymer/lib/legacy/polymer.dom\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport relativeTime from \"../common/datetime/relative_time\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaRelativeTime extends LocalizeMixin(PolymerElement) {\n  static get properties() {\n    return {\n      hass: Object,\n      datetime: {\n        type: String,\n        observer: \"datetimeChanged\",\n      },\n\n      datetimeObj: {\n        type: Object,\n        observer: \"datetimeObjChanged\",\n      },\n\n      parsedDateTime: Object,\n    };\n  }\n\n  constructor() {\n    super();\n    this.updateRelative = this.updateRelative.bind(this);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    // update every 60 seconds\n    this.updateInterval = setInterval(this.updateRelative, 60000);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    clearInterval(this.updateInterval);\n  }\n\n  datetimeChanged(newVal) {\n    this.parsedDateTime = newVal ? new Date(newVal) : null;\n\n    this.updateRelative();\n  }\n\n  datetimeObjChanged(newVal) {\n    this.parsedDateTime = newVal;\n\n    this.updateRelative();\n  }\n\n  updateRelative() {\n    const root = dom(this);\n    if (!this.parsedDateTime) {\n      root.innerHTML = this.localize(\"ui.components.relative_time.never\");\n    } else {\n      root.innerHTML = relativeTime(this.parsedDateTime, this.localize);\n    }\n  }\n}\n\ncustomElements.define(\"ha-relative-time\", HaRelativeTime);\n","import { supportsFeature } from \"../common/entity/supports-feature\";\n\n/* eslint-enable no-bitwise */\nexport default class CoverEntity {\n  constructor(hass, stateObj) {\n    this.hass = hass;\n    this.stateObj = stateObj;\n    this._attr = stateObj.attributes;\n    this._feat = this._attr.supported_features;\n  }\n\n  get isFullyOpen() {\n    if (this._attr.current_position !== undefined) {\n      return this._attr.current_position === 100;\n    }\n    return this.stateObj.state === \"open\";\n  }\n\n  get isFullyClosed() {\n    if (this._attr.current_position !== undefined) {\n      return this._attr.current_position === 0;\n    }\n    return this.stateObj.state === \"closed\";\n  }\n\n  get isFullyOpenTilt() {\n    return this._attr.current_tilt_position === 100;\n  }\n\n  get isFullyClosedTilt() {\n    return this._attr.current_tilt_position === 0;\n  }\n\n  get isOpening() {\n    return this.stateObj.state === \"opening\";\n  }\n\n  get isClosing() {\n    return this.stateObj.state === \"closing\";\n  }\n\n  get supportsOpen() {\n    return supportsFeature(this.stateObj, 1);\n  }\n\n  get supportsClose() {\n    return supportsFeature(this.stateObj, 2);\n  }\n\n  get supportsSetPosition() {\n    return supportsFeature(this.stateObj, 4);\n  }\n\n  get supportsStop() {\n    return supportsFeature(this.stateObj, 8);\n  }\n\n  get supportsOpenTilt() {\n    return supportsFeature(this.stateObj, 16);\n  }\n\n  get supportsCloseTilt() {\n    return supportsFeature(this.stateObj, 32);\n  }\n\n  get supportsStopTilt() {\n    return supportsFeature(this.stateObj, 64);\n  }\n\n  get supportsSetTiltPosition() {\n    return supportsFeature(this.stateObj, 128);\n  }\n\n  get isTiltOnly() {\n    const supportsCover =\n      this.supportsOpen || this.supportsClose || this.supportsStop;\n    const supportsTilt =\n      this.supportsOpenTilt || this.supportsCloseTilt || this.supportsStopTilt;\n    return supportsTilt && !supportsCover;\n  }\n\n  openCover() {\n    this.callService(\"open_cover\");\n  }\n\n  closeCover() {\n    this.callService(\"close_cover\");\n  }\n\n  stopCover() {\n    this.callService(\"stop_cover\");\n  }\n\n  openCoverTilt() {\n    this.callService(\"open_cover_tilt\");\n  }\n\n  closeCoverTilt() {\n    this.callService(\"close_cover_tilt\");\n  }\n\n  stopCoverTilt() {\n    this.callService(\"stop_cover_tilt\");\n  }\n\n  setCoverPosition(position) {\n    this.callService(\"set_cover_position\", { position });\n  }\n\n  setCoverTiltPosition(tiltPosition) {\n    this.callService(\"set_cover_tilt_position\", {\n      tilt_position: tiltPosition,\n    });\n  }\n\n  // helper method\n\n  callService(service, data = {}) {\n    data.entity_id = this.stateObj.entity_id;\n    this.hass.callService(\"cover\", service, data);\n  }\n}\n\nexport const supportsOpen = (stateObj) => supportsFeature(stateObj, 1);\n\nexport const supportsClose = (stateObj) => supportsFeature(stateObj, 2);\n\nexport const supportsSetPosition = (stateObj) => supportsFeature(stateObj, 4);\n\nexport const supportsStop = (stateObj) => supportsFeature(stateObj, 8);\n\nexport const supportsOpenTilt = (stateObj) => supportsFeature(stateObj, 16);\n\nexport const supportsCloseTilt = (stateObj) => supportsFeature(stateObj, 32);\n\nexport const supportsStopTilt = (stateObj) => supportsFeature(stateObj, 64);\n\nexport const supportsSetTiltPosition = (stateObj) =>\n  supportsFeature(stateObj, 128);\n\nexport function isTiltOnly(stateObj) {\n  const supportsCover =\n    supportsOpen(stateObj) || supportsClose(stateObj) || supportsStop(stateObj);\n  const supportsTilt =\n    supportsOpenTilt(stateObj) ||\n    supportsCloseTilt(stateObj) ||\n    supportsStopTilt(stateObj);\n  return supportsTilt && !supportsCover;\n}\n","import fecha from \"fecha\";\n\n// Check for support of native locale string options\nfunction toLocaleStringSupportsOptions() {\n  try {\n    new Date().toLocaleString(\"i\");\n  } catch (e) {\n    return e.name === \"RangeError\";\n  }\n  return false;\n}\n\nexport default (toLocaleStringSupportsOptions()\n  ? (dateObj: Date, locales: string) =>\n      dateObj.toLocaleString(locales, {\n        year: \"numeric\",\n        month: \"long\",\n        day: \"numeric\",\n        hour: \"numeric\",\n        minute: \"2-digit\",\n      })\n  : (dateObj: Date) => fecha.format(dateObj, \"haDateTime\"));\n","import \"@polymer/paper-dropdown-menu/paper-dropdown-menu\";\nimport { Constructor } from \"lit-element\";\nimport { PolymerElement } from \"@polymer/polymer\";\n\nconst paperDropdownClass = customElements.get(\n  \"paper-dropdown-menu\"\n) as Constructor<PolymerElement>;\n\n// patches paper drop down to properly support RTL - https://github.com/PolymerElements/paper-dropdown-menu/issues/183\nexport class HaPaperDropdownClass extends paperDropdownClass {\n  public ready() {\n    super.ready();\n    // wait to check for direction since otherwise direction is wrong even though top level is RTL\n    setTimeout(() => {\n      if (window.getComputedStyle(this).direction === \"rtl\") {\n        this.style.textAlign = \"right\";\n      }\n    }, 100);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-dropdown-menu\": HaPaperDropdownClass;\n  }\n}\n\ncustomElements.define(\"ha-paper-dropdown-menu\", HaPaperDropdownClass);\n","/** Return an icon representing a sensor state. */\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { UNIT_C, UNIT_F } from \"../const\";\nimport domainIcon from \"./domain_icon\";\n\nconst fixedDeviceClassIcons = {\n  humidity: \"hass:water-percent\",\n  illuminance: \"hass:brightness-5\",\n  temperature: \"hass:thermometer\",\n  pressure: \"hass:gauge\",\n  power: \"hass:flash\",\n  signal_strength: \"hass:wifi\",\n};\n\nexport default function sensorIcon(state: HassEntity) {\n  const dclass = state.attributes.device_class;\n\n  if (dclass && dclass in fixedDeviceClassIcons) {\n    return fixedDeviceClassIcons[dclass];\n  }\n  if (dclass === \"battery\") {\n    const battery = Number(state.state);\n    if (isNaN(battery)) {\n      return \"hass:battery-unknown\";\n    }\n    const batteryRound = Math.round(battery / 10) * 10;\n    if (batteryRound >= 100) {\n      return \"hass:battery\";\n    }\n    if (batteryRound <= 0) {\n      return \"hass:battery-alert\";\n    }\n    // Will return one of the following icons: (listed so extractor picks up)\n    // hass:battery-10\n    // hass:battery-20\n    // hass:battery-30\n    // hass:battery-40\n    // hass:battery-50\n    // hass:battery-60\n    // hass:battery-70\n    // hass:battery-80\n    // hass:battery-90\n    // We obscure 'hass' in iconname so this name does not get picked up\n    return `${\"hass\"}:battery-${batteryRound}`;\n  }\n\n  const unit = state.attributes.unit_of_measurement;\n  if (unit === UNIT_C || unit === UNIT_F) {\n    return \"hass:thermometer\";\n  }\n  return domainIcon(\"sensor\");\n}\n","/** Return an icon representing a state. */\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { DEFAULT_DOMAIN_ICON } from \"../const\";\n\nimport computeDomain from \"./compute_domain\";\nimport domainIcon from \"./domain_icon\";\n\nimport binarySensorIcon from \"./binary_sensor_icon\";\nimport coverIcon from \"./cover_icon\";\nimport sensorIcon from \"./sensor_icon\";\nimport inputDateTimeIcon from \"./input_dateteime_icon\";\n\nconst domainIcons = {\n  binary_sensor: binarySensorIcon,\n  cover: coverIcon,\n  sensor: sensorIcon,\n  input_datetime: inputDateTimeIcon,\n};\n\nexport default function stateIcon(state: HassEntity) {\n  if (!state) {\n    return DEFAULT_DOMAIN_ICON;\n  }\n  if (state.attributes.icon) {\n    return state.attributes.icon;\n  }\n\n  const domain = computeDomain(state.entity_id);\n\n  if (domain in domainIcons) {\n    return domainIcons[domain](state);\n  }\n  return domainIcon(domain, state.state);\n}\n","import { HassEntity } from \"home-assistant-js-websocket\";\n\n/** Return an icon representing a binary sensor state. */\n\nexport default function binarySensorIcon(state: HassEntity) {\n  const activated = state.state && state.state === \"off\";\n  switch (state.attributes.device_class) {\n    case \"battery\":\n      return activated ? \"hass:battery\" : \"hass:battery-outline\";\n    case \"cold\":\n      return activated ? \"hass:thermometer\" : \"hass:snowflake\";\n    case \"connectivity\":\n      return activated ? \"hass:server-network-off\" : \"hass:server-network\";\n    case \"door\":\n      return activated ? \"hass:door-closed\" : \"hass:door-open\";\n    case \"garage_door\":\n      return activated ? \"hass:garage\" : \"hass:garage-open\";\n    case \"gas\":\n    case \"power\":\n    case \"problem\":\n    case \"safety\":\n    case \"smoke\":\n      return activated ? \"hass:shield-check\" : \"hass:alert\";\n    case \"heat\":\n      return activated ? \"hass:thermometer\" : \"hass:fire\";\n    case \"light\":\n      return activated ? \"hass:brightness-5\" : \"hass:brightness-7\";\n    case \"lock\":\n      return activated ? \"hass:lock\" : \"hass:lock-open\";\n    case \"moisture\":\n      return activated ? \"hass:water-off\" : \"hass:water\";\n    case \"motion\":\n      return activated ? \"hass:walk\" : \"hass:run\";\n    case \"occupancy\":\n      return activated ? \"hass:home-outline\" : \"hass:home\";\n    case \"opening\":\n      return activated ? \"hass:square\" : \"hass:square-outline\";\n    case \"plug\":\n      return activated ? \"hass:power-plug-off\" : \"hass:power-plug\";\n    case \"presence\":\n      return activated ? \"hass:home-outline\" : \"hass:home\";\n    case \"sound\":\n      return activated ? \"hass:music-note-off\" : \"hass:music-note\";\n    case \"vibration\":\n      return activated ? \"hass:crop-portrait\" : \"hass:vibrate\";\n    case \"window\":\n      return activated ? \"hass:window-closed\" : \"hass:window-open\";\n    default:\n      return activated ? \"hass:radiobox-blank\" : \"hass:checkbox-marked-circle\";\n  }\n}\n","/** Return an icon representing a cover state. */\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport domainIcon from \"./domain_icon\";\n\nexport default function coverIcon(state: HassEntity): string {\n  const open = state.state !== \"closed\";\n  switch (state.attributes.device_class) {\n    case \"garage\":\n      return open ? \"hass:garage-open\" : \"hass:garage\";\n    default:\n      return domainIcon(\"cover\", state.state);\n  }\n}\n","/** Return an icon representing an input datetime state. */\nimport domainIcon from \"./domain_icon\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\n\nexport default function inputDateTimeIcon(state: HassEntity): string {\n  if (!state.attributes.has_date) {\n    return \"hass:clock\";\n  }\n  if (!state.attributes.has_time) {\n    return \"hass:calendar\";\n  }\n  return domainIcon(\"input_datetime\");\n}\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button\";\n\nimport { STATES_OFF } from \"../../common/const\";\nimport computeStateDomain from \"../../common/entity/compute_state_domain\";\nimport {\n  LitElement,\n  TemplateResult,\n  html,\n  CSSResult,\n  css,\n  property,\n  PropertyValues,\n} from \"lit-element\";\nimport { HomeAssistant } from \"../../types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { forwardHaptic } from \"../../data/haptics\";\nimport computeStateName from \"../../common/entity/compute_state_name\";\n\nconst isOn = (stateObj?: HassEntity) =>\n  stateObj !== undefined && !STATES_OFF.includes(stateObj.state);\n\nclass HaEntityToggle extends LitElement {\n  // hass is not a property so that we only re-render on stateObj changes\n  public hass?: HomeAssistant;\n  @property() public stateObj?: HassEntity;\n  @property() private _isOn: boolean = false;\n\n  protected render(): TemplateResult | void {\n    if (!this.stateObj) {\n      return html`\n        <paper-toggle-button disabled></paper-toggle-button>\n      `;\n    }\n\n    if (this.stateObj.attributes.assumed_state) {\n      return html`\n        <paper-icon-button\n          aria-label=${`Turn ${computeStateName(this.stateObj)} off`}\n          icon=\"hass:flash-off\"\n          @click=${this._turnOff}\n          ?state-active=${!this._isOn}\n        ></paper-icon-button>\n        <paper-icon-button\n          aria-label=${`Turn ${computeStateName(this.stateObj)} on`}\n          icon=\"hass:flash\"\n          @click=${this._turnOn}\n          ?state-active=${this._isOn}\n        ></paper-icon-button>\n      `;\n    }\n\n    return html`\n      <paper-toggle-button\n        aria-label=${`Toggle ${computeStateName(this.stateObj)} ${\n          this._isOn ? \"off\" : \"on\"\n        }`}\n        .checked=${this._isOn}\n        @change=${this._toggleChanged}\n      ></paper-toggle-button>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    this.addEventListener(\"click\", (ev) => ev.stopPropagation());\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    if (changedProps.has(\"stateObj\")) {\n      this._isOn = isOn(this.stateObj);\n    }\n  }\n\n  private _toggleChanged(ev) {\n    const newVal = ev.target.checked;\n\n    if (newVal !== this._isOn) {\n      this._callService(newVal);\n    }\n  }\n\n  private _turnOn() {\n    this._callService(true);\n  }\n\n  private _turnOff() {\n    this._callService(false);\n  }\n\n  // We will force a re-render after a successful call to re-sync the toggle\n  // with the state. It will be out of sync if our service call did not\n  // result in the entity to be turned on. Since the state is not changing,\n  // the resync is not called automatic.\n  private async _callService(turnOn): Promise<void> {\n    if (!this.hass || !this.stateObj) {\n      return;\n    }\n    forwardHaptic(\"light\");\n    const stateDomain = computeStateDomain(this.stateObj);\n    let serviceDomain;\n    let service;\n\n    if (stateDomain === \"lock\") {\n      serviceDomain = \"lock\";\n      service = turnOn ? \"unlock\" : \"lock\";\n    } else if (stateDomain === \"cover\") {\n      serviceDomain = \"cover\";\n      service = turnOn ? \"open_cover\" : \"close_cover\";\n    } else if (stateDomain === \"group\") {\n      serviceDomain = \"homeassistant\";\n      service = turnOn ? \"turn_on\" : \"turn_off\";\n    } else {\n      serviceDomain = stateDomain;\n      service = turnOn ? \"turn_on\" : \"turn_off\";\n    }\n\n    const currentState = this.stateObj;\n\n    // Optimistic update.\n    this._isOn = turnOn;\n\n    await this.hass.callService(serviceDomain, service, {\n      entity_id: this.stateObj.entity_id,\n    });\n\n    setTimeout(async () => {\n      // If after 2 seconds we have not received a state update\n      // reset the switch to it's original state.\n      if (this.stateObj === currentState) {\n        this._isOn = isOn(this.stateObj);\n      }\n    }, 2000);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        white-space: nowrap;\n        min-width: 38px;\n      }\n      paper-icon-button {\n        color: var(\n          --paper-icon-button-inactive-color,\n          var(--primary-text-color)\n        );\n        transition: color 0.5s;\n      }\n      paper-icon-button[state-active] {\n        color: var(--paper-icon-button-active-color, var(--primary-color));\n      }\n      paper-toggle-button {\n        cursor: pointer;\n        --paper-toggle-button-label-spacing: 0;\n        padding: 13px 5px;\n        margin: -4px -5px;\n      }\n    `;\n  }\n}\n\ncustomElements.define(\"ha-entity-toggle\", HaEntityToggle);\n","import fecha from \"fecha\";\n\n// Check for support of native locale string options\nfunction toLocaleTimeStringSupportsOptions() {\n  try {\n    new Date().toLocaleTimeString(\"i\");\n  } catch (e) {\n    return e.name === \"RangeError\";\n  }\n  return false;\n}\n\nexport default (toLocaleTimeStringSupportsOptions()\n  ? (dateObj: Date, locales: string) =>\n      dateObj.toLocaleTimeString(locales, {\n        hour: \"numeric\",\n        minute: \"2-digit\",\n      })\n  : (dateObj: Date) => fecha.format(dateObj, \"shortTime\"));\n","import {\n  LovelaceConfig,\n  LovelaceCardConfig,\n  LovelaceViewConfig,\n} from \"../../../data/lovelace\";\n\nexport const addCard = (\n  config: LovelaceConfig,\n  path: [number],\n  cardConfig: LovelaceCardConfig\n): LovelaceConfig => {\n  const [viewIndex] = path;\n  const views: LovelaceViewConfig[] = [];\n\n  config.views.forEach((viewConf, index) => {\n    if (index !== viewIndex) {\n      views.push(config.views[index]);\n      return;\n    }\n\n    const cards = viewConf.cards\n      ? [...viewConf.cards, cardConfig]\n      : [cardConfig];\n\n    views.push({\n      ...viewConf,\n      cards,\n    });\n  });\n\n  return {\n    ...config,\n    views,\n  };\n};\n\nexport const replaceCard = (\n  config: LovelaceConfig,\n  path: [number, number],\n  cardConfig: LovelaceCardConfig\n): LovelaceConfig => {\n  const [viewIndex, cardIndex] = path;\n  const views: LovelaceViewConfig[] = [];\n\n  config.views.forEach((viewConf, index) => {\n    if (index !== viewIndex) {\n      views.push(config.views[index]);\n      return;\n    }\n\n    views.push({\n      ...viewConf,\n      cards: (viewConf.cards || []).map((origConf, ind) =>\n        ind === cardIndex ? cardConfig : origConf\n      ),\n    });\n  });\n\n  return {\n    ...config,\n    views,\n  };\n};\n\nexport const deleteCard = (\n  config: LovelaceConfig,\n  path: [number, number]\n): LovelaceConfig => {\n  const [viewIndex, cardIndex] = path;\n  const views: LovelaceViewConfig[] = [];\n\n  config.views.forEach((viewConf, index) => {\n    if (index !== viewIndex) {\n      views.push(config.views[index]);\n      return;\n    }\n\n    views.push({\n      ...viewConf,\n      cards: (viewConf.cards || []).filter(\n        (_origConf, ind) => ind !== cardIndex\n      ),\n    });\n  });\n\n  return {\n    ...config,\n    views,\n  };\n};\n\nexport const swapCard = (\n  config: LovelaceConfig,\n  path1: [number, number],\n  path2: [number, number]\n): LovelaceConfig => {\n  const card1 = config.views[path1[0]].cards![path1[1]];\n  const card2 = config.views[path2[0]].cards![path2[1]];\n\n  const origView1 = config.views[path1[0]];\n  const newView1 = {\n    ...origView1,\n    cards: origView1.cards!.map((origCard, index) =>\n      index === path1[1] ? card2 : origCard\n    ),\n  };\n\n  const origView2 = path1[0] === path2[0] ? newView1 : config.views[path2[0]];\n  const newView2 = {\n    ...origView2,\n    cards: origView2.cards!.map((origCard, index) =>\n      index === path2[1] ? card1 : origCard\n    ),\n  };\n\n  return {\n    ...config,\n    views: config.views.map((origView, index) =>\n      index === path2[0] ? newView2 : index === path1[0] ? newView1 : origView\n    ),\n  };\n};\n\nexport const moveCard = (\n  config: LovelaceConfig,\n  fromPath: [number, number],\n  toPath: [number]\n): LovelaceConfig => {\n  if (fromPath[0] === toPath[0]) {\n    throw new Error(\"You can not move a card to the view it is in.\");\n  }\n  const fromView = config.views[fromPath[0]];\n  const card = fromView.cards![fromPath[1]];\n\n  const newView1 = {\n    ...fromView,\n    cards: (fromView.cards || []).filter(\n      (_origConf, ind) => ind !== fromPath[1]\n    ),\n  };\n\n  const toView = config.views[toPath[0]];\n  const cards = toView.cards ? [...toView.cards, card] : [card];\n\n  const newView2 = {\n    ...toView,\n    cards,\n  };\n\n  return {\n    ...config,\n    views: config.views.map((origView, index) =>\n      index === toPath[0]\n        ? newView2\n        : index === fromPath[0]\n        ? newView1\n        : origView\n    ),\n  };\n};\n\nexport const addView = (\n  config: LovelaceConfig,\n  viewConfig: LovelaceViewConfig\n): LovelaceConfig => ({\n  ...config,\n  views: config.views.concat(viewConfig),\n});\n\nexport const replaceView = (\n  config: LovelaceConfig,\n  viewIndex: number,\n  viewConfig: LovelaceViewConfig\n): LovelaceConfig => ({\n  ...config,\n  views: config.views.map((origView, index) =>\n    index === viewIndex ? viewConfig : origView\n  ),\n});\n\nexport const swapView = (\n  config: LovelaceConfig,\n  path1: number,\n  path2: number\n): LovelaceConfig => {\n  const view1 = config.views[path1];\n  const view2 = config.views[path2];\n\n  return {\n    ...config,\n    views: config.views.map((origView, index) =>\n      index === path2 ? view1 : index === path1 ? view2 : origView\n    ),\n  };\n};\n\nexport const deleteView = (\n  config: LovelaceConfig,\n  viewIndex: number\n): LovelaceConfig => ({\n  ...config,\n  views: config.views.filter((_origView, index) => index !== viewIndex),\n});\n","import { LocalizeFunc } from \"../translations/localize\";\n\n/**\n * Calculate a string representing a date object as relative time from now.\n *\n * Example output: 5 minutes ago, in 3 days.\n */\nconst tests = [60, 60, 24, 7];\nconst langKey = [\"second\", \"minute\", \"hour\", \"day\"];\n\nexport default function relativeTime(\n  dateObj: Date,\n  localize: LocalizeFunc,\n  options: {\n    compareTime?: Date;\n    includeTense?: boolean;\n  } = {}\n): string {\n  const compareTime = options.compareTime || new Date();\n  let delta = (compareTime.getTime() - dateObj.getTime()) / 1000;\n  const tense = delta >= 0 ? \"past\" : \"future\";\n  delta = Math.abs(delta);\n\n  let timeDesc;\n\n  for (let i = 0; i < tests.length; i++) {\n    if (delta < tests[i]) {\n      delta = Math.floor(delta);\n      timeDesc = localize(\n        `ui.components.relative_time.duration.${langKey[i]}`,\n        \"count\",\n        delta\n      );\n      break;\n    }\n\n    delta /= tests[i];\n  }\n\n  if (timeDesc === undefined) {\n    delta = Math.floor(delta);\n    timeDesc = localize(\n      \"ui.components.relative_time.duration.week\",\n      \"count\",\n      delta\n    );\n  }\n\n  return options.includeTense === false\n    ? timeDesc\n    : localize(`ui.components.relative_time.${tense}`, \"time\", timeDesc);\n}\n","// Parse array of entity objects from config\nimport isValidEntityId from \"../../../common/entity/valid_entity_id\";\nimport { EntityConfig } from \"../entity-rows/types\";\n\nexport const processConfigEntities = <T extends EntityConfig>(\n  entities: Array<T | string>\n): T[] => {\n  if (!entities || !Array.isArray(entities)) {\n    throw new Error(\"Entities need to be an array\");\n  }\n\n  return entities.map(\n    (entityConf, index): T => {\n      if (\n        typeof entityConf === \"object\" &&\n        !Array.isArray(entityConf) &&\n        entityConf.type\n      ) {\n        return entityConf;\n      }\n\n      let config: T;\n\n      if (typeof entityConf === \"string\") {\n        // tslint:disable-next-line:no-object-literal-type-assertion\n        config = { entity: entityConf } as T;\n      } else if (typeof entityConf === \"object\" && !Array.isArray(entityConf)) {\n        if (!entityConf.entity) {\n          throw new Error(\n            `Entity object at position ${index} is missing entity field.`\n          );\n        }\n        config = entityConf as T;\n      } else {\n        throw new Error(`Invalid entity specified at position ${index}.`);\n      }\n\n      if (!isValidEntityId(config.entity)) {\n        throw new Error(\n          `Invalid entity ID at position ${index}: ${config.entity}`\n        );\n      }\n\n      return config;\n    }\n  );\n};\n","import computeStateName from \"../common/entity/compute_state_name\";\nimport computeStateDomain from \"../common/entity/compute_state_domain\";\nimport computeStateDisplay from \"../common/entity/compute_state_display\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { HomeAssistant } from \"../types\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\n\nconst DOMAINS_USE_LAST_UPDATED = [\"climate\", \"water_heater\"];\nconst LINE_ATTRIBUTES_TO_KEEP = [\n  \"temperature\",\n  \"current_temperature\",\n  \"target_temp_low\",\n  \"target_temp_high\",\n];\n\nexport interface LineChartState {\n  state: string;\n  last_changed: string;\n  attributes?: { [key: string]: any };\n}\n\nexport interface LineChartEntity {\n  domain: string;\n  name: string;\n  entity_id: string;\n  states: LineChartState[];\n}\n\nexport interface LineChartUnit {\n  unit: string;\n  identifier: string;\n  data: LineChartEntity[];\n}\n\nexport interface TimelineState {\n  state_localize: string;\n  state: string;\n  last_changed: string;\n}\n\nexport interface TimelineEntity {\n  name: string;\n  entity_id: string;\n  data: TimelineState[];\n}\n\nexport interface HistoryResult {\n  line: LineChartUnit[];\n  timeline: TimelineEntity[];\n}\n\nexport const fetchRecent = (\n  hass,\n  entityId,\n  startTime,\n  endTime,\n  skipInitialState = false\n): Promise<HassEntity[][]> => {\n  let url = \"history/period\";\n  if (startTime) {\n    url += \"/\" + startTime.toISOString();\n  }\n  url += \"?filter_entity_id=\" + entityId;\n  if (endTime) {\n    url += \"&end_time=\" + endTime.toISOString();\n  }\n  if (skipInitialState) {\n    url += \"&skip_initial_state\";\n  }\n\n  return hass.callApi(\"GET\", url);\n};\n\nexport const fetchDate = (\n  hass: HomeAssistant,\n  startTime: Date,\n  endTime: Date\n): Promise<HassEntity[][]> => {\n  return hass.callApi(\n    \"GET\",\n    `history/period/${startTime.toISOString()}?end_time=${endTime.toISOString()}`\n  );\n};\n\nconst equalState = (obj1: LineChartState, obj2: LineChartState) =>\n  obj1.state === obj2.state &&\n  // They either both have an attributes object or not\n  (!obj1.attributes ||\n    LINE_ATTRIBUTES_TO_KEEP.every(\n      (attr) => obj1.attributes![attr] === obj2.attributes![attr]\n    ));\n\nconst processTimelineEntity = (\n  localize: LocalizeFunc,\n  language: string,\n  states: HassEntity[]\n): TimelineEntity => {\n  const data: TimelineState[] = [];\n\n  for (const state of states) {\n    if (data.length > 0 && state.state === data[data.length - 1].state) {\n      continue;\n    }\n\n    data.push({\n      state_localize: computeStateDisplay(localize, state, language),\n      state: state.state,\n      last_changed: state.last_changed,\n    });\n  }\n\n  return {\n    name: computeStateName(states[0]),\n    entity_id: states[0].entity_id,\n    data,\n  };\n};\n\nconst processLineChartEntities = (\n  unit,\n  entities: HassEntity[][]\n): LineChartUnit => {\n  const data: LineChartEntity[] = [];\n\n  for (const states of entities) {\n    const last: HassEntity = states[states.length - 1];\n    const domain = computeStateDomain(last);\n    const processedStates: LineChartState[] = [];\n\n    for (const state of states) {\n      let processedState: LineChartState;\n\n      if (DOMAINS_USE_LAST_UPDATED.includes(domain)) {\n        processedState = {\n          state: state.state,\n          last_changed: state.last_updated,\n          attributes: {},\n        };\n\n        for (const attr of LINE_ATTRIBUTES_TO_KEEP) {\n          if (attr in state.attributes) {\n            processedState.attributes![attr] = state.attributes[attr];\n          }\n        }\n      } else {\n        processedState = state;\n      }\n\n      if (\n        processedStates.length > 1 &&\n        equalState(\n          processedState,\n          processedStates[processedStates.length - 1]\n        ) &&\n        equalState(processedState, processedStates[processedStates.length - 2])\n      ) {\n        continue;\n      }\n\n      processedStates.push(processedState);\n    }\n\n    data.push({\n      domain,\n      name: computeStateName(last),\n      entity_id: last.entity_id,\n      states: processedStates,\n    });\n  }\n\n  return {\n    unit,\n    identifier: entities.map((states) => states[0].entity_id).join(\"\"),\n    data,\n  };\n};\n\nexport const computeHistory = (\n  hass: HomeAssistant,\n  stateHistory: HassEntity[][],\n  localize: LocalizeFunc,\n  language: string\n): HistoryResult => {\n  const lineChartDevices: { [unit: string]: HassEntity[][] } = {};\n  const timelineDevices: TimelineEntity[] = [];\n  if (!stateHistory) {\n    return { line: [], timeline: [] };\n  }\n\n  stateHistory.forEach((stateInfo) => {\n    if (stateInfo.length === 0) {\n      return;\n    }\n\n    const stateWithUnit = stateInfo.find(\n      (state) => \"unit_of_measurement\" in state.attributes\n    );\n\n    let unit: string | undefined;\n\n    if (stateWithUnit) {\n      unit = stateWithUnit.attributes.unit_of_measurement;\n    } else if (computeStateDomain(stateInfo[0]) === \"climate\") {\n      unit = hass.config.unit_system.temperature;\n    } else if (computeStateDomain(stateInfo[0]) === \"water_heater\") {\n      unit = hass.config.unit_system.temperature;\n    }\n\n    if (!unit) {\n      timelineDevices.push(\n        processTimelineEntity(localize, language, stateInfo)\n      );\n    } else if (unit in lineChartDevices) {\n      lineChartDevices[unit].push(stateInfo);\n    } else {\n      lineChartDevices[unit] = [stateInfo];\n    }\n  });\n\n  const unitStates = Object.keys(lineChartDevices).map((unit) =>\n    processLineChartEntities(unit, lineChartDevices[unit])\n  );\n\n  return { line: unitStates, timeline: timelineDevices };\n};\n","import { HomeAssistant } from \"../../types\";\n\n/** Return if a component is loaded. */\nexport default function isComponentLoaded(\n  hass: HomeAssistant,\n  component: string\n): boolean {\n  return hass && hass.config.components.indexOf(component) !== -1;\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\nimport { HomeAssistant } from \"../../../types\";\nimport { ErrorCardConfig } from \"./types\";\n\nexport const createErrorCardElement = (config) => {\n  const el = document.createElement(\"hui-error-card\");\n  el.setConfig(config);\n  return el;\n};\n\nexport const createErrorCardConfig = (error, origConfig) => ({\n  type: \"error\",\n  error,\n  origConfig,\n});\n\n@customElement(\"hui-error-card\")\nexport class HuiErrorCard extends LitElement implements LovelaceCard {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: ErrorCardConfig;\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: ErrorCardConfig): void {\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      ${this._config.error}\n      <pre>${this._toStr(this._config.origConfig)}</pre>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        background-color: #ef5350;\n        color: white;\n        padding: 8px;\n        font-weight: 500;\n      }\n    `;\n  }\n\n  private _toStr(config: LovelaceCardConfig): string {\n    return JSON.stringify(config, null, 2);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-error-card\": HuiErrorCard;\n  }\n}\n","export const compare = (a: string, b: string) => {\n  if (a < b) {\n    return -1;\n  }\n  if (a > b) {\n    return 1;\n  }\n\n  return 0;\n};\n\nexport const caseInsensitiveCompare = (a: string, b: string) =>\n  compare(a.toLowerCase(), b.toLowerCase());\n","/** Compute the object ID of a state. */\nexport default function computeObjectId(entityId: string): string {\n  return entityId.substr(entityId.indexOf(\".\") + 1);\n}\n","const leftPad = (num: number) => (num < 10 ? `0${num}` : num);\n\nexport default function secondsToDuration(d: number) {\n  const h = Math.floor(d / 3600);\n  const m = Math.floor((d % 3600) / 60);\n  const s = Math.floor((d % 3600) % 60);\n\n  if (h > 0) {\n    return `${h}:${leftPad(m)}:${leftPad(s)}`;\n  }\n  if (m > 0) {\n    return `${m}:${leftPad(s)}`;\n  }\n  if (s > 0) {\n    return \"\" + s;\n  }\n  return null;\n}\n","import { LovelaceCard } from \"../types\";\n\nexport const computeCardSize = (card: LovelaceCard): number => {\n  return typeof card.getCardSize === \"function\" ? card.getCardSize() : 1;\n};\n","import \"@polymer/iron-flex-layout/iron-flex-layout-classes\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport CoverEntity from \"../util/cover-model\";\n\nclass HaCoverTiltControls extends PolymerElement {\n  static get template() {\n    return html`\n      <style include=\"iron-flex\"></style>\n      <style>\n        :host {\n          white-space: nowrap;\n        }\n        [invisible] {\n          visibility: hidden !important;\n        }\n      </style>\n      <paper-icon-button\n        icon=\"hass:arrow-top-right\"\n        on-click=\"onOpenTiltTap\"\n        title=\"Open tilt\"\n        invisible$=\"[[!entityObj.supportsOpenTilt]]\"\n        disabled=\"[[computeOpenDisabled(stateObj, entityObj)]]\"\n      ></paper-icon-button>\n      <paper-icon-button\n        icon=\"hass:stop\"\n        on-click=\"onStopTiltTap\"\n        invisible$=\"[[!entityObj.supportsStopTilt]]\"\n        title=\"Stop tilt\"\n      ></paper-icon-button>\n      <paper-icon-button\n        icon=\"hass:arrow-bottom-left\"\n        on-click=\"onCloseTiltTap\"\n        title=\"Close tilt\"\n        invisible$=\"[[!entityObj.supportsCloseTilt]]\"\n        disabled=\"[[computeClosedDisabled(stateObj, entityObj)]]\"\n      ></paper-icon-button>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n      stateObj: {\n        type: Object,\n      },\n      entityObj: {\n        type: Object,\n        computed: \"computeEntityObj(hass, stateObj)\",\n      },\n    };\n  }\n\n  computeEntityObj(hass, stateObj) {\n    return new CoverEntity(hass, stateObj);\n  }\n\n  computeOpenDisabled(stateObj, entityObj) {\n    var assumedState = stateObj.attributes.assumed_state === true;\n    return entityObj.isFullyOpenTilt && !assumedState;\n  }\n\n  computeClosedDisabled(stateObj, entityObj) {\n    var assumedState = stateObj.attributes.assumed_state === true;\n    return entityObj.isFullyClosedTilt && !assumedState;\n  }\n\n  onOpenTiltTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.openCoverTilt();\n  }\n\n  onCloseTiltTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.closeCoverTilt();\n  }\n\n  onStopTiltTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.stopCoverTilt();\n  }\n}\n\ncustomElements.define(\"ha-cover-tilt-controls\", HaCoverTiltControls);\n","import fecha from \"fecha\";\n\n// Check for support of native locale string options\nfunction toLocaleDateStringSupportsOptions() {\n  try {\n    new Date().toLocaleDateString(\"i\");\n  } catch (e) {\n    return e.name === \"RangeError\";\n  }\n  return false;\n}\n\nexport default (toLocaleDateStringSupportsOptions()\n  ? (dateObj: Date, locales: string) =>\n      dateObj.toLocaleDateString(locales, {\n        year: \"numeric\",\n        month: \"long\",\n        day: \"numeric\",\n      })\n  : (dateObj: Date) => fecha.format(dateObj, \"mediumDate\"));\n","import { HomeAssistant } from \"../../types\";\n\ninterface ResultCache<T> {\n  [entityId: string]: Promise<T> | undefined;\n}\n\nexport const timeCachePromiseFunc = async <T>(\n  cacheKey: string,\n  cacheTime: number,\n  func: (\n    hass: HomeAssistant,\n    entityId: string,\n    ...args: unknown[]\n  ) => Promise<T>,\n  hass: HomeAssistant,\n  entityId: string,\n  ...args: unknown[]\n): Promise<T> => {\n  let cache: ResultCache<T> | undefined = (hass as any)[cacheKey];\n\n  if (!cache) {\n    cache = hass[cacheKey] = {};\n  }\n\n  const lastResult = cache[entityId];\n\n  if (lastResult) {\n    return lastResult;\n  }\n\n  const result = func(hass, entityId, ...args);\n  cache[entityId] = result;\n\n  result.then(\n    // When successful, set timer to clear cache\n    () =>\n      setTimeout(() => {\n        cache![entityId] = undefined;\n      }, cacheTime),\n    // On failure, clear cache right away\n    () => {\n      cache![entityId] = undefined;\n    }\n  );\n\n  return result;\n};\n","import { supportsFeature } from \"../common/entity/supports-feature\";\n\nexport default class MediaPlayerEntity {\n  constructor(hass, stateObj) {\n    this.hass = hass;\n    this.stateObj = stateObj;\n    this._attr = stateObj.attributes;\n    this._feat = this._attr.supported_features;\n  }\n\n  get isOff() {\n    return this.stateObj.state === \"off\";\n  }\n\n  get isIdle() {\n    return this.stateObj.state === \"idle\";\n  }\n\n  get isMuted() {\n    return this._attr.is_volume_muted;\n  }\n\n  get isPaused() {\n    return this.stateObj.state === \"paused\";\n  }\n\n  get isPlaying() {\n    return this.stateObj.state === \"playing\";\n  }\n\n  get isMusic() {\n    return this._attr.media_content_type === \"music\";\n  }\n\n  get isTVShow() {\n    return this._attr.media_content_type === \"tvshow\";\n  }\n\n  get hasMediaControl() {\n    return (\n      [\"playing\", \"paused\", \"unknown\", \"on\"].indexOf(this.stateObj.state) !== -1\n    );\n  }\n\n  get volumeSliderValue() {\n    return this._attr.volume_level * 100;\n  }\n\n  get showProgress() {\n    return (\n      (this.isPlaying || this.isPaused) &&\n      \"media_duration\" in this.stateObj.attributes &&\n      \"media_position\" in this.stateObj.attributes &&\n      \"media_position_updated_at\" in this.stateObj.attributes\n    );\n  }\n\n  get currentProgress() {\n    var progress = this._attr.media_position;\n    if (this.isPlaying) {\n      progress +=\n        (Date.now() -\n          new Date(this._attr.media_position_updated_at).getTime()) /\n        1000.0;\n    }\n    return progress;\n  }\n\n  get supportsPause() {\n    return supportsFeature(this.stateObj, 1);\n  }\n\n  get supportsVolumeSet() {\n    return supportsFeature(this.stateObj, 4);\n  }\n\n  get supportsVolumeMute() {\n    return supportsFeature(this.stateObj, 8);\n  }\n\n  get supportsPreviousTrack() {\n    return supportsFeature(this.stateObj, 16);\n  }\n\n  get supportsNextTrack() {\n    return supportsFeature(this.stateObj, 32);\n  }\n\n  get supportsTurnOn() {\n    return supportsFeature(this.stateObj, 128);\n  }\n\n  get supportsTurnOff() {\n    return supportsFeature(this.stateObj, 256);\n  }\n\n  get supportsPlayMedia() {\n    return supportsFeature(this.stateObj, 512);\n  }\n\n  get supportsVolumeButtons() {\n    return supportsFeature(this.stateObj, 1024);\n  }\n\n  get supportsSelectSource() {\n    return supportsFeature(this.stateObj, 2048);\n  }\n\n  get supportsSelectSoundMode() {\n    return supportsFeature(this.stateObj, 65536);\n  }\n\n  get supportsPlay() {\n    return supportsFeature(this.stateObj, 16384);\n  }\n\n  get primaryTitle() {\n    return this._attr.media_title;\n  }\n\n  get secondaryTitle() {\n    if (this.isMusic) {\n      return this._attr.media_artist;\n    }\n    if (this.isTVShow) {\n      var text = this._attr.media_series_title;\n\n      if (this._attr.media_season) {\n        text += \" S\" + this._attr.media_season;\n\n        if (this._attr.media_episode) {\n          text += \"E\" + this._attr.media_episode;\n        }\n      }\n\n      return text;\n    }\n    if (this._attr.app_name) {\n      return this._attr.app_name;\n    }\n    return \"\";\n  }\n\n  get source() {\n    return this._attr.source;\n  }\n\n  get sourceList() {\n    return this._attr.source_list;\n  }\n\n  get soundMode() {\n    return this._attr.sound_mode;\n  }\n\n  get soundModeList() {\n    return this._attr.sound_mode_list;\n  }\n\n  mediaPlayPause() {\n    this.callService(\"media_play_pause\");\n  }\n\n  nextTrack() {\n    this.callService(\"media_next_track\");\n  }\n\n  playbackControl() {\n    this.callService(\"media_play_pause\");\n  }\n\n  previousTrack() {\n    this.callService(\"media_previous_track\");\n  }\n\n  setVolume(volume) {\n    this.callService(\"volume_set\", { volume_level: volume });\n  }\n\n  togglePower() {\n    if (this.isOff) {\n      this.turnOn();\n    } else {\n      this.turnOff();\n    }\n  }\n\n  turnOff() {\n    this.callService(\"turn_off\");\n  }\n\n  turnOn() {\n    this.callService(\"turn_on\");\n  }\n\n  volumeDown() {\n    this.callService(\"volume_down\");\n  }\n\n  volumeMute(mute) {\n    if (!this.supportsVolumeMute) {\n      throw new Error(\"Muting volume not supported\");\n    }\n    this.callService(\"volume_mute\", { is_volume_muted: mute });\n  }\n\n  volumeUp() {\n    this.callService(\"volume_up\");\n  }\n\n  selectSource(source) {\n    this.callService(\"select_source\", { source });\n  }\n\n  selectSoundMode(soundMode) {\n    this.callService(\"select_sound_mode\", { sound_mode: soundMode });\n  }\n\n  // helper method\n\n  callService(service, data = {}) {\n    data.entity_id = this.stateObj.entity_id;\n    this.hass.callService(\"media_player\", service, data);\n  }\n}\n","import { HomeAssistant, CameraEntity } from \"../types\";\nimport { timeCachePromiseFunc } from \"../common/util/time-cache-function-promise\";\nimport { getSignedPath } from \"./auth\";\n\nexport const CAMERA_SUPPORT_ON_OFF = 1;\nexport const CAMERA_SUPPORT_STREAM = 2;\n\nexport interface CameraPreferences {\n  preload_stream: boolean;\n}\n\nexport interface CameraThumbnail {\n  content_type: string;\n  content: string;\n}\n\nexport interface Stream {\n  url: string;\n}\n\nexport const computeMJPEGStreamUrl = (entity: CameraEntity) =>\n  `/api/camera_proxy_stream/${entity.entity_id}?token=${\n    entity.attributes.access_token\n  }`;\n\nexport const fetchThumbnailUrlWithCache = (\n  hass: HomeAssistant,\n  entityId: string\n) =>\n  timeCachePromiseFunc(\n    \"_cameraTmbUrl\",\n    9000,\n    fetchThumbnailUrl,\n    hass,\n    entityId\n  );\n\nexport const fetchThumbnailUrl = (hass: HomeAssistant, entityId: string) =>\n  getSignedPath(hass, `/api/camera_proxy/${entityId}`).then(({ path }) => path);\n\nexport const fetchThumbnail = (hass: HomeAssistant, entityId: string) => {\n  // tslint:disable-next-line: no-console\n  console.warn(\"This method has been deprecated.\");\n  return hass.callWS<CameraThumbnail>({\n    type: \"camera_thumbnail\",\n    entity_id: entityId,\n  });\n};\n\nexport const fetchStreamUrl = (\n  hass: HomeAssistant,\n  entityId: string,\n  format?: \"hls\"\n) => {\n  const data = {\n    type: \"camera/stream\",\n    entity_id: entityId,\n  };\n  if (format) {\n    // @ts-ignore\n    data.format = format;\n  }\n  return hass.callWS<Stream>(data);\n};\n\nexport const fetchCameraPrefs = (hass: HomeAssistant, entityId: string) =>\n  hass.callWS<CameraPreferences>({\n    type: \"camera/get_prefs\",\n    entity_id: entityId,\n  });\n\nexport const updateCameraPrefs = (\n  hass: HomeAssistant,\n  entityId: string,\n  prefs: {\n    preload_stream?: boolean;\n  }\n) =>\n  hass.callWS<CameraPreferences>({\n    type: \"camera/update_prefs\",\n    entity_id: entityId,\n    ...prefs,\n  });\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { HomeAssistant } from \"../types\";\nimport { compare } from \"../common/string/compare\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport interface AreaRegistryEntry {\n  area_id: string;\n  name: string;\n}\n\nexport interface AreaRegistryEntryMutableParams {\n  name: string;\n}\n\nexport const createAreaRegistryEntry = (\n  hass: HomeAssistant,\n  values: AreaRegistryEntryMutableParams\n) =>\n  hass.callWS<AreaRegistryEntry>({\n    type: \"config/area_registry/create\",\n    ...values,\n  });\n\nexport const updateAreaRegistryEntry = (\n  hass: HomeAssistant,\n  areaId: string,\n  updates: Partial<AreaRegistryEntryMutableParams>\n) =>\n  hass.callWS<AreaRegistryEntry>({\n    type: \"config/area_registry/update\",\n    area_id: areaId,\n    ...updates,\n  });\n\nexport const deleteAreaRegistryEntry = (hass: HomeAssistant, areaId: string) =>\n  hass.callWS({\n    type: \"config/area_registry/delete\",\n    area_id: areaId,\n  });\n\nconst fetchAreaRegistry = (conn) =>\n  conn\n    .sendMessagePromise({\n      type: \"config/area_registry/list\",\n    })\n    .then((areas) => areas.sort((ent1, ent2) => compare(ent1.name, ent2.name)));\n\nconst subscribeAreaRegistryUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchAreaRegistry(conn).then((areas) => store.setState(areas, true)),\n      500,\n      true\n    ),\n    \"area_registry_updated\"\n  );\n\nexport const subscribeAreaRegistry = (\n  conn: Connection,\n  onChange: (areas: AreaRegistryEntry[]) => void\n) =>\n  createCollection<AreaRegistryEntry[]>(\n    \"_areaRegistry\",\n    fetchAreaRegistry,\n    subscribeAreaRegistryUpdates,\n    conn,\n    onChange\n  );\n","import { HomeAssistant } from \"../types\";\nimport { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport interface DeviceRegistryEntry {\n  id: string;\n  config_entries: string[];\n  connections: Array<[string, string]>;\n  manufacturer: string;\n  model?: string;\n  name?: string;\n  sw_version?: string;\n  via_device_id?: string;\n  area_id?: string;\n  name_by_user?: string;\n}\n\nexport interface DeviceRegistryEntryMutableParams {\n  area_id?: string | null;\n  name_by_user?: string | null;\n}\n\nexport const updateDeviceRegistryEntry = (\n  hass: HomeAssistant,\n  deviceId: string,\n  updates: Partial<DeviceRegistryEntryMutableParams>\n) =>\n  hass.callWS<DeviceRegistryEntry>({\n    type: \"config/device_registry/update\",\n    device_id: deviceId,\n    ...updates,\n  });\n\nconst fetchDeviceRegistry = (conn) =>\n  conn.sendMessagePromise({\n    type: \"config/device_registry/list\",\n  });\n\nconst subscribeDeviceRegistryUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchDeviceRegistry(conn).then((devices) =>\n          store.setState(devices, true)\n        ),\n      500,\n      true\n    ),\n    \"device_registry_updated\"\n  );\n\nexport const subscribeDeviceRegistry = (\n  conn: Connection,\n  onChange: (devices: DeviceRegistryEntry[]) => void\n) =>\n  createCollection<DeviceRegistryEntry[]>(\n    \"_dr\",\n    fetchDeviceRegistry,\n    subscribeDeviceRegistryUpdates,\n    conn,\n    onChange\n  );\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n  property,\n  customElement,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-label-badge\";\nimport \"../components/hui-warning\";\n\nimport { LovelaceCard } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport {\n  callAlarmAction,\n  FORMAT_NUMBER,\n} from \"../../../data/alarm_control_panel\";\nimport { AlarmPanelCardConfig } from \"./types\";\n\nconst ICONS = {\n  armed_away: \"hass:shield-lock\",\n  armed_custom_bypass: \"hass:security\",\n  armed_home: \"hass:shield-home\",\n  armed_night: \"hass:shield-home\",\n  disarmed: \"hass:shield-check\",\n  pending: \"hass:shield-outline\",\n  triggered: \"hass:bell-ring\",\n};\n\nconst BUTTONS = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"\", \"0\", \"clear\"];\n\n@customElement(\"hui-alarm-panel-card\")\nclass HuiAlarmPanelCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement() {\n    await import(/* webpackChunkName: \"hui-alarm-panel-card-editor\" */ \"../editor/config-elements/hui-alarm-panel-card-editor\");\n    return document.createElement(\"hui-alarm-panel-card-editor\");\n  }\n\n  public static getStubConfig() {\n    return { states: [\"arm_home\", \"arm_away\"] };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: AlarmPanelCardConfig;\n\n  @property() private _code?: string;\n\n  public getCardSize(): number {\n    if (!this._config || !this.hass) {\n      return 0;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    return !stateObj || stateObj.attributes.code_format !== FORMAT_NUMBER\n      ? 3\n      : 8;\n  }\n\n  public setConfig(config: AlarmPanelCardConfig): void {\n    if (\n      !config ||\n      !config.entity ||\n      config.entity.split(\".\")[0] !== \"alarm_control_panel\"\n    ) {\n      throw new Error(\"Invalid card configuration\");\n    }\n\n    const defaults = {\n      states: [\"arm_away\", \"arm_home\"],\n    };\n\n    this._config = { ...defaults, ...config };\n    this._code = \"\";\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\") || changedProps.has(\"_code\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (oldHass) {\n      return (\n        oldHass.states[this._config!.entity] !==\n        this.hass!.states[this._config!.entity]\n      );\n    }\n    return true;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.name || this._label(stateObj.state)}\">\n        <ha-label-badge\n          class=\"${classMap({ [stateObj.state]: true })}\"\n          .icon=\"${ICONS[stateObj.state] || \"hass:shield-outline\"}\"\n          .label=\"${this._stateIconLabel(stateObj.state)}\"\n        ></ha-label-badge>\n        <div id=\"armActions\" class=\"actions\">\n          ${(stateObj.state === \"disarmed\"\n            ? this._config.states!\n            : [\"disarm\"]\n          ).map((state) => {\n            return html`\n              <mwc-button\n                .action=\"${state}\"\n                @click=\"${this._handleActionClick}\"\n                outlined\n              >\n                ${this._label(state)}\n              </mwc-button>\n            `;\n          })}\n        </div>\n        ${!stateObj.attributes.code_format\n          ? html``\n          : html`\n              <paper-input\n                label=\"Alarm Code\"\n                type=\"password\"\n                .value=\"${this._code}\"\n              ></paper-input>\n            `}\n        ${stateObj.attributes.code_format !== FORMAT_NUMBER\n          ? html``\n          : html`\n              <div id=\"keypad\">\n                ${BUTTONS.map((value) => {\n                  return value === \"\"\n                    ? html`\n                        <mwc-button disabled></mwc-button>\n                      `\n                    : html`\n                        <mwc-button\n                          .value=\"${value}\"\n                          @click=\"${this._handlePadClick}\"\n                          dense\n                        >\n                          ${value === \"clear\"\n                            ? this._label(\"clear_code\")\n                            : value}\n                        </mwc-button>\n                      `;\n                })}\n              </div>\n            `}\n      </ha-card>\n    `;\n  }\n\n  private _stateIconLabel(state: string): string {\n    const stateLabel = state.split(\"_\").pop();\n    return stateLabel === \"disarmed\" ||\n      stateLabel === \"triggered\" ||\n      !stateLabel\n      ? \"\"\n      : stateLabel;\n  }\n\n  private _label(state: string): string {\n    return (\n      this.hass!.localize(`state.alarm_control_panel.${state}`) ||\n      this.hass!.localize(`ui.card.alarm_control_panel.${state}`)\n    );\n  }\n\n  private _handlePadClick(e: MouseEvent): void {\n    const val = (e.currentTarget! as any).value;\n    this._code = val === \"clear\" ? \"\" : this._code + val;\n  }\n\n  private _handleActionClick(e: MouseEvent): void {\n    callAlarmAction(\n      this.hass!,\n      this._config!.entity,\n      (e.currentTarget! as any).action,\n      this._code!\n    );\n    this._code = \"\";\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        padding-bottom: 16px;\n        position: relative;\n        --alarm-color-disarmed: var(--label-badge-green);\n        --alarm-color-pending: var(--label-badge-yellow);\n        --alarm-color-triggered: var(--label-badge-red);\n        --alarm-color-armed: var(--label-badge-red);\n        --alarm-color-autoarm: rgba(0, 153, 255, 0.1);\n        --alarm-state-color: var(--alarm-color-armed);\n        --base-unit: 15px;\n        font-size: calc(var(--base-unit));\n      }\n\n      ha-label-badge {\n        --ha-label-badge-color: var(--alarm-state-color);\n        --label-badge-text-color: var(--alarm-state-color);\n        --label-badge-background-color: var(--paper-card-background-color);\n        color: var(--alarm-state-color);\n        position: absolute;\n        right: 12px;\n        top: 12px;\n      }\n\n      .disarmed {\n        --alarm-state-color: var(--alarm-color-disarmed);\n      }\n\n      .triggered {\n        --alarm-state-color: var(--alarm-color-triggered);\n        animation: pulse 1s infinite;\n      }\n\n      .arming {\n        --alarm-state-color: var(--alarm-color-pending);\n        animation: pulse 1s infinite;\n      }\n\n      .pending {\n        --alarm-state-color: var(--alarm-color-pending);\n        animation: pulse 1s infinite;\n      }\n\n      @keyframes pulse {\n        0% {\n          --ha-label-badge-color: var(--alarm-state-color);\n        }\n        100% {\n          --ha-label-badge-color: rgba(255, 153, 0, 0.3);\n        }\n      }\n\n      paper-input {\n        margin: 0 auto 8px;\n        max-width: 150px;\n        font-size: calc(var(--base-unit));\n        text-align: center;\n      }\n\n      .state {\n        margin-left: 16px;\n        font-size: calc(var(--base-unit) * 0.9);\n        position: relative;\n        bottom: 16px;\n        color: var(--alarm-state-color);\n        animation: none;\n      }\n\n      #keypad {\n        display: flex;\n        justify-content: center;\n        flex-wrap: wrap;\n        margin: auto;\n        width: 300px;\n      }\n\n      #keypad mwc-button {\n        margin-bottom: 5%;\n        width: 30%;\n        padding: calc(var(--base-unit));\n        font-size: calc(var(--base-unit) * 1.1);\n        box-sizing: border-box;\n      }\n\n      .actions {\n        margin: 0 8px;\n        padding-top: 20px;\n        display: flex;\n        flex-wrap: wrap;\n        justify-content: center;\n        font-size: calc(var(--base-unit) * 1);\n      }\n\n      .actions mwc-button {\n        min-width: calc(var(--base-unit) * 9);\n        margin: 0 4px 4px;\n      }\n\n      mwc-button#disarm {\n        color: var(--google-red-500);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-alarm-panel-card\": HuiAlarmPanelCard;\n  }\n}\n","import { HomeAssistant } from \"../types\";\n\nexport const FORMAT_TEXT = \"text\";\nexport const FORMAT_NUMBER = \"number\";\n\nexport const callAlarmAction = (\n  hass: HomeAssistant,\n  entity: string,\n  action:\n    | \"arm_away\"\n    | \"arm_home\"\n    | \"arm_night\"\n    | \"arm_custom_bypass\"\n    | \"disarm\",\n  code: string\n) => {\n  hass!.callService(\"alarm_control_panel\", \"alarm_\" + action, {\n    entity_id: entity,\n    code,\n  });\n};\n","import { HomeAssistant } from \"../../../types\";\n\nexport interface Condition {\n  entity: string;\n  state?: string;\n  state_not?: string;\n}\n\nexport function checkConditionsMet(\n  conditions: Condition[],\n  hass: HomeAssistant\n): boolean {\n  return conditions.every((c) => {\n    const state = hass.states[c.entity]\n      ? hass!.states[c.entity].state\n      : \"unavailable\";\n\n    return c.state ? state === c.state : state !== c.state_not;\n  });\n}\n\nexport function validateConditionalConfig(conditions: Condition[]): boolean {\n  return conditions.every(\n    (c) => ((c.entity && (c.state || c.state_not)) as unknown) as boolean\n  );\n}\n","import { createCardElement } from \"../common/create-card-element\";\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport {\n  checkConditionsMet,\n  validateConditionalConfig,\n} from \"../../lovelace/common/validate-condition\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard } from \"../types\";\nimport { ConditionalCardConfig } from \"./types\";\n\nclass HuiConditionalCard extends HTMLElement implements LovelaceCard {\n  private _hass?: HomeAssistant;\n  private _config?: ConditionalCardConfig;\n  private _card?: LovelaceCard;\n\n  public setConfig(config) {\n    if (\n      !config.card ||\n      !config.conditions ||\n      !Array.isArray(config.conditions) ||\n      !validateConditionalConfig(config.conditions)\n    ) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    if (this._card && this._card.parentElement) {\n      this.removeChild(this._card);\n    }\n\n    this._config = config;\n    this._card = createCardElement(config.card);\n\n    this.update();\n  }\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n\n    this.update();\n  }\n\n  public getCardSize() {\n    return computeCardSize(this._card!);\n  }\n\n  private update() {\n    if (!this._card || !this._hass) {\n      return;\n    }\n\n    const visible =\n      this._config && checkConditionsMet(this._config.conditions, this._hass);\n\n    if (visible) {\n      this._card.hass = this._hass;\n      if (!this._card.parentElement) {\n        this.appendChild(this._card);\n      }\n    } else if (this._card.parentElement) {\n      this.removeChild(this._card);\n    }\n    // This will hide the complete card so it won't get styled by parent\n    this.style.setProperty(\"display\", visible ? \"\" : \"none\");\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-conditional-card\": HuiConditionalCard;\n  }\n}\n\ncustomElements.define(\"hui-conditional-card\", HuiConditionalCard);\n","import { directive, PropertyPart } from \"lit-html\";\n// See https://github.com/home-assistant/home-assistant-polymer/pull/2457\n// on how to undo mwc -> paper migration\n// import \"@material/mwc-ripple\";\nimport \"@polymer/paper-ripple\";\n\nconst isTouch =\n  \"ontouchstart\" in window ||\n  navigator.maxTouchPoints > 0 ||\n  navigator.msMaxTouchPoints > 0;\n\ninterface LongPress extends HTMLElement {\n  holdTime: number;\n  bind(element: Element): void;\n}\ninterface LongPressElement extends Element {\n  longPress?: boolean;\n}\n\nclass LongPress extends HTMLElement implements LongPress {\n  public holdTime: number;\n  protected ripple: any;\n  protected timer: number | undefined;\n  protected held: boolean;\n  protected cooldownStart: boolean;\n  protected cooldownEnd: boolean;\n\n  constructor() {\n    super();\n    this.holdTime = 500;\n    this.ripple = document.createElement(\"paper-ripple\");\n    this.timer = undefined;\n    this.held = false;\n    this.cooldownStart = false;\n    this.cooldownEnd = false;\n  }\n\n  public connectedCallback() {\n    Object.assign(this.style, {\n      borderRadius: \"50%\", // paper-ripple\n      position: \"absolute\",\n      width: isTouch ? \"100px\" : \"50px\",\n      height: isTouch ? \"100px\" : \"50px\",\n      transform: \"translate(-50%, -50%)\",\n      pointerEvents: \"none\",\n    });\n\n    this.appendChild(this.ripple);\n    this.ripple.style.color = \"#03a9f4\"; // paper-ripple\n    this.ripple.style.color = \"var(--primary-color)\"; // paper-ripple\n    // this.ripple.primary = true;\n\n    [\n      \"touchcancel\",\n      \"mouseout\",\n      \"mouseup\",\n      \"touchmove\",\n      \"mousewheel\",\n      \"wheel\",\n      \"scroll\",\n    ].forEach((ev) => {\n      document.addEventListener(\n        ev,\n        () => {\n          clearTimeout(this.timer);\n          this.stopAnimation();\n          this.timer = undefined;\n        },\n        { passive: true }\n      );\n    });\n  }\n\n  public bind(element: LongPressElement) {\n    if (element.longPress) {\n      return;\n    }\n    element.longPress = true;\n\n    element.addEventListener(\"contextmenu\", (ev: Event) => {\n      const e = ev || window.event;\n      if (e.preventDefault) {\n        e.preventDefault();\n      }\n      if (e.stopPropagation) {\n        e.stopPropagation();\n      }\n      e.cancelBubble = true;\n      e.returnValue = false;\n      return false;\n    });\n\n    const clickStart = (ev: Event) => {\n      if (this.cooldownStart) {\n        return;\n      }\n      this.held = false;\n      let x;\n      let y;\n      if ((ev as TouchEvent).touches) {\n        x = (ev as TouchEvent).touches[0].pageX;\n        y = (ev as TouchEvent).touches[0].pageY;\n      } else {\n        x = (ev as MouseEvent).pageX;\n        y = (ev as MouseEvent).pageY;\n      }\n      this.timer = window.setTimeout(() => {\n        this.startAnimation(x, y);\n        this.held = true;\n      }, this.holdTime);\n\n      this.cooldownStart = true;\n      window.setTimeout(() => (this.cooldownStart = false), 100);\n    };\n\n    const clickEnd = (ev: Event) => {\n      if (\n        this.cooldownEnd ||\n        ([\"touchend\", \"touchcancel\"].includes(ev.type) &&\n          this.timer === undefined)\n      ) {\n        return;\n      }\n      clearTimeout(this.timer);\n      this.stopAnimation();\n      this.timer = undefined;\n      if (this.held) {\n        element.dispatchEvent(new Event(\"ha-hold\"));\n      } else {\n        element.dispatchEvent(new Event(\"ha-click\"));\n      }\n      this.cooldownEnd = true;\n      window.setTimeout(() => (this.cooldownEnd = false), 100);\n    };\n\n    element.addEventListener(\"touchstart\", clickStart, { passive: true });\n    element.addEventListener(\"touchend\", clickEnd);\n    element.addEventListener(\"touchcancel\", clickEnd);\n    element.addEventListener(\"mousedown\", clickStart, { passive: true });\n    element.addEventListener(\"click\", clickEnd);\n  }\n\n  private startAnimation(x: number, y: number) {\n    Object.assign(this.style, {\n      left: `${x}px`,\n      top: `${y}px`,\n      display: null,\n    });\n    this.ripple.holdDown = true; // paper-ripple\n    this.ripple.simulatedRipple(); // paper-ripple\n    // this.ripple.disabled = false;\n    // this.ripple.active = true;\n    // this.ripple.unbounded = true;\n  }\n\n  private stopAnimation() {\n    this.ripple.holdDown = false; // paper-ripple\n    // this.ripple.active = false;\n    // this.ripple.disabled = true;\n    this.style.display = \"none\";\n  }\n}\n\ncustomElements.define(\"long-press\", LongPress);\n\nconst getLongPress = (): LongPress => {\n  const body = document.body;\n  if (body.querySelector(\"long-press\")) {\n    return body.querySelector(\"long-press\") as LongPress;\n  }\n\n  const longpress = document.createElement(\"long-press\");\n  body.appendChild(longpress);\n\n  return longpress as LongPress;\n};\n\nexport const longPressBind = (element: LongPressElement) => {\n  const longpress: LongPress = getLongPress();\n  if (!longpress) {\n    return;\n  }\n  longpress.bind(element);\n};\n\nexport const longPress = directive(() => (part: PropertyPart) => {\n  longPressBind(part.committer.element);\n});\n","import { STATES_OFF } from \"../../../../common/const\";\nimport { turnOnOffEntity } from \"./turn-on-off-entity\";\nimport { HomeAssistant } from \"../../../../types\";\nexport const toggleEntity = (\n  hass: HomeAssistant,\n  entityId: string\n): Promise<void> => {\n  const turnOn = STATES_OFF.includes(hass.states[entityId].state);\n  return turnOnOffEntity(hass, entityId, turnOn);\n};\n","import computeDomain from \"../../../../common/entity/compute_domain\";\nimport { HomeAssistant } from \"../../../../types\";\n\nexport const turnOnOffEntity = (\n  hass: HomeAssistant,\n  entityId: string,\n  turnOn = true\n): Promise<void> => {\n  const stateDomain = computeDomain(entityId);\n  const serviceDomain = stateDomain === \"group\" ? \"homeassistant\" : stateDomain;\n\n  let service;\n  switch (stateDomain) {\n    case \"lock\":\n      service = turnOn ? \"unlock\" : \"lock\";\n      break;\n    case \"cover\":\n      service = turnOn ? \"open_cover\" : \"close_cover\";\n      break;\n    default:\n      service = turnOn ? \"turn_on\" : \"turn_off\";\n  }\n\n  return hass.callService(serviceDomain, service, { entity_id: entityId });\n};\n","import { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { navigate } from \"../../../common/navigate\";\nimport { toggleEntity } from \"../../../../src/panels/lovelace/common/entity/toggle-entity\";\nimport { ActionConfig } from \"../../../data/lovelace\";\n\nexport const handleClick = (\n  node: HTMLElement,\n  hass: HomeAssistant,\n  config: {\n    entity?: string;\n    camera_image?: string;\n    hold_action?: ActionConfig;\n    tap_action?: ActionConfig;\n  },\n  hold: boolean\n): void => {\n  let actionConfig: ActionConfig | undefined;\n\n  if (hold && config.hold_action) {\n    actionConfig = config.hold_action;\n  } else if (!hold && config.tap_action) {\n    actionConfig = config.tap_action;\n  }\n\n  if (!actionConfig) {\n    actionConfig = {\n      action: \"more-info\",\n    };\n  }\n\n  switch (actionConfig.action) {\n    case \"more-info\":\n      if (config.entity || config.camera_image) {\n        fireEvent(node, \"hass-more-info\", {\n          entityId: config.entity ? config.entity : config.camera_image!,\n        });\n      }\n      break;\n    case \"navigate\":\n      if (actionConfig.navigation_path) {\n        navigate(node, actionConfig.navigation_path);\n      }\n      break;\n    case \"toggle\":\n      if (config.entity) {\n        toggleEntity(hass, config.entity!);\n      }\n      break;\n    case \"call-service\": {\n      if (!actionConfig.service) {\n        return;\n      }\n      const [domain, service] = actionConfig.service.split(\".\", 2);\n      hass.callService(domain, service, actionConfig.service_data);\n    }\n  }\n};\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n  customElement,\n  property,\n} from \"lit-element\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport \"@material/mwc-ripple\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-warning\";\n\nimport isValidEntityId from \"../../../common/entity/valid_entity_id\";\nimport stateIcon from \"../../../common/entity/state_icon\";\nimport computeStateDomain from \"../../../common/entity/compute_state_domain\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nimport { HomeAssistant, LightEntity } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { handleClick } from \"../common/handle-click\";\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { EntityButtonCardConfig } from \"./types\";\n\n@customElement(\"hui-entity-button-card\")\nclass HuiEntityButtonCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-entity-button-card-editor\" */ \"../editor/config-elements/hui-entity-button-card-editor\");\n    return document.createElement(\"hui-entity-button-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {\n      tap_action: { action: \"toggle\" },\n      hold_action: { action: \"more-info\" },\n      show_icon: true,\n      show_name: true,\n    };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityButtonCardConfig;\n\n  public getCardSize(): number {\n    return 2;\n  }\n\n  public setConfig(config: EntityButtonCardConfig): void {\n    if (!isValidEntityId(config.entity)) {\n      throw new Error(\"Invalid Entity\");\n    }\n\n    this._config = {\n      theme: \"default\",\n      hold_action: { action: \"more-info\" },\n      show_icon: true,\n      show_name: true,\n      ...config,\n    };\n\n    if (DOMAINS_TOGGLE.has(computeDomain(config.entity))) {\n      this._config = {\n        tap_action: {\n          action: \"toggle\",\n        },\n        ...this._config,\n      };\n    } else {\n      this._config = {\n        tap_action: {\n          action: \"more-info\",\n        },\n        ...this._config,\n      };\n    }\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (oldHass) {\n      return (\n        oldHass.states[this._config!.entity] !==\n        this.hass!.states[this._config!.entity]\n      );\n    }\n    return true;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      >\n        ${this._config.show_icon\n          ? html`\n              <ha-icon\n                data-domain=\"${computeStateDomain(stateObj)}\"\n                data-state=\"${stateObj.state}\"\n                .icon=\"${this._config.icon || stateIcon(stateObj)}\"\n                style=\"${styleMap({\n                  filter: this._computeBrightness(stateObj),\n                  color: this._computeColor(stateObj),\n                  height: this._config.icon_height\n                    ? this._config.icon_height\n                    : \"auto\",\n                })}\"\n              ></ha-icon>\n            `\n          : \"\"}\n        ${this._config.show_name\n          ? html`\n              <span>\n                ${this._config.name || computeStateName(stateObj)}\n              </span>\n            `\n          : \"\"}\n        <mwc-ripple></mwc-ripple>\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        cursor: pointer;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        text-align: center;\n        padding: 4% 0;\n        font-size: 1.2rem;\n      }\n\n      ha-icon {\n        width: 40%;\n        height: auto;\n        color: var(--paper-item-icon-color, #44739e);\n      }\n\n      ha-icon[data-domain=\"light\"][data-state=\"on\"],\n      ha-icon[data-domain=\"switch\"][data-state=\"on\"],\n      ha-icon[data-domain=\"binary_sensor\"][data-state=\"on\"],\n      ha-icon[data-domain=\"fan\"][data-state=\"on\"],\n      ha-icon[data-domain=\"sun\"][data-state=\"above_horizon\"] {\n        color: var(--paper-item-icon-active-color, #fdd835);\n      }\n\n      ha-icon[data-state=\"unavailable\"] {\n        color: var(--state-icon-unavailable-color);\n      }\n    `;\n  }\n\n  private _computeBrightness(stateObj: HassEntity | LightEntity): string {\n    if (!stateObj.attributes.brightness) {\n      return \"\";\n    }\n    const brightness = stateObj.attributes.brightness;\n    return `brightness(${(brightness + 245) / 5}%)`;\n  }\n\n  private _computeColor(stateObj: HassEntity | LightEntity): string {\n    if (!stateObj.attributes.hs_color) {\n      return \"\";\n    }\n    const [hue, sat] = stateObj.attributes.hs_color;\n    if (sat <= 10) {\n      return \"\";\n    }\n    return `hsl(${hue}, 100%, ${100 - sat / 2}%)`;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entity-button-card\": HuiEntityButtonCard;\n  }\n}\n","import { createCardElement } from \"../common/create-card-element\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\nimport { EntityConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityFilterCardConfig } from \"./types\";\n\nclass EntityFilterCard extends HTMLElement implements LovelaceCard {\n  public isPanel?: boolean;\n  private _element?: LovelaceCard;\n  private _config?: EntityFilterCardConfig;\n  private _configEntities?: EntityConfig[];\n  private _baseCardConfig?: LovelaceCardConfig;\n\n  public getCardSize(): number {\n    return this._element ? this._element.getCardSize() : 1;\n  }\n\n  public setConfig(config: EntityFilterCardConfig): void {\n    if (!config.state_filter || !Array.isArray(config.state_filter)) {\n      throw new Error(\"Incorrect filter config.\");\n    }\n\n    this._config = config;\n    this._configEntities = undefined;\n    this._baseCardConfig = {\n      type: \"entities\",\n      entities: [],\n      ...this._config.card,\n    };\n\n    if (this.lastChild) {\n      this.removeChild(this.lastChild);\n      this._element = undefined;\n    }\n  }\n\n  set hass(hass: HomeAssistant) {\n    if (!hass || !this._config) {\n      return;\n    }\n\n    if (!this._configEntities) {\n      this._configEntities = processConfigEntities(this._config.entities);\n    }\n\n    const entitiesList = this._configEntities.filter((entityConf) => {\n      const stateObj = hass.states[entityConf.entity];\n      return stateObj && this._config!.state_filter.includes(stateObj.state);\n    });\n\n    if (entitiesList.length === 0 && this._config.show_empty === false) {\n      this.style.display = \"none\";\n      return;\n    }\n\n    const element = this._cardElement();\n\n    if (!element) {\n      return;\n    }\n\n    if (element.tagName !== \"HUI-ERROR-CARD\") {\n      element.setConfig({ ...this._baseCardConfig!, entities: entitiesList });\n      element.isPanel = this.isPanel;\n      element.hass = hass;\n    }\n\n    // Attach element if it has never been attached.\n    if (!this.lastChild) {\n      this.appendChild(element);\n    }\n\n    this.style.display = \"block\";\n  }\n\n  private _cardElement(): LovelaceCard | undefined {\n    if (!this._element && this._config) {\n      const element = createCardElement(this._baseCardConfig!);\n      this._element = element;\n    }\n\n    return this._element;\n  }\n}\ncustomElements.define(\"hui-entity-filter-card\", EntityFilterCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResult,\n  css,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport \"../../../components/ha-icon\";\n\n@customElement(\"hui-warning-element\")\nexport class HuiWarningElement extends LitElement {\n  @property() public label?: string;\n\n  protected render(): TemplateResult | void {\n    return html`\n      <ha-icon icon=\"hass:alert\" .title=\"${this.label}\"></ha-icon>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-icon {\n        color: #fce588;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-warning-element\": HuiWarningElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\n\nimport \"../../../components/entity/state-badge\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning-element\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { handleClick } from \"../common/handle-click\";\nimport { GlanceCardConfig, ConfigEntity } from \"./types\";\n\n@customElement(\"hui-glance-card\")\nexport class HuiGlanceCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-glance-card-editor\" */ \"../editor/config-elements/hui-glance-card-editor\");\n    return document.createElement(\"hui-glance-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { entities: [] };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: GlanceCardConfig;\n\n  private _configEntities?: ConfigEntity[];\n\n  public getCardSize(): number {\n    return (\n      (this._config!.title ? 1 : 0) +\n      Math.ceil(this._configEntities!.length / 5)\n    );\n  }\n\n  public setConfig(config: GlanceCardConfig): void {\n    this._config = { theme: \"default\", ...config };\n    const entities = processConfigEntities<ConfigEntity>(config.entities);\n\n    for (const entity of entities) {\n      if (\n        (entity.tap_action &&\n          entity.tap_action.action === \"call-service\" &&\n          !entity.tap_action.service) ||\n        (entity.hold_action &&\n          entity.hold_action.action === \"call-service\" &&\n          !entity.hold_action.service)\n      ) {\n        throw new Error(\n          'Missing required property \"service\" when tap_action or hold_action is call-service'\n        );\n      }\n    }\n\n    const columns = config.columns || Math.min(config.entities.length, 5);\n    this.style.setProperty(\"--glance-column-width\", `${100 / columns}%`);\n\n    this._configEntities = entities;\n\n    if (this.hass) {\n      this.requestUpdate();\n    }\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (oldHass && this._configEntities) {\n      for (const entity of this._configEntities) {\n        if (\n          oldHass.states[entity.entity] !== this.hass!.states[entity.entity]\n        ) {\n          return true;\n        }\n      }\n      return false;\n    }\n    return true;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const { title } = this._config;\n\n    return html`\n      <ha-card .header=\"${title}\">\n        <div class=\"${classMap({ entities: true, \"no-header\": !title })}\">\n          ${this._configEntities!.map((entityConf) =>\n            this.renderEntity(entityConf)\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProperties.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .entities {\n        display: flex;\n        padding: 0 16px 4px;\n        flex-wrap: wrap;\n      }\n      .entities.no-header {\n        padding-top: 16px;\n      }\n      .entity {\n        box-sizing: border-box;\n        padding: 0 4px;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        cursor: pointer;\n        margin-bottom: 12px;\n        width: var(--glance-column-width, 20%);\n      }\n      .entity div {\n        width: 100%;\n        text-align: center;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .name {\n        min-height: var(--paper-font-body1_-_line-height, 20px);\n      }\n      state-badge {\n        margin: 8px 0;\n      }\n    `;\n  }\n\n  private renderEntity(entityConf): TemplateResult {\n    const stateObj = this.hass!.states[entityConf.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass!.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            entityConf.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <div\n        class=\"entity\"\n        .entityConf=\"${entityConf}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      >\n        ${this._config!.show_name !== false\n          ? html`\n              <div class=\"name\">\n                ${\"name\" in entityConf\n                  ? entityConf.name\n                  : computeStateName(stateObj)}\n              </div>\n            `\n          : \"\"}\n        ${this._config!.show_icon !== false\n          ? html`\n              <state-badge\n                .stateObj=\"${stateObj}\"\n                .overrideIcon=\"${entityConf.icon}\"\n              ></state-badge>\n            `\n          : \"\"}\n        ${this._config!.show_state !== false\n          ? html`\n              <div>\n                ${computeStateDisplay(\n                  this.hass!.localize,\n                  stateObj,\n                  this.hass!.language\n                )}\n              </div>\n            `\n          : \"\"}\n      </div>\n    `;\n  }\n\n  private _handleTap(ev: MouseEvent): void {\n    const config = (ev.currentTarget as any).entityConf as ConfigEntity;\n    handleClick(this, this.hass!, config, false);\n  }\n\n  private _handleHold(ev: MouseEvent): void {\n    const config = (ev.currentTarget as any).entityConf as ConfigEntity;\n    handleClick(this, this.hass!, config, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-glance-card\": HuiGlanceCard;\n  }\n}\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/state-history-charts\";\nimport \"../../../data/ha-state-history-data\";\n\nimport { processConfigEntities } from \"../common/process-config-entities\";\n\nclass HuiHistoryGraphCard extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        .content {\n          padding: 16px;\n        }\n        [header] .content {\n          padding-top: 0;\n        }\n      </style>\n\n      <ha-card header$=\"[[_config.title]]\">\n        <div class=\"content\">\n          <ha-state-history-data\n            hass=\"[[hass]]\"\n            filter-type=\"recent-entity\"\n            entity-id=\"[[_entities]]\"\n            data=\"{{_stateHistory}}\"\n            is-loading=\"{{_stateHistoryLoading}}\"\n            cache-config=\"[[_cacheConfig]]\"\n          ></ha-state-history-data>\n          <state-history-charts\n            hass=\"[[hass]]\"\n            history-data=\"[[_stateHistory]]\"\n            is-loading-data=\"[[_stateHistoryLoading]]\"\n            names=\"[[_names]]\"\n            up-to-now\n            no-single\n          ></state-history-charts>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      _config: Object,\n      _names: Object,\n      _entities: Array,\n\n      _stateHistory: Object,\n      _stateHistoryLoading: Boolean,\n      _cacheConfig: Object,\n    };\n  }\n\n  getCardSize() {\n    return 4;\n  }\n\n  setConfig(config) {\n    const entities = processConfigEntities(config.entities);\n\n    this._config = config;\n\n    const _entities = [];\n    const _names = {};\n    for (const entity of entities) {\n      _entities.push(entity.entity);\n      if (entity.name) {\n        _names[entity.entity] = entity.name;\n      }\n    }\n\n    this.setProperties({\n      _cacheConfig: {\n        cacheKey: _entities.sort().join(),\n        hoursToShow: config.hours_to_show || 24,\n        refresh: config.refresh_interval || 0,\n      },\n      _entities,\n      _names,\n    });\n  }\n}\n\ncustomElements.define(\"hui-history-graph-card\", HuiHistoryGraphCard);\n","import { html, LitElement, TemplateResult } from \"lit-element\";\n\nimport { createCardElement } from \"../common/create-card-element\";\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\nimport { HomeAssistant } from \"../../../types\";\nimport { StackCardConfig } from \"./types\";\n\nexport abstract class HuiStackCard extends LitElement implements LovelaceCard {\n  static get properties() {\n    return {\n      _config: {},\n    };\n  }\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n\n    if (!this._cards) {\n      return;\n    }\n\n    for (const element of this._cards) {\n      element.hass = this._hass;\n    }\n  }\n  protected _cards?: LovelaceCard[];\n  private _config?: StackCardConfig;\n  private _hass?: HomeAssistant;\n\n  public abstract getCardSize(): number;\n\n  public setConfig(config: StackCardConfig): void {\n    if (!config || !config.cards || !Array.isArray(config.cards)) {\n      throw new Error(\"Card config incorrect\");\n    }\n    this._config = config;\n    this._cards = config.cards.map((card) => {\n      const element = this._createCardElement(card) as LovelaceCard;\n      return element;\n    });\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      ${this.renderStyle()}\n      <div id=\"root\">${this._cards}</div>\n    `;\n  }\n\n  protected abstract renderStyle(): TemplateResult;\n\n  private _createCardElement(cardConfig: LovelaceCardConfig) {\n    const element = createCardElement(cardConfig) as LovelaceCard;\n    if (this._hass) {\n      element.hass = this._hass;\n    }\n    element.addEventListener(\n      \"ll-rebuild\",\n      (ev) => {\n        ev.stopPropagation();\n        this._rebuildCard(element, cardConfig);\n      },\n      { once: true }\n    );\n    return element;\n  }\n\n  private _rebuildCard(\n    cardElToReplace: LovelaceCard,\n    config: LovelaceCardConfig\n  ): void {\n    const newCardEl = this._createCardElement(config);\n    cardElToReplace.parentElement!.replaceChild(newCardEl, cardElToReplace);\n    this._cards = this._cards!.map((curCardEl) =>\n      curCardEl === cardElToReplace ? newCardEl : curCardEl\n    );\n  }\n}\n","import { html, TemplateResult } from \"lit-element\";\n\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport { HuiStackCard } from \"./hui-stack-card\";\n\nclass HuiHorizontalStackCard extends HuiStackCard {\n  public getCardSize(): number {\n    let totalSize = 0;\n\n    if (this._cards) {\n      for (const element of this._cards) {\n        const elementSize = computeCardSize(element);\n        totalSize = elementSize > totalSize ? elementSize : totalSize;\n      }\n    }\n\n    return totalSize;\n  }\n\n  protected renderStyle(): TemplateResult {\n    return html`\n      <style>\n        #root {\n          display: flex;\n        }\n        #root > * {\n          flex: 1 1 0;\n          margin: 0 4px;\n          min-width: 0;\n        }\n        #root > *:first-child {\n          margin-left: 0;\n        }\n        #root > *:last-child {\n          margin-right: 0;\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-horitzontal-stack-card\": HuiHorizontalStackCard;\n  }\n}\n\ncustomElements.define(\"hui-horizontal-stack-card\", HuiHorizontalStackCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../components/ha-card\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport { IframeCardConfig } from \"./types\";\n\n@customElement(\"hui-iframe-card\")\nexport class HuiIframeCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-iframe-card-editor\" */ \"../editor/config-elements/hui-iframe-card-editor\");\n    return document.createElement(\"hui-iframe-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return { url: \"https://www.home-assistant.io\", aspect_ratio: \"50%\" };\n  }\n\n  @property() protected _config?: IframeCardConfig;\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 3;\n    }\n    const aspectRatio = this._config.aspect_ratio\n      ? Number(this._config.aspect_ratio.replace(\"%\", \"\"))\n      : 50;\n    return 1 + aspectRatio / 25;\n  }\n\n  public setConfig(config: IframeCardConfig): void {\n    if (!config.url) {\n      throw new Error(\"URL required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    const aspectRatio = this._config.aspect_ratio || \"50%\";\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <div\n          id=\"root\"\n          style=\"${styleMap({\n            \"padding-top\": aspectRatio,\n          })}\"\n        >\n          <iframe src=\"${this._config.url}\"></iframe>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        overflow: hidden;\n      }\n\n      #root {\n        width: 100%;\n        position: relative;\n      }\n\n      iframe {\n        position: absolute;\n        border: none;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-iframe-card\": HuiIframeCard;\n  }\n}\n","import { TemplateResult } from \"lit-element\";\n\ntype LoadedRoundSlider = Promise<{\n  roundSliderStyle: TemplateResult;\n  jQuery: any;\n}>;\n\nlet loaded: LoadedRoundSlider;\n\nexport const loadRoundslider = async (): LoadedRoundSlider => {\n  if (!loaded) {\n    loaded = import(/* webpackChunkName: \"jquery-roundslider\" */ \"./jquery.roundslider\");\n  }\n  return loaded;\n};\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n\nimport stateIcon from \"../../../common/entity/state_icon\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport { HomeAssistant, LightEntity } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { loadRoundslider } from \"../../../resources/jquery.roundslider.ondemand\";\nimport { toggleEntity } from \"../common/entity/toggle-entity\";\nimport { LightCardConfig } from \"./types\";\n\nconst lightConfig = {\n  radius: 80,\n  step: 1,\n  circleShape: \"pie\",\n  startAngle: 315,\n  width: 5,\n  min: 1,\n  max: 100,\n  sliderType: \"min-range\",\n  lineCap: \"round\",\n  handleSize: \"+12\",\n  showTooltip: false,\n  animation: false,\n};\n\n@customElement(\"hui-light-card\")\nexport class HuiLightCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-light-card-editor\" */ \"../editor/config-elements/hui-light-card-editor\");\n    return document.createElement(\"hui-light-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: LightCardConfig;\n\n  @property() private _roundSliderStyle?: TemplateResult;\n\n  @property() private _jQuery?: any;\n\n  private _brightnessTimout?: number;\n\n  public getCardSize(): number {\n    return 2;\n  }\n\n  public setConfig(config: LightCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"light\") {\n      throw new Error(\"Specify an entity from within the light domain.\");\n    }\n\n    this._config = { theme: \"default\", ...config };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config!.entity] as LightEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      ${this.renderStyle()}\n      <ha-card>\n        <paper-icon-button\n          icon=\"hass:dots-vertical\"\n          class=\"more-info\"\n          @click=\"${this._handleMoreInfo}\"\n        ></paper-icon-button>\n        <div id=\"light\"></div>\n        <div id=\"tooltip\">\n          <div class=\"icon-state\">\n            <ha-icon\n              class=\"light-icon\"\n              data-state=\"${stateObj.state}\"\n              .icon=\"${stateIcon(stateObj)}\"\n              style=\"${styleMap({\n                filter: this._computeBrightness(stateObj),\n                color: this._computeColor(stateObj),\n              })}\"\n              @click=\"${this._handleTap}\"\n            ></ha-icon>\n            <div class=\"brightness\" @ha-click=\"${this._handleTap}\"></div>\n            <div class=\"name\">\n              ${this._config.name || computeStateName(stateObj)}\n            </div>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected async firstUpdated(): Promise<void> {\n    const loaded = await loadRoundslider();\n\n    this._roundSliderStyle = loaded.roundSliderStyle;\n    this._jQuery = loaded.jQuery;\n\n    const stateObj = this.hass!.states[this._config!.entity] as LightEntity;\n\n    if (!stateObj) {\n      // Card will require refresh to work again\n      return;\n    }\n\n    const brightness = stateObj.attributes.brightness || 0;\n\n    this._jQuery(\"#light\", this.shadowRoot).roundSlider({\n      ...lightConfig,\n      change: (value) => this._setBrightness(value),\n      drag: (value) => this._dragEvent(value),\n      start: () => this._showBrightness(),\n      stop: () => this._hideBrightness(),\n    });\n    this.shadowRoot!.querySelector(\".brightness\")!.innerHTML =\n      (Math.round((brightness / 254) * 100) || 0) + \"%\";\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass || !this._jQuery) {\n      return;\n    }\n\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (!stateObj) {\n      return;\n    }\n\n    const attrs = stateObj.attributes;\n\n    this._jQuery(\"#light\", this.shadowRoot).roundSlider({\n      value: Math.round((attrs.brightness / 254) * 100) || 0,\n    });\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  private renderStyle(): TemplateResult {\n    return html`\n      ${this._roundSliderStyle}\n      <style>\n        :host {\n          display: block;\n        }\n\n        ha-card {\n          position: relative;\n          overflow: hidden;\n          --brightness-font-color: white;\n          --brightness-font-text-shadow: -1px -1px 0 #000, 1px -1px 0 #000,\n            -1px 1px 0 #000, 1px 1px 0 #000;\n          --name-font-size: 1.2rem;\n          --brightness-font-size: 1.2rem;\n          --rail-border-color: transparent;\n        }\n\n        #tooltip {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 100%;\n          text-align: center;\n          z-index: 15;\n        }\n\n        .icon-state {\n          display: block;\n          margin: auto;\n          width: 100%;\n          height: 100%;\n          transform: translate(0, 25%);\n        }\n\n        #light {\n          margin: 0 auto;\n          padding-top: 16px;\n          padding-bottom: 16px;\n        }\n\n        #light .rs-bar.rs-transition.rs-first,\n        .rs-bar.rs-transition.rs-second {\n          z-index: 20 !important;\n        }\n\n        #light .rs-range-color {\n          background-color: var(--primary-color);\n        }\n\n        #light .rs-path-color {\n          background-color: var(--disabled-text-color);\n        }\n\n        #light .rs-handle {\n          background-color: var(--paper-card-background-color, white);\n          padding: 7px;\n          border: 2px solid var(--disabled-text-color);\n        }\n\n        #light .rs-handle.rs-focus {\n          border-color: var(--primary-color);\n        }\n\n        #light .rs-handle:after {\n          border-color: var(--primary-color);\n          background-color: var(--primary-color);\n        }\n\n        #light .rs-border {\n          border-color: var(--rail-border-color);\n        }\n\n        #light .rs-inner.rs-bg-color.rs-border,\n        #light .rs-overlay.rs-transition.rs-bg-color {\n          background-color: var(--paper-card-background-color, white);\n        }\n\n        .light-icon {\n          margin: auto;\n          width: 76px;\n          height: 76px;\n          color: var(--paper-item-icon-color, #44739e);\n          cursor: pointer;\n        }\n\n        .light-icon[data-state=\"on\"] {\n          color: var(--paper-item-icon-active-color, #fdd835);\n        }\n\n        .light-icon[data-state=\"unavailable\"] {\n          color: var(--state-icon-unavailable-color);\n        }\n\n        .name {\n          padding-top: 40px;\n          font-size: var(--name-font-size);\n        }\n\n        .brightness {\n          font-size: var(--brightness-font-size);\n          position: absolute;\n          margin: 0 auto;\n          left: 50%;\n          top: 10%;\n          transform: translate(-50%);\n          opacity: 0;\n          transition: opacity 0.5s ease-in-out;\n          -moz-transition: opacity 0.5s ease-in-out;\n          -webkit-transition: opacity 0.5s ease-in-out;\n          cursor: pointer;\n          color: var(--brightness-font-color);\n          text-shadow: var(--brightness-font-text-shadow);\n          pointer-events: none;\n        }\n\n        .show_brightness {\n          opacity: 1;\n        }\n\n        .more-info {\n          position: absolute;\n          cursor: pointer;\n          top: 0;\n          right: 0;\n          z-index: 25;\n          color: var(--secondary-text-color);\n        }\n      </style>\n    `;\n  }\n\n  private _dragEvent(e: any): void {\n    this.shadowRoot!.querySelector(\".brightness\")!.innerHTML = e.value + \"%\";\n  }\n\n  private _showBrightness(): void {\n    clearTimeout(this._brightnessTimout);\n    this.shadowRoot!.querySelector(\".brightness\")!.classList.add(\n      \"show_brightness\"\n    );\n  }\n\n  private _hideBrightness(): void {\n    this._brightnessTimout = window.setTimeout(() => {\n      this.shadowRoot!.querySelector(\".brightness\")!.classList.remove(\n        \"show_brightness\"\n      );\n    }, 500);\n  }\n\n  private _setBrightness(e: any): void {\n    this.hass!.callService(\"light\", \"turn_on\", {\n      entity_id: this._config!.entity,\n      brightness_pct: e.value,\n    });\n  }\n\n  private _computeBrightness(stateObj: LightEntity): string {\n    if (!stateObj.attributes.brightness) {\n      return \"\";\n    }\n    const brightness = stateObj.attributes.brightness;\n    return `brightness(${(brightness + 245) / 5}%)`;\n  }\n\n  private _computeColor(stateObj: LightEntity): string {\n    if (!stateObj.attributes.hs_color) {\n      return \"\";\n    }\n    const [hue, sat] = stateObj.attributes.hs_color;\n    if (sat <= 10) {\n      return \"\";\n    }\n    return `hsl(${hue}, 100%, ${100 - sat / 2}%)`;\n  }\n\n  private _handleTap() {\n    toggleEntity(this.hass!, this._config!.entity!);\n  }\n\n  private _handleMoreInfo() {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-light-card\": HuiLightCard;\n  }\n}\n","import \"@polymer/iron-image/iron-image\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport { EventsMixin } from \"../../mixins/events-mixin\";\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaEntityMarker extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style include=\"iron-positioning\"></style>\n      <style>\n        .marker {\n          vertical-align: top;\n          position: relative;\n          display: block;\n          margin: 0 auto;\n          width: 2.5em;\n          text-align: center;\n          height: 2.5em;\n          line-height: 2.5em;\n          font-size: 1.5em;\n          border-radius: 50%;\n          border: 0.1em solid\n            var(--ha-marker-color, var(--default-primary-color));\n          color: rgb(76, 76, 76);\n          background-color: white;\n        }\n        iron-image {\n          border-radius: 50%;\n        }\n      </style>\n\n      <div class=\"marker\">\n        <template is=\"dom-if\" if=\"[[entityName]]\"\n          >[[entityName]]</template\n        >\n        <template is=\"dom-if\" if=\"[[entityPicture]]\">\n          <iron-image\n            sizing=\"cover\"\n            class=\"fit\"\n            src=\"[[entityPicture]]\"\n          ></iron-image>\n        </template>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      entityId: {\n        type: String,\n        value: \"\",\n      },\n\n      entityName: {\n        type: String,\n        value: null,\n      },\n\n      entityPicture: {\n        type: String,\n        value: null,\n      },\n    };\n  }\n\n  ready() {\n    super.ready();\n    this.addEventListener(\"click\", (ev) => this.badgeTap(ev));\n  }\n\n  badgeTap(ev) {\n    ev.stopPropagation();\n    if (this.entityId) {\n      this.fire(\"hass-more-info\", { entityId: this.entityId });\n    }\n  }\n}\n\ncustomElements.define(\"ha-entity-marker\", HaEntityMarker);\n","// Handle 16x9, 16:9, 1.78x1, 1.78:1, 1.78\n// Ignore everything else\nconst parseOrThrow = (num) => {\n  const parsed = parseFloat(num);\n  if (isNaN(parsed)) {\n    throw new Error(`${num} is not a number`);\n  }\n  return parsed;\n};\n\nexport default function parseAspectRatio(input: string) {\n  if (!input) {\n    return null;\n  }\n  try {\n    if (input.endsWith(\"%\")) {\n      return { w: 100, h: parseOrThrow(input.substr(0, input.length - 1)) };\n    }\n\n    const arr = input.replace(\":\", \"x\").split(\"x\");\n    if (arr.length === 0) {\n      return null;\n    }\n\n    return arr.length === 1\n      ? { w: parseOrThrow(arr[0]), h: 1 }\n      : { w: parseOrThrow(arr[0]), h: parseOrThrow(arr[1]) };\n  } catch (err) {\n    // Ignore the error\n  }\n  return null;\n}\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport { Layer, Marker, Circle, Map } from \"leaflet\";\nimport {\n  LitElement,\n  TemplateResult,\n  css,\n  html,\n  property,\n  PropertyValues,\n  CSSResult,\n  customElement,\n} from \"lit-element\";\n\nimport \"../../map/ha-entity-marker\";\n\nimport {\n  setupLeafletMap,\n  LeafletModuleType,\n} from \"../../../common/dom/setup-leaflet-map\";\nimport computeStateDomain from \"../../../common/entity/compute_state_domain\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport { debounce } from \"../../../common/util/debounce\";\nimport parseAspectRatio from \"../../../common/util/parse-aspect-ratio\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard } from \"../types\";\nimport { EntityConfig } from \"../entity-rows/types\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { MapCardConfig } from \"./types\";\n\n@customElement(\"hui-map-card\")\nclass HuiMapCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement() {\n    await import(\n      /* webpackChunkName: \"hui-map-card-editor\" */ \"../editor/config-elements/hui-map-card-editor\"\n    );\n    return document.createElement(\"hui-map-card-editor\");\n  }\n\n  public static getStubConfig() {\n    return { entities: [] };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property({ type: Boolean, reflect: true })\n  public isPanel = false;\n\n  @property()\n  private _config?: MapCardConfig;\n  private _configEntities?: EntityConfig[];\n  // tslint:disable-next-line\n  private Leaflet?: LeafletModuleType;\n  private _leafletMap?: Map;\n  // @ts-ignore\n  private _resizeObserver?: ResizeObserver;\n  private _debouncedResizeListener = debounce(\n    () => {\n      if (!this._leafletMap) {\n        return;\n      }\n      this._leafletMap.invalidateSize();\n    },\n    100,\n    false\n  );\n  private _mapItems: Array<Marker | Circle> = [];\n  private _connected = false;\n\n  public setConfig(config: MapCardConfig): void {\n    if (!config) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    if (!config.entities && !config.geo_location_sources) {\n      throw new Error(\n        \"Either entities or geo_location_sources must be defined\"\n      );\n    }\n    if (config.entities && !Array.isArray(config.entities)) {\n      throw new Error(\"Entities need to be an array\");\n    }\n    if (\n      config.geo_location_sources &&\n      !Array.isArray(config.geo_location_sources)\n    ) {\n      throw new Error(\"Geo_location_sources needs to be an array\");\n    }\n\n    this._config = config;\n    this._configEntities = config.entities\n      ? processConfigEntities(config.entities)\n      : [];\n  }\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 3;\n    }\n    const ratio = parseAspectRatio(this._config.aspect_ratio);\n    const ar =\n      ratio && ratio.w > 0 && ratio.h > 0\n        ? `${((100 * ratio.h) / ratio.w).toFixed(2)}`\n        : \"100\";\n    return 1 + Math.floor(Number(ar) / 25) || 3;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._connected = true;\n    if (this.hasUpdated) {\n      this.loadMap();\n      this._attachObserver();\n    }\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._connected = false;\n\n    if (this._leafletMap) {\n      this._leafletMap.remove();\n      this._leafletMap = undefined;\n      this.Leaflet = undefined;\n    }\n\n    if (this._resizeObserver) {\n      this._resizeObserver.unobserve(this._mapEl);\n    } else {\n      window.removeEventListener(\"resize\", this._debouncedResizeListener);\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n    return html`\n      <ha-card id=\"card\" .header=${this._config.title}>\n        <div id=\"root\">\n          <div id=\"map\"></div>\n          <paper-icon-button\n            @click=${this._fitMap}\n            icon=\"hass:image-filter-center-focus\"\n            title=\"Reset focus\"\n          ></paper-icon-button>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues): void {\n    super.firstUpdated(changedProps);\n    this.loadMap();\n    const root = this.shadowRoot!.getElementById(\"root\");\n\n    if (!this._config || this.isPanel || !root) {\n      return;\n    }\n\n    if (this._connected) {\n      this._attachObserver();\n    }\n\n    const ratio = parseAspectRatio(this._config.aspect_ratio);\n\n    root.style.paddingBottom =\n      ratio && ratio.w > 0 && ratio.h > 0\n        ? `${((100 * ratio.h) / ratio.w).toFixed(2)}%`\n        : (root.style.paddingBottom = \"100%\");\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    if (changedProps.has(\"hass\")) {\n      this._drawEntities();\n    }\n  }\n\n  private get _mapEl(): HTMLDivElement {\n    return this.shadowRoot!.getElementById(\"map\") as HTMLDivElement;\n  }\n\n  private async loadMap(): Promise<void> {\n    [this._leafletMap, this.Leaflet] = await setupLeafletMap(\n      this._mapEl,\n      this._config !== undefined ? this._config.dark_mode === true : false\n    );\n    this._drawEntities();\n    this._leafletMap.invalidateSize();\n    this._fitMap();\n  }\n\n  private _fitMap(): void {\n    if (!this._leafletMap || !this.Leaflet || !this._config || !this.hass) {\n      return;\n    }\n    const zoom = this._config.default_zoom;\n    if (this._mapItems.length === 0) {\n      this._leafletMap.setView(\n        new this.Leaflet.LatLng(\n          this.hass.config.latitude,\n          this.hass.config.longitude\n        ),\n        zoom || 14\n      );\n      return;\n    }\n\n    const bounds = this.Leaflet.latLngBounds(\n      this._mapItems ? this._mapItems.map((item) => item.getLatLng()) : []\n    );\n    this._leafletMap.fitBounds(bounds.pad(0.5));\n\n    if (zoom && this._leafletMap.getZoom() > zoom) {\n      this._leafletMap.setZoom(zoom);\n    }\n  }\n\n  private _drawEntities(): void {\n    const hass = this.hass;\n    const map = this._leafletMap;\n    const config = this._config;\n    const Leaflet = this.Leaflet;\n    if (!hass || !map || !config || !Leaflet) {\n      return;\n    }\n\n    if (this._mapItems) {\n      this._mapItems.forEach((marker) => marker.remove());\n    }\n    const mapItems: Layer[] = (this._mapItems = []);\n\n    const allEntities = this._configEntities!.concat();\n\n    // Calculate visible geo location sources\n    if (config.geo_location_sources) {\n      const includesAll = config.geo_location_sources.includes(\"all\");\n      for (const entityId of Object.keys(hass.states)) {\n        const stateObj = hass.states[entityId];\n        if (\n          computeDomain(entityId) === \"geo_location\" &&\n          (includesAll ||\n            config.geo_location_sources.includes(stateObj.attributes.source))\n        ) {\n          allEntities.push({ entity: entityId });\n        }\n      }\n    }\n\n    for (const entity of allEntities) {\n      const entityId = entity.entity;\n      const stateObj = hass.states[entityId];\n      if (!stateObj) {\n        continue;\n      }\n      const title = computeStateName(stateObj);\n      const {\n        latitude,\n        longitude,\n        passive,\n        icon,\n        radius,\n        entity_picture: entityPicture,\n        gps_accuracy: gpsAccuracy,\n      } = stateObj.attributes;\n\n      if (!(latitude && longitude)) {\n        continue;\n      }\n\n      if (computeStateDomain(stateObj) === \"zone\") {\n        // DRAW ZONE\n        if (passive) {\n          continue;\n        }\n\n        // create marker with the icon\n        mapItems.push(\n          Leaflet.marker([latitude, longitude], {\n            icon: Leaflet.divIcon({\n              html: icon ? `<ha-icon icon=\"${icon}\"></ha-icon>` : title,\n              iconSize: [24, 24],\n              className: \"\",\n            }),\n            interactive: false,\n            title,\n          })\n        );\n\n        // create circle around it\n        mapItems.push(\n          Leaflet.circle([latitude, longitude], {\n            interactive: false,\n            color: \"#FF9800\",\n            radius,\n          })\n        );\n\n        continue;\n      }\n\n      // DRAW ENTITY\n      // create icon\n      const entityName = title\n        .split(\" \")\n        .map((part) => part[0])\n        .join(\"\")\n        .substr(0, 3);\n\n      // create market with the icon\n      mapItems.push(\n        Leaflet.marker([latitude, longitude], {\n          icon: Leaflet.divIcon({\n            // Leaflet clones this element before adding it to the map. This messes up\n            // our Polymer object and we can't pass data through. Thus we hack like this.\n            html: `\n              <ha-entity-marker\n                entity-id=\"${entityId}\"\n                entity-name=\"${entityName}\"\n                entity-picture=\"${entityPicture || \"\"}\"\n              ></ha-entity-marker>\n            `,\n            iconSize: [48, 48],\n            className: \"\",\n          }),\n          title: computeStateName(stateObj),\n        })\n      );\n\n      // create circle around if entity has accuracy\n      if (gpsAccuracy) {\n        mapItems.push(\n          Leaflet.circle([latitude, longitude], {\n            interactive: false,\n            color: \"#0288D1\",\n            radius: gpsAccuracy,\n          })\n        );\n      }\n    }\n\n    this._mapItems.forEach((marker) => map.addLayer(marker));\n  }\n\n  private _attachObserver(): void {\n    // Observe changes to map size and invalidate to prevent broken rendering\n    // Uses ResizeObserver in Chrome, otherwise window resize event\n\n    // @ts-ignore\n    if (typeof ResizeObserver === \"function\") {\n      // @ts-ignore\n      this._resizeObserver = new ResizeObserver(() =>\n        this._debouncedResizeListener()\n      );\n      this._resizeObserver.observe(this._mapEl);\n    } else {\n      window.addEventListener(\"resize\", this._debouncedResizeListener);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host([ispanel]) ha-card {\n        left: 0;\n        top: 0;\n        width: 100%;\n        /**\n       * In panel mode we want a full height map. Since parent #view\n       * only sets min-height, we need absolute positioning here\n       */\n        height: 100%;\n        position: absolute;\n      }\n\n      ha-card {\n        overflow: hidden;\n      }\n\n      #map {\n        z-index: 0;\n        border: none;\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n      }\n\n      paper-icon-button {\n        position: absolute;\n        top: 75px;\n        left: 7px;\n      }\n\n      #root {\n        position: relative;\n      }\n\n      :host([ispanel]) #root {\n        height: 100%;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-map-card\": HuiMapCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-markdown\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { MarkdownCardConfig } from \"./types\";\n\n@customElement(\"hui-markdown-card\")\nexport class HuiMarkdownCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-markdown-card-editor\" */ \"../editor/config-elements/hui-markdown-card-editor\");\n    return document.createElement(\"hui-markdown-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { content: \" \" };\n  }\n\n  @property() private _config?: MarkdownCardConfig;\n\n  public getCardSize(): number {\n    return this._config!.content.split(\"\\n\").length;\n  }\n\n  public setConfig(config: MarkdownCardConfig): void {\n    if (!config.content) {\n      throw new Error(\"Invalid Configuration: Content Required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <ha-markdown\n          class=\"markdown ${classMap({\n            \"no-header\": !this._config.title,\n          })}\"\n          .content=\"${this._config.content}\"\n        ></ha-markdown>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        /* start paper-font-body1 style */\n        font-family: \"Roboto\", \"Noto\", sans-serif;\n        -webkit-font-smoothing: antialiased; /* OS X subpixel AA bleed bug */\n        font-size: 14px;\n        font-weight: 400;\n        line-height: 20px;\n        /* end paper-font-body1 style */\n      }\n      ha-markdown {\n        display: block;\n        padding: 0 16px 16px;\n        -ms-user-select: initial;\n        -webkit-user-select: initial;\n        -moz-user-select: initial;\n      }\n      .markdown.no-header {\n        padding-top: 16px;\n      }\n      ha-markdown > *:first-child {\n        margin-top: 0;\n      }\n      ha-markdown > *:last-child {\n        margin-bottom: 0;\n      }\n      ha-markdown a {\n        color: var(--primary-color);\n      }\n      ha-markdown img {\n        max-width: 100%;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-markdown-card\": HuiMarkdownCard;\n  }\n}\n","import \"@polymer/iron-flex-layout/iron-flex-layout-classes\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@polymer/paper-progress/paper-progress\";\nimport \"@polymer/paper-styles/element-styles/paper-material-styles\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport HassMediaPlayerEntity from \"../util/hass-media-player-model\";\nimport { fetchMediaPlayerThumbnailWithCache } from \"../data/media-player\";\n\nimport computeStateName from \"../common/entity/compute_state_name\";\nimport { EventsMixin } from \"../mixins/events-mixin\";\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\n/*\n * @appliesMixin LocalizeMixin\n * @appliesMixin EventsMixin\n */\nclass HaMediaPlayerCard extends LocalizeMixin(EventsMixin(PolymerElement)) {\n  static get template() {\n    return html`\n      <style\n        include=\"paper-material-styles iron-flex iron-flex-alignment iron-positioning\"\n      >\n        :host {\n          @apply --paper-material-elevation-1;\n          display: block;\n          position: relative;\n          font-size: 0px;\n          border-radius: 2px;\n        }\n\n        .banner {\n          position: relative;\n          background-color: white;\n          border-top-left-radius: 2px;\n          border-top-right-radius: 2px;\n        }\n\n        .banner:before {\n          display: block;\n          content: \"\";\n          width: 100%;\n          /* removed .25% from 16:9 ratio to fix YT black bars */\n          padding-top: 56%;\n          transition: padding-top 0.8s;\n        }\n\n        .banner.no-cover {\n          background-position: center center;\n          background-image: url(/static/images/card_media_player_bg.png);\n          background-repeat: no-repeat;\n          background-color: var(--primary-color);\n        }\n\n        .banner.content-type-music:before {\n          padding-top: 100%;\n        }\n\n        .banner.content-type-game:before {\n          padding-top: 100%;\n        }\n\n        .banner.no-cover:before {\n          padding-top: 88px;\n        }\n\n        .banner > .cover {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n\n          border-top-left-radius: 2px;\n          border-top-right-radius: 2px;\n\n          background-position: center center;\n          background-size: cover;\n          transition: opacity 0.8s;\n          opacity: 1;\n        }\n\n        .banner.is-off > .cover {\n          opacity: 0;\n        }\n\n        .banner > .caption {\n          @apply --paper-font-caption;\n\n          position: absolute;\n          left: 0;\n          right: 0;\n          bottom: 0;\n\n          background-color: rgba(0, 0, 0, var(--dark-secondary-opacity));\n\n          padding: 8px 16px;\n\n          font-size: 14px;\n          font-weight: 500;\n          color: white;\n\n          transition: background-color 0.5s;\n        }\n\n        .banner.is-off > .caption {\n          background-color: initial;\n        }\n\n        .banner > .caption .title {\n          @apply --paper-font-common-nowrap;\n          font-size: 1.2em;\n          margin: 8px 0 4px;\n        }\n\n        .progress {\n          width: 100%;\n          height: var(--paper-progress-height, 4px);\n          margin-top: calc(-1 * var(--paper-progress-height, 4px));\n          --paper-progress-active-color: var(--accent-color);\n          --paper-progress-container-color: rgba(200, 200, 200, 0.5);\n        }\n\n        .controls {\n          position: relative;\n          @apply --paper-font-body1;\n          padding: 8px;\n          border-bottom-left-radius: 2px;\n          border-bottom-right-radius: 2px;\n          background-color: var(--paper-card-background-color, white);\n        }\n\n        .controls paper-icon-button {\n          width: 44px;\n          height: 44px;\n        }\n\n        .playback-controls {\n          direction: ltr;\n        }\n\n        paper-icon-button {\n          opacity: var(--dark-primary-opacity);\n        }\n\n        paper-icon-button[disabled] {\n          opacity: var(--dark-disabled-opacity);\n        }\n\n        paper-icon-button.primary {\n          width: 56px !important;\n          height: 56px !important;\n          background-color: var(--primary-color);\n          color: white;\n          border-radius: 50%;\n          padding: 8px;\n          transition: background-color 0.5s;\n        }\n\n        paper-icon-button.primary[disabled] {\n          background-color: rgba(0, 0, 0, var(--dark-disabled-opacity));\n        }\n\n        [invisible] {\n          visibility: hidden !important;\n        }\n      </style>\n\n      <div\n        class$=\"[[computeBannerClasses(playerObj, _coverShowing, _coverLoadError)]]\"\n      >\n        <div class=\"cover\" id=\"cover\"></div>\n\n        <div class=\"caption\">\n          [[_computeStateName(stateObj)]]\n          <div class=\"title\">[[computePrimaryText(localize, playerObj)]]</div>\n          [[playerObj.secondaryTitle]]<br />\n        </div>\n      </div>\n\n      <paper-progress\n        max=\"[[stateObj.attributes.media_duration]]\"\n        value=\"[[playbackPosition]]\"\n        hidden$=\"[[computeHideProgress(playerObj)]]\"\n        class=\"progress\"\n      ></paper-progress>\n\n      <div class=\"controls layout horizontal justified\">\n        <paper-icon-button\n          aria-label=\"Turn off\"\n          icon=\"hass:power\"\n          on-click=\"handleTogglePower\"\n          invisible$=\"[[computeHidePowerButton(playerObj)]]\"\n          class=\"self-center secondary\"\n        ></paper-icon-button>\n\n        <div class=\"playback-controls\">\n          <paper-icon-button\n            aria-label=\"Previous track\"\n            icon=\"hass:skip-previous\"\n            invisible$=\"[[!playerObj.supportsPreviousTrack]]\"\n            disabled=\"[[playerObj.isOff]]\"\n            on-click=\"handlePrevious\"\n          ></paper-icon-button>\n          <paper-icon-button\n            aria-label=\"Play or Pause\"\n            class=\"primary\"\n            icon=\"[[computePlaybackControlIcon(playerObj)]]\"\n            invisible$=\"[[!computePlaybackControlIcon(playerObj)]]\"\n            disabled=\"[[playerObj.isOff]]\"\n            on-click=\"handlePlaybackControl\"\n          ></paper-icon-button>\n          <paper-icon-button\n            aria-label=\"Next track\"\n            icon=\"hass:skip-next\"\n            invisible$=\"[[!playerObj.supportsNextTrack]]\"\n            disabled=\"[[playerObj.isOff]]\"\n            on-click=\"handleNext\"\n          ></paper-icon-button>\n        </div>\n\n        <paper-icon-button\n          aria-label=\"More information.\"\n          icon=\"hass:dots-vertical\"\n          on-click=\"handleOpenMoreInfo\"\n          class=\"self-center secondary\"\n        ></paper-icon-button>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      stateObj: Object,\n      playerObj: {\n        type: Object,\n        computed: \"computePlayerObj(hass, stateObj)\",\n        observer: \"playerObjChanged\",\n      },\n      playbackControlIcon: {\n        type: String,\n        computed: \"computePlaybackControlIcon(playerObj)\",\n      },\n      playbackPosition: Number,\n      _coverShowing: {\n        type: Boolean,\n        value: false,\n      },\n      _coverLoadError: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  async playerObjChanged(playerObj, oldPlayerObj) {\n    if (playerObj.isPlaying && playerObj.showProgress) {\n      if (!this._positionTracking) {\n        this._positionTracking = setInterval(\n          () => this.updatePlaybackPosition(),\n          1000\n        );\n      }\n    } else if (this._positionTracking) {\n      clearInterval(this._positionTracking);\n      this._positionTracking = null;\n    }\n    if (playerObj.showProgress) {\n      this.updatePlaybackPosition();\n    }\n\n    const picture = playerObj.stateObj.attributes.entity_picture;\n    const oldPicture =\n      oldPlayerObj && oldPlayerObj.stateObj.attributes.entity_picture;\n\n    if (picture !== oldPicture && !picture) {\n      this.$.cover.style.backgroundImage = \"\";\n      return;\n    }\n    if (picture === oldPicture) {\n      return;\n    }\n\n    // We have a new picture url\n    // If entity picture is non-relative, we use that url directly.\n    if (picture.substr(0, 1) !== \"/\") {\n      this._coverShowing = true;\n      this._coverLoadError = false;\n      this.$.cover.style.backgroundImage = `url(${picture})`;\n      return;\n    }\n\n    try {\n      const {\n        content_type: contentType,\n        content,\n      } = await fetchMediaPlayerThumbnailWithCache(\n        this.hass,\n        playerObj.stateObj.entity_id\n      );\n      this._coverShowing = true;\n      this._coverLoadError = false;\n      this.$.cover.style.backgroundImage = `url(data:${contentType};base64,${content})`;\n    } catch (err) {\n      this._coverShowing = false;\n      this._coverLoadError = true;\n      this.$.cover.style.backgroundImage = \"\";\n    }\n  }\n\n  updatePlaybackPosition() {\n    this.playbackPosition = this.playerObj.currentProgress;\n  }\n\n  computeBannerClasses(playerObj, coverShowing, coverLoadError) {\n    var cls = \"banner\";\n\n    if (playerObj.isOff || playerObj.isIdle) {\n      cls += \" is-off no-cover\";\n    } else if (\n      !playerObj.stateObj.attributes.entity_picture ||\n      coverLoadError ||\n      !coverShowing\n    ) {\n      cls += \" no-cover\";\n    } else if (playerObj.stateObj.attributes.media_content_type === \"music\") {\n      cls += \" content-type-music\";\n    } else if (playerObj.stateObj.attributes.media_content_type === \"game\") {\n      cls += \" content-type-game\";\n    }\n    return cls;\n  }\n\n  computeHideProgress(playerObj) {\n    return !playerObj.showProgress;\n  }\n\n  computeHidePowerButton(playerObj) {\n    return playerObj.isOff\n      ? !playerObj.supportsTurnOn\n      : !playerObj.supportsTurnOff;\n  }\n\n  computePlayerObj(hass, stateObj) {\n    return new HassMediaPlayerEntity(hass, stateObj);\n  }\n\n  computePrimaryText(localize, playerObj) {\n    return (\n      playerObj.primaryTitle ||\n      localize(`state.media_player.${playerObj.stateObj.state}`) ||\n      localize(`state.default.${playerObj.stateObj.state}`) ||\n      playerObj.stateObj.state\n    );\n  }\n\n  computePlaybackControlIcon(playerObj) {\n    if (playerObj.isPlaying) {\n      return playerObj.supportsPause ? \"hass:pause\" : \"hass:stop\";\n    }\n    if (playerObj.hasMediaControl || playerObj.isOff || playerObj.isIdle) {\n      if (\n        playerObj.hasMediaControl &&\n        playerObj.supportsPause &&\n        !playerObj.isPaused\n      ) {\n        return \"hass:play-pause\";\n      }\n      return playerObj.supportsPlay ? \"hass:play\" : null;\n    }\n    return \"\";\n  }\n\n  _computeStateName(stateObj) {\n    return computeStateName(stateObj);\n  }\n\n  handleNext(ev) {\n    ev.stopPropagation();\n    this.playerObj.nextTrack();\n  }\n\n  handleOpenMoreInfo(ev) {\n    ev.stopPropagation();\n    this.fire(\"hass-more-info\", { entityId: this.stateObj.entity_id });\n  }\n\n  handlePlaybackControl(ev) {\n    ev.stopPropagation();\n    this.playerObj.mediaPlayPause();\n  }\n\n  handlePrevious(ev) {\n    ev.stopPropagation();\n    this.playerObj.previousTrack();\n  }\n\n  handleTogglePower(ev) {\n    ev.stopPropagation();\n    this.playerObj.togglePower();\n  }\n}\ncustomElements.define(\"ha-media_player-card\", HaMediaPlayerCard);\n","import { createErrorCardConfig } from \"./hui-error-card\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nexport default class LegacyWrapperCard extends HTMLElement {\n  constructor(tag, domain) {\n    super();\n    this._tag = tag.toUpperCase();\n    this._domain = domain;\n    this._element = null;\n  }\n\n  getCardSize() {\n    return 3;\n  }\n\n  setConfig(config) {\n    if (!config.entity) {\n      throw new Error(\"No entity specified\");\n    }\n\n    if (computeDomain(config.entity) !== this._domain) {\n      throw new Error(\n        `Specified entity needs to be of domain ${this._domain}.`\n      );\n    }\n\n    this._config = config;\n  }\n\n  set hass(hass) {\n    const entityId = this._config.entity;\n\n    if (entityId in hass.states) {\n      this._ensureElement(this._tag);\n      this.lastChild.hass = hass;\n      this.lastChild.stateObj = hass.states[entityId];\n      this.lastChild.config = this._config;\n    } else {\n      this._ensureElement(\"HUI-ERROR-CARD\");\n      this.lastChild.setConfig(\n        createErrorCardConfig(\n          `No state available for ${entityId}`,\n          this._config\n        )\n      );\n    }\n  }\n\n  _ensureElement(tag) {\n    if (this.lastChild && this.lastChild.tagName === tag) return;\n\n    if (this.lastChild) {\n      this.removeChild(this.lastChild);\n    }\n\n    this.appendChild(document.createElement(tag));\n  }\n}\n","import \"../../../cards/ha-media_player-card\";\n\nimport LegacyWrapperCard from \"./hui-legacy-wrapper-card\";\n\nclass HuiMediaControlCard extends LegacyWrapperCard {\n  static async getConfigElement() {\n    await import(/* webpackChunkName: \"hui-media-control-card-editor\" */ \"../editor/config-elements/hui-media-control-card-editor\");\n    return document.createElement(\"hui-media-control-card-editor\");\n  }\n\n  static getStubConfig() {\n    return {};\n  }\n\n  constructor() {\n    super(\"ha-media_player-card\", \"media_player\");\n  }\n}\n\ncustomElements.define(\"hui-media-control-card\", HuiMediaControlCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../components/ha-card\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { PictureCardConfig } from \"./types\";\n\n@customElement(\"hui-picture-card\")\nexport class HuiPictureCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-picture-card-editor\" */ \"../editor/config-elements/hui-picture-card-editor\");\n    return document.createElement(\"hui-picture-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return {\n      image:\n        \"https://www.home-assistant.io/images/merchandise/shirt-frontpage.png\",\n      tap_action: { action: \"none\" },\n      hold_action: { action: \"none\" },\n    };\n  }\n\n  public hass?: HomeAssistant;\n\n  @property() protected _config?: PictureCardConfig;\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PictureCardConfig): void {\n    if (!config || !config.image) {\n      throw new Error(\"Invalid Configuration: 'image' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-card\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n        class=\"${classMap({\n          clickable: Boolean(\n            this._config.tap_action || this._config.hold_action\n          ),\n        })}\"\n      >\n        <img src=\"${this._config.image}\" />\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        overflow: hidden;\n      }\n\n      ha-card.clickable {\n        cursor: pointer;\n      }\n\n      img {\n        display: block;\n        width: 100%;\n      }\n    `;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-card\": HuiPictureCard;\n  }\n}\n","import {\n  checkConditionsMet,\n  validateConditionalConfig,\n} from \"../../lovelace/common/validate-condition\";\nimport { createStyledHuiElement } from \"../cards/picture-elements/create-styled-hui-element\";\nimport {\n  LovelaceElement,\n  LovelaceElementConfig,\n  ConditionalElementConfig,\n} from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\nclass HuiConditionalElement extends HTMLElement implements LovelaceElement {\n  public _hass?: HomeAssistant;\n  private _config?: ConditionalElementConfig;\n  private _elements: LovelaceElement[] = [];\n\n  public setConfig(config: ConditionalElementConfig): void {\n    if (\n      !config.conditions ||\n      !Array.isArray(config.conditions) ||\n      !config.elements ||\n      !Array.isArray(config.elements) ||\n      !validateConditionalConfig(config.conditions)\n    ) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    if (this._elements.length > 0) {\n      this._elements.map((el: LovelaceElement) => {\n        if (el.parentElement) {\n          el.parentElement.removeChild(el);\n        }\n      });\n\n      this._elements = [];\n    }\n\n    this._config = config;\n\n    this._config.elements.map((elementConfig: LovelaceElementConfig) => {\n      this._elements.push(createStyledHuiElement(elementConfig));\n    });\n\n    this.updateElements();\n  }\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n\n    this.updateElements();\n  }\n\n  private updateElements() {\n    if (!this._hass || !this._config) {\n      return;\n    }\n\n    const visible = checkConditionsMet(this._config.conditions, this._hass);\n\n    this._elements.map((el: LovelaceElement) => {\n      if (visible) {\n        el.hass = this._hass;\n        if (!el.parentElement) {\n          this.appendChild(el);\n        }\n      } else if (el.parentElement) {\n        el.parentElement.removeChild(el);\n      }\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-conditional-element\": HuiConditionalElement;\n  }\n}\n\ncustomElements.define(\"hui-conditional-element\", HuiConditionalElement);\n","import computeStateName from \"../../../common/entity/compute_state_name\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceElementConfig } from \"../elements/types\";\nimport { ActionConfig } from \"../../../data/lovelace\";\n\ninterface Config extends LovelaceElementConfig {\n  entity?: string;\n  title?: string;\n  tap_action?: ActionConfig;\n  hold_action?: ActionConfig;\n}\n\nexport const computeTooltip = (hass: HomeAssistant, config: Config): string => {\n  if (config.title === null) {\n    return \"\";\n  }\n\n  if (config.title) {\n    return config.title;\n  }\n\n  let stateName = \"\";\n  let tooltip = \"\";\n\n  if (config.entity) {\n    stateName =\n      config.entity in hass.states\n        ? computeStateName(hass.states[config.entity])\n        : config.entity;\n  }\n\n  const tapTooltip = config.tap_action\n    ? computeActionTooltip(hass, stateName, config.tap_action, false)\n    : \"\";\n  const holdTooltip = config.hold_action\n    ? computeActionTooltip(hass, stateName, config.hold_action, true)\n    : \"\";\n\n  const newline = tapTooltip && holdTooltip ? \"\\n\" : \"\";\n\n  tooltip = tapTooltip + newline + holdTooltip;\n\n  return tooltip;\n};\n\nfunction computeActionTooltip(\n  hass: HomeAssistant,\n  state: string,\n  config: ActionConfig,\n  isHold: boolean\n) {\n  if (!config || !config.action || config.action === \"none\") {\n    return \"\";\n  }\n\n  let tooltip =\n    (isHold\n      ? hass.localize(\"ui.panel.lovelace.cards.picture-elements.hold\")\n      : hass.localize(\"ui.panel.lovelace.cards.picture-elements.tap\")) + \" \";\n\n  switch (config.action) {\n    case \"navigate\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.navigate_to\",\n        \"location\",\n        config.navigation_path\n      )}`;\n      break;\n    case \"toggle\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.toggle\",\n        \"name\",\n        state\n      )}`;\n      break;\n    case \"call-service\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.call_service\",\n        \"name\",\n        config.service\n      )}`;\n      break;\n    case \"more-info\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.more_info\",\n        \"name\",\n        state\n      )}`;\n      break;\n  }\n\n  return tooltip;\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n} from \"lit-element\";\n\nimport \"../../../components/ha-icon\";\n\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, IconElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-icon-element\")\nexport class HuiIconElement extends LitElement implements LovelaceElement {\n  public hass?: HomeAssistant;\n  @property() private _config?: IconElementConfig;\n\n  public setConfig(config: IconElementConfig): void {\n    if (!config.icon) {\n      throw Error(\"Invalid Configuration: 'icon' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-icon\n        .icon=\"${this._config.icon}\"\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      ></ha-icon>\n    `;\n  }\n\n  private _handleTap(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-icon-element\": HuiIconElement;\n  }\n}\n","import \"@polymer/paper-toggle-button/paper-toggle-button\";\n\nimport { STATES_OFF } from \"../../../common/const\";\n\nimport parseAspectRatio from \"../../../common/util/parse-aspect-ratio\";\nimport {\n  LitElement,\n  TemplateResult,\n  html,\n  property,\n  CSSResult,\n  css,\n  PropertyValues,\n  query,\n  customElement,\n} from \"lit-element\";\nimport { HomeAssistant, CameraEntity } from \"../../../types\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { fetchThumbnailUrlWithCache } from \"../../../data/camera\";\n\nconst UPDATE_INTERVAL = 10000;\nconst DEFAULT_FILTER = \"grayscale(100%)\";\n\nexport interface StateSpecificConfig {\n  [state: string]: string;\n}\n\n@customElement(\"hui-image\")\nexport class HuiImage extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public entity?: string;\n\n  @property() public image?: string;\n\n  @property() public stateImage?: StateSpecificConfig;\n\n  @property() public cameraImage?: string;\n\n  @property() public cameraView?: \"live\" | \"auto\";\n\n  @property() public aspectRatio?: string;\n\n  @property() public filter?: string;\n\n  @property() public stateFilter?: StateSpecificConfig;\n\n  @property() private _loadError?: boolean;\n\n  @property() private _cameraImageSrc?: string;\n\n  @query(\"img\") private _image!: HTMLImageElement;\n\n  private _lastImageHeight?: number;\n\n  private _cameraUpdater?: number;\n\n  private _attached?: boolean;\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._attached = true;\n    if (this.cameraImage && this.cameraView !== \"live\") {\n      this._startUpdateCameraInterval();\n    }\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._attached = false;\n    this._stopUpdateCameraInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    const ratio = this.aspectRatio ? parseAspectRatio(this.aspectRatio) : null;\n    const stateObj =\n      this.hass && this.entity ? this.hass.states[this.entity] : undefined;\n    const state = stateObj ? stateObj.state : \"unavailable\";\n\n    // Figure out image source to use\n    let imageSrc: string | undefined;\n    let cameraObj: CameraEntity | undefined;\n    // Track if we are we using a fallback image, used for filter.\n    let imageFallback = !this.stateImage;\n\n    if (this.cameraImage) {\n      if (this.cameraView === \"live\") {\n        cameraObj =\n          this.hass && (this.hass.states[this.cameraImage] as CameraEntity);\n      } else {\n        imageSrc = this._cameraImageSrc;\n      }\n    } else if (this.stateImage) {\n      const stateImage = this.stateImage[state];\n\n      if (stateImage) {\n        imageSrc = stateImage;\n      } else {\n        imageSrc = this.image;\n        imageFallback = true;\n      }\n    } else {\n      imageSrc = this.image;\n    }\n\n    // Figure out filter to use\n    let filter = this.filter || \"\";\n\n    if (this.stateFilter && this.stateFilter[state]) {\n      filter = this.stateFilter[state];\n    }\n\n    if (!filter && this.entity) {\n      const isOff = !stateObj || STATES_OFF.includes(state);\n      filter = isOff && imageFallback ? DEFAULT_FILTER : \"\";\n    }\n\n    return html`\n      <div\n        style=${styleMap({\n          paddingBottom:\n            ratio && ratio.w > 0 && ratio.h > 0\n              ? `${((100 * ratio.h) / ratio.w).toFixed(2)}%`\n              : \"\",\n        })}\n        class=${classMap({\n          ratio: Boolean(ratio && ratio.w > 0 && ratio.h > 0),\n        })}\n      >\n        ${this.cameraImage && this.cameraView === \"live\"\n          ? html`\n              <ha-camera-stream\n                .hass=\"${this.hass}\"\n                .stateObj=\"${cameraObj}\"\n              ></ha-camera-stream>\n            `\n          : html`\n              <img\n                id=\"image\"\n                src=${imageSrc}\n                @error=${this._onImageError}\n                @load=${this._onImageLoad}\n                style=${styleMap({\n                  filter,\n                  display: this._loadError ? \"none\" : \"block\",\n                })}\n              />\n            `}\n        <div\n          id=\"brokenImage\"\n          style=${styleMap({\n            height: `${this._lastImageHeight || \"100\"}px`,\n            display: this._loadError ? \"block\" : \"none\",\n          })}\n        ></div>\n      </div>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    if (changedProps.has(\"cameraImage\") && this.cameraView !== \"live\") {\n      this._updateCameraImageSrc();\n      this._startUpdateCameraInterval();\n      return;\n    }\n  }\n\n  private _startUpdateCameraInterval(): void {\n    this._stopUpdateCameraInterval();\n    if (this.cameraImage && this._attached) {\n      this._cameraUpdater = window.setInterval(\n        () => this._updateCameraImageSrc(),\n        UPDATE_INTERVAL\n      );\n    }\n  }\n\n  private _stopUpdateCameraInterval(): void {\n    if (this._cameraUpdater) {\n      clearInterval(this._cameraUpdater);\n    }\n  }\n\n  private _onImageError(): void {\n    this._loadError = true;\n  }\n\n  private async _onImageLoad(): Promise<void> {\n    this._loadError = false;\n    await this.updateComplete;\n    this._lastImageHeight = this._image.offsetHeight;\n  }\n\n  private async _updateCameraImageSrc(): Promise<void> {\n    if (!this.hass || !this.cameraImage) {\n      return;\n    }\n\n    const cameraState = this.hass.states[this.cameraImage] as\n      | CameraEntity\n      | undefined;\n\n    if (!cameraState) {\n      this._onImageError();\n      return;\n    }\n\n    this._cameraImageSrc = await fetchThumbnailUrlWithCache(\n      this.hass,\n      this.cameraImage\n    );\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      img {\n        display: block;\n        height: auto;\n        transition: filter 0.2s linear;\n        width: 100%;\n      }\n\n      .ratio {\n        position: relative;\n        width: 100%;\n        height: 0;\n      }\n\n      .ratio img,\n      .ratio div {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n      }\n\n      #brokenImage {\n        background: grey url(\"/static/images/image-broken.svg\") center/36px\n          no-repeat;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-image\": HuiImage;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../components/hui-image\";\n\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, ImageElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-image-element\")\nexport class HuiImageElement extends LitElement implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: ImageElementConfig;\n\n  public setConfig(config: ImageElementConfig): void {\n    if (!config) {\n      throw Error(\"Error in element configuration\");\n    }\n\n    this.classList.toggle(\n      \"clickable\",\n      config.tap_action && config.tap_action.action !== \"none\"\n    );\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <hui-image\n        .hass=\"${this.hass}\"\n        .entity=\"${this._config.entity}\"\n        .image=\"${this._config.image}\"\n        .stateImage=\"${this._config.state_image}\"\n        .cameraImage=\"${this._config.camera_image}\"\n        .filter=\"${this._config.filter}\"\n        .stateFilter=\"${this._config.state_filter}\"\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        .aspectRatio=\"${this._config.aspect_ratio}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      ></hui-image>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host(.clickable) {\n        cursor: pointer;\n        overflow: hidden;\n        -webkit-touch-callout: none !important;\n      }\n      hui-image {\n        -webkit-user-select: none !important;\n      }\n    `;\n  }\n\n  private _handleTap(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-image-element\": HuiImageElement;\n  }\n}\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-spinner/paper-spinner\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nclass HaProgressButton extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        .container {\n          position: relative;\n          display: inline-block;\n        }\n\n        mwc-button {\n          transition: all 1s;\n        }\n\n        .success mwc-button {\n          --mdc-theme-primary: white;\n          background-color: var(--google-green-500);\n          transition: none;\n        }\n\n        .error mwc-button {\n          --mdc-theme-primary: white;\n          background-color: var(--google-red-500);\n          transition: none;\n        }\n\n        .progress {\n          @apply --layout;\n          @apply --layout-center-center;\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n        }\n      </style>\n      <div class=\"container\" id=\"container\">\n        <mwc-button\n          id=\"button\"\n          disabled=\"[[computeDisabled(disabled, progress)]]\"\n          on-click=\"buttonTapped\"\n        >\n          <slot></slot>\n        </mwc-button>\n        <template is=\"dom-if\" if=\"[[progress]]\">\n          <div class=\"progress\"><paper-spinner active=\"\"></paper-spinner></div>\n        </template>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      progress: {\n        type: Boolean,\n        value: false,\n      },\n\n      disabled: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  tempClass(className) {\n    var classList = this.$.container.classList;\n    classList.add(className);\n    setTimeout(() => {\n      classList.remove(className);\n    }, 1000);\n  }\n\n  ready() {\n    super.ready();\n    this.addEventListener(\"click\", (ev) => this.buttonTapped(ev));\n  }\n\n  buttonTapped(ev) {\n    if (this.progress) ev.stopPropagation();\n  }\n\n  actionSuccess() {\n    this.tempClass(\"success\");\n  }\n\n  actionError() {\n    this.tempClass(\"error\");\n  }\n\n  computeDisabled(disabled, progress) {\n    return disabled || progress;\n  }\n}\n\ncustomElements.define(\"ha-progress-button\", HaProgressButton);\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"./ha-progress-button\";\nimport { EventsMixin } from \"../../mixins/events-mixin\";\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaCallServiceButton extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <ha-progress-button\n        id=\"progress\"\n        progress=\"[[progress]]\"\n        on-click=\"buttonTapped\"\n        ><slot></slot\n      ></ha-progress-button>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      progress: {\n        type: Boolean,\n        value: false,\n      },\n\n      domain: {\n        type: String,\n      },\n\n      service: {\n        type: String,\n      },\n\n      serviceData: {\n        type: Object,\n        value: {},\n      },\n    };\n  }\n\n  buttonTapped() {\n    this.progress = true;\n    var el = this;\n    var eventData = {\n      domain: this.domain,\n      service: this.service,\n      serviceData: this.serviceData,\n    };\n\n    this.hass\n      .callService(this.domain, this.service, this.serviceData)\n      .then(\n        function() {\n          el.progress = false;\n          el.$.progress.actionSuccess();\n          eventData.success = true;\n        },\n        function() {\n          el.progress = false;\n          el.$.progress.actionError();\n          eventData.success = false;\n        }\n      )\n      .then(function() {\n        el.fire(\"hass-service-called\", eventData);\n      });\n  }\n}\n\ncustomElements.define(\"ha-call-service-button\", HaCallServiceButton);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  CSSResult,\n  css,\n} from \"lit-element\";\n\nimport \"../../../components/buttons/ha-call-service-button\";\n\nimport { LovelaceElement, ServiceButtonElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-service-button-element\")\nexport class HuiServiceButtonElement extends LitElement\n  implements LovelaceElement {\n  public hass?: HomeAssistant;\n  @property() private _config?: ServiceButtonElementConfig;\n  private _domain?: string;\n  private _service?: string;\n\n  static get properties() {\n    return { _config: {} };\n  }\n\n  public setConfig(config: ServiceButtonElementConfig): void {\n    if (!config || !config.service) {\n      throw Error(\"Invalid Configuration: 'service' required\");\n    }\n\n    [this._domain, this._service] = config.service.split(\".\", 2);\n\n    if (!this._domain) {\n      throw Error(\"Invalid Configuration: 'service' does not have a domain\");\n    }\n\n    if (!this._service) {\n      throw Error(\n        \"Invalid Configuration: 'service' does not have a service name\"\n      );\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-call-service-button\n        .hass=\"${this.hass}\"\n        .domain=\"${this._domain}\"\n        .service=\"${this._service}\"\n        .serviceData=\"${this._config.service_data}\"\n        >${this._config.title}</ha-call-service-button\n      >\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-call-service-button {\n        color: var(--primary-color);\n        white-space: nowrap;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-service-button-element\": HuiServiceButtonElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/entity/ha-state-label-badge\";\nimport \"../components/hui-warning-element\";\n\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport { LovelaceElement, StateBadgeElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-state-badge-element\")\nexport class HuiStateBadgeElement extends LitElement\n  implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: StateBadgeElementConfig;\n\n  public setConfig(config: StateBadgeElementConfig): void {\n    if (!config.entity) {\n      throw Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity!];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=\"${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}\"\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <ha-state-label-badge\n        .hass=\"${this.hass}\"\n        .state=\"${stateObj}\"\n        .title=\"${this._config.title === undefined\n          ? computeStateName(stateObj)\n          : this._config.title === null\n          ? \"\"\n          : this._config.title}\"\n      ></ha-state-label-badge>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-state-badge-element\": HuiStateBadgeElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/entity/state-badge\";\nimport \"../components/hui-warning-element\";\n\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, StateIconElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-state-icon-element\")\nexport class HuiStateIconElement extends LitElement implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: StateIconElementConfig;\n\n  public setConfig(config: StateIconElementConfig): void {\n    if (!config.entity) {\n      throw Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity!];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <state-badge\n        .stateObj=\"${stateObj}\"\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        @ha-click=\"${this._handleClick}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n        .overrideIcon=${this._config.icon}\n      ></state-badge>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n    `;\n  }\n\n  private _handleClick(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-state-icon-element\": HuiStateIconElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/entity/ha-state-label-badge\";\nimport \"../components/hui-warning-element\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, StateLabelElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-state-label-element\")\nclass HuiStateLabelElement extends LitElement implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: StateLabelElementConfig;\n\n  public setConfig(config: StateLabelElementConfig): void {\n    if (!config.entity) {\n      throw Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity!];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <div\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      >\n        ${this._config.prefix}${stateObj\n          ? computeStateDisplay(\n              this.hass.localize,\n              stateObj,\n              this.hass.language\n            )\n          : \"-\"}${this._config.suffix}\n      </div>\n    `;\n  }\n\n  private _handleTap(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n      div {\n        padding: 8px;\n        white-space: nowrap;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-state-label-element\": HuiStateLabelElement;\n  }\n}\n","import deepClone from \"deep-clone-simple\";\n\nimport \"../elements/hui-conditional-element\";\nimport \"../elements/hui-icon-element\";\nimport \"../elements/hui-image-element\";\nimport \"../elements/hui-service-button-element\";\nimport \"../elements/hui-state-badge-element\";\nimport \"../elements/hui-state-icon-element\";\nimport \"../elements/hui-state-label-element\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport {\n  createErrorCardElement,\n  createErrorCardConfig,\n  HuiErrorCard,\n} from \"../cards/hui-error-card\";\nimport { LovelaceElementConfig, LovelaceElement } from \"../elements/types\";\n\nconst CUSTOM_TYPE_PREFIX = \"custom:\";\nconst ELEMENT_TYPES = new Set([\n  \"conditional\",\n  \"icon\",\n  \"image\",\n  \"service-button\",\n  \"state-badge\",\n  \"state-icon\",\n  \"state-label\",\n]);\nconst TIMEOUT = 2000;\n\nconst _createElement = (\n  tag: string,\n  config: LovelaceElementConfig\n): LovelaceElement | HuiErrorCard => {\n  const element = document.createElement(tag) as LovelaceElement;\n  try {\n    element.setConfig(deepClone(config));\n  } catch (err) {\n    // tslint:disable-next-line\n    console.error(tag, err);\n    return _createErrorElement(err.message, config);\n  }\n  return element;\n};\n\nconst _createErrorElement = (\n  error: string,\n  config: LovelaceElementConfig\n): HuiErrorCard => createErrorCardElement(createErrorCardConfig(error, config));\n\nfunction _hideErrorElement(element) {\n  element.style.display = \"None\";\n  return window.setTimeout(() => {\n    element.style.display = \"\";\n  }, TIMEOUT);\n}\n\nexport const createHuiElement = (\n  config: LovelaceElementConfig\n): LovelaceElement | HuiErrorCard => {\n  if (!config || typeof config !== \"object\" || !config.type) {\n    return _createErrorElement(\"No element type configured.\", config);\n  }\n\n  if (config.type.startsWith(CUSTOM_TYPE_PREFIX)) {\n    const tag = config.type.substr(CUSTOM_TYPE_PREFIX.length);\n\n    if (customElements.get(tag)) {\n      return _createElement(tag, config);\n    }\n    const element = _createErrorElement(\n      `Custom element doesn't exist: ${tag}.`,\n      config\n    );\n    const timer = _hideErrorElement(element);\n\n    customElements.whenDefined(tag).then(() => {\n      clearTimeout(timer);\n      fireEvent(element, \"ll-rebuild\");\n    });\n\n    return element;\n  }\n\n  if (!ELEMENT_TYPES.has(config.type)) {\n    return _createErrorElement(\n      `Unknown element type encountered: ${config.type}.`,\n      config\n    );\n  }\n\n  return _createElement(`hui-${config.type}-element`, config);\n};\n","import { LovelaceElement, LovelaceElementConfig } from \"../../elements/types\";\nimport { createHuiElement } from \"../../common/create-hui-element\";\n\nexport function createStyledHuiElement(\n  elementConfig: LovelaceElementConfig\n): LovelaceElement {\n  const element = createHuiElement(elementConfig) as LovelaceElement;\n  // keep conditional card as a transparent container so let its position remain static\n  if (element.tagName !== \"HUI-CONDITIONAL-ELEMENT\") {\n    element.classList.add(\"element\");\n  }\n\n  if (elementConfig.style) {\n    Object.keys(elementConfig.style).forEach((prop) => {\n      element.style.setProperty(prop, elementConfig.style[prop]);\n    });\n  }\n\n  return element;\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { createStyledHuiElement } from \"./picture-elements/create-styled-hui-element\";\nimport { LovelaceCard } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceElementConfig, LovelaceElement } from \"../elements/types\";\nimport { PictureElementsCardConfig } from \"./types\";\n\n@customElement(\"hui-picture-elements-card\")\nclass HuiPictureElementsCard extends LitElement implements LovelaceCard {\n  @property() private _config?: PictureElementsCardConfig;\n\n  private _hass?: HomeAssistant;\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n    for (const el of this.shadowRoot!.querySelectorAll(\"#root > *\")) {\n      const element = el as LovelaceElement;\n      element.hass = this._hass;\n    }\n  }\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: PictureElementsCardConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid Configuration\");\n    } else if (\n      !(config.image || config.camera_image || config.state_image) ||\n      (config.state_image && !config.entity)\n    ) {\n      throw new Error(\"Invalid Configuration: image required\");\n    } else if (!Array.isArray(config.elements)) {\n      throw new Error(\"Invalid Configuration: elements required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <div id=\"root\">\n          <hui-image\n            .hass=\"${this._hass}\"\n            .image=\"${this._config.image}\"\n            .stateImage=\"${this._config.state_image}\"\n            .cameraImage=\"${this._config.camera_image}\"\n            .cameraView=\"${this._config.camera_view}\"\n            .entity=\"${this._config.entity}\"\n            .aspectRatio=\"${this._config.aspect_ratio}\"\n          ></hui-image>\n          ${this._config.elements.map(\n            (elementConfig: LovelaceElementConfig) => {\n              const element = createStyledHuiElement(elementConfig);\n              element.hass = this._hass;\n\n              return element;\n            }\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      #root {\n        position: relative;\n      }\n\n      .element {\n        position: absolute;\n        transform: translate(-50%, -50%);\n      }\n\n      ha-card {\n        overflow: hidden;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-elements-card\": HuiPictureElementsCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-image\";\nimport \"../components/hui-warning\";\n\nimport computeDomain from \"../../../common/entity/compute_domain\";\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard } from \"../types\";\nimport { handleClick } from \"../common/handle-click\";\nimport { UNAVAILABLE } from \"../../../data/entity\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { PictureEntityCardConfig } from \"./types\";\n\n@customElement(\"hui-picture-entity-card\")\nclass HuiPictureEntityCard extends LitElement implements LovelaceCard {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: PictureEntityCardConfig;\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PictureEntityCardConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    if (\n      computeDomain(config.entity) !== \"camera\" &&\n      (!config.image && !config.state_image && !config.camera_image)\n    ) {\n      throw new Error(\"No image source configured.\");\n    }\n\n    this._config = { show_name: true, show_state: true, ...config };\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    const name = this._config.name || computeStateName(stateObj);\n    const state = computeStateDisplay(\n      this.hass!.localize,\n      stateObj,\n      this.hass.language\n    );\n\n    let footer: TemplateResult | string = \"\";\n    if (this._config.show_name && this._config.show_state) {\n      footer = html`\n        <div class=\"footer both\">\n          <div>${name}</div>\n          <div>${state}</div>\n        </div>\n      `;\n    } else if (this._config.show_name) {\n      footer = html`\n        <div class=\"footer\">${name}</div>\n      `;\n    } else if (this._config.show_state) {\n      footer = html`\n        <div class=\"footer state\">${state}</div>\n      `;\n    }\n\n    return html`\n      <ha-card>\n        <hui-image\n          .hass=\"${this.hass}\"\n          .image=\"${this._config.image}\"\n          .stateImage=\"${this._config.state_image}\"\n          .cameraImage=\"${computeDomain(this._config.entity) === \"camera\"\n            ? this._config.entity\n            : this._config.camera_image}\"\n          .cameraView=\"${this._config.camera_view}\"\n          .entity=\"${this._config.entity}\"\n          .aspectRatio=\"${this._config.aspect_ratio}\"\n          @ha-click=\"${this._handleTap}\"\n          @ha-hold=\"${this._handleHold}\"\n          .longPress=\"${longPress()}\"\n          class=\"${classMap({\n            clickable: stateObj.state !== UNAVAILABLE,\n          })}\"\n        ></hui-image>\n        ${footer}\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        min-height: 75px;\n        overflow: hidden;\n        position: relative;\n      }\n\n      hui-image.clickable {\n        cursor: pointer;\n      }\n\n      .footer {\n        /* start paper-font-common-nowrap style */\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        /* end paper-font-common-nowrap style */\n\n        position: absolute;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: rgba(0, 0, 0, 0.3);\n        padding: 16px;\n        font-size: 16px;\n        line-height: 16px;\n        color: white;\n      }\n\n      .both {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .state {\n        text-align: right;\n      }\n    `;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-entity-card\": HuiPictureEntityCard;\n  }\n}\n","export const UNAVAILABLE = \"unavailable\";\n\nexport const ENTITY_COMPONENT_DOMAINS = [\n  \"air_quality\",\n  \"alarm_control_panel\",\n  \"automation\",\n  \"binary_sensor\",\n  \"calendar\",\n  \"counter\",\n  \"cover\",\n  \"dominos\",\n  \"fan\",\n  \"geo_location\",\n  \"group\",\n  \"history_graph\",\n  \"image_processing\",\n  \"input_boolean\",\n  \"input_datetime\",\n  \"input_number\",\n  \"input_select\",\n  \"input_text\",\n  \"light\",\n  \"lock\",\n  \"mailbox\",\n  \"media_player\",\n  \"person\",\n  \"plant\",\n  \"remember_the_milk\",\n  \"remote\",\n  \"scene\",\n  \"script\",\n  \"sensor\",\n  \"switch\",\n  \"timer\",\n  \"utility_meter\",\n  \"vacuum\",\n  \"weather\",\n  \"wink\",\n  \"zha\",\n  \"zwave\",\n];\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\nimport stateIcon from \"../../../common/entity/state_icon\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-image\";\nimport \"../components/hui-warning-element\";\n\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { LovelaceCard } from \"../types\";\nimport { EntityConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { handleClick } from \"../common/handle-click\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { toggleEntity } from \"../common/entity/toggle-entity\";\nimport { PictureGlanceCardConfig } from \"./types\";\n\nconst STATES_OFF = new Set([\"closed\", \"locked\", \"not_home\", \"off\"]);\n\n@customElement(\"hui-picture-glance-card\")\nclass HuiPictureGlanceCard extends LitElement implements LovelaceCard {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: PictureGlanceCardConfig;\n\n  private _entitiesDialog?: EntityConfig[];\n\n  private _entitiesToggle?: EntityConfig[];\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PictureGlanceCardConfig): void {\n    if (\n      !config ||\n      !config.entities ||\n      !Array.isArray(config.entities) ||\n      !(config.image || config.camera_image || config.state_image) ||\n      (config.state_image && !config.entity)\n    ) {\n      throw new Error(\"Invalid card configuration\");\n    }\n\n    const entities = processConfigEntities(config.entities);\n    this._entitiesDialog = [];\n    this._entitiesToggle = [];\n\n    entities.forEach((item) => {\n      if (\n        config.force_dialog ||\n        !DOMAINS_TOGGLE.has(computeDomain(item.entity))\n      ) {\n        this._entitiesDialog!.push(item);\n      } else {\n        this._entitiesToggle!.push(item);\n      }\n    });\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass) {\n      return true;\n    }\n\n    if (this._entitiesDialog) {\n      for (const entity of this._entitiesDialog) {\n        if (\n          oldHass.states[entity.entity] !== this.hass!.states[entity.entity]\n        ) {\n          return true;\n        }\n      }\n    }\n\n    if (this._entitiesToggle) {\n      for (const entity of this._entitiesToggle) {\n        if (\n          oldHass.states[entity.entity] !== this.hass!.states[entity.entity]\n        ) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-card>\n        <hui-image\n          class=\"${classMap({\n            clickable: Boolean(\n              this._config.tap_action ||\n                this._config.hold_action ||\n                this._config.camera_image\n            ),\n          })}\"\n          @ha-click=\"${this._handleTap}\"\n          @ha-hold=\"${this._handleHold}\"\n          .longPress=\"${longPress()}\"\n          .hass=\"${this.hass}\"\n          .image=\"${this._config.image}\"\n          .stateImage=\"${this._config.state_image}\"\n          .cameraImage=\"${this._config.camera_image}\"\n          .cameraView=\"${this._config.camera_view}\"\n          .entity=\"${this._config.entity}\"\n          .aspectRatio=\"${this._config.aspect_ratio}\"\n        ></hui-image>\n        <div class=\"box\">\n          ${this._config.title\n            ? html`\n                <div class=\"title\">${this._config.title}</div>\n              `\n            : \"\"}\n          <div>\n            ${this._entitiesDialog!.map((entityConf) =>\n              this.renderEntity(entityConf, true)\n            )}\n          </div>\n          <div>\n            ${this._entitiesToggle!.map((entityConf) =>\n              this.renderEntity(entityConf, false)\n            )}\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  private renderEntity(\n    entityConf: EntityConfig,\n    dialog: boolean\n  ): TemplateResult {\n    const stateObj = this.hass!.states[entityConf.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass!.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            entityConf.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <ha-icon\n        .entity=\"${stateObj.entity_id}\"\n        @click=\"${dialog ? this._openDialog : this._callService}\"\n        class=\"${classMap({\n          \"state-on\": !STATES_OFF.has(stateObj.state),\n        })}\"\n        .icon=\"${entityConf.icon || stateIcon(stateObj)}\"\n        title=\"${`\n            ${computeStateName(stateObj)} : ${computeStateDisplay(\n          this.hass!.localize,\n          stateObj,\n          this.hass!.language\n        )}\n          `}\"\n      ></ha-icon>\n    `;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n\n  private _openDialog(ev: MouseEvent): void {\n    fireEvent(this, \"hass-more-info\", { entityId: (ev.target as any).entity });\n  }\n\n  private _callService(ev: MouseEvent): void {\n    toggleEntity(this.hass!, (ev.target as any).entity);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        position: relative;\n        min-height: 48px;\n        overflow: hidden;\n      }\n\n      hui-image.clickable {\n        cursor: pointer;\n      }\n\n      .box {\n        /* start paper-font-common-nowrap style */\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        /* end paper-font-common-nowrap style */\n\n        position: absolute;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: rgba(0, 0, 0, 0.3);\n        padding: 4px 8px;\n        font-size: 16px;\n        line-height: 40px;\n        color: white;\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .box .title {\n        font-weight: 500;\n        margin-left: 8px;\n      }\n\n      ha-icon {\n        cursor: pointer;\n        padding: 8px;\n        color: #a9a9a9;\n      }\n\n      ha-icon.state-on {\n        color: white;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-glance-card\": HuiPictureGlanceCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\n\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { LovelaceCardEditor, LovelaceCard } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { PlantStatusCardConfig, PlantAttributeTarget } from \"./types\";\n\nconst SENSORS = {\n  moisture: \"hass:water\",\n  temperature: \"hass:thermometer\",\n  brightness: \"hass:white-balance-sunny\",\n  conductivity: \"hass:emoticon-poop\",\n  battery: \"hass:battery\",\n};\n\n@customElement(\"hui-plant-status-card\")\nclass HuiPlantStatusCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-plant-status-card-editor\" */ \"../editor/config-elements/hui-plant-status-card-editor\");\n    return document.createElement(\"hui-plant-status-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: PlantStatusCardConfig;\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PlantStatusCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"plant\") {\n      throw new Error(\"Specify an entity from within the plant domain.\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config!.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card\n        class=\"${stateObj.attributes.entity_picture ? \"has-plant-image\" : \"\"}\"\n      >\n        <div\n          class=\"banner\"\n          style=\"background-image:url(${stateObj.attributes.entity_picture})\"\n        >\n          <div class=\"header\">\n            ${this._config.name || computeStateName(stateObj)}\n          </div>\n        </div>\n        <div class=\"content\">\n          ${this.computeAttributes(stateObj).map(\n            (item) => html`\n              <div\n                class=\"attributes\"\n                @click=\"${this._handleMoreInfo}\"\n                .value=\"${item}\"\n              >\n                <div>\n                  <ha-icon\n                    icon=\"${this.computeIcon(\n                      item,\n                      stateObj.attributes.battery\n                    )}\"\n                  ></ha-icon>\n                </div>\n                <div\n                  class=\"${stateObj.attributes.problem.indexOf(item) === -1\n                    ? \"\"\n                    : \"problem\"}\"\n                >\n                  ${stateObj.attributes[item]}\n                </div>\n                <div class=\"uom\">\n                  ${stateObj.attributes.unit_of_measurement_dict[item] || \"\"}\n                </div>\n              </div>\n            `\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .banner {\n        display: flex;\n        align-items: flex-end;\n        background-repeat: no-repeat;\n        background-size: cover;\n        background-position: center;\n        padding-top: 12px;\n      }\n\n      .has-plant-image .banner {\n        padding-top: 30%;\n      }\n\n      .header {\n        /* start paper-font-headline style */\n        font-family: \"Roboto\", \"Noto\", sans-serif;\n        -webkit-font-smoothing: antialiased; /* OS X subpixel AA bleed bug */\n        text-rendering: optimizeLegibility;\n        font-size: 24px;\n        font-weight: 400;\n        letter-spacing: -0.012em;\n        /* end paper-font-headline style */\n\n        line-height: 40px;\n        padding: 8px 16px;\n      }\n\n      .has-plant-image .header {\n        font-size: 16px;\n        font-weight: 500;\n        line-height: 16px;\n        padding: 16px;\n        color: white;\n        width: 100%;\n        background: rgba(0, 0, 0, var(--dark-secondary-opacity));\n      }\n\n      .content {\n        display: flex;\n        justify-content: space-between;\n        padding: 16px 32px 24px 32px;\n      }\n\n      .has-plant-image .content {\n        padding-bottom: 16px;\n      }\n\n      ha-icon {\n        color: var(--paper-item-icon-color);\n        margin-bottom: 8px;\n      }\n\n      .attributes {\n        cursor: pointer;\n      }\n\n      .attributes div {\n        text-align: center;\n      }\n\n      .problem {\n        color: var(--google-red-500);\n        font-weight: bold;\n      }\n\n      .uom {\n        color: var(--secondary-text-color);\n      }\n    `;\n  }\n\n  private computeAttributes(stateObj: HassEntity): string[] {\n    return Object.keys(SENSORS).filter((key) => key in stateObj.attributes);\n  }\n\n  private computeIcon(attr: string, batLvl: number): string {\n    const icon = SENSORS[attr];\n    if (attr === \"battery\") {\n      if (batLvl <= 5) {\n        return `${icon}-alert`;\n      }\n      if (batLvl < 95) {\n        return `${icon}-${Math.round(batLvl / 10 - 0.01) * 10}`;\n      }\n    }\n    return icon;\n  }\n\n  private _handleMoreInfo(ev: Event): void {\n    const target = ev.currentTarget! as PlantAttributeTarget;\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (target.value) {\n      fireEvent(this, \"hass-more-info\", {\n        entityId: stateObj.attributes.sensors[target.value],\n      });\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-plant-status-card\": HuiPlantStatusCard;\n  }\n}\n","import {\n  html,\n  svg,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport \"@polymer/paper-spinner/paper-spinner\";\n\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport stateIcon from \"../../../common/entity/state_icon\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { fetchRecent } from \"../../../data/history\";\nimport { SensorCardConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\nconst midPoint = (\n  _Ax: number,\n  _Ay: number,\n  _Bx: number,\n  _By: number\n): number[] => {\n  const _Zx = (_Ax - _Bx) / 2 + _Bx;\n  const _Zy = (_Ay - _By) / 2 + _By;\n  return [_Zx, _Zy];\n};\n\nconst getPath = (coords: number[][]): string => {\n  let next;\n  let Z;\n  const X = 0;\n  const Y = 1;\n  let path = \"\";\n  let last = coords.filter(Boolean)[0];\n\n  path += `M ${last[X]},${last[Y]}`;\n\n  for (const coord of coords) {\n    next = coord;\n    Z = midPoint(last[X], last[Y], next[X], next[Y]);\n    path += ` ${Z[X]},${Z[Y]}`;\n    path += ` Q${next[X]},${next[Y]}`;\n    last = next;\n  }\n\n  path += ` ${next[X]},${next[Y]}`;\n  return path;\n};\n\nconst calcPoints = (\n  history: any,\n  hours: number,\n  width: number,\n  detail: number,\n  min: number,\n  max: number\n): number[][] => {\n  const coords = [] as number[][];\n  const margin = 5;\n  const height = 80;\n  width -= 10;\n  let yRatio = (max - min) / height;\n  yRatio = yRatio !== 0 ? yRatio : height;\n  let xRatio = width / (hours - (detail === 1 ? 1 : 0));\n  xRatio = isFinite(xRatio) ? xRatio : width;\n  const getCoords = (item, i, offset = 0, depth = 1) => {\n    if (depth > 1) {\n      return item.forEach((subItem, index) =>\n        getCoords(subItem, i, index, depth - 1)\n      );\n    }\n    const average =\n      item.reduce((sum, entry) => sum + parseFloat(entry.state), 0) /\n      item.length;\n\n    const x = xRatio * (i + offset / 6) + margin;\n    const y = height - (average - min) / yRatio + margin * 2;\n    return coords.push([x, y]);\n  };\n\n  history.forEach((item, i) => getCoords(item, i, 0, detail));\n  if (coords.length === 1) {\n    coords[1] = [width + margin, coords[0][1]];\n  }\n\n  coords.push([width + margin, coords[coords.length - 1][1]]);\n  return coords;\n};\n\nconst coordinates = (\n  history: any,\n  hours: number,\n  width: number,\n  detail: number\n): number[][] => {\n  history.forEach((item) => (item.state = Number(item.state)));\n  history = history.filter((item) => !Number.isNaN(item.state));\n\n  const min = Math.min.apply(Math, history.map((item) => item.state));\n  const max = Math.max.apply(Math, history.map((item) => item.state));\n  const now = new Date().getTime();\n\n  const reduce = (res, item, point) => {\n    const age = now - new Date(item.last_changed).getTime();\n\n    let key = Math.abs(age / (1000 * 3600) - hours);\n    if (point) {\n      key = (key - Math.floor(key)) * 60;\n      key = Number((Math.round(key / 10) * 10).toString()[0]);\n    } else {\n      key = Math.floor(key);\n    }\n    if (!res[key]) {\n      res[key] = [];\n    }\n    res[key].push(item);\n    return res;\n  };\n\n  history = history.reduce((res, item) => reduce(res, item, false), []);\n  if (detail > 1) {\n    history = history.map((entry) =>\n      entry.reduce((res, item) => reduce(res, item, true), [])\n    );\n  }\n  return calcPoints(history, hours, width, detail, min, max);\n};\n\n@customElement(\"hui-sensor-card\")\nclass HuiSensorCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-sensor-card-editor\" */ \"../editor/config-elements/hui-sensor-card-editor\");\n    return document.createElement(\"hui-sensor-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: SensorCardConfig;\n\n  @property() private _history?: any;\n\n  private _date?: Date;\n\n  public setConfig(config: SensorCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"sensor\") {\n      throw new Error(\"Specify an entity from within the sensor domain.\");\n    }\n\n    const cardConfig = {\n      detail: 1,\n      theme: \"default\",\n      hours_to_show: 24,\n      ...config,\n    };\n\n    cardConfig.hours_to_show = Number(cardConfig.hours_to_show);\n    cardConfig.detail =\n      cardConfig.detail === 1 || cardConfig.detail === 2\n        ? cardConfig.detail\n        : 1;\n\n    this._config = cardConfig;\n  }\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    let graph;\n\n    if (stateObj && this._config.graph === \"line\") {\n      if (!stateObj.attributes.unit_of_measurement) {\n        return html`\n          <hui-warning\n            >Entity: ${this._config.entity} - Has no Unit of Measurement and\n            therefore can not display a line graph.</hui-warning\n          >\n        `;\n      } else if (!this._history) {\n        graph = svg`\n          <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 500 100\"></svg>\n        `;\n      } else {\n        graph = svg`\n          <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 500 100\">\n            <path\n              d=\"${this._history}\"\n              fill=\"none\"\n              stroke=\"var(--accent-color)\"\n              stroke-width=\"5\"\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n            />\n          </svg>\n        `;\n      }\n    } else {\n      graph = \"\";\n    }\n    return html`\n      <ha-card @click=\"${this._handleClick}\">\n        <div class=\"flex\">\n          <div class=\"icon\">\n            <ha-icon\n              .icon=\"${this._config.icon || stateIcon(stateObj)}\"\n            ></ha-icon>\n          </div>\n          <div class=\"header\">\n            <span class=\"name\"\n              >${this._config.name || computeStateName(stateObj)}</span\n            >\n          </div>\n        </div>\n        <div class=\"flex info\">\n          <span id=\"value\">${stateObj.state}</span>\n          <span id=\"measurement\"\n            >${this._config.unit ||\n              stateObj.attributes.unit_of_measurement}</span\n          >\n        </div>\n        <div class=\"graph\"><div>${graph}</div></div>\n      </ha-card>\n    `;\n  }\n\n  protected firstUpdated(): void {\n    this._date = new Date();\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_history\")) {\n      return true;\n    }\n\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n    if (!this._config || this._config.graph !== \"line\" || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config!.theme);\n    }\n\n    const minute = 60000;\n    if (changedProps.has(\"_config\")) {\n      this._getHistory();\n    } else if (Date.now() - this._date!.getTime() >= minute) {\n      this._getHistory();\n    }\n  }\n\n  private _handleClick(): void {\n    fireEvent(this, \"hass-more-info\", { entityId: this._config!.entity });\n  }\n\n  private async _getHistory(): Promise<void> {\n    const endTime = new Date();\n    const startTime = new Date();\n    startTime.setHours(endTime.getHours() - this._config!.hours_to_show!);\n\n    const stateHistory = await fetchRecent(\n      this.hass,\n      this._config!.entity,\n      startTime,\n      endTime\n    );\n\n    if (stateHistory.length < 1 || stateHistory[0].length < 1) {\n      return;\n    }\n\n    const coords = coordinates(\n      stateHistory[0],\n      this._config!.hours_to_show!,\n      500,\n      this._config!.detail!\n    );\n\n    this._history = getPath(coords);\n    this._date = new Date();\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        flex-direction: column;\n      }\n\n      ha-card {\n        display: flex;\n        flex-direction: column;\n        flex: 1;\n        padding: 16px;\n        position: relative;\n        cursor: pointer;\n      }\n\n      .flex {\n        display: flex;\n      }\n\n      .header {\n        align-items: center;\n        display: flex;\n        min-width: 0;\n        opacity: 0.8;\n        position: relative;\n      }\n\n      .name {\n        display: block;\n        display: -webkit-box;\n        font-size: 1.2rem;\n        font-weight: 500;\n        max-height: 1.4rem;\n        margin-top: 2px;\n        opacity: 0.8;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        -webkit-line-clamp: 1;\n        -webkit-box-orient: vertical;\n        word-wrap: break-word;\n        word-break: break-all;\n      }\n\n      .icon {\n        color: var(--paper-item-icon-color, #44739e);\n        display: inline-block;\n        flex: 0 0 40px;\n        line-height: 40px;\n        position: relative;\n        text-align: center;\n        width: 40px;\n      }\n\n      .info {\n        flex-wrap: wrap;\n        margin: 16px 0 16px 8px;\n      }\n\n      #value {\n        display: inline-block;\n        font-size: 2rem;\n        font-weight: 400;\n        line-height: 1em;\n        margin-right: 4px;\n      }\n\n      #measurement {\n        align-self: flex-end;\n        display: inline-block;\n        font-size: 1.3rem;\n        line-height: 1.2em;\n        margin-top: 0.1em;\n        opacity: 0.6;\n        vertical-align: bottom;\n      }\n\n      .graph {\n        align-self: flex-end;\n        margin: auto;\n        margin-bottom: 0px;\n        position: relative;\n        width: 100%;\n      }\n\n      .graph > div {\n        align-self: flex-end;\n        margin: auto 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-sensor-card\": HuiSensorCard;\n  }\n}\n","import { html, TemplateResult } from \"lit-element\";\n\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport { HuiStackCard } from \"./hui-stack-card\";\n\nclass HuiVerticalStackCard extends HuiStackCard {\n  public getCardSize() {\n    let totalSize = 0;\n\n    if (!this._cards) {\n      return totalSize;\n    }\n\n    for (const element of this._cards) {\n      totalSize += computeCardSize(element);\n    }\n\n    return totalSize;\n  }\n\n  protected renderStyle(): TemplateResult {\n    return html`\n      <style>\n        #root {\n          display: flex;\n          flex-direction: column;\n        }\n        #root > * {\n          margin: 4px 0 4px 0;\n        }\n        #root > *:first-child {\n          margin-top: 0;\n        }\n        #root > *:last-child {\n          margin-bottom: 0;\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-vertical-stack-card\": HuiVerticalStackCard;\n  }\n}\n\ncustomElements.define(\"hui-vertical-stack-card\", HuiVerticalStackCard);\n","import { HomeAssistant } from \"../types\";\n\nexport interface ShoppingListItem {\n  id: number;\n  name: string;\n  complete: boolean;\n}\n\nexport const fetchItems = (hass: HomeAssistant): Promise<ShoppingListItem[]> =>\n  hass.callWS({\n    type: \"shopping_list/items\",\n  });\n\nexport const updateItem = (\n  hass: HomeAssistant,\n  itemId: number,\n  item: {\n    name?: string;\n    complete?: boolean;\n  }\n): Promise<ShoppingListItem> =>\n  hass.callWS({\n    type: \"shopping_list/items/update\",\n    item_id: itemId,\n    ...item,\n  });\n\nexport const clearItems = (hass: HomeAssistant): Promise<void> =>\n  hass.callWS({\n    type: \"shopping_list/items/clear\",\n  });\n\nexport const addItem = (\n  hass: HomeAssistant,\n  name: string\n): Promise<ShoppingListItem> =>\n  hass.callWS({\n    type: \"shopping_list/items/add\",\n    name,\n  });\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport { repeat } from \"lit-html/directives/repeat\";\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-checkbox/paper-checkbox\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport {\n  fetchItems,\n  updateItem,\n  ShoppingListItem,\n  clearItems,\n  addItem,\n} from \"../../../data/shopping-list\";\nimport { ShoppingListCardConfig } from \"./types\";\n\n@customElement(\"hui-shopping-list-card\")\nclass HuiShoppingListCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-shopping-list-editor\" */ \"../editor/config-elements/hui-shopping-list-editor\");\n    return document.createElement(\"hui-shopping-list-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: ShoppingListCardConfig;\n\n  @property() private _uncheckedItems?: ShoppingListItem[];\n\n  @property() private _checkedItems?: ShoppingListItem[];\n\n  private _unsubEvents?: Promise<() => Promise<void>>;\n\n  public getCardSize(): number {\n    return (this._config ? (this._config.title ? 1 : 0) : 0) + 3;\n  }\n\n  public setConfig(config: ShoppingListCardConfig): void {\n    this._config = config;\n    this._uncheckedItems = [];\n    this._checkedItems = [];\n    this._fetchData();\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (this.hass) {\n      this._unsubEvents = this.hass.connection.subscribeEvents(\n        () => this._fetchData(),\n        \"shopping_list_updated\"\n      );\n      this._fetchData();\n    }\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n\n    if (this._unsubEvents) {\n      this._unsubEvents.then((unsub) => unsub());\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <div class=\"addRow\">\n          <ha-icon\n            class=\"addButton\"\n            @click=\"${this._addItem}\"\n            icon=\"hass:plus\"\n            .title=\"${this.hass!.localize(\n              \"ui.panel.lovelace.cards.shopping-list.add_item\"\n            )}\"\n          >\n          </ha-icon>\n          <paper-item-body>\n            <paper-input\n              no-label-float\n              class=\"addBox\"\n              placeholder=\"${this.hass!.localize(\n                \"ui.panel.lovelace.cards.shopping-list.add_item\"\n              )}\"\n              @keydown=\"${this._addKeyPress}\"\n            ></paper-input>\n          </paper-item-body>\n        </div>\n        ${repeat(\n          this._uncheckedItems!,\n          (item) => item.id,\n          (item, index) =>\n            html`\n              <div class=\"editRow\">\n                <paper-checkbox\n                  slot=\"item-icon\"\n                  id=\"${index}\"\n                  ?checked=\"${item.complete}\"\n                  .itemId=\"${item.id}\"\n                  @click=\"${this._completeItem}\"\n                  tabindex=\"0\"\n                ></paper-checkbox>\n                <paper-item-body>\n                  <paper-input\n                    no-label-float\n                    .value=\"${item.name}\"\n                    .itemId=\"${item.id}\"\n                    @change=\"${this._saveEdit}\"\n                  ></paper-input>\n                </paper-item-body>\n              </div>\n            `\n        )}\n        ${this._checkedItems!.length > 0\n          ? html`\n              <div class=\"divider\"></div>\n              <div class=\"checked\">\n                <span class=\"label\">\n                  ${this.hass!.localize(\n                    \"ui.panel.lovelace.cards.shopping-list.checked_items\"\n                  )}\n                </span>\n                <ha-icon\n                  class=\"clearall\"\n                  @click=\"${this._clearItems}\"\n                  icon=\"hass:notification-clear-all\"\n                  .title=\"${this.hass!.localize(\n                    \"ui.panel.lovelace.cards.shopping-list.clear_items\"\n                  )}\"\n                >\n                </ha-icon>\n              </div>\n              ${repeat(\n                this._checkedItems!,\n                (item) => item.id,\n                (item, index) =>\n                  html`\n                    <div class=\"editRow\">\n                      <paper-checkbox\n                        slot=\"item-icon\"\n                        id=\"${index}\"\n                        ?checked=\"${item.complete}\"\n                        .itemId=\"${item.id}\"\n                        @click=\"${this._completeItem}\"\n                        tabindex=\"0\"\n                      ></paper-checkbox>\n                      <paper-item-body>\n                        <paper-input\n                          no-label-float\n                          .value=\"${item.name}\"\n                          .itemId=\"${item.id}\"\n                          @change=\"${this._saveEdit}\"\n                        ></paper-input>\n                      </paper-item-body>\n                    </div>\n                  `\n              )}\n            `\n          : \"\"}\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .editRow,\n      .addRow {\n        display: flex;\n        flex-direction: row;\n      }\n\n      .addButton {\n        padding: 9px 15px 11px 15px;\n        cursor: pointer;\n      }\n\n      paper-item-body {\n        width: 75%;\n      }\n\n      paper-checkbox {\n        padding: 11px 11px 11px 18px;\n      }\n\n      paper-input {\n        --paper-input-container-underline: {\n          display: none;\n        }\n        --paper-input-container-underline-focus: {\n          display: none;\n        }\n        --paper-input-container-underline-disabled: {\n          display: none;\n        }\n        position: relative;\n        top: 1px;\n      }\n\n      .checked {\n        margin-left: 17px;\n        margin-bottom: 11px;\n        margin-top: 11px;\n      }\n\n      .label {\n        color: var(--primary-color);\n      }\n\n      .divider {\n        height: 1px;\n        background-color: var(--divider-color);\n        margin: 10px;\n      }\n\n      .clearall {\n        cursor: pointer;\n        margin-bottom: 3px;\n        float: right;\n        padding-right: 10px;\n      }\n\n      .addRow > ha-icon {\n        color: var(--secondary-text-color);\n      }\n    `;\n  }\n\n  private async _fetchData(): Promise<void> {\n    if (this.hass) {\n      const checkedItems: ShoppingListItem[] = [];\n      const uncheckedItems: ShoppingListItem[] = [];\n      const items = await fetchItems(this.hass);\n      for (const key in items) {\n        if (items[key].complete) {\n          checkedItems.push(items[key]);\n        } else {\n          uncheckedItems.push(items[key]);\n        }\n      }\n      this._checkedItems = checkedItems;\n      this._uncheckedItems = uncheckedItems;\n    }\n  }\n\n  private _completeItem(ev): void {\n    updateItem(this.hass!, ev.target.itemId, {\n      complete: ev.target.checked,\n    }).catch(() => this._fetchData());\n  }\n\n  private _saveEdit(ev): void {\n    updateItem(this.hass!, ev.target.itemId, {\n      name: ev.target.value,\n    }).catch(() => this._fetchData());\n\n    ev.target.blur();\n  }\n\n  private _clearItems(): void {\n    if (this.hass) {\n      clearItems(this.hass).catch(() => this._fetchData());\n    }\n  }\n\n  private get _newItem(): PaperInputElement {\n    return this.shadowRoot!.querySelector(\".addBox\") as PaperInputElement;\n  }\n\n  private _addItem(ev): void {\n    const newItem = this._newItem;\n\n    if (newItem.value!.length > 0) {\n      addItem(this.hass!, newItem.value!).catch(() => this._fetchData());\n    }\n\n    newItem.value = \"\";\n    if (ev) {\n      newItem.focus();\n    }\n  }\n\n  private _addKeyPress(ev): void {\n    if (ev.keyCode === 13) {\n      this._addItem(null);\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-shopping-list-card\": HuiShoppingListCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { HomeAssistant, ClimateEntity } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { loadRoundslider } from \"../../../resources/jquery.roundslider.ondemand\";\nimport { UNIT_F } from \"../../../common/const\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { ThermostatCardConfig } from \"./types\";\n\nconst thermostatConfig = {\n  radius: 150,\n  circleShape: \"pie\",\n  startAngle: 315,\n  width: 5,\n  lineCap: \"round\",\n  handleSize: \"+10\",\n  showTooltip: false,\n  animation: false,\n};\n\nconst modeIcons = {\n  auto: \"hass:autorenew\",\n  manual: \"hass:cursor-pointer\",\n  heat: \"hass:fire\",\n  cool: \"hass:snowflake\",\n  off: \"hass:power\",\n  fan_only: \"hass:fan\",\n  eco: \"hass:leaf\",\n  dry: \"hass:water-percent\",\n  idle: \"hass:power-sleep\",\n};\n\n@customElement(\"hui-thermostat-card\")\nexport class HuiThermostatCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-thermostat-card-editor\" */ \"../editor/config-elements/hui-thermostat-card-editor\");\n    return document.createElement(\"hui-thermostat-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { entity: \"\" };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: ThermostatCardConfig;\n\n  @property() private _roundSliderStyle?: TemplateResult;\n\n  @property() private _jQuery?: any;\n\n  private _broadCard?: boolean;\n\n  private _loaded?: boolean;\n\n  private _updated?: boolean;\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: ThermostatCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"climate\") {\n      throw new Error(\"Specify an entity from within the climate domain.\");\n    }\n\n    this._config = { theme: \"default\", ...config };\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (this._updated && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n    const stateObj = this.hass.states[this._config.entity] as ClimateEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    const mode = modeIcons[stateObj.attributes.operation_mode || \"\"]\n      ? stateObj.attributes.operation_mode!\n      : \"unknown-mode\";\n    return html`\n      ${this.renderStyle()}\n      <ha-card\n        class=\"${classMap({\n          [mode]: true,\n          large: this._broadCard!,\n          small: !this._broadCard,\n        })}\">\n        <div id=\"root\">\n          <paper-icon-button\n            icon=\"hass:dots-vertical\"\n            class=\"more-info\"\n            @click=\"${this._handleMoreInfo}\"\n          ></paper-icon-button>\n          <div id=\"thermostat\"></div>\n          <div id=\"tooltip\">\n            <div class=\"title\">${this._config.name ||\n              computeStateName(stateObj)}</div>\n            <div class=\"current-temperature\">\n              <span class=\"current-temperature-text\">\n                ${stateObj.attributes.current_temperature}\n                ${\n                  stateObj.attributes.current_temperature\n                    ? html`\n                        <span class=\"uom\"\n                          >${this.hass.config.unit_system.temperature}</span\n                        >\n                      `\n                    : \"\"\n                }\n              </span>\n            </div>\n            <div class=\"climate-info\">\n            <div id=\"set-temperature\"></div>\n            <div class=\"current-mode\">${this.hass!.localize(\n              `state.climate.${stateObj.state}`\n            )}</div>\n            <div class=\"modes\">\n              ${(stateObj.attributes.operation_list || []).map((modeItem) =>\n                this._renderIcon(modeItem, mode)\n              )}\n            </div>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected firstUpdated(): void {\n    this._updated = true;\n    if (this.isConnected && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass || !changedProps.has(\"hass\")) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as ClimateEntity;\n\n    if (!stateObj) {\n      return;\n    }\n\n    if (\n      this._jQuery &&\n      // If jQuery changed, we just rendered in firstUpdated\n      !changedProps.has(\"_jQuery\") &&\n      (!oldHass || oldHass.states[this._config.entity] !== stateObj)\n    ) {\n      const [sliderValue, uiValue] = this._genSliderValue(stateObj);\n\n      this._jQuery(\"#thermostat\", this.shadowRoot).roundSlider({\n        value: sliderValue,\n      });\n      this._updateSetTemp(uiValue);\n    }\n  }\n\n  private get _stepSize(): number {\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (stateObj.attributes.target_temp_step) {\n      return stateObj.attributes.target_temp_step;\n    }\n    return this.hass!.config.unit_system.temperature === UNIT_F ? 1 : 0.5;\n  }\n\n  private async _initialLoad(): Promise<void> {\n    const stateObj = this.hass!.states[this._config!.entity] as ClimateEntity;\n\n    if (!stateObj) {\n      // Card will require refresh to work again\n      return;\n    }\n\n    this._loaded = true;\n\n    await this.updateComplete;\n\n    let radius = this.clientWidth / 3.2;\n    this._broadCard = this.clientWidth > 390;\n\n    if (radius === 0) {\n      radius = 100;\n    }\n\n    (this.shadowRoot!.querySelector(\n      \"#thermostat\"\n    ) as HTMLElement)!.style.height = radius * 2 + \"px\";\n\n    const loaded = await loadRoundslider();\n\n    this._roundSliderStyle = loaded.roundSliderStyle;\n    this._jQuery = loaded.jQuery;\n\n    const _sliderType =\n      stateObj.attributes.target_temp_low &&\n      stateObj.attributes.target_temp_high\n        ? \"range\"\n        : \"min-range\";\n\n    const [sliderValue, uiValue] = this._genSliderValue(stateObj);\n\n    this._jQuery(\"#thermostat\", this.shadowRoot).roundSlider({\n      ...thermostatConfig,\n      radius,\n      min: stateObj.attributes.min_temp,\n      max: stateObj.attributes.max_temp,\n      sliderType: _sliderType,\n      change: (value) => this._setTemperature(value),\n      drag: (value) => this._dragEvent(value),\n      value: sliderValue,\n      step: this._stepSize,\n    });\n    this._updateSetTemp(uiValue);\n  }\n\n  private _genSliderValue(stateObj: ClimateEntity): [string | number, string] {\n    let sliderValue: string | number;\n    let uiValue: string;\n\n    if (\n      stateObj.attributes.target_temp_low &&\n      stateObj.attributes.target_temp_high\n    ) {\n      sliderValue = `${stateObj.attributes.target_temp_low}, ${\n        stateObj.attributes.target_temp_high\n      }`;\n      uiValue = this.formatTemp(\n        [\n          String(stateObj.attributes.target_temp_low),\n          String(stateObj.attributes.target_temp_high),\n        ],\n        false\n      );\n    } else {\n      sliderValue = stateObj.attributes.temperature;\n      uiValue =\n        stateObj.attributes.temperature !== null\n          ? String(stateObj.attributes.temperature)\n          : \"\";\n    }\n\n    return [sliderValue, uiValue];\n  }\n\n  private _updateSetTemp(value: string): void {\n    this.shadowRoot!.querySelector(\"#set-temperature\")!.innerHTML = value;\n  }\n\n  private _dragEvent(e): void {\n    this._updateSetTemp(this.formatTemp(String(e.value).split(\",\"), true));\n  }\n\n  private _setTemperature(e): void {\n    const stateObj = this.hass!.states[this._config!.entity] as ClimateEntity;\n    if (\n      stateObj.attributes.target_temp_low &&\n      stateObj.attributes.target_temp_high\n    ) {\n      if (e.handle.index === 1) {\n        this.hass!.callService(\"climate\", \"set_temperature\", {\n          entity_id: this._config!.entity,\n          target_temp_low: e.handle.value,\n          target_temp_high: stateObj.attributes.target_temp_high,\n        });\n      } else {\n        this.hass!.callService(\"climate\", \"set_temperature\", {\n          entity_id: this._config!.entity,\n          target_temp_low: stateObj.attributes.target_temp_low,\n          target_temp_high: e.handle.value,\n        });\n      }\n    } else {\n      this.hass!.callService(\"climate\", \"set_temperature\", {\n        entity_id: this._config!.entity,\n        temperature: e.value,\n      });\n    }\n  }\n\n  private _renderIcon(mode: string, currentMode: string): TemplateResult {\n    if (!modeIcons[mode]) {\n      return html``;\n    }\n    return html`\n      <ha-icon\n        class=\"${classMap({ \"selected-icon\": currentMode === mode })}\"\n        .mode=\"${mode}\"\n        .icon=\"${modeIcons[mode]}\"\n        @click=\"${this._handleModeClick}\"\n      ></ha-icon>\n    `;\n  }\n\n  private _handleMoreInfo() {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this._config!.entity,\n    });\n  }\n\n  private _handleModeClick(e: MouseEvent): void {\n    this.hass!.callService(\"climate\", \"set_operation_mode\", {\n      entity_id: this._config!.entity,\n      operation_mode: (e.currentTarget as any).mode,\n    });\n  }\n\n  private formatTemp(temps: string[], spaceStepSize: boolean): string {\n    temps = temps.filter(Boolean);\n\n    // If we are sliding the slider, append 0 to the temperatures if we're\n    // having a 0.5 step size, so that the text doesn't jump while sliding\n    if (spaceStepSize) {\n      const stepSize = this._stepSize;\n      temps = temps.map((val) =>\n        val.includes(\".\") || stepSize === 1 ? val : `${val}.0`\n      );\n    }\n\n    return temps.join(\"-\");\n  }\n\n  private renderStyle(): TemplateResult {\n    return html`\n      ${this._roundSliderStyle}\n      <style>\n        :host {\n          display: block;\n        }\n        ha-card {\n          overflow: hidden;\n          --rail-border-color: transparent;\n          --auto-color: green;\n          --eco-color: springgreen;\n          --cool-color: #2b9af9;\n          --heat-color: #ff8100;\n          --manual-color: #44739e;\n          --off-color: #8a8a8a;\n          --fan_only-color: #8a8a8a;\n          --dry-color: #efbd07;\n          --idle-color: #8a8a8a;\n          --unknown-color: #bac;\n        }\n        #root {\n          position: relative;\n          overflow: hidden;\n        }\n        .auto {\n          --mode-color: var(--auto-color);\n        }\n        .cool {\n          --mode-color: var(--cool-color);\n        }\n        .heat {\n          --mode-color: var(--heat-color);\n        }\n        .manual {\n          --mode-color: var(--manual-color);\n        }\n        .off {\n          --mode-color: var(--off-color);\n        }\n        .fan_only {\n          --mode-color: var(--fan_only-color);\n        }\n        .eco {\n          --mode-color: var(--eco-color);\n        }\n        .dry {\n          --mode-color: var(--dry-color);\n        }\n        .idle {\n          --mode-color: var(--idle-color);\n        }\n        .unknown-mode {\n          --mode-color: var(--unknown-color);\n        }\n        .no-title {\n          --title-position-top: 33% !important;\n        }\n        .large {\n          --thermostat-padding-top: 25px;\n          --thermostat-margin-bottom: 25px;\n          --title-font-size: 28px;\n          --title-position-top: 27%;\n          --climate-info-position-top: 81%;\n          --set-temperature-font-size: 25px;\n          --current-temperature-font-size: 71px;\n          --current-temperature-position-top: 10%;\n          --current-temperature-text-padding-left: 15px;\n          --uom-font-size: 20px;\n          --uom-margin-left: -18px;\n          --current-mode-font-size: 18px;\n          --set-temperature-margin-bottom: -5px;\n        }\n        .small {\n          --thermostat-padding-top: 15px;\n          --thermostat-margin-bottom: 15px;\n          --title-font-size: 18px;\n          --title-position-top: 28%;\n          --climate-info-position-top: 79%;\n          --set-temperature-font-size: 16px;\n          --current-temperature-font-size: 25px;\n          --current-temperature-position-top: 5%;\n          --current-temperature-text-padding-left: 7px;\n          --uom-font-size: 12px;\n          --uom-margin-left: -5px;\n          --current-mode-font-size: 14px;\n          --set-temperature-margin-bottom: 0px;\n        }\n        #thermostat {\n          margin: 0 auto var(--thermostat-margin-bottom);\n          padding-top: var(--thermostat-padding-top);\n        }\n        #thermostat .rs-range-color {\n          background-color: var(--mode-color, var(--disabled-text-color));\n        }\n        #thermostat .rs-path-color {\n          background-color: var(--disabled-text-color);\n        }\n        #thermostat .rs-handle {\n          background-color: var(--paper-card-background-color, white);\n          padding: 7px;\n          border: 2px solid var(--disabled-text-color);\n        }\n        #thermostat .rs-handle.rs-focus {\n          border-color: var(--mode-color, var(--disabled-text-color));\n        }\n        #thermostat .rs-handle:after {\n          border-color: var(--mode-color, var(--disabled-text-color));\n          background-color: var(--mode-color, var(--disabled-text-color));\n        }\n        #thermostat .rs-border {\n          border-color: var(--rail-border-color);\n        }\n        #thermostat .rs-bar.rs-transition.rs-first,\n        .rs-bar.rs-transition.rs-second {\n          z-index: 20 !important;\n        }\n        #thermostat .rs-inner.rs-bg-color.rs-border,\n        #thermostat .rs-overlay.rs-transition.rs-bg-color {\n          background-color: var(--paper-card-background-color, white);\n        }\n        #tooltip {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 100%;\n          text-align: center;\n          z-index: 15;\n          color: var(--primary-text-color);\n        }\n        #set-temperature {\n          font-size: var(--set-temperature-font-size);\n          margin-bottom: var(--set-temperature-margin-bottom);\n        }\n        .title {\n          font-size: var(--title-font-size);\n          position: absolute;\n          top: var(--title-position-top);\n          left: 50%;\n          transform: translate(-50%, -50%);\n        }\n        .climate-info {\n          position: absolute;\n          top: var(--climate-info-position-top);\n          left: 50%;\n          transform: translate(-50%, -50%);\n          width: 100%;\n        }\n        .current-mode {\n          font-size: var(--current-mode-font-size);\n          color: var(--secondary-text-color);\n        }\n        .modes {\n          margin-top: 16px;\n        }\n        .modes ha-icon {\n          color: var(--disabled-text-color);\n          cursor: pointer;\n          display: inline-block;\n          margin: 0 10px;\n        }\n        .modes ha-icon.selected-icon {\n          color: var(--mode-color);\n        }\n        .current-temperature {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          font-size: var(--current-temperature-font-size);\n        }\n        .current-temperature-text {\n          padding-left: var(--current-temperature-text-padding-left);\n        }\n        .uom {\n          font-size: var(--uom-font-size);\n          vertical-align: top;\n          margin-left: var(--uom-margin-left);\n        }\n        .more-info {\n          position: absolute;\n          cursor: pointer;\n          top: 0;\n          right: 0;\n          z-index: 25;\n          color: var(--secondary-text-color);\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-thermostat-card\": HuiThermostatCard;\n  }\n}\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport computeStateName from \"../common/entity/compute_state_name\";\n\nimport \"../components/ha-card\";\nimport \"../components/ha-icon\";\n\nimport { EventsMixin } from \"../mixins/events-mixin\";\nimport LocalizeMixin from \"../mixins/localize-mixin\";\nimport { computeRTL } from \"../common/util/compute_rtl\";\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaWeatherCard extends LocalizeMixin(EventsMixin(PolymerElement)) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          cursor: pointer;\n        }\n\n        .content {\n          padding: 0 20px 20px;\n        }\n\n        ha-icon {\n          color: var(--paper-item-icon-color);\n        }\n\n        .header {\n          font-family: var(--paper-font-headline_-_font-family);\n          -webkit-font-smoothing: var(\n            --paper-font-headline_-_-webkit-font-smoothing\n          );\n          font-size: var(--paper-font-headline_-_font-size);\n          font-weight: var(--paper-font-headline_-_font-weight);\n          letter-spacing: var(--paper-font-headline_-_letter-spacing);\n          line-height: var(--paper-font-headline_-_line-height);\n          text-rendering: var(\n            --paper-font-common-expensive-kerning_-_text-rendering\n          );\n          opacity: var(--dark-primary-opacity);\n          padding: 24px 16px 16px;\n          display: flex;\n          align-items: baseline;\n        }\n\n        .name {\n          margin-left: 16px;\n          font-size: 16px;\n          color: var(--secondary-text-color);\n        }\n\n        :host([rtl]) .name {\n          margin-left: 0px;\n          margin-right: 16px;\n        }\n\n        .now {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          flex-wrap: wrap;\n        }\n\n        .main {\n          display: flex;\n          align-items: center;\n          margin-right: 32px;\n        }\n\n        :host([rtl]) .main {\n          margin-right: 0px;\n        }\n\n        .main ha-icon {\n          --iron-icon-height: 72px;\n          --iron-icon-width: 72px;\n          margin-right: 8px;\n        }\n\n        :host([rtl]) .main ha-icon {\n          margin-right: 0px;\n        }\n\n        .main .temp {\n          font-size: 52px;\n          line-height: 1em;\n          position: relative;\n        }\n\n        :host([rtl]) .main .temp {\n          direction: ltr;\n          margin-right: 28px;\n        }\n\n        .main .temp span {\n          font-size: 24px;\n          line-height: 1em;\n          position: absolute;\n          top: 4px;\n        }\n\n        .measurand {\n          display: inline-block;\n        }\n\n        :host([rtl]) .measurand {\n          direction: ltr;\n        }\n\n        .forecast {\n          margin-top: 16px;\n          display: flex;\n          justify-content: space-between;\n        }\n\n        .forecast div {\n          flex: 0 0 auto;\n          text-align: center;\n        }\n\n        .forecast .icon {\n          margin: 4px 0;\n          text-align: center;\n        }\n\n        :host([rtl]) .forecast .temp {\n          direction: ltr;\n        }\n\n        .weekday {\n          font-weight: bold;\n        }\n\n        .attributes,\n        .templow,\n        .precipitation {\n          color: var(--secondary-text-color);\n        }\n\n        :host([rtl]) .precipitation {\n          direction: ltr;\n        }\n      </style>\n      <ha-card>\n        <div class=\"header\">\n          [[computeState(stateObj.state, localize)]]\n          <div class=\"name\">[[computeName(stateObj)]]</div>\n        </div>\n        <div class=\"content\">\n          <div class=\"now\">\n            <div class=\"main\">\n              <template is=\"dom-if\" if=\"[[showWeatherIcon(stateObj.state)]]\">\n                <ha-icon icon=\"[[getWeatherIcon(stateObj.state)]]\"></ha-icon>\n              </template>\n              <div class=\"temp\">\n                [[stateObj.attributes.temperature]]<span\n                  >[[getUnit('temperature')]]</span\n                >\n              </div>\n            </div>\n            <div class=\"attributes\">\n              <template\n                is=\"dom-if\"\n                if=\"[[_showValue(stateObj.attributes.pressure)]]\"\n              >\n                <div>\n                  [[localize('ui.card.weather.attributes.air_pressure')]]:\n                  <span class=\"measurand\">\n                    [[stateObj.attributes.pressure]] [[getUnit('air_pressure')]]\n                  </span>\n                </div>\n              </template>\n              <template\n                is=\"dom-if\"\n                if=\"[[_showValue(stateObj.attributes.humidity)]]\"\n              >\n                <div>\n                  [[localize('ui.card.weather.attributes.humidity')]]:\n                  <span class=\"measurand\"\n                    >[[stateObj.attributes.humidity]] %</span\n                  >\n                </div>\n              </template>\n              <template\n                is=\"dom-if\"\n                if=\"[[_showValue(stateObj.attributes.wind_speed)]]\"\n              >\n                <div>\n                  [[localize('ui.card.weather.attributes.wind_speed')]]:\n                  <span class=\"measurand\">\n                    [[getWindSpeed(stateObj.attributes.wind_speed)]]\n                  </span>\n                  [[getWindBearing(stateObj.attributes.wind_bearing, localize)]]\n                </div>\n              </template>\n            </div>\n          </div>\n          <template is=\"dom-if\" if=\"[[forecast]]\">\n            <div class=\"forecast\">\n              <template is=\"dom-repeat\" items=\"[[forecast]]\">\n                <div>\n                  <div class=\"weekday\">\n                    [[computeDate(item.datetime)]]<br />\n                    <template is=\"dom-if\" if=\"[[!_showValue(item.templow)]]\">\n                      [[computeTime(item.datetime)]]\n                    </template>\n                  </div>\n                  <template is=\"dom-if\" if=\"[[_showValue(item.condition)]]\">\n                    <div class=\"icon\">\n                      <ha-icon\n                        icon=\"[[getWeatherIcon(item.condition)]]\"\n                      ></ha-icon>\n                    </div>\n                  </template>\n                  <template is=\"dom-if\" if=\"[[_showValue(item.temperature)]]\">\n                    <div class=\"temp\">\n                      [[item.temperature]] [[getUnit('temperature')]]\n                    </div>\n                  </template>\n                  <template is=\"dom-if\" if=\"[[_showValue(item.templow)]]\">\n                    <div class=\"templow\">\n                      [[item.templow]] [[getUnit('temperature')]]\n                    </div>\n                  </template>\n                  <template is=\"dom-if\" if=\"[[_showValue(item.precipitation)]]\">\n                    <div class=\"precipitation\">\n                      [[item.precipitation]] [[getUnit('precipitation')]]\n                    </div>\n                  </template>\n                </div>\n              </template>\n            </div>\n          </template>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      config: Object,\n      stateObj: Object,\n      forecast: {\n        type: Array,\n        computed: \"computeForecast(stateObj.attributes.forecast)\",\n      },\n      rtl: {\n        type: Boolean,\n        reflectToAttribute: true,\n        computed: \"_computeRTL(hass)\",\n      },\n    };\n  }\n\n  constructor() {\n    super();\n    this.cardinalDirections = [\n      \"N\",\n      \"NNE\",\n      \"NE\",\n      \"ENE\",\n      \"E\",\n      \"ESE\",\n      \"SE\",\n      \"SSE\",\n      \"S\",\n      \"SSW\",\n      \"SW\",\n      \"WSW\",\n      \"W\",\n      \"WNW\",\n      \"NW\",\n      \"NNW\",\n      \"N\",\n    ];\n    this.weatherIcons = {\n      \"clear-night\": \"hass:weather-night\",\n      cloudy: \"hass:weather-cloudy\",\n      fog: \"hass:weather-fog\",\n      hail: \"hass:weather-hail\",\n      lightning: \"hass:weather-lightning\",\n      \"lightning-rainy\": \"hass:weather-lightning-rainy\",\n      partlycloudy: \"hass:weather-partlycloudy\",\n      pouring: \"hass:weather-pouring\",\n      rainy: \"hass:weather-rainy\",\n      snowy: \"hass:weather-snowy\",\n      \"snowy-rainy\": \"hass:weather-snowy-rainy\",\n      sunny: \"hass:weather-sunny\",\n      windy: \"hass:weather-windy\",\n      \"windy-variant\": \"hass:weather-windy-variant\",\n    };\n  }\n\n  ready() {\n    this.addEventListener(\"click\", this._onClick);\n    super.ready();\n  }\n\n  _onClick() {\n    this.fire(\"hass-more-info\", { entityId: this.stateObj.entity_id });\n  }\n\n  computeForecast(forecast) {\n    return forecast && forecast.slice(0, 5);\n  }\n\n  getUnit(measure) {\n    const lengthUnit = this.hass.config.unit_system.length || \"\";\n    switch (measure) {\n      case \"air_pressure\":\n        return lengthUnit === \"km\" ? \"hPa\" : \"inHg\";\n      case \"length\":\n        return lengthUnit;\n      case \"precipitation\":\n        return lengthUnit === \"km\" ? \"mm\" : \"in\";\n      default:\n        return this.hass.config.unit_system[measure] || \"\";\n    }\n  }\n\n  computeState(state, localize) {\n    return localize(`state.weather.${state}`) || state;\n  }\n\n  computeName(stateObj) {\n    return (this.config && this.config.name) || computeStateName(stateObj);\n  }\n\n  showWeatherIcon(condition) {\n    return condition in this.weatherIcons;\n  }\n\n  getWeatherIcon(condition) {\n    return this.weatherIcons[condition];\n  }\n\n  windBearingToText(degree) {\n    const degreenum = parseInt(degree);\n    if (isFinite(degreenum)) {\n      return this.cardinalDirections[(((degreenum + 11.25) / 22.5) | 0) % 16];\n    }\n    return degree;\n  }\n\n  getWindSpeed(speed) {\n    return `${speed} ${this.getUnit(\"length\")}/h`;\n  }\n\n  getWindBearing(bearing, localize) {\n    if (bearing != null) {\n      const cardinalDirection = this.windBearingToText(bearing);\n      return `(${localize(\n        `ui.card.weather.cardinal_direction.${cardinalDirection.toLowerCase()}`\n      ) || cardinalDirection})`;\n    }\n    return ``;\n  }\n\n  _showValue(item) {\n    return typeof item !== \"undefined\" && item !== null;\n  }\n\n  computeDate(data) {\n    const date = new Date(data);\n    return date.toLocaleDateString(this.hass.language, { weekday: \"short\" });\n  }\n\n  computeTime(data) {\n    const date = new Date(data);\n    return date.toLocaleTimeString(this.hass.language, { hour: \"numeric\" });\n  }\n\n  _computeRTL(hass) {\n    return computeRTL(hass);\n  }\n}\ncustomElements.define(\"ha-weather-card\", HaWeatherCard);\n","import \"../../../cards/ha-weather-card\";\n\nimport LegacyWrapperCard from \"./hui-legacy-wrapper-card\";\n\nclass HuiWeatherForecastCard extends LegacyWrapperCard {\n  static async getConfigElement() {\n    await import(/* webpackChunkName: \"hui-weather-forecast-card-editor\" */ \"../editor/config-elements/hui-weather-forecast-card-editor\");\n    return document.createElement(\"hui-weather-forecast-card-editor\");\n  }\n\n  static getStubConfig() {\n    return {};\n  }\n\n  constructor() {\n    super(\"ha-weather-card\", \"weather\");\n  }\n\n  getCardSize() {\n    return 4;\n  }\n}\n\ncustomElements.define(\"hui-weather-forecast-card\", HuiWeatherForecastCard);\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport { styleMap } from \"lit-html/directives/style-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-warning\";\n\nimport isValidEntityId from \"../../../common/entity/valid_entity_id\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { GaugeCardConfig } from \"./types\";\n\nexport const severityMap = {\n  red: \"var(--label-badge-red)\",\n  green: \"var(--label-badge-green)\",\n  yellow: \"var(--label-badge-yellow)\",\n  normal: \"var(--label-badge-blue)\",\n};\n\n@customElement(\"hui-gauge-card\")\nclass HuiGaugeCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-gauge-card-editor\" */ \"../editor/config-elements/hui-gauge-card-editor\");\n    return document.createElement(\"hui-gauge-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _baseUnit = \"50px\";\n  @property() private _config?: GaugeCardConfig;\n\n  private _updated?: boolean;\n\n  public getCardSize(): number {\n    return 2;\n  }\n\n  public setConfig(config: GaugeCardConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid card configuration\");\n    }\n    if (!isValidEntityId(config.entity)) {\n      throw new Error(\"Invalid Entity\");\n    }\n    this._config = { min: 0, max: 100, theme: \"default\", ...config };\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._setBaseUnit();\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    const state = Number(stateObj.state);\n\n    if (isNaN(state)) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_non_numeric\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card\n        @click=\"${this._handleClick}\"\n        style=${styleMap({\n          \"--base-unit\": this._baseUnit,\n        })}\n      >\n        <div class=\"container\">\n          <div class=\"gauge-a\"></div>\n          <div class=\"gauge-b\"></div>\n          <div\n            class=\"gauge-c\"\n            style=${styleMap({\n              transform: `rotate(${this._translateTurn(state)}turn)`,\n              \"background-color\": this._computeSeverity(state),\n            })}\n          ></div>\n          <div class=\"gauge-data\">\n            <div id=\"percent\">\n              ${stateObj.state}\n              ${this._config.unit ||\n                stateObj.attributes.unit_of_measurement ||\n                \"\"}\n            </div>\n            <div id=\"name\">\n              ${this._config.name || computeStateName(stateObj)}\n            </div>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected firstUpdated(): void {\n    this._updated = true;\n    this._setBaseUnit();\n    this.classList.add(\"init\");\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  private _setBaseUnit(): void {\n    if (!this.isConnected || !this._updated) {\n      return;\n    }\n    const baseUnit = this._computeBaseUnit();\n    if (baseUnit !== \"0px\") {\n      this._baseUnit = baseUnit;\n    }\n  }\n\n  private _computeSeverity(numberValue: number): string {\n    const sections = this._config!.severity;\n\n    if (!sections) {\n      return severityMap.normal;\n    }\n\n    const sectionsArray = Object.keys(sections);\n    const sortable = sectionsArray.map((severity) => [\n      severity,\n      sections[severity],\n    ]);\n\n    for (const severity of sortable) {\n      if (severityMap[severity[0]] == null || isNaN(severity[1])) {\n        return severityMap.normal;\n      }\n    }\n    sortable.sort((a, b) => a[1] - b[1]);\n\n    if (numberValue >= sortable[0][1] && numberValue < sortable[1][1]) {\n      return severityMap[sortable[0][0]];\n    }\n    if (numberValue >= sortable[1][1] && numberValue < sortable[2][1]) {\n      return severityMap[sortable[1][0]];\n    }\n    if (numberValue >= sortable[2][1]) {\n      return severityMap[sortable[2][0]];\n    }\n    return severityMap.normal;\n  }\n\n  private _translateTurn(value: number): number {\n    const { min, max } = this._config!;\n    const maxTurnValue = Math.min(Math.max(value, min!), max!);\n    return (5 * (maxTurnValue - min!)) / (max! - min!) / 10;\n  }\n\n  private _computeBaseUnit(): string {\n    return this.clientWidth < 200 ? this.clientWidth / 5 + \"px\" : \"50px\";\n  }\n\n  private _handleClick(): void {\n    fireEvent(this, \"hass-more-info\", { entityId: this._config!.entity });\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        height: calc(var(--base-unit) * 3);\n        position: relative;\n        cursor: pointer;\n      }\n      .container {\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2);\n        position: absolute;\n        top: calc(var(--base-unit) * 1.5);\n        left: 50%;\n        overflow: hidden;\n        text-align: center;\n        transform: translate(-50%, -50%);\n      }\n      .gauge-a {\n        z-index: 1;\n        position: absolute;\n        background-color: var(--primary-background-color);\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2);\n        top: 0%;\n        border-radius: calc(var(--base-unit) * 2.5) calc(var(--base-unit) * 2.5)\n          0px 0px;\n      }\n      .gauge-b {\n        z-index: 3;\n        position: absolute;\n        background-color: var(--paper-card-background-color);\n        width: calc(var(--base-unit) * 2.5);\n        height: calc(var(--base-unit) * 1.25);\n        top: calc(var(--base-unit) * 0.75);\n        margin-left: calc(var(--base-unit) * 0.75);\n        margin-right: auto;\n        border-radius: calc(var(--base-unit) * 2.5) calc(var(--base-unit) * 2.5)\n          0px 0px;\n      }\n      .gauge-c {\n        z-index: 2;\n        position: absolute;\n        background-color: var(--label-badge-blue);\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2);\n        top: calc(var(--base-unit) * 2);\n        margin-left: auto;\n        margin-right: auto;\n        border-radius: 0px 0px calc(var(--base-unit) * 2)\n          calc(var(--base-unit) * 2);\n        transform-origin: center top;\n      }\n      .init .gauge-c {\n        transition: all 1.3s ease-in-out;\n      }\n      .gauge-data {\n        z-index: 4;\n        color: var(--primary-text-color);\n        line-height: calc(var(--base-unit) * 0.3);\n        position: absolute;\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2.1);\n        top: calc(var(--base-unit) * 1.2);\n        margin-left: auto;\n        margin-right: auto;\n      }\n      .init .gauge-data {\n        transition: all 1s ease-out;\n      }\n      .gauge-data #percent {\n        font-size: calc(var(--base-unit) * 0.55);\n      }\n      .gauge-data #name {\n        padding-top: calc(var(--base-unit) * 0.15);\n        font-size: calc(var(--base-unit) * 0.3);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-gauge-card\": HuiGaugeCard;\n  }\n}\n","import deepClone from \"deep-clone-simple\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\n\nimport \"../cards/hui-alarm-panel-card\";\nimport \"../cards/hui-conditional-card\";\nimport \"../cards/hui-entities-card\";\nimport \"../cards/hui-entity-button-card\";\nimport \"../cards/hui-entity-filter-card\";\nimport {\n  createErrorCardElement,\n  createErrorCardConfig,\n  HuiErrorCard,\n} from \"../cards/hui-error-card\";\nimport \"../cards/hui-glance-card\";\nimport \"../cards/hui-history-graph-card\";\nimport \"../cards/hui-horizontal-stack-card\";\nimport \"../cards/hui-iframe-card\";\nimport \"../cards/hui-light-card\";\nimport \"../cards/hui-map-card\";\nimport \"../cards/hui-markdown-card\";\nimport \"../cards/hui-media-control-card\";\nimport \"../cards/hui-picture-card\";\nimport \"../cards/hui-picture-elements-card\";\nimport \"../cards/hui-picture-entity-card\";\nimport \"../cards/hui-picture-glance-card\";\nimport \"../cards/hui-plant-status-card\";\nimport \"../cards/hui-sensor-card\";\nimport \"../cards/hui-vertical-stack-card\";\nimport \"../cards/hui-shopping-list-card\";\nimport \"../cards/hui-thermostat-card\";\nimport \"../cards/hui-weather-forecast-card\";\nimport \"../cards/hui-gauge-card\";\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\n\nconst CARD_TYPES = new Set([\n  \"alarm-panel\",\n  \"conditional\",\n  \"entities\",\n  \"entity-button\",\n  \"entity-filter\",\n  \"error\",\n  \"gauge\",\n  \"glance\",\n  \"history-graph\",\n  \"horizontal-stack\",\n  \"iframe\",\n  \"light\",\n  \"map\",\n  \"markdown\",\n  \"media-control\",\n  \"picture\",\n  \"picture-elements\",\n  \"picture-entity\",\n  \"picture-glance\",\n  \"plant-status\",\n  \"sensor\",\n  \"shopping-list\",\n  \"thermostat\",\n  \"vertical-stack\",\n  \"weather-forecast\",\n]);\nconst CUSTOM_TYPE_PREFIX = \"custom:\";\nconst TIMEOUT = 2000;\n\nconst _createElement = (\n  tag: string,\n  config: LovelaceCardConfig\n): LovelaceCard | HuiErrorCard => {\n  const element = document.createElement(tag) as LovelaceCard;\n  try {\n    element.setConfig(deepClone(config));\n  } catch (err) {\n    // tslint:disable-next-line\n    console.error(tag, err);\n    return _createErrorElement(err.message, config);\n  }\n  return element;\n};\n\nconst _createErrorElement = (\n  error: string,\n  config: LovelaceCardConfig\n): HuiErrorCard => createErrorCardElement(createErrorCardConfig(error, config));\n\nexport const createCardElement = (\n  config: LovelaceCardConfig\n): LovelaceCard | HuiErrorCard => {\n  if (!config || typeof config !== \"object\" || !config.type) {\n    return _createErrorElement(\"No card type configured.\", config);\n  }\n\n  if (config.type.startsWith(CUSTOM_TYPE_PREFIX)) {\n    const tag = config.type.substr(CUSTOM_TYPE_PREFIX.length);\n\n    if (customElements.get(tag)) {\n      return _createElement(tag, config);\n    }\n    const element = _createErrorElement(\n      `Custom element doesn't exist: ${tag}.`,\n      config\n    );\n    element.style.display = \"None\";\n    const timer = window.setTimeout(() => {\n      element.style.display = \"\";\n    }, TIMEOUT);\n\n    customElements.whenDefined(tag).then(() => {\n      clearTimeout(timer);\n      fireEvent(element, \"ll-rebuild\");\n    });\n\n    return element;\n  }\n\n  if (!CARD_TYPES.has(config.type)) {\n    return _createErrorElement(\n      `Unknown card type encountered: ${config.type}.`,\n      config\n    );\n  }\n\n  return _createElement(`hui-${config.type}-card`, config);\n};\n","import { PolymerElement } from \"@polymer/polymer/polymer-element\";\nimport { IronResizableBehavior } from \"@polymer/iron-resizable-behavior/iron-resizable-behavior\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { Debouncer } from \"@polymer/polymer/lib/utils/debounce\";\nimport { timeOut } from \"@polymer/polymer/lib/utils/async\";\nimport { mixinBehaviors } from \"@polymer/polymer/lib/legacy/class\";\n\nimport formatTime from \"../../common/datetime/format_time\";\n// eslint-disable-next-line no-unused-vars\n/* global Chart moment Color */\n\nlet scriptsLoaded = null;\n\nclass HaChartBase extends mixinBehaviors(\n  [IronResizableBehavior],\n  PolymerElement\n) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n        }\n        .chartHeader {\n          padding: 6px 0 0 0;\n          width: 100%;\n          display: flex;\n          flex-direction: row;\n        }\n        .chartHeader > div {\n          vertical-align: top;\n          padding: 0 8px;\n        }\n        .chartHeader > div.chartTitle {\n          padding-top: 8px;\n          flex: 0 0 0;\n          max-width: 30%;\n        }\n        .chartHeader > div.chartLegend {\n          flex: 1 1;\n          min-width: 70%;\n        }\n        :root {\n          user-select: none;\n          -moz-user-select: none;\n          -webkit-user-select: none;\n          -ms-user-select: none;\n        }\n        .chartTooltip {\n          font-size: 90%;\n          opacity: 1;\n          position: absolute;\n          background: rgba(80, 80, 80, 0.9);\n          color: white;\n          border-radius: 3px;\n          pointer-events: none;\n          transform: translate(-50%, 12px);\n          z-index: 1000;\n          width: 200px;\n          transition: opacity 0.15s ease-in-out;\n        }\n        :host([rtl]) .chartTooltip {\n          direction: rtl;\n        }\n        .chartLegend ul,\n        .chartTooltip ul {\n          display: inline-block;\n          padding: 0 0px;\n          margin: 5px 0 0 0;\n          width: 100%;\n        }\n        .chartTooltip li {\n          display: block;\n          white-space: pre-line;\n        }\n        .chartTooltip .title {\n          text-align: center;\n          font-weight: 500;\n        }\n        .chartLegend li {\n          display: inline-block;\n          padding: 0 6px;\n          max-width: 49%;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          overflow: hidden;\n          box-sizing: border-box;\n        }\n        .chartLegend li:nth-child(odd):last-of-type {\n          /* Make last item take full width if it is odd-numbered. */\n          max-width: 100%;\n        }\n        .chartLegend li[data-hidden] {\n          text-decoration: line-through;\n        }\n        .chartLegend em,\n        .chartTooltip em {\n          border-radius: 5px;\n          display: inline-block;\n          height: 10px;\n          margin-right: 4px;\n          width: 10px;\n        }\n        :host([rtl]) .chartTooltip em {\n          margin-right: inherit;\n          margin-left: 4px;\n        }\n        paper-icon-button {\n          color: var(--secondary-text-color);\n        }\n      </style>\n      <template is=\"dom-if\" if=\"[[unit]]\">\n        <div class=\"chartHeader\">\n          <div class=\"chartTitle\">[[unit]]</div>\n          <div class=\"chartLegend\">\n            <ul>\n              <template is=\"dom-repeat\" items=\"[[metas]]\">\n                <li on-click=\"_legendClick\" data-hidden$=\"[[item.hidden]]\">\n                  <em style$=\"background-color:[[item.bgColor]]\"></em>\n                  [[item.label]]\n                </li>\n              </template>\n            </ul>\n          </div>\n        </div>\n      </template>\n      <div id=\"chartTarget\" style=\"height:40px; width:100%\">\n        <canvas id=\"chartCanvas\"></canvas>\n        <div\n          class$=\"chartTooltip [[tooltip.yAlign]]\"\n          style$=\"opacity:[[tooltip.opacity]]; top:[[tooltip.top]]; left:[[tooltip.left]]; padding:[[tooltip.yPadding]]px [[tooltip.xPadding]]px\"\n        >\n          <div class=\"title\">[[tooltip.title]]</div>\n          <div>\n            <ul>\n              <template is=\"dom-repeat\" items=\"[[tooltip.lines]]\">\n                <li>\n                  <em style$=\"background-color:[[item.bgColor]]\"></em\n                  >[[item.text]]\n                </li>\n              </template>\n            </ul>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  get chart() {\n    return this._chart;\n  }\n\n  static get properties() {\n    return {\n      data: Object,\n      identifier: String,\n      rendered: {\n        type: Boolean,\n        notify: true,\n        value: false,\n        readOnly: true,\n      },\n      metas: {\n        type: Array,\n        value: () => [],\n      },\n      tooltip: {\n        type: Object,\n        value: () => ({\n          opacity: \"0\",\n          left: \"0\",\n          top: \"0\",\n          xPadding: \"5\",\n          yPadding: \"3\",\n        }),\n      },\n      unit: Object,\n      rtl: {\n        type: Boolean,\n        reflectToAttribute: true,\n      },\n    };\n  }\n\n  static get observers() {\n    return [\"onPropsChange(data)\"];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._isAttached = true;\n    this.onPropsChange();\n    this._resizeListener = () => {\n      this._debouncer = Debouncer.debounce(\n        this._debouncer,\n        timeOut.after(10),\n        () => {\n          if (this._isAttached) {\n            this.resizeChart();\n          }\n        }\n      );\n    };\n\n    if (typeof ResizeObserver === \"function\") {\n      this.resizeObserver = new ResizeObserver((entries) => {\n        entries.forEach(() => {\n          this._resizeListener();\n        });\n      });\n      this.resizeObserver.observe(this.$.chartTarget);\n    } else {\n      this.addEventListener(\"iron-resize\", this._resizeListener);\n    }\n\n    if (scriptsLoaded === null) {\n      scriptsLoaded = import(/* webpackChunkName: \"load_chart\" */ \"../../resources/ha-chart-scripts.js\");\n    }\n    scriptsLoaded.then((ChartModule) => {\n      this.ChartClass = ChartModule.default;\n      this.onPropsChange();\n    });\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this._isAttached = false;\n    if (this.resizeObserver) {\n      this.resizeObserver.unobserve(this.$.chartTarget);\n    }\n\n    this.removeEventListener(\"iron-resize\", this._resizeListener);\n\n    if (this._resizeTimer !== undefined) {\n      clearInterval(this._resizeTimer);\n      this._resizeTimer = undefined;\n    }\n  }\n\n  onPropsChange() {\n    if (!this._isAttached || !this.ChartClass || !this.data) {\n      return;\n    }\n    this.drawChart();\n  }\n\n  _customTooltips(tooltip) {\n    // Hide if no tooltip\n    if (tooltip.opacity === 0) {\n      this.set([\"tooltip\", \"opacity\"], 0);\n      return;\n    }\n    // Set caret Position\n    if (tooltip.yAlign) {\n      this.set([\"tooltip\", \"yAlign\"], tooltip.yAlign);\n    } else {\n      this.set([\"tooltip\", \"yAlign\"], \"no-transform\");\n    }\n\n    const title = tooltip.title ? tooltip.title[0] || \"\" : \"\";\n    this.set([\"tooltip\", \"title\"], title);\n\n    const bodyLines = tooltip.body.map((n) => n.lines);\n\n    // Set Text\n    if (tooltip.body) {\n      this.set(\n        [\"tooltip\", \"lines\"],\n        bodyLines.map((body, i) => {\n          const colors = tooltip.labelColors[i];\n          return {\n            color: colors.borderColor,\n            bgColor: colors.backgroundColor,\n            text: body.join(\"\\n\"),\n          };\n        })\n      );\n    }\n    const parentWidth = this.$.chartTarget.clientWidth;\n    let positionX = tooltip.caretX;\n    const positionY = this._chart.canvas.offsetTop + tooltip.caretY;\n    if (tooltip.caretX + 100 > parentWidth) {\n      positionX = parentWidth - 100;\n    } else if (tooltip.caretX < 100) {\n      positionX = 100;\n    }\n    positionX += this._chart.canvas.offsetLeft;\n    // Display, position, and set styles for font\n    this.tooltip = Object.assign({}, this.tooltip, {\n      opacity: 1,\n      left: `${positionX}px`,\n      top: `${positionY}px`,\n    });\n  }\n\n  _legendClick(event) {\n    event = event || window.event;\n    event.stopPropagation();\n    let target = event.target || event.srcElement;\n    while (target.nodeName !== \"LI\") {\n      // user clicked child, find parent LI\n      target = target.parentElement;\n    }\n    const index = event.model.itemsIndex;\n\n    const meta = this._chart.getDatasetMeta(index);\n    meta.hidden =\n      meta.hidden === null ? !this._chart.data.datasets[index].hidden : null;\n    this.set(\n      [\"metas\", index, \"hidden\"],\n      this._chart.isDatasetVisible(index) ? null : \"hidden\"\n    );\n    this._chart.update();\n  }\n\n  _drawLegend() {\n    const chart = this._chart;\n    // New data for old graph. Keep metadata.\n    const preserveVisibility =\n      this._oldIdentifier && this.identifier === this._oldIdentifier;\n    this._oldIdentifier = this.identifier;\n    this.set(\n      \"metas\",\n      this._chart.data.datasets.map((x, i) => ({\n        label: x.label,\n        color: x.color,\n        bgColor: x.backgroundColor,\n        hidden:\n          preserveVisibility && i < this.metas.length\n            ? this.metas[i].hidden\n            : !chart.isDatasetVisible(i),\n      }))\n    );\n    let updateNeeded = false;\n    if (preserveVisibility) {\n      for (let i = 0; i < this.metas.length; i++) {\n        const meta = chart.getDatasetMeta(i);\n        if (!!meta.hidden !== !!this.metas[i].hidden) updateNeeded = true;\n        meta.hidden = this.metas[i].hidden ? true : null;\n      }\n    }\n    if (updateNeeded) {\n      chart.update();\n    }\n    this.unit = this.data.unit;\n  }\n\n  _formatTickValue(value, index, values) {\n    if (values.length === 0) {\n      return value;\n    }\n    const date = new Date(values[index].value);\n    return formatTime(date);\n  }\n\n  drawChart() {\n    const data = this.data.data;\n    const ctx = this.$.chartCanvas;\n\n    if ((!data.datasets || !data.datasets.length) && !this._chart) {\n      return;\n    }\n    if (this.data.type !== \"timeline\" && data.datasets.length > 0) {\n      const cnt = data.datasets.length;\n      const colors = this.constructor.getColorList(cnt);\n      for (let loopI = 0; loopI < cnt; loopI++) {\n        data.datasets[loopI].borderColor = colors[loopI].rgbString();\n        data.datasets[loopI].backgroundColor = colors[loopI]\n          .alpha(0.6)\n          .rgbaString();\n      }\n    }\n\n    if (this._chart) {\n      this._customTooltips({ opacity: 0 });\n      this._chart.data = data;\n      this._chart.update({ duration: 0 });\n      if (this.isTimeline) {\n        this._chart.options.scales.yAxes[0].gridLines.display = data.length > 1;\n      } else if (this.data.legend === true) {\n        this._drawLegend();\n      }\n      this.resizeChart();\n    } else {\n      if (!data.datasets) {\n        return;\n      }\n      this._customTooltips({ opacity: 0 });\n      const plugins = [{ afterRender: () => this._setRendered(true) }];\n      let options = {\n        responsive: true,\n        maintainAspectRatio: false,\n        animation: {\n          duration: 0,\n        },\n        hover: {\n          animationDuration: 0,\n        },\n        responsiveAnimationDuration: 0,\n        tooltips: {\n          enabled: false,\n          custom: this._customTooltips.bind(this),\n        },\n        legend: {\n          display: false,\n        },\n        line: {\n          spanGaps: true,\n        },\n        elements: {\n          font: \"12px 'Roboto', 'sans-serif'\",\n        },\n        ticks: {\n          fontFamily: \"'Roboto', 'sans-serif'\",\n        },\n      };\n      options = Chart.helpers.merge(options, this.data.options);\n      options.scales.xAxes[0].ticks.callback = this._formatTickValue;\n      if (this.data.type === \"timeline\") {\n        this.set(\"isTimeline\", true);\n        if (this.data.colors !== undefined) {\n          this._colorFunc = this.constructor.getColorGenerator(\n            this.data.colors.staticColors,\n            this.data.colors.staticColorIndex\n          );\n        }\n        if (this._colorFunc !== undefined) {\n          options.elements.colorFunction = this._colorFunc;\n        }\n        if (data.datasets.length === 1) {\n          if (options.scales.yAxes[0].ticks) {\n            options.scales.yAxes[0].ticks.display = false;\n          } else {\n            options.scales.yAxes[0].ticks = { display: false };\n          }\n          if (options.scales.yAxes[0].gridLines) {\n            options.scales.yAxes[0].gridLines.display = false;\n          } else {\n            options.scales.yAxes[0].gridLines = { display: false };\n          }\n        }\n        this.$.chartTarget.style.height = \"50px\";\n      } else {\n        this.$.chartTarget.style.height = \"160px\";\n      }\n      const chartData = {\n        type: this.data.type,\n        data: this.data.data,\n        options: options,\n        plugins: plugins,\n      };\n      // Async resize after dom update\n      this._chart = new this.ChartClass(ctx, chartData);\n      if (this.isTimeline !== true && this.data.legend === true) {\n        this._drawLegend();\n      }\n      this.resizeChart();\n    }\n  }\n\n  resizeChart() {\n    if (!this._chart) return;\n    // Chart not ready\n    if (this._resizeTimer === undefined) {\n      this._resizeTimer = setInterval(this.resizeChart.bind(this), 10);\n      return;\n    }\n\n    clearInterval(this._resizeTimer);\n    this._resizeTimer = undefined;\n\n    this._resizeChart();\n  }\n\n  _resizeChart() {\n    const chartTarget = this.$.chartTarget;\n\n    const options = this.data;\n    const data = options.data;\n\n    if (data.datasets.length === 0) {\n      return;\n    }\n\n    if (!this.isTimeline) {\n      this._chart.resize();\n      return;\n    }\n\n    // Recalculate chart height for Timeline chart\n    const areaTop = this._chart.chartArea.top;\n    const areaBot = this._chart.chartArea.bottom;\n    const height1 = this._chart.canvas.clientHeight;\n    if (areaBot > 0) {\n      this._axisHeight = height1 - areaBot + areaTop;\n    }\n\n    if (!this._axisHeight) {\n      chartTarget.style.height = \"50px\";\n      this._chart.resize();\n      this.resizeChart();\n      return;\n    }\n    if (this._axisHeight) {\n      const cnt = data.datasets.length;\n      const targetHeight = 30 * cnt + this._axisHeight + \"px\";\n      if (chartTarget.style.height !== targetHeight) {\n        chartTarget.style.height = targetHeight;\n      }\n      this._chart.resize();\n    }\n  }\n\n  // Get HSL distributed color list\n  static getColorList(count) {\n    let processL = false;\n    if (count > 10) {\n      processL = true;\n      count = Math.ceil(count / 2);\n    }\n    const h1 = 360 / count;\n    const result = [];\n    for (let loopI = 0; loopI < count; loopI++) {\n      result[loopI] = Color().hsl(h1 * loopI, 80, 38);\n      if (processL) {\n        result[loopI + count] = Color().hsl(h1 * loopI, 80, 62);\n      }\n    }\n    return result;\n  }\n\n  static getColorGenerator(staticColors, startIndex) {\n    // Known colors for static data,\n    // should add for very common state string manually.\n    // Palette modified from http://google.github.io/palette.js/ mpn65, Apache 2.0\n    const palette = [\n      \"ff0029\",\n      \"66a61e\",\n      \"377eb8\",\n      \"984ea3\",\n      \"00d2d5\",\n      \"ff7f00\",\n      \"af8d00\",\n      \"7f80cd\",\n      \"b3e900\",\n      \"c42e60\",\n      \"a65628\",\n      \"f781bf\",\n      \"8dd3c7\",\n      \"bebada\",\n      \"fb8072\",\n      \"80b1d3\",\n      \"fdb462\",\n      \"fccde5\",\n      \"bc80bd\",\n      \"ffed6f\",\n      \"c4eaff\",\n      \"cf8c00\",\n      \"1b9e77\",\n      \"d95f02\",\n      \"e7298a\",\n      \"e6ab02\",\n      \"a6761d\",\n      \"0097ff\",\n      \"00d067\",\n      \"f43600\",\n      \"4ba93b\",\n      \"5779bb\",\n      \"927acc\",\n      \"97ee3f\",\n      \"bf3947\",\n      \"9f5b00\",\n      \"f48758\",\n      \"8caed6\",\n      \"f2b94f\",\n      \"eff26e\",\n      \"e43872\",\n      \"d9b100\",\n      \"9d7a00\",\n      \"698cff\",\n      \"d9d9d9\",\n      \"00d27e\",\n      \"d06800\",\n      \"009f82\",\n      \"c49200\",\n      \"cbe8ff\",\n      \"fecddf\",\n      \"c27eb6\",\n      \"8cd2ce\",\n      \"c4b8d9\",\n      \"f883b0\",\n      \"a49100\",\n      \"f48800\",\n      \"27d0df\",\n      \"a04a9b\",\n    ];\n    function getColorIndex(idx) {\n      // Reuse the color if index too large.\n      return Color(\"#\" + palette[idx % palette.length]);\n    }\n    const colorDict = {};\n    let colorIndex = 0;\n    if (startIndex > 0) colorIndex = startIndex;\n    if (staticColors) {\n      Object.keys(staticColors).forEach((c) => {\n        const c1 = staticColors[c];\n        if (isFinite(c1)) {\n          colorDict[c.toLowerCase()] = getColorIndex(c1);\n        } else {\n          colorDict[c.toLowerCase()] = Color(staticColors[c]);\n        }\n      });\n    }\n    // Custom color assign\n    function getColor(__, data) {\n      let ret;\n      const name = data[3];\n      if (name === null) return Color().hsl(0, 40, 38);\n      if (name === undefined) return Color().hsl(120, 40, 38);\n      const name1 = name.toLowerCase();\n      if (ret === undefined) {\n        ret = colorDict[name1];\n      }\n      if (ret === undefined) {\n        ret = getColorIndex(colorIndex);\n        colorIndex++;\n        colorDict[name1] = ret;\n      }\n      return ret;\n    }\n    return getColor;\n  }\n}\ncustomElements.define(\"ha-chart-base\", HaChartBase);\n","import \"@polymer/polymer/lib/utils/debounce\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"./entity/ha-chart-base\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\nimport formatDateTime from \"../common/datetime/format_date_time\";\n\nclass StateHistoryChartLine extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          overflow: hidden;\n          height: 0;\n          transition: height 0.3s ease-in-out;\n        }\n      </style>\n      <ha-chart-base\n        id=\"chart\"\n        data=\"[[chartData]]\"\n        identifier=\"[[identifier]]\"\n        rendered=\"{{rendered}}\"\n      ></ha-chart-base>\n    `;\n  }\n\n  static get properties() {\n    return {\n      chartData: Object,\n      data: Object,\n      names: Object,\n      unit: String,\n      identifier: String,\n\n      isSingleDevice: {\n        type: Boolean,\n        value: false,\n      },\n\n      endTime: Object,\n      rendered: {\n        type: Boolean,\n        value: false,\n        observer: \"_onRenderedChanged\",\n      },\n    };\n  }\n\n  static get observers() {\n    return [\"dataChanged(data, endTime, isSingleDevice)\"];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._isAttached = true;\n    this.drawChart();\n  }\n\n  dataChanged() {\n    this.drawChart();\n  }\n\n  _onRenderedChanged(rendered) {\n    if (rendered) this.animateHeight();\n  }\n\n  animateHeight() {\n    requestAnimationFrame(() =>\n      requestAnimationFrame(() => {\n        this.style.height = this.$.chart.scrollHeight + \"px\";\n      })\n    );\n  }\n\n  drawChart() {\n    const unit = this.unit;\n    const deviceStates = this.data;\n    const datasets = [];\n    let endTime;\n\n    if (!this._isAttached) {\n      return;\n    }\n\n    if (deviceStates.length === 0) {\n      return;\n    }\n\n    function safeParseFloat(value) {\n      const parsed = parseFloat(value);\n      return isFinite(parsed) ? parsed : null;\n    }\n\n    endTime =\n      this.endTime ||\n      // Get the highest date from the last date of each device\n      new Date(\n        Math.max.apply(\n          null,\n          deviceStates.map(\n            (devSts) =>\n              new Date(devSts.states[devSts.states.length - 1].last_changed)\n          )\n        )\n      );\n    if (endTime > new Date()) {\n      endTime = new Date();\n    }\n\n    const names = this.names || {};\n    deviceStates.forEach((states) => {\n      const domain = states.domain;\n      const name = names[states.entity_id] || states.name;\n      // array containing [value1, value2, etc]\n      let prevValues;\n      const data = [];\n\n      function pushData(timestamp, datavalues) {\n        if (!datavalues) return;\n        if (timestamp > endTime) {\n          // Drop datapoints that are after the requested endTime. This could happen if\n          // endTime is \"now\" and client time is not in sync with server time.\n          return;\n        }\n        data.forEach((d, i) => {\n          d.data.push({ x: timestamp, y: datavalues[i] });\n        });\n        prevValues = datavalues;\n      }\n\n      function addColumn(nameY, step, fill) {\n        let dataFill = false;\n        let dataStep = false;\n        if (fill) {\n          dataFill = \"origin\";\n        }\n        if (step) {\n          dataStep = \"before\";\n        }\n        data.push({\n          label: nameY,\n          fill: dataFill,\n          steppedLine: dataStep,\n          pointRadius: 0,\n          data: [],\n          unitText: unit,\n        });\n      }\n\n      if (\n        domain === \"thermostat\" ||\n        domain === \"climate\" ||\n        domain === \"water_heater\"\n      ) {\n        // We differentiate between thermostats that have a target temperature\n        // range versus ones that have just a target temperature\n\n        // Using step chart by step-before so manually interpolation not needed.\n        const hasTargetRange = states.states.some(\n          (state) =>\n            state.attributes &&\n            state.attributes.target_temp_high !==\n              state.attributes.target_temp_low\n        );\n        const hasHeat = states.states.some((state) => state.state === \"heat\");\n        const hasCool = states.states.some((state) => state.state === \"cool\");\n\n        addColumn(name + \" current temperature\", true);\n        if (hasHeat) {\n          addColumn(name + \" heating\", true, true);\n          // The \"heating\" series uses steppedArea to shade the area below the current\n          // temperature when the thermostat is calling for heat.\n        }\n        if (hasCool) {\n          addColumn(name + \" cooling\", true, true);\n          // The \"cooling\" series uses steppedArea to shade the area below the current\n          // temperature when the thermostat is calling for heat.\n        }\n\n        if (hasTargetRange) {\n          addColumn(name + \" target temperature high\", true);\n          addColumn(name + \" target temperature low\", true);\n        } else {\n          addColumn(name + \" target temperature\", true);\n        }\n\n        states.states.forEach((state) => {\n          if (!state.attributes) return;\n          const curTemp = safeParseFloat(state.attributes.current_temperature);\n          const series = [curTemp];\n          if (hasHeat) {\n            series.push(state.state === \"heat\" ? curTemp : null);\n          }\n          if (hasCool) {\n            series.push(state.state === \"cool\" ? curTemp : null);\n          }\n          if (hasTargetRange) {\n            const targetHigh = safeParseFloat(\n              state.attributes.target_temp_high\n            );\n            const targetLow = safeParseFloat(state.attributes.target_temp_low);\n            series.push(targetHigh, targetLow);\n            pushData(new Date(state.last_changed), series);\n          } else {\n            const target = safeParseFloat(state.attributes.temperature);\n            series.push(target);\n            pushData(new Date(state.last_changed), series);\n          }\n        });\n      } else {\n        // Only disable interpolation for sensors\n        const isStep = domain === \"sensor\";\n        addColumn(name, isStep);\n\n        let lastValue = null;\n        let lastDate = null;\n        let lastNullDate = null;\n\n        // Process chart data.\n        // When state is `unknown`, calculate the value and break the line.\n        states.states.forEach((state) => {\n          const value = safeParseFloat(state.state);\n          const date = new Date(state.last_changed);\n          if (value !== null && lastNullDate !== null) {\n            const dateTime = date.getTime();\n            const lastNullDateTime = lastNullDate.getTime();\n            const lastDateTime = lastDate.getTime();\n            const tmpValue =\n              (value - lastValue) *\n                ((lastNullDateTime - lastDateTime) /\n                  (dateTime - lastDateTime)) +\n              lastValue;\n            pushData(lastNullDate, [tmpValue]);\n            pushData(new Date(lastNullDateTime + 1), [null]);\n            pushData(date, [value]);\n            lastDate = date;\n            lastValue = value;\n            lastNullDate = null;\n          } else if (value !== null && lastNullDate === null) {\n            pushData(date, [value]);\n            lastDate = date;\n            lastValue = value;\n          } else if (\n            value === null &&\n            lastNullDate === null &&\n            lastValue !== null\n          ) {\n            lastNullDate = date;\n          }\n        });\n      }\n\n      // Add an entry for final values\n      pushData(endTime, prevValues, false);\n\n      // Concat two arrays\n      Array.prototype.push.apply(datasets, data);\n    });\n\n    const formatTooltipTitle = (items, data) => {\n      const item = items[0];\n      const date = data.datasets[item.datasetIndex].data[item.index].x;\n\n      return formatDateTime(date, this.hass.language);\n    };\n\n    const chartOptions = {\n      type: \"line\",\n      unit: unit,\n      legend: !this.isSingleDevice,\n      options: {\n        scales: {\n          xAxes: [\n            {\n              type: \"time\",\n              ticks: {\n                major: {\n                  fontStyle: \"bold\",\n                },\n              },\n            },\n          ],\n          yAxes: [\n            {\n              ticks: {\n                maxTicksLimit: 7,\n              },\n            },\n          ],\n        },\n        tooltips: {\n          mode: \"neareach\",\n          callbacks: {\n            title: formatTooltipTitle,\n          },\n        },\n        hover: {\n          mode: \"neareach\",\n        },\n        layout: {\n          padding: {\n            top: 5,\n          },\n        },\n        elements: {\n          line: {\n            tension: 0.1,\n            pointRadius: 0,\n            borderWidth: 1.5,\n          },\n          point: {\n            hitRadius: 5,\n          },\n        },\n        plugins: {\n          filler: {\n            propagate: true,\n          },\n        },\n      },\n      data: {\n        labels: [],\n        datasets: datasets,\n      },\n    };\n    this.chartData = chartOptions;\n  }\n}\ncustomElements.define(\"state-history-chart-line\", StateHistoryChartLine);\n","import \"@polymer/polymer/lib/utils/debounce\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\nimport \"./entity/ha-chart-base\";\n\nimport formatDateTime from \"../common/datetime/format_date_time\";\nimport { computeRTL } from \"../common/util/compute_rtl\";\n\nclass StateHistoryChartTimeline extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          opacity: 0;\n          transition: opacity 0.3s ease-in-out;\n        }\n        :host([rendered]) {\n          opacity: 1;\n        }\n\n        ha-chart-base {\n          direction: ltr;\n        }\n      </style>\n      <ha-chart-base\n        data=\"[[chartData]]\"\n        rendered=\"{{rendered}}\"\n        rtl=\"{{rtl}}\"\n      ></ha-chart-base>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n      chartData: Object,\n      data: {\n        type: Object,\n        observer: \"dataChanged\",\n      },\n      names: Object,\n      noSingle: Boolean,\n      endTime: Date,\n      rendered: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true,\n      },\n      rtl: {\n        reflectToAttribute: true,\n        computed: \"_computeRTL(hass)\",\n      },\n    };\n  }\n\n  static get observers() {\n    return [\"dataChanged(data, endTime, localize, language)\"];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._isAttached = true;\n    this.drawChart();\n  }\n\n  dataChanged() {\n    this.drawChart();\n  }\n\n  drawChart() {\n    const staticColors = {\n      on: 1,\n      off: 0,\n      unavailable: \"#a0a0a0\",\n      unknown: \"#606060\",\n      idle: 2,\n    };\n    let stateHistory = this.data;\n\n    if (!this._isAttached) {\n      return;\n    }\n\n    if (!stateHistory) {\n      stateHistory = [];\n    }\n\n    const startTime = new Date(\n      stateHistory.reduce(\n        (minTime, stateInfo) =>\n          Math.min(minTime, new Date(stateInfo.data[0].last_changed)),\n        new Date()\n      )\n    );\n\n    // end time is Math.max(startTime, last_event)\n    let endTime =\n      this.endTime ||\n      new Date(\n        stateHistory.reduce(\n          (maxTime, stateInfo) =>\n            Math.max(\n              maxTime,\n              new Date(stateInfo.data[stateInfo.data.length - 1].last_changed)\n            ),\n          startTime\n        )\n      );\n\n    if (endTime > new Date()) {\n      endTime = new Date();\n    }\n\n    const labels = [];\n    const datasets = [];\n    // stateHistory is a list of lists of sorted state objects\n    const names = this.names || {};\n    stateHistory.forEach((stateInfo) => {\n      let newLastChanged;\n      let prevState = null;\n      let locState = null;\n      let prevLastChanged = startTime;\n      const entityDisplay = names[stateInfo.entity_id] || stateInfo.name;\n\n      const dataRow = [];\n      stateInfo.data.forEach((state) => {\n        let newState = state.state;\n        const timeStamp = new Date(state.last_changed);\n        if (newState === undefined || newState === \"\") {\n          newState = null;\n        }\n        if (timeStamp > endTime) {\n          // Drop datapoints that are after the requested endTime. This could happen if\n          // endTime is 'now' and client time is not in sync with server time.\n          return;\n        }\n        if (prevState !== null && newState !== prevState) {\n          newLastChanged = new Date(state.last_changed);\n\n          dataRow.push([prevLastChanged, newLastChanged, locState, prevState]);\n\n          prevState = newState;\n          locState = state.state_localize;\n          prevLastChanged = newLastChanged;\n        } else if (prevState === null) {\n          prevState = newState;\n          locState = state.state_localize;\n          prevLastChanged = new Date(state.last_changed);\n        }\n      });\n\n      if (prevState !== null) {\n        dataRow.push([prevLastChanged, endTime, locState, prevState]);\n      }\n      datasets.push({ data: dataRow });\n      labels.push(entityDisplay);\n    });\n\n    const formatTooltipLabel = (item, data) => {\n      const values = data.datasets[item.datasetIndex].data[item.index];\n\n      const start = formatDateTime(values[0], this.hass.language);\n      const end = formatDateTime(values[1], this.hass.language);\n      const state = values[2];\n\n      return [state, start, end];\n    };\n\n    const chartOptions = {\n      type: \"timeline\",\n      options: {\n        tooltips: {\n          callbacks: {\n            label: formatTooltipLabel,\n          },\n        },\n        scales: {\n          xAxes: [\n            {\n              ticks: {\n                major: {\n                  fontStyle: \"bold\",\n                },\n              },\n            },\n          ],\n          yAxes: [\n            {\n              afterSetDimensions: (yaxe) => {\n                yaxe.maxWidth = yaxe.chart.width * 0.18;\n              },\n              position: this._computeRTL ? \"right\" : \"left\",\n            },\n          ],\n        },\n      },\n      data: {\n        labels: labels,\n        datasets: datasets,\n      },\n      colors: {\n        staticColors: staticColors,\n        staticColorIndex: 3,\n      },\n    };\n    this.chartData = chartOptions;\n  }\n\n  _computeRTL(hass) {\n    return computeRTL(hass);\n  }\n}\ncustomElements.define(\n  \"state-history-chart-timeline\",\n  StateHistoryChartTimeline\n);\n","import \"@polymer/paper-spinner/paper-spinner\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"./state-history-chart-line\";\nimport \"./state-history-chart-timeline\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\nclass StateHistoryCharts extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          /* height of single timeline chart = 58px */\n          min-height: 58px;\n        }\n        .info {\n          text-align: center;\n          line-height: 58px;\n          color: var(--secondary-text-color);\n        }\n      </style>\n      <template\n        is=\"dom-if\"\n        class=\"info\"\n        if=\"[[_computeIsLoading(isLoadingData)]]\"\n      >\n        <div class=\"info\">\n          [[localize('ui.components.history_charts.loading_history')]]\n        </div>\n      </template>\n\n      <template\n        is=\"dom-if\"\n        class=\"info\"\n        if=\"[[_computeIsEmpty(isLoadingData, historyData)]]\"\n      >\n        <div class=\"info\">\n          [[localize('ui.components.history_charts.no_history_found')]]\n        </div>\n      </template>\n\n      <template is=\"dom-if\" if=\"[[historyData.timeline.length]]\">\n        <state-history-chart-timeline\n          hass=\"[[hass]]\"\n          data=\"[[historyData.timeline]]\"\n          end-time=\"[[_computeEndTime(endTime, upToNow, historyData)]]\"\n          no-single=\"[[noSingle]]\"\n          names=\"[[names]]\"\n        ></state-history-chart-timeline>\n      </template>\n\n      <template is=\"dom-repeat\" items=\"[[historyData.line]]\">\n        <state-history-chart-line\n          hass=\"[[hass]]\"\n          unit=\"[[item.unit]]\"\n          data=\"[[item.data]]\"\n          identifier=\"[[item.identifier]]\"\n          is-single-device=\"[[_computeIsSingleLineChart(item.data, noSingle)]]\"\n          end-time=\"[[_computeEndTime(endTime, upToNow, historyData)]]\"\n          names=\"[[names]]\"\n        ></state-history-chart-line>\n      </template>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      historyData: {\n        type: Object,\n        value: null,\n      },\n      names: Object,\n\n      isLoadingData: Boolean,\n\n      endTime: {\n        type: Object,\n      },\n\n      upToNow: Boolean,\n      noSingle: Boolean,\n    };\n  }\n\n  _computeIsSingleLineChart(data, noSingle) {\n    return !noSingle && data && data.length === 1;\n  }\n\n  _computeIsEmpty(isLoadingData, historyData) {\n    const historyDataEmpty =\n      !historyData ||\n      !historyData.timeline ||\n      !historyData.line ||\n      (historyData.timeline.length === 0 && historyData.line.length === 0);\n    return !isLoadingData && historyDataEmpty;\n  }\n\n  _computeIsLoading(isLoading) {\n    return isLoading && !this.historyData;\n  }\n\n  _computeEndTime(endTime, upToNow) {\n    // We don't really care about the value of historyData, but if it change we want to update\n    // endTime.\n    return upToNow ? new Date() : endTime;\n  }\n}\ncustomElements.define(\"state-history-charts\", StateHistoryCharts);\n","import {\n  computeHistory,\n  fetchRecent,\n  HistoryResult,\n  TimelineEntity,\n  LineChartUnit,\n} from \"./history\";\nimport { HomeAssistant } from \"../types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\n\ninterface CacheConfig {\n  refresh: number;\n  cacheKey: string;\n  hoursToShow: number;\n}\n\ninterface CachedResults {\n  prom: Promise<HistoryResult>;\n  startTime: Date;\n  endTime: Date;\n  language: string;\n  data: HistoryResult;\n}\n\n// This is a different interface, a different cache :(\ninterface RecentCacheResults {\n  created: number;\n  language: string;\n  data: Promise<HistoryResult>;\n}\n\nconst RECENT_THRESHOLD = 60000; // 1 minute\nconst RECENT_CACHE: { [cacheKey: string]: RecentCacheResults } = {};\nconst stateHistoryCache: { [cacheKey: string]: CachedResults } = {};\n\n// Cached type 1 unction. Without cache config.\nexport const getRecent = (\n  hass: HomeAssistant,\n  entityId: string,\n  startTime: Date,\n  endTime: Date,\n  localize: LocalizeFunc,\n  language: string\n) => {\n  const cacheKey = entityId;\n  const cache = RECENT_CACHE[cacheKey];\n\n  if (\n    cache &&\n    Date.now() - cache.created < RECENT_THRESHOLD &&\n    cache.language === language\n  ) {\n    return cache.data;\n  }\n\n  const prom = fetchRecent(hass, entityId, startTime, endTime).then(\n    (stateHistory) => computeHistory(hass, stateHistory, localize, language),\n    (err) => {\n      delete RECENT_CACHE[entityId];\n      throw err;\n    }\n  );\n\n  RECENT_CACHE[cacheKey] = {\n    created: Date.now(),\n    language,\n    data: prom,\n  };\n  return prom;\n};\n\n// Cache type 2 functionality\nfunction getEmptyCache(\n  language: string,\n  startTime: Date,\n  endTime: Date\n): CachedResults {\n  return {\n    prom: Promise.resolve({ line: [], timeline: [] }),\n    language,\n    startTime,\n    endTime,\n    data: { line: [], timeline: [] },\n  };\n}\n\nexport const getRecentWithCache = (\n  hass: HomeAssistant,\n  entityId: string,\n  cacheConfig: CacheConfig,\n  localize: LocalizeFunc,\n  language: string\n) => {\n  const cacheKey = cacheConfig.cacheKey;\n  const endTime = new Date();\n  const startTime = new Date(endTime);\n  startTime.setHours(startTime.getHours() - cacheConfig.hoursToShow);\n  let toFetchStartTime = startTime;\n  let appendingToCache = false;\n\n  let cache = stateHistoryCache[cacheKey];\n  if (\n    cache &&\n    toFetchStartTime >= cache.startTime &&\n    toFetchStartTime <= cache.endTime &&\n    cache.language === language\n  ) {\n    toFetchStartTime = cache.endTime;\n    appendingToCache = true;\n    // This pretty much never happens as endTime is usually set to now\n    if (endTime <= cache.endTime) {\n      return cache.prom;\n    }\n  } else {\n    cache = stateHistoryCache[cacheKey] = getEmptyCache(\n      language,\n      startTime,\n      endTime\n    );\n  }\n\n  const curCacheProm = cache.prom;\n\n  const genProm = async () => {\n    let fetchedHistory: HassEntity[][];\n\n    try {\n      const results = await Promise.all([\n        curCacheProm,\n        fetchRecent(\n          hass,\n          entityId,\n          toFetchStartTime,\n          endTime,\n          appendingToCache\n        ),\n      ]);\n      fetchedHistory = results[1];\n    } catch (err) {\n      delete stateHistoryCache[cacheKey];\n      throw err;\n    }\n    const stateHistory = computeHistory(\n      hass,\n      fetchedHistory,\n      localize,\n      language\n    );\n    if (appendingToCache) {\n      mergeLine(stateHistory.line, cache.data.line);\n      mergeTimeline(stateHistory.timeline, cache.data.timeline);\n      pruneStartTime(startTime, cache.data);\n    } else {\n      cache.data = stateHistory;\n    }\n    return cache.data;\n  };\n\n  cache.prom = genProm();\n  cache.startTime = startTime;\n  cache.endTime = endTime;\n  return cache.prom;\n};\n\nconst mergeLine = (\n  historyLines: LineChartUnit[],\n  cacheLines: LineChartUnit[]\n) => {\n  historyLines.forEach((line) => {\n    const unit = line.unit;\n    const oldLine = cacheLines.find((cacheLine) => cacheLine.unit === unit);\n    if (oldLine) {\n      line.data.forEach((entity) => {\n        const oldEntity = oldLine.data.find(\n          (cacheEntity) => entity.entity_id === cacheEntity.entity_id\n        );\n        if (oldEntity) {\n          oldEntity.states = oldEntity.states.concat(entity.states);\n        } else {\n          oldLine.data.push(entity);\n        }\n      });\n    } else {\n      cacheLines.push(line);\n    }\n  });\n};\n\nconst mergeTimeline = (\n  historyTimelines: TimelineEntity[],\n  cacheTimelines: TimelineEntity[]\n) => {\n  historyTimelines.forEach((timeline) => {\n    const oldTimeline = cacheTimelines.find(\n      (cacheTimeline) => cacheTimeline.entity_id === timeline.entity_id\n    );\n    if (oldTimeline) {\n      oldTimeline.data = oldTimeline.data.concat(timeline.data);\n    } else {\n      cacheTimelines.push(timeline);\n    }\n  });\n};\n\nconst pruneArray = (originalStartTime: Date, arr) => {\n  if (arr.length === 0) {\n    return arr;\n  }\n  const changedAfterStartTime = arr.findIndex(\n    (state) => new Date(state.last_changed) > originalStartTime\n  );\n  if (changedAfterStartTime === 0) {\n    // If all changes happened after originalStartTime then we are done.\n    return arr;\n  }\n\n  // If all changes happened at or before originalStartTime. Use last index.\n  const updateIndex =\n    changedAfterStartTime === -1 ? arr.length - 1 : changedAfterStartTime - 1;\n  arr[updateIndex].last_changed = originalStartTime;\n  return arr.slice(updateIndex);\n};\n\nconst pruneStartTime = (originalStartTime: Date, cacheData: HistoryResult) => {\n  cacheData.line.forEach((line) => {\n    line.data.forEach((entity) => {\n      entity.states = pruneArray(originalStartTime, entity.states);\n    });\n  });\n\n  cacheData.timeline.forEach((timeline) => {\n    timeline.data = pruneArray(originalStartTime, timeline.data);\n  });\n};\n","import { timeOut } from \"@polymer/polymer/lib/utils/async\";\nimport { Debouncer } from \"@polymer/polymer/lib/utils/debounce\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\nimport { computeHistory, fetchDate } from \"./history\";\nimport { getRecent, getRecentWithCache } from \"./cached-history\";\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaStateHistoryData extends LocalizeMixin(PolymerElement) {\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n        observer: \"hassChanged\",\n      },\n\n      filterType: String,\n\n      cacheConfig: Object,\n\n      startTime: Date,\n      endTime: Date,\n\n      entityId: String,\n\n      isLoading: {\n        type: Boolean,\n        value: true,\n        readOnly: true,\n        notify: true,\n      },\n\n      data: {\n        type: Object,\n        value: null,\n        readOnly: true,\n        notify: true,\n      },\n    };\n  }\n\n  static get observers() {\n    return [\n      \"filterChangedDebouncer(filterType, entityId, startTime, endTime, cacheConfig, localize)\",\n    ];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.filterChangedDebouncer(\n      this.filterType,\n      this.entityId,\n      this.startTime,\n      this.endTime,\n      this.cacheConfig,\n      this.localize\n    );\n  }\n\n  disconnectedCallback() {\n    if (this._refreshTimeoutId) {\n      window.clearInterval(this._refreshTimeoutId);\n      this._refreshTimeoutId = null;\n    }\n    super.disconnectedCallback();\n  }\n\n  hassChanged(newHass, oldHass) {\n    if (!oldHass && !this._madeFirstCall) {\n      this.filterChangedDebouncer(\n        this.filterType,\n        this.entityId,\n        this.startTime,\n        this.endTime,\n        this.cacheConfig,\n        this.localize\n      );\n    }\n  }\n\n  filterChangedDebouncer(...args) {\n    this._debounceFilterChanged = Debouncer.debounce(\n      this._debounceFilterChanged,\n      timeOut.after(0),\n      () => {\n        this.filterChanged(...args);\n      }\n    );\n  }\n\n  filterChanged(\n    filterType,\n    entityId,\n    startTime,\n    endTime,\n    cacheConfig,\n    localize\n  ) {\n    if (!this.hass) {\n      return;\n    }\n    if (cacheConfig && !cacheConfig.cacheKey) {\n      return;\n    }\n    if (!localize) {\n      return;\n    }\n    this._madeFirstCall = true;\n    const language = this.hass.language;\n    let data;\n\n    if (filterType === \"date\") {\n      if (!startTime || !endTime) return;\n\n      data = fetchDate(this.hass, startTime, endTime).then((dateHistory) =>\n        computeHistory(this.hass, dateHistory, localize, language)\n      );\n    } else if (filterType === \"recent-entity\") {\n      if (!entityId) return;\n      if (cacheConfig) {\n        data = this.getRecentWithCacheRefresh(\n          entityId,\n          cacheConfig,\n          localize,\n          language\n        );\n      } else {\n        data = getRecent(\n          this.hass,\n          entityId,\n          startTime,\n          endTime,\n          localize,\n          language\n        );\n      }\n    } else {\n      return;\n    }\n    this._setIsLoading(true);\n\n    data.then((stateHistory) => {\n      this._setData(stateHistory);\n      this._setIsLoading(false);\n    });\n  }\n\n  getRecentWithCacheRefresh(entityId, cacheConfig, localize, language) {\n    if (this._refreshTimeoutId) {\n      window.clearInterval(this._refreshTimeoutId);\n      this._refreshTimeoutId = null;\n    }\n    if (cacheConfig.refresh) {\n      this._refreshTimeoutId = window.setInterval(() => {\n        getRecentWithCache(\n          this.hass,\n          entityId,\n          cacheConfig,\n          localize,\n          language\n        ).then((stateHistory) => {\n          this._setData(Object.assign({}, stateHistory));\n        });\n      }, cacheConfig.refresh * 1000);\n    }\n    return getRecentWithCache(\n      this.hass,\n      entityId,\n      cacheConfig,\n      localize,\n      language\n    );\n  }\n}\ncustomElements.define(\"ha-state-history-data\", HaStateHistoryData);\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport durationToSeconds from \"../datetime/duration_to_seconds\";\n\nexport default function timerTimeRemaining(stateObj: HassEntity) {\n  let timeRemaining = durationToSeconds(stateObj.attributes.remaining);\n\n  if (stateObj.state === \"active\") {\n    const now = new Date().getTime();\n    const madeActive = new Date(stateObj.last_changed).getTime();\n    timeRemaining = Math.max(timeRemaining - (now - madeActive) / 1000, 0);\n  }\n\n  return timeRemaining;\n}\n","export default function durationToSeconds(duration: string): number {\n  const parts = duration.split(\":\").map(Number);\n  return parts[0] * 3600 + parts[1] * 60 + parts[2];\n}\n","import {\n  LitElement,\n  html,\n  PropertyValues,\n  TemplateResult,\n  css,\n  CSSResult,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { HomeAssistant } from \"../../types\";\n\nimport computeStateDomain from \"../../common/entity/compute_state_domain\";\nimport computeStateName from \"../../common/entity/compute_state_name\";\nimport domainIcon from \"../../common/entity/domain_icon\";\nimport stateIcon from \"../../common/entity/state_icon\";\nimport timerTimeRemaining from \"../../common/entity/timer_time_remaining\";\nimport secondsToDuration from \"../../common/datetime/seconds_to_duration\";\n\nimport \"../ha-label-badge\";\n\n@customElement(\"ha-state-label-badge\")\nexport class HaStateLabelBadge extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public state?: HassEntity;\n\n  @property() private _timerTimeRemaining?: number;\n\n  private _connected?: boolean;\n\n  private _updateRemaining?: number;\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._connected = true;\n    this.startInterval(this.state);\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._connected = false;\n    this.clearInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    const state = this.state;\n\n    if (!state) {\n      return html`\n        <ha-label-badge\n          class=\"warning\"\n          label=\"${this.hass!.localize(\"state_badge.default.error\")}\"\n          icon=\"hass:alert\"\n          description=\"${this.hass!.localize(\n            \"state_badge.default.entity_not_found\"\n          )}\"\n        ></ha-label-badge>\n      `;\n    }\n\n    const domain = computeStateDomain(state);\n\n    return html`\n      <ha-label-badge\n        class=\"${classMap({\n          [domain]: true,\n          \"has-unit_of_measurement\": \"unit_of_measurement\" in state.attributes,\n        })}\"\n        .value=\"${this._computeValue(domain, state)}\"\n        .icon=\"${this._computeIcon(domain, state)}\"\n        .image=\"${state.attributes.entity_picture}\"\n        .label=\"${this._computeLabel(domain, state, this._timerTimeRemaining)}\"\n        .description=\"${computeStateName(state)}\"\n      ></ha-label-badge>\n    `;\n  }\n\n  protected firstUpdated(changedProperties: PropertyValues): void {\n    super.firstUpdated(changedProperties);\n    this.addEventListener(\"click\", (ev) => {\n      ev.stopPropagation();\n      if (this.state) {\n        fireEvent(this, \"hass-more-info\", { entityId: this.state.entity_id });\n      }\n    });\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    if (this._connected && changedProperties.has(\"state\")) {\n      this.startInterval(this.state);\n    }\n  }\n\n  private _computeValue(domain: string, state: HassEntity) {\n    switch (domain) {\n      case \"binary_sensor\":\n      case \"device_tracker\":\n      case \"person\":\n      case \"updater\":\n      case \"sun\":\n      case \"alarm_control_panel\":\n      case \"timer\":\n        return null;\n      case \"sensor\":\n      default:\n        return state.state === \"unknown\"\n          ? \"-\"\n          : this.hass!.localize(`component.${domain}.state.${state.state}`) ||\n              state.state;\n    }\n  }\n\n  private _computeIcon(domain: string, state: HassEntity) {\n    if (state.state === \"unavailable\") {\n      return null;\n    }\n    switch (domain) {\n      case \"alarm_control_panel\":\n        if (state.state === \"pending\") {\n          return \"hass:clock-fast\";\n        }\n        if (state.state === \"armed_away\") {\n          return \"hass:nature\";\n        }\n        if (state.state === \"armed_home\") {\n          return \"hass:home-variant\";\n        }\n        if (state.state === \"armed_night\") {\n          return \"hass:weather-night\";\n        }\n        if (state.state === \"armed_custom_bypass\") {\n          return \"hass:shield-home\";\n        }\n        if (state.state === \"triggered\") {\n          return \"hass:alert-circle\";\n        }\n        // state == 'disarmed'\n        return domainIcon(domain, state.state);\n      case \"binary_sensor\":\n      case \"device_tracker\":\n      case \"updater\":\n      case \"person\":\n        return stateIcon(state);\n      case \"sun\":\n        return state.state === \"above_horizon\"\n          ? domainIcon(domain)\n          : \"hass:brightness-3\";\n      case \"timer\":\n        return state.state === \"active\" ? \"hass:timer\" : \"hass:timer-off\";\n      default:\n        return null;\n    }\n  }\n\n  private _computeLabel(domain, state, _timerTimeRemaining) {\n    if (\n      state.state === \"unavailable\" ||\n      [\"device_tracker\", \"alarm_control_panel\", \"person\"].includes(domain)\n    ) {\n      // Localize the state with a special state_badge namespace, which has variations of\n      // the state translations that are truncated to fit within the badge label. Translations\n      // are only added for device_tracker, alarm_control_panel and person.\n      return (\n        this.hass!.localize(`state_badge.${domain}.${state.state}`) ||\n        this.hass!.localize(`state_badge.default.${state.state}`) ||\n        state.state\n      );\n    }\n    if (domain === \"timer\") {\n      return secondsToDuration(_timerTimeRemaining);\n    }\n    return state.attributes.unit_of_measurement || null;\n  }\n\n  private clearInterval() {\n    if (this._updateRemaining) {\n      clearInterval(this._updateRemaining);\n      this._updateRemaining = undefined;\n    }\n  }\n\n  private startInterval(stateObj) {\n    this.clearInterval();\n    if (stateObj && computeStateDomain(stateObj) === \"timer\") {\n      this.calculateTimerRemaining(stateObj);\n\n      if (stateObj.state === \"active\") {\n        this._updateRemaining = window.setInterval(\n          () => this.calculateTimerRemaining(this.state),\n          1000\n        );\n      }\n    }\n  }\n\n  private calculateTimerRemaining(stateObj) {\n    this._timerTimeRemaining = timerTimeRemaining(stateObj);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n\n      ha-label-badge {\n        --ha-label-badge-color: var(--label-badge-red, #df4c1e);\n      }\n      ha-label-badge.has-unit_of_measurement {\n        --ha-label-badge-label-text-transform: none;\n      }\n\n      ha-label-badge.binary_sensor,\n      ha-label-badge.updater {\n        --ha-label-badge-color: var(--label-badge-blue, #039be5);\n      }\n\n      .red {\n        --ha-label-badge-color: var(--label-badge-red, #df4c1e);\n      }\n\n      .blue {\n        --ha-label-badge-color: var(--label-badge-blue, #039be5);\n      }\n\n      .green {\n        --ha-label-badge-color: var(--label-badge-green, #0da035);\n      }\n\n      .yellow {\n        --ha-label-badge-color: var(--label-badge-yellow, #f4b400);\n      }\n\n      .grey {\n        --ha-label-badge-color: var(--label-badge-grey, var(--paper-grey-500));\n      }\n\n      .warning {\n        --ha-label-badge-color: var(--label-badge-yellow, #fce588);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-state-label-badge\": HaStateLabelBadge;\n  }\n}\n","const validEntityId = /^(\\w+)\\.(\\w+)$/;\nexport default (entityId: string) => validEntityId.test(entityId);\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaClimateState extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          white-space: nowrap;\n        }\n\n        .target {\n          color: var(--primary-text-color);\n        }\n\n        .current {\n          color: var(--secondary-text-color);\n        }\n\n        .state-label {\n          font-weight: bold;\n          text-transform: capitalize;\n        }\n\n        .unit {\n          display: inline-block;\n          direction: ltr;\n        }\n      </style>\n\n      <div class=\"target\">\n        <template is=\"dom-if\" if=\"[[_hasKnownState(stateObj.state)]]\">\n          <span class=\"state-label\"> [[_localizeState(stateObj.state)]] </span>\n        </template>\n        <div class=\"unit\">[[computeTarget(hass, stateObj)]]</div>\n      </div>\n\n      <template is=\"dom-if\" if=\"[[currentStatus]]\">\n        <div class=\"current\">\n          [[localize('ui.card.climate.currently')]]:\n          <div class=\"unit\">[[currentStatus]]</div>\n        </div>\n      </template>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      stateObj: Object,\n      currentStatus: {\n        type: String,\n        computed: \"computeCurrentStatus(hass, stateObj)\",\n      },\n    };\n  }\n\n  computeCurrentStatus(hass, stateObj) {\n    if (!hass || !stateObj) return null;\n    if (stateObj.attributes.current_temperature != null) {\n      return `${stateObj.attributes.current_temperature} ${\n        hass.config.unit_system.temperature\n      }`;\n    }\n    if (stateObj.attributes.current_humidity != null) {\n      return `${stateObj.attributes.current_humidity} %`;\n    }\n    return null;\n  }\n\n  computeTarget(hass, stateObj) {\n    if (!hass || !stateObj) return null;\n    // We're using \"!= null\" on purpose so that we match both null and undefined.\n    if (\n      stateObj.attributes.target_temp_low != null &&\n      stateObj.attributes.target_temp_high != null\n    ) {\n      return `${stateObj.attributes.target_temp_low} - ${\n        stateObj.attributes.target_temp_high\n      } ${hass.config.unit_system.temperature}`;\n    }\n    if (stateObj.attributes.temperature != null) {\n      return `${stateObj.attributes.temperature} ${\n        hass.config.unit_system.temperature\n      }`;\n    }\n    if (\n      stateObj.attributes.target_humidity_low != null &&\n      stateObj.attributes.target_humidity_high != null\n    ) {\n      return `${stateObj.attributes.target_humidity_low} - ${\n        stateObj.attributes.target_humidity_high\n      } %`;\n    }\n    if (stateObj.attributes.humidity != null) {\n      return `${stateObj.attributes.humidity} %`;\n    }\n\n    return \"\";\n  }\n\n  _hasKnownState(state) {\n    return state !== \"unknown\";\n  }\n\n  _localizeState(state) {\n    return this.localize(`state.climate.${state}`) || state;\n  }\n}\ncustomElements.define(\"ha-climate-state\", HaClimateState);\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport CoverEntity from \"../util/cover-model\";\n\nclass HaCoverControls extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        .state {\n          white-space: nowrap;\n        }\n        [invisible] {\n          visibility: hidden !important;\n        }\n      </style>\n\n      <div class=\"state\">\n        <paper-icon-button\n          icon=\"hass:arrow-up\"\n          on-click=\"onOpenTap\"\n          invisible$=\"[[!entityObj.supportsOpen]]\"\n          disabled=\"[[computeOpenDisabled(stateObj, entityObj)]]\"\n        ></paper-icon-button>\n        <paper-icon-button\n          icon=\"hass:stop\"\n          on-click=\"onStopTap\"\n          invisible$=\"[[!entityObj.supportsStop]]\"\n        ></paper-icon-button>\n        <paper-icon-button\n          icon=\"hass:arrow-down\"\n          on-click=\"onCloseTap\"\n          invisible$=\"[[!entityObj.supportsClose]]\"\n          disabled=\"[[computeClosedDisabled(stateObj, entityObj)]]\"\n        ></paper-icon-button>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n      stateObj: {\n        type: Object,\n      },\n      entityObj: {\n        type: Object,\n        computed: \"computeEntityObj(hass, stateObj)\",\n      },\n    };\n  }\n\n  computeEntityObj(hass, stateObj) {\n    return new CoverEntity(hass, stateObj);\n  }\n\n  computeOpenDisabled(stateObj, entityObj) {\n    var assumedState = stateObj.attributes.assumed_state === true;\n    return (entityObj.isFullyOpen || entityObj.isOpening) && !assumedState;\n  }\n\n  computeClosedDisabled(stateObj, entityObj) {\n    var assumedState = stateObj.attributes.assumed_state === true;\n    return (entityObj.isFullyClosed || entityObj.isClosing) && !assumedState;\n  }\n\n  onOpenTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.openCover();\n  }\n\n  onCloseTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.closeCover();\n  }\n\n  onStopTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.stopCover();\n  }\n}\n\ncustomElements.define(\"ha-cover-controls\", HaCoverControls);\n","/**\nAdapted from paper-time-input from\nhttps://github.com/ryanburns23/paper-time-input\nMIT Licensed. Copyright (c) 2017 Ryan Burns\n\n`<paper-time-input>` Polymer element to accept a time with paper-input & paper-dropdown-menu\nInspired by the time input in google forms\n\n### Styling\n\n`<paper-time-input>` provides the following custom properties and mixins for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-time-input-dropdown-ripple-color` | dropdown ripple color | `--primary-color`\n`--paper-time-input-cotnainer` | Mixin applied to the inputs | `{}`\n`--paper-time-dropdown-input-cotnainer` | Mixin applied to the dropdown input | `{}`\n*/\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-listbox/paper-listbox\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nexport class PaperTimeInput extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          @apply --paper-font-common-base;\n        }\n\n        paper-input {\n          width: 30px;\n          text-align: center;\n          --paper-input-container-input: {\n            /* Damn you firefox\n             * Needed to hide spin num in firefox\n             * http://stackoverflow.com/questions/3790935/can-i-hide-the-html5-number-input-s-spin-box\n             */\n            -moz-appearance: textfield;\n            @apply --paper-time-input-cotnainer;\n          }\n          --paper-input-container-input-webkit-spinner: {\n            -webkit-appearance: none;\n            margin: 0;\n            display: none;\n          }\n          --paper-input-container-shared-input-style_-_-webkit-appearance: textfield;\n        }\n\n        paper-dropdown-menu {\n          width: 55px;\n          padding: 0;\n          /* Force ripple to use the whole container */\n          --paper-dropdown-menu-ripple: {\n            color: var(\n              --paper-time-input-dropdown-ripple-color,\n              var(--primary-color)\n            );\n          }\n          --paper-input-container-input: {\n            @apply --paper-font-button;\n            text-align: center;\n            padding-left: 5px;\n            @apply --paper-time-dropdown-input-cotnainer;\n          }\n          --paper-input-container-underline: {\n            border-color: transparent;\n          }\n          --paper-input-container-underline-focus: {\n            border-color: transparent;\n          }\n        }\n\n        paper-item {\n          cursor: pointer;\n          text-align: center;\n          font-size: 14px;\n        }\n\n        paper-listbox {\n          padding: 0;\n        }\n\n        label {\n          @apply --paper-font-caption;\n        }\n\n        .time-input-wrap {\n          @apply --layout-horizontal;\n          @apply --layout-no-wrap;\n        }\n\n        [hidden] {\n          display: none !important;\n        }\n      </style>\n\n      <label hidden$=\"[[hideLabel]]\">[[label]]</label>\n      <div class=\"time-input-wrap\">\n        <!-- Hour Input -->\n        <paper-input\n          id=\"hour\"\n          type=\"number\"\n          value=\"{{hour}}\"\n          on-change=\"_shouldFormatHour\"\n          required=\"\"\n          auto-validate=\"[[autoValidate]]\"\n          prevent-invalid-input=\"\"\n          maxlength=\"2\"\n          max=\"[[_computeHourMax(format)]]\"\n          min=\"0\"\n          no-label-float=\"\"\n          disabled=\"[[disabled]]\"\n        >\n          <span suffix=\"\" slot=\"suffix\">:</span>\n        </paper-input>\n\n        <!-- Min Input -->\n        <paper-input\n          id=\"min\"\n          type=\"number\"\n          value=\"{{min}}\"\n          on-change=\"_formatMin\"\n          required=\"\"\n          auto-validate=\"[[autoValidate]]\"\n          prevent-invalid-input=\"\"\n          maxlength=\"2\"\n          max=\"59\"\n          min=\"0\"\n          no-label-float=\"\"\n          disabled=\"[[disabled]]\"\n        >\n        </paper-input>\n\n        <!-- Dropdown Menu -->\n        <paper-dropdown-menu\n          id=\"dropdown\"\n          required=\"\"\n          hidden$=\"[[_equal(format, 24)]]\"\n          no-label-float=\"\"\n          disabled=\"[[disabled]]\"\n        >\n          <paper-listbox\n            attr-for-selected=\"name\"\n            selected=\"{{amPm}}\"\n            slot=\"dropdown-content\"\n          >\n            <paper-item name=\"AM\">AM</paper-item>\n            <paper-item name=\"PM\">PM</paper-item>\n          </paper-listbox>\n        </paper-dropdown-menu>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      /**\n       * Label for the input\n       */\n      label: {\n        type: String,\n        value: \"Time\",\n      },\n      /**\n       * auto validate time inputs\n       */\n      autoValidate: {\n        type: Boolean,\n        value: true,\n      },\n      /**\n       * hides the label\n       */\n      hideLabel: {\n        type: Boolean,\n        value: false,\n      },\n      /**\n       * 12 or 24 hr format\n       */\n      format: {\n        type: Number,\n        value: 12,\n      },\n      /**\n       * disables the inputs\n       */\n      disabled: {\n        type: Boolean,\n        value: false,\n      },\n      /**\n       * hour\n       */\n      hour: {\n        type: String,\n        notify: true,\n      },\n      /**\n       * minute\n       */\n      min: {\n        type: String,\n        notify: true,\n      },\n      /**\n       * AM or PM\n       */\n      amPm: {\n        type: String,\n        notify: true,\n        value: \"AM\",\n      },\n      /**\n       * Formatted time string\n       */\n      value: {\n        type: String,\n        notify: true,\n        readOnly: true,\n        computed: \"_computeTime(min, hour, amPm)\",\n      },\n    };\n  }\n\n  /**\n   * Validate the inputs\n   * @return {boolean}\n   */\n  validate() {\n    var valid = true;\n    // Validate hour & min fields\n    if (!this.$.hour.validate() | !this.$.min.validate()) {\n      valid = false;\n    }\n    // Validate AM PM if 12 hour time\n    if (this.format === 12 && !this.$.dropdown.validate()) {\n      valid = false;\n    }\n    return valid;\n  }\n\n  /**\n   * Create time string\n   */\n  _computeTime(min, hour, amPm) {\n    if (hour && min) {\n      // No ampm on 24 hr time\n      if (this.format === 24) {\n        amPm = \"\";\n      }\n      return hour + \":\" + min + \" \" + amPm;\n    }\n    return undefined;\n  }\n\n  /**\n   * Format min\n   */\n  _formatMin() {\n    if (this.min.toString().length === 1) {\n      this.min = this.min < 10 ? \"0\" + this.min : this.min;\n    }\n  }\n\n  /**\n   * Hour needs a leading zero in 24hr format\n   */\n  _shouldFormatHour() {\n    if (this.format === 24 && this.hour.toString().length === 1) {\n      this.hour = this.hour < 10 ? \"0\" + this.hour : this.hour;\n    }\n  }\n\n  /**\n   * 24 hour format has a max hr of 23\n   */\n  _computeHourMax(format) {\n    if (format === 12) {\n      return format;\n    }\n    return 23;\n  }\n\n  _equal(n1, n2) {\n    return n1 === n2;\n  }\n}\n\ncustomElements.define(\"paper-time-input\", PaperTimeInput);\n","import \"@polymer/paper-slider\";\n\nconst PaperSliderClass = customElements.get(\"paper-slider\");\nlet subTemplate;\n\nclass HaSlider extends PaperSliderClass {\n  static get template() {\n    if (!subTemplate) {\n      subTemplate = PaperSliderClass.template.cloneNode(true);\n\n      const superStyle = subTemplate.content.querySelector(\"style\");\n\n      // append style to add mirroring of pin in RTL\n      superStyle.appendChild(\n        document.createTextNode(`\n          :host([dir=\"rtl\"]) #sliderContainer.pin.expand > .slider-knob > .slider-knob-inner::after {\n            -webkit-transform: scale(1) translate(0, -17px) scaleX(-1) !important;\n            transform: scale(1) translate(0, -17px) scaleX(-1) !important;\n            }\n        `)\n      );\n    }\n    return subTemplate;\n  }\n\n  _calcStep(value) {\n    if (!this.step) {\n      return parseFloat(value);\n    }\n\n    const numSteps = Math.round((value - this.min) / this.step);\n    const stepStr = this.step.toString();\n    const stepPointAt = stepStr.indexOf(\".\");\n    if (stepPointAt !== -1) {\n      /**\n       * For small values of this.step, if we calculate the step using\n       * For non-integer values of this.step, if we calculate the step using\n       * `Math.round(value / step) * step` we may hit a precision point issue\n       * eg. 0.1 * 0.2 =  0.020000000000000004\n       * http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\n       *\n       * as a work around we can round with the decimal precision of `step`\n       */\n      const precision = 10 ** (stepStr.length - stepPointAt - 1);\n      return (\n        Math.round((numSteps * this.step + this.min) * precision) / precision\n      );\n    }\n\n    return numSteps * this.step + this.min;\n  }\n}\ncustomElements.define(\"ha-slider\", HaSlider);\n","import { HomeAssistant } from \"../types\";\n\nexport const setInputSelectOption = (\n  hass: HomeAssistant,\n  entity: string,\n  option: string\n) =>\n  hass.callService(\"input_select\", \"select_option\", {\n    option,\n    entity_id: entity,\n  });\n","export const stopPropagation = (ev) => ev.stopPropagation();\n","import { Map } from \"leaflet\";\n\n// Sets up a Leaflet map on the provided DOM element\nexport type LeafletModuleType = typeof import(\"leaflet\");\n\nexport const setupLeafletMap = async (\n  mapElement: HTMLElement,\n  darkMode = false\n): Promise<[Map, LeafletModuleType]> => {\n  if (!mapElement.parentNode) {\n    throw new Error(\"Cannot setup Leaflet map on disconnected element\");\n  }\n  // tslint:disable-next-line\n  const Leaflet = (await import(\n    /* webpackChunkName: \"leaflet\" */ \"leaflet\"\n  )) as LeafletModuleType;\n  Leaflet.Icon.Default.imagePath = \"/static/images/leaflet/images/\";\n\n  const map = Leaflet.map(mapElement);\n  const style = document.createElement(\"link\");\n  style.setAttribute(\"href\", \"/static/images/leaflet/leaflet.css\");\n  style.setAttribute(\"rel\", \"stylesheet\");\n  mapElement.parentNode.appendChild(style);\n  map.setView([52.3731339, 4.8903147], 13);\n  Leaflet.tileLayer(\n    `https://{s}.basemaps.cartocdn.com/${\n      darkMode ? \"dark_all\" : \"light_all\"\n    }/{z}/{x}/{y}${Leaflet.Browser.retina ? \"@2x.png\" : \".png\"}`,\n    {\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: \"abcd\",\n      minZoom: 0,\n      maxZoom: 20,\n    }\n  ).addTo(map);\n\n  return [map, Leaflet];\n};\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { HomeAssistant } from \"../types\";\nimport computeStateName from \"../common/entity/compute_state_name\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport interface EntityRegistryEntry {\n  entity_id: string;\n  name: string;\n  platform: string;\n  config_entry_id?: string;\n  device_id?: string;\n  disabled_by?: string;\n}\n\nexport interface EntityRegistryEntryUpdateParams {\n  name: string | null;\n  new_entity_id: string;\n}\n\nexport const computeEntityRegistryName = (\n  hass: HomeAssistant,\n  entry: EntityRegistryEntry\n): string | null => {\n  if (entry.name) {\n    return entry.name;\n  }\n  const state = hass.states[entry.entity_id];\n  return state ? computeStateName(state) : null;\n};\n\nexport const updateEntityRegistryEntry = (\n  hass: HomeAssistant,\n  entityId: string,\n  updates: Partial<EntityRegistryEntryUpdateParams>\n): Promise<EntityRegistryEntry> =>\n  hass.callWS<EntityRegistryEntry>({\n    type: \"config/entity_registry/update\",\n    entity_id: entityId,\n    ...updates,\n  });\n\nexport const removeEntityRegistryEntry = (\n  hass: HomeAssistant,\n  entityId: string\n): Promise<void> =>\n  hass.callWS({\n    type: \"config/entity_registry/remove\",\n    entity_id: entityId,\n  });\n\nconst fetchEntityRegistry = (conn) =>\n  conn.sendMessagePromise({\n    type: \"config/entity_registry/list\",\n  });\n\nconst subscribeEntityRegistryUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchEntityRegistry(conn).then((entities) =>\n          store.setState(entities, true)\n        ),\n      500,\n      true\n    ),\n    \"entity_registry_updated\"\n  );\n\nexport const subscribeEntityRegistry = (\n  conn: Connection,\n  onChange: (entities: EntityRegistryEntry[]) => void\n) =>\n  createCollection<EntityRegistryEntry[]>(\n    \"_entityRegistry\",\n    fetchEntityRegistry,\n    subscribeEntityRegistryUpdates,\n    conn,\n    onChange\n  );\n","import {\n  html,\n  LitElement,\n  PropertyDeclarations,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport \"./ha-icon\";\n\nclass HaLabelBadge extends LitElement {\n  public value?: string;\n  public icon?: string;\n  public label?: string;\n  public description?: string;\n  public image?: string;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      value: {},\n      icon: {},\n      label: {},\n      description: {},\n      image: {},\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    return html`\n      <div class=\"badge-container\">\n        <div class=\"label-badge\" id=\"badge\">\n          <div\n            class=\"${classMap({\n              value: true,\n              big: Boolean(this.value && this.value.length > 4),\n            })}\"\n          >\n            ${this.icon && !this.value && !this.image\n              ? html`\n                  <ha-icon .icon=\"${this.icon}\"></ha-icon>\n                `\n              : \"\"}\n            ${this.value && !this.image\n              ? html`\n                  <span>${this.value}</span>\n                `\n              : \"\"}\n          </div>\n          ${this.label\n            ? html`\n                <div\n                  class=\"${classMap({\n                    label: true,\n                    big: this.label.length > 5,\n                  })}\"\n                >\n                  <span>${this.label}</span>\n                </div>\n              `\n            : \"\"}\n        </div>\n        ${this.description\n          ? html`\n              <div class=\"title\">${this.description}</div>\n            `\n          : \"\"}\n      </div>\n    `;\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      css`\n        .badge-container {\n          display: inline-block;\n          text-align: center;\n          vertical-align: top;\n        }\n        .label-badge {\n          position: relative;\n          display: block;\n          margin: 0 auto;\n          width: var(--ha-label-badge-size, 2.5em);\n          text-align: center;\n          height: var(--ha-label-badge-size, 2.5em);\n          line-height: var(--ha-label-badge-size, 2.5em);\n          font-size: var(--ha-label-badge-font-size, 1.5em);\n          border-radius: 50%;\n          border: 0.1em solid var(--ha-label-badge-color, var(--primary-color));\n          color: var(--label-badge-text-color, rgb(76, 76, 76));\n\n          white-space: nowrap;\n          background-color: var(--label-badge-background-color, white);\n          background-size: cover;\n          transition: border 0.3s ease-in-out;\n        }\n        .label-badge .value {\n          font-size: 90%;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        .label-badge .value.big {\n          font-size: 70%;\n        }\n        .label-badge .label {\n          position: absolute;\n          bottom: -1em;\n          /* Make the label as wide as container+border. (parent_borderwidth / font-size) */\n          left: -0.2em;\n          right: -0.2em;\n          line-height: 1em;\n          font-size: 0.5em;\n        }\n        .label-badge .label span {\n          box-sizing: border-box;\n          max-width: 100%;\n          display: inline-block;\n          background-color: var(--ha-label-badge-color, var(--primary-color));\n          color: var(--ha-label-badge-label-color, white);\n          border-radius: 1em;\n          padding: 9% 16% 8% 16%; /* mostly apitalized text, not much descenders => bit more top margin */\n          font-weight: 500;\n          overflow: hidden;\n          text-transform: uppercase;\n          text-overflow: ellipsis;\n          transition: background-color 0.3s ease-in-out;\n          text-transform: var(--ha-label-badge-label-text-transform, uppercase);\n        }\n        .label-badge .label.big span {\n          font-size: 90%;\n          padding: 10% 12% 7% 12%; /* push smaller text a bit down to center vertically */\n        }\n        .badge-container .title {\n          margin-top: 1em;\n          font-size: var(--ha-label-badge-title-font-size, 0.9em);\n          width: var(--ha-label-badge-title-width, 5em);\n          font-weight: var(--ha-label-badge-title-font-weight, 400);\n          overflow: hidden;\n          text-overflow: ellipsis;\n          line-height: normal;\n        }\n      `,\n    ];\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (changedProperties.has(\"image\")) {\n      this.shadowRoot!.getElementById(\"badge\")!.style.backgroundImage = this\n        .image\n        ? `url(${this.image})`\n        : \"\";\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-label-badge\": HaLabelBadge;\n  }\n}\n\ncustomElements.define(\"ha-label-badge\", HaLabelBadge);\n","import { HomeAssistant } from \"../types\";\n\nimport { timeCachePromiseFunc } from \"../common/util/time-cache-function-promise\";\n\nexport const SUPPORT_PAUSE = 1;\nexport const SUPPORT_NEXT_TRACK = 32;\nexport const SUPPORTS_PLAY = 16384;\nexport const OFF_STATES = [\"off\", \"idle\"];\n\nexport interface MediaPlayerThumbnail {\n  content_type: string;\n  content: string;\n}\n\nexport const fetchMediaPlayerThumbnailWithCache = (\n  hass: HomeAssistant,\n  entityId: string\n) =>\n  timeCachePromiseFunc(\n    \"_media_playerTmb\",\n    9000,\n    fetchMediaPlayerThumbnail,\n    hass,\n    entityId\n  );\n\nexport const fetchMediaPlayerThumbnail = (\n  hass: HomeAssistant,\n  entityId: string\n) => {\n  return hass.callWS<MediaPlayerThumbnail>({\n    type: \"media_player_thumbnail\",\n    entity_id: entityId,\n  });\n};\n","import { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { Lovelace } from \"../../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"show-edit-card\": EditCardDialogParams;\n  }\n}\n\nlet registeredDialog = false;\nconst dialogShowEvent = \"show-edit-card\";\nconst dialogTag = \"hui-dialog-edit-card\";\n\nexport interface EditCardDialogParams {\n  lovelace: Lovelace;\n  path: [number] | [number, number];\n}\n\nconst registerEditCardDialog = (element: HTMLElement): Event =>\n  fireEvent(element, \"register-dialog\", {\n    dialogShowEvent,\n    dialogTag,\n    dialogImport: () =>\n      import(/* webpackChunkName: \"hui-dialog-edit-card\" */ \"./hui-dialog-edit-card\"),\n  });\n\nexport const showEditCardDialog = (\n  element: HTMLElement,\n  editCardDialogParams: EditCardDialogParams\n): void => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    registerEditCardDialog(element);\n  }\n  fireEvent(element, dialogShowEvent, editCardDialogParams);\n};\n","export const afterNextRender = (cb: () => void): void => {\n  requestAnimationFrame(() => setTimeout(cb, 0));\n};\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport { PaperToggleButtonElement } from \"@polymer/paper-toggle-button/paper-toggle-button\";\n\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { turnOnOffEntities } from \"../common/entity/turn-on-off-entities\";\nimport { HomeAssistant } from \"../../../types\";\nimport { forwardHaptic } from \"../../../data/haptics\";\n\n@customElement(\"hui-entities-toggle\")\nclass HuiEntitiesToggle extends LitElement {\n  @property() public entities?: string[];\n\n  @property() protected hass?: HomeAssistant;\n\n  @property() private _toggleEntities?: string[];\n\n  public updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (changedProperties.has(\"entities\")) {\n      this._toggleEntities = this.entities!.filter(\n        (entityId) =>\n          entityId in this.hass!.states &&\n          DOMAINS_TOGGLE.has(entityId.split(\".\", 1)[0])\n      );\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._toggleEntities) {\n      return html``;\n    }\n\n    return html`\n      <paper-toggle-button\n        aria-label=\"Toggle entities.\"\n        ?checked=\"${this._toggleEntities!.some((entityId) => {\n          const stateObj = this.hass!.states[entityId];\n          return stateObj && stateObj.state === \"on\";\n        })}\"\n        @change=\"${this._callService}\"\n      ></paper-toggle-button>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        width: 38px;\n        display: block;\n      }\n      paper-toggle-button {\n        cursor: pointer;\n        --paper-toggle-button-label-spacing: 0;\n        padding: 13px 5px;\n        margin: -4px -5px;\n      }\n    `;\n  }\n\n  private _callService(ev: MouseEvent): void {\n    forwardHaptic(\"light\");\n    const turnOn = (ev.target as PaperToggleButtonElement).checked;\n    turnOnOffEntities(this.hass!, this._toggleEntities!, turnOn!);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entities-toggle\": HuiEntitiesToggle;\n  }\n}\n","import computeDomain from \"../../../../common/entity/compute_domain\";\nimport { STATES_OFF } from \"../../../../common/const\";\nimport { HomeAssistant } from \"../../../../types\";\n\nexport const turnOnOffEntities = (\n  hass: HomeAssistant,\n  entityIds: string[],\n  turnOn = true\n): void => {\n  const domainsToCall = {};\n  entityIds.forEach((entityId) => {\n    if (STATES_OFF.includes(hass.states[entityId].state) === turnOn) {\n      const stateDomain = computeDomain(entityId);\n      const serviceDomain = [\"cover\", \"lock\"].includes(stateDomain)\n        ? stateDomain\n        : \"homeassistant\";\n\n      if (!(serviceDomain in domainsToCall)) {\n        domainsToCall[serviceDomain] = [];\n      }\n      domainsToCall[serviceDomain].push(entityId);\n    }\n  });\n\n  Object.keys(domainsToCall).forEach((domain) => {\n    let service;\n    switch (domain) {\n      case \"lock\":\n        service = turnOn ? \"unlock\" : \"lock\";\n        break;\n      case \"cover\":\n        service = turnOn ? \"open_cover\" : \"close_cover\";\n        break;\n      default:\n        service = turnOn ? \"turn_on\" : \"turn_off\";\n    }\n\n    const entities = domainsToCall[domain];\n    hass.callService(domain, service, { entity_id: entities });\n  });\n};\n","import computeStateName from \"../../../common/entity/compute_state_name\";\nimport {\n  LitElement,\n  html,\n  css,\n  CSSResult,\n  PropertyValues,\n  property,\n  TemplateResult,\n} from \"lit-element\";\n\nimport \"../../../components/entity/state-badge\";\nimport \"../../../components/ha-relative-time\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { computeRTL } from \"../../../common/util/compute_rtl\";\nimport { EntitiesCardEntityConfig } from \"../cards/types\";\n\nclass HuiGenericEntityRow extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public config?: EntitiesCardEntityConfig;\n\n  @property() public showSecondary: boolean = true;\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this.config) {\n      return html``;\n    }\n    const stateObj = this.config.entity\n      ? this.hass.states[this.config.entity]\n      : undefined;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this.config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <state-badge\n        .stateObj=\"${stateObj}\"\n        .overrideIcon=\"${this.config.icon}\"\n      ></state-badge>\n      <div class=\"flex\">\n        <div class=\"info\">\n          ${this.config.name || computeStateName(stateObj)}\n          <div class=\"secondary\">\n            ${!this.showSecondary\n              ? html`\n                  <slot name=\"secondary\"></slot>\n                `\n              : this.config.secondary_info === \"entity-id\"\n              ? stateObj.entity_id\n              : this.config.secondary_info === \"last-changed\"\n              ? html`\n                  <ha-relative-time\n                    .hass=\"${this.hass}\"\n                    .datetime=\"${stateObj.last_changed}\"\n                  ></ha-relative-time>\n                `\n              : \"\"}\n          </div>\n        </div>\n\n        <slot></slot>\n      </div>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (changedProps.has(\"hass\")) {\n      this.toggleAttribute(\"rtl\", computeRTL(this.hass!));\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      .flex {\n        flex: 1;\n        margin-left: 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        min-width: 0;\n      }\n      .info {\n        flex: 1 0 60px;\n      }\n      .info,\n      .info > * {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .flex ::slotted(*) {\n        margin-left: 8px;\n        min-width: 0;\n      }\n      .flex ::slotted([slot=\"secondary\"]) {\n        margin-left: 0;\n      }\n      .secondary,\n      ha-relative-time {\n        display: block;\n        color: var(--secondary-text-color);\n      }\n      state-badge {\n        flex: 0 0 40px;\n      }\n      :host([rtl]) .flex {\n        margin-left: 0;\n        margin-right: 16px;\n      }\n      :host([rtl]) .flex ::slotted(*) {\n        margin-left: 0;\n        margin-right: 8px;\n      }\n    `;\n  }\n}\ncustomElements.define(\"hui-generic-entity-row\", HuiGenericEntityRow);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/ha-climate-state\";\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-climate-entity-row\")\nclass HuiClimateEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <ha-climate-state\n          .hass=\"${this.hass}\"\n          .stateObj=\"${stateObj}\"\n        ></ha-climate-state>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-climate-state {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-climate-entity-row\": HuiClimateEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/ha-cover-controls\";\nimport \"../../../components/ha-cover-tilt-controls\";\nimport \"../components/hui-warning\";\n\nimport { isTiltOnly } from \"../../../util/cover-model\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-cover-entity-row\")\nclass HuiCoverEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${isTiltOnly(stateObj)\n          ? html`\n              <ha-cover-tilt-controls\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-cover-tilt-controls>\n            `\n          : html`\n              <ha-cover-controls\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-cover-controls>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-cover-controls,\n      ha-cover-tilt-controls {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-cover-entity-row\": HuiCoverEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-group-entity-row\")\nclass HuiGroupEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${this._computeCanToggle(stateObj.attributes.entity_id)\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <div>\n                ${computeStateDisplay(\n                  this.hass!.localize,\n                  stateObj,\n                  this.hass.language\n                )}\n              </div>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  private _computeCanToggle(entityIds): boolean {\n    return entityIds.some((entityId) =>\n      DOMAINS_TOGGLE.has(entityId.split(\".\", 1)[0])\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-group-entity-row\": HuiGroupEntityRow;\n  }\n}\n","import {\n  html,\n  css,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n} from \"lit-element\";\n\nimport \"@polymer/paper-input/paper-input\";\n// tslint:disable-next-line:no-duplicate-imports\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\n\n@customElement(\"ha-date-input\")\nexport class HaDateInput extends LitElement {\n  @property() public year?: string;\n  @property() public month?: string;\n  @property() public day?: string;\n  @property({ type: Boolean }) public disabled = false;\n\n  static get styles() {\n    return css`\n      :host {\n        display: block;\n        font-family: var(--paper-font-common-base_-_font-family);\n        -webkit-font-smoothing: var(\n          --paper-font-common-base_-_-webkit-font-smoothing\n        );\n      }\n\n      paper-input {\n        width: 30px;\n        text-align: center;\n        --paper-input-container-shared-input-style_-_-webkit-appearance: textfield;\n        --paper-input-container-input_-_-moz-appearance: textfield;\n        --paper-input-container-shared-input-style_-_appearance: textfield;\n        --paper-input-container-input-webkit-spinner_-_-webkit-appearance: none;\n        --paper-input-container-input-webkit-spinner_-_margin: 0;\n        --paper-input-container-input-webkit-spinner_-_display: none;\n      }\n\n      paper-input#year {\n        width: 50px;\n      }\n\n      .date-input-wrap {\n        display: flex;\n        flex-direction: row;\n      }\n    `;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"date-input-wrap\">\n        <paper-input\n          id=\"year\"\n          type=\"number\"\n          .value=${this.year}\n          @change=${this._formatYear}\n          maxlength=\"4\"\n          max=\"9999\"\n          min=\"0\"\n          .disabled=${this.disabled}\n          no-label-float\n        >\n          <span suffix=\"\" slot=\"suffix\">-</span>\n        </paper-input>\n        <paper-input\n          id=\"month\"\n          type=\"number\"\n          .value=${this.month}\n          @change=${this._formatMonth}\n          maxlength=\"2\"\n          max=\"12\"\n          min=\"1\"\n          .disabled=${this.disabled}\n          no-label-float\n        >\n          <span suffix=\"\" slot=\"suffix\">-</span>\n        </paper-input>\n        <paper-input\n          id=\"day\"\n          type=\"number\"\n          .value=${this.day}\n          @change=${this._formatDay}\n          maxlength=\"2\"\n          max=\"31\"\n          min=\"1\"\n          .disabled=${this.disabled}\n          no-label-float\n        >\n        </paper-input>\n      </div>\n    `;\n  }\n\n  private _formatYear() {\n    const yearElement = this.shadowRoot!.getElementById(\n      \"year\"\n    ) as PaperInputElement;\n    this.year = yearElement.value!;\n  }\n\n  private _formatMonth() {\n    const monthElement = this.shadowRoot!.getElementById(\n      \"month\"\n    ) as PaperInputElement;\n    this.month = (\"0\" + monthElement.value!).slice(-2);\n  }\n\n  private _formatDay() {\n    const dayElement = this.shadowRoot!.getElementById(\n      \"day\"\n    ) as PaperInputElement;\n    this.day = (\"0\" + dayElement.value!).slice(-2);\n  }\n\n  get value() {\n    return `${this.year}-${this.month}-${this.day}`;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-date-input\": HaDateInput;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  PropertyValues,\n  customElement,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/paper-time-input.js\";\n// tslint:disable-next-line:no-duplicate-imports\nimport { PaperTimeInput } from \"../../../components/paper-time-input.js\";\nimport \"../../../components/ha-date-input\";\n// tslint:disable-next-line:no-duplicate-imports\nimport { HaDateInput } from \"../../../components/ha-date-input\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { setInputDateTimeValue } from \"../../../data/input_datetime\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-input-datetime-entity-row\")\nclass HuiInputDatetimeEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.attributes.has_date\n          ? html`\n              <ha-date-input\n                .year=${stateObj.attributes.year}\n                .month=${(\"0\" + stateObj.attributes.month).slice(-2)}\n                .day=${(\"0\" + stateObj.attributes.day).slice(-2)}\n                @change=${this._selectedValueChanged}\n                @click=${this._stopEventPropagation}\n              ></ha-date-input>\n              ${stateObj.attributes.has_time ? \",\" : \"\"}\n            `\n          : ``}\n        ${stateObj.attributes.has_time\n          ? html`\n              <paper-time-input\n                .hour=${stateObj.state === \"unknown\"\n                  ? \"\"\n                  : (\"0\" + stateObj.attributes.hour).slice(-2)}\n                .min=${stateObj.state === \"unknown\"\n                  ? \"\"\n                  : (\"0\" + stateObj.attributes.minute).slice(-2)}\n                .amPm=${false}\n                @change=${this._selectedValueChanged}\n                @click=${this._stopEventPropagation}\n                hide-label\n                format=\"24\"\n              ></paper-time-input>\n            `\n          : ``}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  private _stopEventPropagation(ev: Event): void {\n    ev.stopPropagation();\n  }\n\n  private get _timeInputEl(): PaperTimeInput {\n    return this.shadowRoot!.querySelector(\"paper-time-input\")!;\n  }\n\n  private get _dateInputEl(): HaDateInput {\n    return this.shadowRoot!.querySelector(\"ha-date-input\")!;\n  }\n\n  private _selectedValueChanged(ev): void {\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    const time =\n      this._timeInputEl !== null\n        ? this._timeInputEl.value.trim() + \":00\"\n        : undefined;\n\n    const date =\n      this._dateInputEl !== null ? this._dateInputEl.value : undefined;\n\n    if (time !== stateObj.state) {\n      setInputDateTimeValue(this.hass!, stateObj.entity_id, time, date);\n    }\n\n    ev.target.blur();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-datetime-entity-row\": HuiInputDatetimeEntityRow;\n  }\n}\n","import { HomeAssistant } from \"../types\";\n\nexport const setInputDateTimeValue = (\n  hass: HomeAssistant,\n  entityId: string,\n  time: string | undefined = undefined,\n  date: string | undefined = undefined\n) => {\n  const param = { entity_id: entityId, time, date };\n  hass.callService(entityId.split(\".\", 1)[0], \"set_datetime\", param);\n};\n","import { HomeAssistant } from \"../types\";\n\nexport const setValue = (hass: HomeAssistant, entity: string, value: string) =>\n  hass.callService(entity.split(\".\", 1)[0], \"set_value\", {\n    value,\n    entity_id: entity,\n  });\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/ha-slider\";\nimport \"../components/hui-warning\";\n\nimport { computeRTLDirection } from \"../../../common/util/compute_rtl\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { setValue } from \"../../../data/input_text\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-input-number-entity-row\")\nclass HuiInputNumberEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  private _loaded?: boolean;\n\n  private _updated?: boolean;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (this._updated && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected firstUpdated(): void {\n    this._updated = true;\n    if (this.isConnected && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>\n          ${stateObj.attributes.mode === \"slider\"\n            ? html`\n                <div class=\"flex\">\n                  <ha-slider\n                    .dir=\"${computeRTLDirection(this.hass!)}\"\n                    .step=\"${Number(stateObj.attributes.step)}\"\n                    .min=\"${Number(stateObj.attributes.min)}\"\n                    .max=\"${Number(stateObj.attributes.max)}\"\n                    .value=\"${Number(stateObj.state)}\"\n                    pin\n                    @change=\"${this._selectedValueChanged}\"\n                    ignore-bar-touch\n                    id=\"input\"\n                  ></ha-slider>\n                  <span class=\"state\">\n                    ${Number(stateObj.state)}\n                    ${stateObj.attributes.unit_of_measurement}\n                  </span>\n                </div>\n              `\n            : html`\n                <paper-input\n                  no-label-float\n                  auto-validate\n                  .pattern=\"[0-9]+([\\\\.][0-9]+)?\"\n                  .step=\"${Number(stateObj.attributes.step)}\"\n                  .min=\"${Number(stateObj.attributes.min)}\"\n                  .max=\"${Number(stateObj.attributes.max)}\"\n                  .value=\"${Number(stateObj.state)}\"\n                  type=\"number\"\n                  @change=\"${this._selectedValueChanged}\"\n                  id=\"input\"\n                ></paper-input>\n              `}\n        </div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .flex {\n        display: flex;\n        align-items: center;\n      }\n      .state {\n        min-width: 45px;\n        text-align: end;\n      }\n      paper-input {\n        text-align: end;\n      }\n    `;\n  }\n\n  private async _initialLoad(): Promise<void> {\n    this._loaded = true;\n    await this.updateComplete;\n    const element = this.shadowRoot!.querySelector(\".state\") as HTMLElement;\n\n    if (!element || !this.parentElement) {\n      return;\n    }\n\n    element.hidden = this.parentElement.clientWidth <= 350;\n  }\n\n  private get _inputElement(): { value: string } {\n    // linter recommended the following syntax\n    return (this.shadowRoot!.getElementById(\"input\") as unknown) as {\n      value: string;\n    };\n  }\n\n  private _selectedValueChanged(): void {\n    const element = this._inputElement;\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (element.value !== stateObj.state) {\n      setValue(this.hass!, stateObj.entity_id, element.value!);\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-number-entity-row\": HuiInputNumberEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-listbox/paper-listbox\";\n\nimport \"../../../components/ha-paper-dropdown-menu\";\nimport \"../../../components/entity/state-badge\";\nimport \"../components/hui-warning\";\n\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { HomeAssistant, InputSelectEntity } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { setInputSelectOption } from \"../../../data/input-select\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { forwardHaptic } from \"../../../data/haptics\";\nimport { stopPropagation } from \"../../../common/dom/stop_propagation\";\n\n@customElement(\"hui-input-select-entity-row\")\nclass HuiInputSelectEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as\n      | InputSelectEntity\n      | undefined;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <state-badge .stateObj=\"${stateObj}\"></state-badge>\n      <ha-paper-dropdown-menu\n        .label=${this._config.name || computeStateName(stateObj)}\n        .value=${stateObj.state}\n        @iron-select=${this._selectedChanged}\n        @click=${stopPropagation}\n      >\n        <paper-listbox slot=\"dropdown-content\">\n          ${stateObj.attributes.options.map(\n            (option) => html`\n              <paper-item>${option}</paper-item>\n            `\n          )}\n        </paper-listbox>\n      </ha-paper-dropdown-menu>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n\n    if (!this.hass || !this._config) {\n      return;\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as\n      | InputSelectEntity\n      | undefined;\n\n    if (!stateObj) {\n      return;\n    }\n\n    // Update selected after rendering the items or else it won't work in Firefox\n    this.shadowRoot!.querySelector(\n      \"paper-listbox\"\n    )!.selected = stateObj.attributes.options.indexOf(stateObj.state);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      ha-paper-dropdown-menu {\n        margin-left: 16px;\n        flex: 1;\n      }\n\n      paper-item {\n        cursor: pointer;\n        min-width: 200px;\n      }\n    `;\n  }\n\n  private _selectedChanged(ev): void {\n    const stateObj = this.hass!.states[this._config!.entity];\n    const option = ev.target.selectedItem.innerText.trim();\n    if (option === stateObj.state) {\n      return;\n    }\n\n    forwardHaptic(\"light\");\n\n    setInputSelectOption(this.hass!, stateObj.entity_id, option);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-select-entity-row\": HuiInputSelectEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { setValue } from \"../../../data/input_text\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-input-text-entity-row\")\nclass HuiInputTextEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <paper-input\n          no-label-float\n          .value=\"${stateObj.state}\"\n          .minlength=\"${stateObj.attributes.min}\"\n          .maxlength=\"${stateObj.attributes.max}\"\n          .autoValidate=\"${stateObj.attributes.pattern}\"\n          .pattern=\"${stateObj.attributes.pattern}\"\n          .type=\"${stateObj.attributes.mode}\"\n          @change=\"${this._selectedValueChanged}\"\n          placeholder=\"(empty value)\"\n        ></paper-input>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  private get _inputEl(): PaperInputElement {\n    return this.shadowRoot!.querySelector(\"paper-input\") as PaperInputElement;\n  }\n\n  private _selectedValueChanged(ev): void {\n    const element = this._inputEl;\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (element.value !== stateObj.state) {\n      setValue(this.hass!, stateObj.entity_id, element.value!);\n    }\n\n    ev.target.blur();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-text-entity-row\": HuiInputTextEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-lock-entity-row\")\nclass HuiLockEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <mwc-button @click=\"${this._callService}\">\n          ${stateObj.state === \"locked\"\n            ? this.hass!.localize(\"ui.card.lock.unlock\")\n            : this.hass!.localize(\"ui.card.lock.lock\")}\n        </mwc-button>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService(ev): void {\n    ev.stopPropagation();\n    const stateObj = this.hass!.states[this._config!.entity];\n    this.hass!.callService(\n      \"lock\",\n      stateObj.state === \"locked\" ? \"unlock\" : \"lock\",\n      { entity_id: stateObj.entity_id }\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-lock-entity-row\": HuiLockEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { supportsFeature } from \"../../../common/entity/supports-feature\";\nimport {\n  SUPPORTS_PLAY,\n  SUPPORT_NEXT_TRACK,\n  OFF_STATES,\n  SUPPORT_PAUSE,\n} from \"../../../data/media-player\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-media-player-entity-row\")\nclass HuiMediaPlayerEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row\n        .hass=\"${this.hass}\"\n        .config=\"${this._config}\"\n        .showSecondary=\"false\"\n      >\n        ${OFF_STATES.includes(stateObj.state)\n          ? html`\n              <div>\n                ${this.hass!.localize(`state.media_player.${stateObj.state}`) ||\n                  this.hass!.localize(`state.default.${stateObj.state}`) ||\n                  stateObj.state}\n              </div>\n            `\n          : html`\n              <div class=\"controls\">\n                ${stateObj.state !== \"playing\" &&\n                !supportsFeature(stateObj, SUPPORTS_PLAY)\n                  ? \"\"\n                  : html`\n                      <paper-icon-button\n                        icon=\"${this._computeControlIcon(stateObj)}\"\n                        @click=\"${this._playPause}\"\n                      ></paper-icon-button>\n                    `}\n                ${supportsFeature(stateObj, SUPPORT_NEXT_TRACK)\n                  ? html`\n                      <paper-icon-button\n                        icon=\"hass:skip-next\"\n                        @click=\"${this._nextTrack}\"\n                      ></paper-icon-button>\n                    `\n                  : \"\"}\n              </div>\n              <div slot=\"secondary\">${this._computeMediaTitle(stateObj)}</div>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .controls {\n        white-space: nowrap;\n      }\n    `;\n  }\n\n  private _computeControlIcon(stateObj: HassEntity): string {\n    if (stateObj.state !== \"playing\") {\n      return \"hass:play\";\n    }\n\n    // tslint:disable-next-line:no-bitwise\n    return supportsFeature(stateObj, SUPPORT_PAUSE)\n      ? \"hass:pause\"\n      : \"hass:stop\";\n  }\n\n  private _computeMediaTitle(stateObj: HassEntity): string {\n    let prefix;\n    let suffix;\n\n    switch (stateObj.attributes.media_content_type) {\n      case \"music\":\n        prefix = stateObj.attributes.media_artist;\n        suffix = stateObj.attributes.media_title;\n        break;\n      case \"tvshow\":\n        prefix = stateObj.attributes.media_series_title;\n        suffix = stateObj.attributes.media_title;\n        break;\n      default:\n        prefix =\n          stateObj.attributes.media_title ||\n          stateObj.attributes.app_name ||\n          stateObj.state;\n        suffix = \"\";\n    }\n\n    return prefix && suffix ? `${prefix}: ${suffix}` : prefix || suffix || \"\";\n  }\n\n  private _playPause(ev: MouseEvent): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"media_player\", \"media_play_pause\", {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _nextTrack(ev: MouseEvent): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"media_player\", \"media_next_track\", {\n      entity_id: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-media-player-entity-row\": HuiMediaPlayerEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResult,\n  css,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-scene-entity-row\")\nclass HuiSceneEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.attributes.can_cancel\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <mwc-button @click=\"${this._callService}\">\n                ${this.hass!.localize(\"ui.card.scene.activate\")}\n              </mwc-button>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService(ev): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"scene\", \"turn_on\", {\n      entity_id: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-scene-entity-row\": HuiSceneEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-script-entity-row\")\nclass HuiScriptEntityRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.attributes.can_cancel\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <mwc-button @click=\"${this._callService}\">\n                ${this.hass!.localize(\"ui.card.script.execute\")}\n              </mwc-button>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService(ev): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"script\", \"turn_on\", {\n      entity_id: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-script-entity-row\": HuiScriptEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport format_date from \"../../../common/datetime/format_date\";\nimport format_date_time from \"../../../common/datetime/format_date_time\";\nimport format_time from \"../../../common/datetime/format_time\";\nimport relativeTime from \"../../../common/datetime/relative_time\";\n\nconst FORMATS: { [key: string]: (ts: Date, lang: string) => string } = {\n  date: format_date,\n  datetime: format_date_time,\n  time: format_time,\n};\nconst INTERVAL_FORMAT = [\"relative\", \"total\"];\n\n@customElement(\"hui-timestamp-display\")\nclass HuiTimestampDisplay extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public ts?: Date;\n\n  @property() public format?:\n    | \"relative\"\n    | \"total\"\n    | \"date\"\n    | \"datetime\"\n    | \"time\";\n\n  @property() private _relative?: string;\n\n  private _connected?: boolean;\n\n  private _interval?: number;\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._connected = true;\n    this._startInterval();\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._connected = false;\n    this._clearInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.ts || !this.hass) {\n      return html``;\n    }\n\n    if (isNaN(this.ts.getTime())) {\n      return html`\n        Invalid date\n      `;\n    }\n\n    const format = this._format;\n\n    if (INTERVAL_FORMAT.includes(format)) {\n      return html`\n        ${this._relative}\n      `;\n    }\n    if (format in FORMATS) {\n      return html`\n        ${FORMATS[format](this.ts, this.hass.language)}\n      `;\n    }\n    return html`\n      Invalid format\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (!changedProperties.has(\"format\") || !this._connected) {\n      return;\n    }\n\n    if (INTERVAL_FORMAT.includes(\"relative\")) {\n      this._startInterval();\n    } else {\n      this._clearInterval();\n    }\n  }\n\n  private get _format(): string {\n    return this.format || \"relative\";\n  }\n\n  private _startInterval(): void {\n    this._clearInterval();\n    if (this._connected && INTERVAL_FORMAT.includes(this._format)) {\n      this._updateRelative();\n      this._interval = window.setInterval(() => this._updateRelative(), 1000);\n    }\n  }\n\n  private _clearInterval(): void {\n    if (this._interval) {\n      clearInterval(this._interval);\n      this._interval = undefined;\n    }\n  }\n\n  private _updateRelative(): void {\n    if (this.ts && this.hass!.localize) {\n      this._relative =\n        this._format === \"relative\"\n          ? relativeTime(this.ts, this.hass!.localize)\n          : (this._relative = relativeTime(new Date(), this.hass!.localize, {\n              compareTime: this.ts,\n              includeTense: false,\n            }));\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-timestamp-display\": HuiTimestampDisplay;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-timestamp-display\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\ninterface SensorEntityConfig extends EntityConfig {\n  format?: \"relative\" | \"date\" | \"time\" | \"datetime\";\n}\n\n@customElement(\"hui-sensor-entity-row\")\nclass HuiSensorEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: SensorEntityConfig;\n\n  public setConfig(config: SensorEntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>\n          ${stateObj.attributes.device_class === \"timestamp\"\n            ? html`\n                <hui-timestamp-display\n                  .hass=\"${this.hass}\"\n                  .ts=\"${new Date(stateObj.state)}\"\n                  .format=\"${this._config.format}\"\n                ></hui-timestamp-display>\n              `\n            : computeStateDisplay(\n                this.hass!.localize,\n                stateObj,\n                this.hass.language\n              )}\n        </div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      div {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-sensor-entity-row\": HuiSensorEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-text-entity-row\")\nclass HuiTextEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>\n          ${computeStateDisplay(\n            this.hass!.localize,\n            stateObj,\n            this.hass.language\n          )}\n        </div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      div {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-text-entity-row\": HuiTextEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  PropertyValues,\n  customElement,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport timerTimeRemaining from \"../../../common/entity/timer_time_remaining\";\nimport secondsToDuration from \"../../../common/datetime/seconds_to_duration\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityConfig } from \"./types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-timer-entity-row\")\nclass HuiTimerEntityRow extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  @property() private _timeRemaining?: number;\n\n  private _interval?: number;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._clearInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>${this._computeDisplay(stateObj)}</div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_timeRemaining\")) {\n      return true;\n    }\n\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n\n    if (changedProps.has(\"hass\")) {\n      const stateObj = this.hass!.states[this._config!.entity];\n      const oldHass = changedProps.get(\"hass\") as this[\"hass\"];\n      const oldStateObj = oldHass\n        ? oldHass.states[this._config!.entity]\n        : undefined;\n\n      if (oldStateObj !== stateObj) {\n        this._startInterval(stateObj);\n      } else if (!stateObj) {\n        this._clearInterval();\n      }\n    }\n  }\n\n  private _clearInterval(): void {\n    if (this._interval) {\n      window.clearInterval(this._interval);\n      this._interval = undefined;\n    }\n  }\n\n  private _startInterval(stateObj: HassEntity): void {\n    this._clearInterval();\n    this._calculateRemaining(stateObj);\n\n    if (stateObj.state === \"active\") {\n      this._interval = window.setInterval(\n        () => this._calculateRemaining(stateObj),\n        1000\n      );\n    }\n  }\n\n  private _calculateRemaining(stateObj: HassEntity): void {\n    this._timeRemaining = timerTimeRemaining(stateObj);\n  }\n\n  private _computeDisplay(stateObj: HassEntity): string | null {\n    if (!stateObj) {\n      return null;\n    }\n\n    if (stateObj.state === \"idle\" || this._timeRemaining === 0) {\n      return this.hass!.localize(\"state.timer.\" + stateObj.state);\n    }\n\n    let display = secondsToDuration(this._timeRemaining || 0);\n\n    if (stateObj.state === \"paused\") {\n      display += ` (${this.hass!.localize(\"state.timer.paused\")})`;\n    }\n\n    return display;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-timer-entity-row\": HuiTimerEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-toggle-entity-row\")\nclass HuiToggleEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.state === \"on\" || stateObj.state === \"off\"\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <div>\n                ${computeStateDisplay(\n                  this.hass!.localize,\n                  stateObj,\n                  this.hass!.language\n                )}\n              </div>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-toggle-entity-row\": HuiToggleEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport \"@material/mwc-button\";\n\nimport \"../../../components/ha-icon\";\n\nimport { callService } from \"../common/call-service\";\nimport { EntityRow, CallServiceConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-call-service-row\")\nclass HuiCallServiceRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: CallServiceConfig;\n\n  public setConfig(config: CallServiceConfig): void {\n    if (!config || !config.name || !config.service) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    this._config = { icon: \"hass:remote\", action_name: \"Run\", ...config };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-icon .icon=\"${this._config.icon}\"></ha-icon>\n      <div class=\"flex\">\n        <div>${this._config.name}</div>\n        <mwc-button @click=\"${this._callService}\"\n          >${this._config.action_name}</mwc-button\n        >\n      </div>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      ha-icon {\n        padding: 8px;\n        color: var(--paper-item-icon-color);\n      }\n      .flex {\n        flex: 1;\n        overflow: hidden;\n        margin-left: 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n      .flex div {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService() {\n    callService(this._config!, this.hass!);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-call-service-row\": HuiCallServiceRow;\n  }\n}\n","import { HomeAssistant } from \"../../../types\";\nimport { CallServiceConfig } from \"../entity-rows/types\";\n\nexport const callService = (\n  config: CallServiceConfig,\n  hass: HomeAssistant\n): void => {\n  const entityId = config.entity;\n  const [domain, service] = config.service.split(\".\", 2);\n  const serviceData = { entity_id: entityId, ...config.service_data };\n  hass.callService(domain, service, serviceData);\n};\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport { EntityRow, DividerConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-divider-row\")\nclass HuiDividerRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: DividerConfig;\n\n  public setConfig(config): void {\n    if (!config) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    this._config = {\n      style: {\n        height: \"1px\",\n        \"background-color\": \"var(--secondary-text-color)\",\n      },\n      ...config,\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    const el = document.createElement(\"div\");\n\n    Object.keys(this._config.style).forEach((prop) => {\n      el.style.setProperty(prop, this._config!.style[prop]);\n    });\n\n    return html`\n      ${el}\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-divider-row\": HuiDividerRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { EntityRow, SectionConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\nimport \"../../../components/ha-icon\";\n\n@customElement(\"hui-section-row\")\nclass HuiSectionRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: SectionConfig;\n\n  public setConfig(config: SectionConfig): void {\n    if (!config) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <div class=\"divider\"></div>\n      ${this._config.label\n        ? html`\n            <div class=\"label\">${this._config.label}</div>\n          `\n        : html``}\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .label {\n        color: var(--primary-color);\n        margin-left: 8px;\n        margin-bottom: 16px;\n        margin-top: 16px;\n      }\n      .divider {\n        height: 1px;\n        background-color: var(--secondary-text-color);\n        opacity: 0.25;\n        margin-left: -16px;\n        margin-right: -16px;\n        margin-top: 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-section-row\": HuiSectionRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { EntityRow, WeblinkConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\nimport \"../../../components/ha-icon\";\n\n@customElement(\"hui-weblink-row\")\nclass HuiWeblinkRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: WeblinkConfig;\n\n  public setConfig(config: WeblinkConfig): void {\n    if (!config || !config.url) {\n      throw new Error(\"Invalid Configuration: 'url' required\");\n    }\n\n    this._config = {\n      icon: \"hass:link\",\n      name: config.url,\n      ...config,\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <a href=\"${this._config.url}\" target=\"_blank\">\n        <ha-icon .icon=\"${this._config.icon}\"></ha-icon>\n        <div>${this._config.name}</div>\n      </a>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      a {\n        display: flex;\n        align-items: center;\n        color: var(--primary-color);\n      }\n      ha-icon {\n        padding: 8px;\n        color: var(--paper-item-icon-color);\n      }\n      div {\n        flex: 1;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        margin-left: 16px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-weblink-row\": HuiWeblinkRow;\n  }\n}\n","import deepClone from \"deep-clone-simple\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\n\nimport {\n  createErrorCardElement,\n  createErrorCardConfig,\n  HuiErrorCard,\n} from \"../cards/hui-error-card\";\nimport \"../entity-rows/hui-climate-entity-row\";\nimport \"../entity-rows/hui-cover-entity-row\";\nimport \"../entity-rows/hui-group-entity-row\";\nimport \"../entity-rows/hui-input-datetime-entity-row\";\nimport \"../entity-rows/hui-input-number-entity-row\";\nimport \"../entity-rows/hui-input-select-entity-row\";\nimport \"../entity-rows/hui-input-text-entity-row\";\nimport \"../entity-rows/hui-lock-entity-row\";\nimport \"../entity-rows/hui-media-player-entity-row\";\nimport \"../entity-rows/hui-scene-entity-row\";\nimport \"../entity-rows/hui-script-entity-row\";\nimport \"../entity-rows/hui-sensor-entity-row\";\nimport \"../entity-rows/hui-text-entity-row\";\nimport \"../entity-rows/hui-timer-entity-row\";\nimport \"../entity-rows/hui-toggle-entity-row\";\nimport \"../special-rows/hui-call-service-row\";\nimport \"../special-rows/hui-divider-row\";\nimport \"../special-rows/hui-section-row\";\nimport \"../special-rows/hui-weblink-row\";\nimport { EntityConfig, EntityRow } from \"../entity-rows/types\";\n\nconst CUSTOM_TYPE_PREFIX = \"custom:\";\nconst SPECIAL_TYPES = new Set([\n  \"call-service\",\n  \"divider\",\n  \"section\",\n  \"weblink\",\n]);\nconst DOMAIN_TO_ELEMENT_TYPE = {\n  alert: \"toggle\",\n  automation: \"toggle\",\n  climate: \"climate\",\n  cover: \"cover\",\n  fan: \"toggle\",\n  group: \"group\",\n  input_boolean: \"toggle\",\n  input_number: \"input-number\",\n  input_select: \"input-select\",\n  input_text: \"input-text\",\n  light: \"toggle\",\n  lock: \"lock\",\n  media_player: \"media-player\",\n  remote: \"toggle\",\n  scene: \"scene\",\n  script: \"script\",\n  sensor: \"sensor\",\n  timer: \"timer\",\n  switch: \"toggle\",\n  vacuum: \"toggle\",\n  // Temporary. Once climate is rewritten,\n  // water heater should get it's own row.\n  water_heater: \"climate\",\n  input_datetime: \"input-datetime\",\n};\nconst TIMEOUT = 2000;\n\nconst _createElement = (\n  tag: string,\n  config: EntityConfig\n): EntityRow | HuiErrorCard => {\n  const element = document.createElement(tag) as EntityRow;\n  try {\n    element.setConfig(deepClone(config));\n  } catch (err) {\n    // tslint:disable-next-line\n    console.error(tag, err);\n    return _createErrorElement(err.message, config);\n  }\n\n  return element;\n};\n\nconst _createErrorElement = (\n  error: string,\n  config: EntityConfig\n): HuiErrorCard => createErrorCardElement(createErrorCardConfig(error, config));\n\nconst _hideErrorElement = (element) => {\n  element.style.display = \"None\";\n  return window.setTimeout(() => {\n    element.style.display = \"\";\n  }, TIMEOUT);\n};\n\nexport const createRowElement = (\n  config: EntityConfig\n): EntityRow | HuiErrorCard => {\n  let tag;\n\n  if (\n    !config ||\n    typeof config !== \"object\" ||\n    (!config.entity && !config.type)\n  ) {\n    return _createErrorElement(\"Invalid config given.\", config);\n  }\n\n  const type = config.type || \"default\";\n  if (SPECIAL_TYPES.has(type)) {\n    return _createElement(`hui-${type}-row`, config);\n  }\n\n  if (type.startsWith(CUSTOM_TYPE_PREFIX)) {\n    tag = type.substr(CUSTOM_TYPE_PREFIX.length);\n\n    if (customElements.get(tag)) {\n      return _createElement(tag, config);\n    }\n    const element = _createErrorElement(\n      `Custom element doesn't exist: ${tag}.`,\n      config\n    );\n    const timer = _hideErrorElement(element);\n\n    customElements.whenDefined(tag).then(() => {\n      clearTimeout(timer);\n      fireEvent(element, \"ll-rebuild\");\n    });\n\n    return element;\n  }\n\n  const domain = config.entity.split(\".\", 1)[0];\n  tag = `hui-${DOMAIN_TO_ELEMENT_TYPE[domain] || \"text\"}-entity-row`;\n\n  return _createElement(tag, config);\n};\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-entities-toggle\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { DOMAINS_HIDE_MORE_INFO } from \"../../../common/const\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow } from \"../entity-rows/types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { createRowElement } from \"../common/create-row-element\";\nimport { EntitiesCardConfig, EntitiesCardEntityConfig } from \"./types\";\n\nimport computeDomain from \"../../../common/entity/compute_domain\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\n\n@customElement(\"hui-entities-card\")\nclass HuiEntitiesCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-entities-card-editor\" */ \"../editor/config-elements/hui-entities-card-editor\");\n    return document.createElement(\"hui-entities-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { entities: [] };\n  }\n\n  @property() protected _config?: EntitiesCardConfig;\n\n  protected _hass?: HomeAssistant;\n\n  protected _configEntities?: EntitiesCardEntityConfig[];\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n    this.shadowRoot!.querySelectorAll(\"#states > div > *\").forEach(\n      (element: unknown) => {\n        (element as EntityRow).hass = hass;\n      }\n    );\n    const entitiesToggle = this.shadowRoot!.querySelector(\n      \"hui-entities-toggle\"\n    );\n    if (entitiesToggle) {\n      (entitiesToggle as any).hass = hass;\n    }\n  }\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 0;\n    }\n    // +1 for the header\n    return (this._config.title ? 1 : 0) + this._config.entities.length;\n  }\n\n  public setConfig(config: EntitiesCardConfig): void {\n    const entities = processConfigEntities(config.entities);\n\n    this._config = { theme: \"default\", ...config };\n    this._configEntities = entities;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (this._hass && this._config) {\n      applyThemesOnElement(this, this._hass.themes, this._config.theme);\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this._hass) {\n      return html``;\n    }\n    const { show_header_toggle, title } = this._config;\n\n    return html`\n      <ha-card>\n        ${!title && !show_header_toggle\n          ? html``\n          : html`\n              <div class=\"card-header\">\n                <div class=\"name\">${title}</div>\n                ${show_header_toggle === false\n                  ? html``\n                  : html`\n                      <hui-entities-toggle\n                        .hass=\"${this._hass}\"\n                        .entities=\"${this._configEntities!.map(\n                          (conf) => conf.entity\n                        )}\"\n                      ></hui-entities-toggle>\n                    `}\n              </div>\n            `}\n        <div id=\"states\" class=\"card-content\">\n          ${this._configEntities!.map((entityConf) =>\n            this.renderEntity(entityConf)\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .card-header {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .card-header .name {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n\n      .card-header hui-entities-toggle {\n        margin: -4px 0;\n      }\n\n      #states > * {\n        margin: 8px 0;\n      }\n\n      #states > div > * {\n        overflow: hidden;\n      }\n\n      .state-card-dialog {\n        cursor: pointer;\n      }\n    `;\n  }\n\n  private renderEntity(entityConf: EntitiesCardEntityConfig): TemplateResult {\n    const element = createRowElement(entityConf);\n    if (this._hass) {\n      element.hass = this._hass;\n    }\n    if (\n      entityConf.entity &&\n      !DOMAINS_HIDE_MORE_INFO.includes(computeDomain(entityConf.entity))\n    ) {\n      element.classList.add(\"state-card-dialog\");\n      element.addEventListener(\"click\", () => this._handleClick(entityConf));\n    }\n\n    return html`\n      <div>${element}</div>\n    `;\n  }\n\n  private _handleClick(entityConf: EntitiesCardEntityConfig): void {\n    const entityId = entityConf.entity;\n    fireEvent(this, \"hass-more-info\", { entityId });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entities-card\": HuiEntitiesCard;\n  }\n}\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n/*\nThis code is copied from app-header-layout.\n'fullbleed' support is removed as Home Assisstant doesn't use it.\ntransform: translate(0) is added.\n*/\n/*\n  FIXME(polymer-modulizer): the above comments were extracted\n  from HTML and may be out of place here. Review them and\n  then delete this comment!\n*/\nimport \"@polymer/app-layout/app-header-layout/app-header-layout\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport \"@polymer/polymer/polymer-element\";\n\nclass HaAppLayout extends customElements.get(\"app-header-layout\") {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          /**\n         * Force app-header-layout to have its own stacking context so that its parent can\n         * control the stacking of it relative to other elements (e.g. app-drawer-layout).\n         * This could be done using \\`isolation: isolate\\`, but that's not well supported\n         * across browsers.\n         */\n          position: relative;\n          z-index: 0;\n        }\n\n        #wrapper ::slotted([slot=\"header\"]) {\n          @apply --layout-fixed-top;\n          z-index: 1;\n        }\n\n        #wrapper.initializing ::slotted([slot=\"header\"]) {\n          position: relative;\n        }\n\n        :host([has-scrolling-region]) {\n          height: 100%;\n        }\n\n        :host([has-scrolling-region]) #wrapper ::slotted([slot=\"header\"]) {\n          position: absolute;\n        }\n\n        :host([has-scrolling-region])\n          #wrapper.initializing\n          ::slotted([slot=\"header\"]) {\n          position: relative;\n        }\n\n        :host([has-scrolling-region]) #wrapper #contentContainer {\n          @apply --layout-fit;\n          overflow-y: auto;\n          -webkit-overflow-scrolling: touch;\n        }\n\n        :host([has-scrolling-region]) #wrapper.initializing #contentContainer {\n          position: relative;\n        }\n\n        #contentContainer {\n          /* Create a stacking context here so that all children appear below the header. */\n          position: relative;\n          z-index: 0;\n          /* Using 'transform' will cause 'position: fixed' elements to behave like\n           'position: absolute' relative to this element. */\n          transform: translate(0);\n        }\n\n        @media print {\n          :host([has-scrolling-region]) #wrapper #contentContainer {\n            overflow-y: visible;\n          }\n        }\n      </style>\n\n      <div id=\"wrapper\" class=\"initializing\">\n        <slot id=\"headerSlot\" name=\"header\"></slot>\n\n        <div id=\"contentContainer\"><slot></slot></div>\n        <slot id=\"fab\" name=\"fab\"></slot>\n      </div>\n    `;\n  }\n}\ncustomElements.define(\"ha-app-layout\", HaAppLayout);\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport { EventsMixin } from \"../mixins/events-mixin\";\n\nimport isComponentLoaded from \"../common/config/is_component_loaded\";\nimport { fireEvent } from \"../common/dom/fire_event\";\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaStartVoiceButton extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <paper-icon-button\n        aria-label=\"Start conversation\"\n        icon=\"hass:microphone\"\n        hidden$=\"[[!canListen]]\"\n        on-click=\"handleListenClick\"\n      ></paper-icon-button>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n        value: null,\n      },\n\n      canListen: {\n        type: Boolean,\n        computed: \"computeCanListen(hass)\",\n        notify: true,\n      },\n    };\n  }\n\n  computeCanListen(hass) {\n    return (\n      \"webkitSpeechRecognition\" in window &&\n      isComponentLoaded(hass, \"conversation\")\n    );\n  }\n\n  handleListenClick() {\n    fireEvent(this, \"show-dialog\", {\n      dialogImport: () =>\n        import(\n          /* webpackChunkName: \"voice-command-dialog\" */ \"../dialogs/ha-voice-command-dialog\"\n        ),\n      dialogTag: \"ha-voice-command-dialog\",\n    });\n  }\n}\n\ncustomElements.define(\"ha-start-voice-button\", HaStartVoiceButton);\n","import { Constructor } from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { PaperIconButtonElement } from \"@polymer/paper-icon-button/paper-icon-button\";\n\nconst paperIconButtonClass = customElements.get(\n  \"paper-icon-button\"\n) as Constructor<PaperIconButtonElement>;\n\nexport class HaPaperIconButtonArrowNext extends paperIconButtonClass {\n  public connectedCallback() {\n    this.icon =\n      window.getComputedStyle(this).direction === \"ltr\"\n        ? \"hass:arrow-right\"\n        : \"hass:arrow-left\";\n\n    // calling super after setting icon to have it consistently show the icon (otherwise not always shown)\n    super.connectedCallback();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-icon-button-arrow-next\": HaPaperIconButtonArrowNext;\n  }\n}\n\ncustomElements.define(\n  \"ha-paper-icon-button-arrow-next\",\n  HaPaperIconButtonArrowNext\n);\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\r\n\r\nconst fetchNotifications = (conn) =>\r\n  conn.sendMessagePromise({\r\n    type: \"persistent_notification/get\",\r\n  });\r\n\r\nconst subscribeUpdates = (conn, store) =>\r\n  conn.subscribeEvents(\r\n    () => fetchNotifications(conn).then((ntf) => store.setState(ntf, true)),\r\n    \"persistent_notifications_updated\"\r\n  );\r\n\r\nexport const subscribeNotifications = (\r\n  conn: Connection,\r\n  onChange: (notifications: Notification[]) => void\r\n) =>\r\n  createCollection<Notification[]>(\r\n    \"_ntf\",\r\n    fetchNotifications,\r\n    subscribeUpdates,\r\n    conn,\r\n    onChange\r\n  );\r\n","import {\r\n  html,\r\n  LitElement,\r\n  TemplateResult,\r\n  customElement,\r\n  css,\r\n  CSSResult,\r\n} from \"lit-element\";\r\n\r\nimport \"../../../../components/ha-card\";\r\n\r\n@customElement(\"hui-notification-item-template\")\r\nexport class HuiNotificationItemTemplate extends LitElement {\r\n  protected render(): TemplateResult | void {\r\n    return html`\r\n      <ha-card>\r\n        <div class=\"header\"><slot name=\"header\"></slot></div>\r\n        <div class=\"contents\"><slot></slot></div>\r\n        <div class=\"actions\"><slot name=\"actions\"></slot></div>\r\n      </ha-card>\r\n    `;\r\n  }\r\n\r\n  static get styles(): CSSResult {\r\n    return css`\r\n      .contents {\r\n        padding: 16px;\r\n        -ms-user-select: text;\r\n        -webkit-user-select: text;\r\n        -moz-user-select: text;\r\n        user-select: text;\r\n      }\r\n\r\n      ha-card .header {\r\n        /* start paper-font-headline style */\r\n        font-family: \"Roboto\", \"Noto\", sans-serif;\r\n        -webkit-font-smoothing: antialiased; /* OS X subpixel AA bleed bug */\r\n        text-rendering: optimizeLegibility;\r\n        font-size: 24px;\r\n        font-weight: 400;\r\n        letter-spacing: -0.012em;\r\n        line-height: 32px;\r\n        /* end paper-font-headline style */\r\n\r\n        color: var(--primary-text-color);\r\n        padding: 16px 16px 0;\r\n      }\r\n\r\n      .actions {\r\n        border-top: 1px solid #e8e8e8;\r\n        padding: 5px 16px;\r\n      }\r\n\r\n      ::slotted(.primary) {\r\n        color: var(--primary-color);\r\n      }\r\n    `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"hui-notification-item-template\": HuiNotificationItemTemplate;\r\n  }\r\n}\r\n","import {\r\n  html,\r\n  LitElement,\r\n  TemplateResult,\r\n  property,\r\n  customElement,\r\n} from \"lit-element\";\r\nimport \"@material/mwc-button\";\r\n\r\nimport \"./hui-notification-item-template\";\r\n\r\nimport { HomeAssistant } from \"../../../../types\";\r\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\r\nimport { HassNotification } from \"./types\";\r\n\r\n@customElement(\"hui-configurator-notification-item\")\r\nexport class HuiConfiguratorNotificationItem extends LitElement {\r\n  @property() public hass?: HomeAssistant;\r\n\r\n  @property() public notification?: HassNotification;\r\n\r\n  protected render(): TemplateResult | void {\r\n    if (!this.hass || !this.notification) {\r\n      return html``;\r\n    }\r\n\r\n    return html`\r\n      <hui-notification-item-template>\r\n        <span slot=\"header\">${this.hass.localize(\"domain.configurator\")}</span>\r\n\r\n        <div>\r\n          ${this.hass.localize(\r\n            \"ui.notification_drawer.click_to_configure\",\r\n            \"entity\",\r\n            this.notification.attributes.friendly_name\r\n          )}\r\n        </div>\r\n\r\n        <mwc-button slot=\"actions\" @click=\"${this._handleClick}\"\r\n          >${this.hass.localize(\r\n            `state.configurator.${this.notification.state}`\r\n          )}</mwc-button\r\n        >\r\n      </hui-notification-item-template>\r\n    `;\r\n  }\r\n\r\n  private _handleClick(): void {\r\n    fireEvent(this, \"hass-more-info\", {\r\n      entityId: this.notification!.entity_id,\r\n    });\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"hui-configurator-notification-item\": HuiConfiguratorNotificationItem;\r\n  }\r\n}\r\n","import {\r\n  html,\r\n  LitElement,\r\n  TemplateResult,\r\n  property,\r\n  customElement,\r\n  css,\r\n  CSSResult,\r\n} from \"lit-element\";\r\nimport \"@material/mwc-button\";\r\nimport \"@polymer/paper-tooltip/paper-tooltip\";\r\n\r\nimport \"../../../../components/ha-relative-time\";\r\nimport \"../../../../components/ha-markdown\";\r\nimport \"./hui-notification-item-template\";\r\n\r\nimport { HomeAssistant } from \"../../../../types\";\r\nimport { HassNotification } from \"./types\";\r\n\r\n@customElement(\"hui-persistent-notification-item\")\r\nexport class HuiPersistentNotificationItem extends LitElement {\r\n  @property() public hass?: HomeAssistant;\r\n\r\n  @property() public notification?: HassNotification;\r\n\r\n  protected render(): TemplateResult | void {\r\n    if (!this.hass || !this.notification) {\r\n      return html``;\r\n    }\r\n\r\n    return html`\r\n      <hui-notification-item-template>\r\n        <span slot=\"header\">${this._computeTitle(this.notification)}</span>\r\n\r\n        <ha-markdown content=\"${this.notification.message}\"></ha-markdown>\r\n\r\n        <div class=\"time\">\r\n          <span>\r\n            <ha-relative-time\r\n              .hass=\"${this.hass}\"\r\n              .datetime=\"${this.notification.created_at}\"\r\n            ></ha-relative-time>\r\n            <paper-tooltip\r\n              >${this._computeTooltip(\r\n                this.hass,\r\n                this.notification\r\n              )}</paper-tooltip\r\n            >\r\n          </span>\r\n        </div>\r\n\r\n        <mwc-button slot=\"actions\" @click=\"${this._handleDismiss}\"\r\n          >${this.hass.localize(\r\n            \"ui.card.persistent_notification.dismiss\"\r\n          )}</mwc-button\r\n        >\r\n      </hui-notification-item-template>\r\n    `;\r\n  }\r\n\r\n  static get styles(): CSSResult {\r\n    return css`\r\n      .time {\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        margin-top: 6px;\r\n      }\r\n      ha-relative-time {\r\n        color: var(--secondary-text-color);\r\n      }\r\n      a {\r\n        color: var(--primary-color);\r\n      }\r\n    `;\r\n  }\r\n\r\n  private _handleDismiss(): void {\r\n    this.hass!.callService(\"persistent_notification\", \"dismiss\", {\r\n      notification_id: this.notification!.notification_id,\r\n    });\r\n  }\r\n\r\n  private _computeTitle(notification: HassNotification): string | undefined {\r\n    return notification.title || notification.notification_id;\r\n  }\r\n\r\n  private _computeTooltip(\r\n    hass: HomeAssistant,\r\n    notification: HassNotification\r\n  ): string | undefined {\r\n    if (!hass || !notification) {\r\n      return undefined;\r\n    }\r\n\r\n    const d = new Date(notification.created_at!);\r\n    return d.toLocaleDateString(hass.language, {\r\n      year: \"numeric\",\r\n      month: \"short\",\r\n      day: \"numeric\",\r\n      minute: \"numeric\",\r\n      hour: \"numeric\",\r\n    });\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"hui-persistent-notification-item\": HuiPersistentNotificationItem;\r\n  }\r\n}\r\n","import {\r\n  LitElement,\r\n  property,\r\n  customElement,\r\n  PropertyValues,\r\n  TemplateResult,\r\n  html,\r\n} from \"lit-element\";\r\n\r\nimport \"./hui-configurator-notification-item\";\r\nimport \"./hui-persistent-notification-item\";\r\n\r\nimport { HomeAssistant } from \"../../../../types\";\r\nimport { HassNotification } from \"./types\";\r\n\r\n@customElement(\"hui-notification-item\")\r\nexport class HuiNotificationItem extends LitElement {\r\n  @property() public hass?: HomeAssistant;\r\n\r\n  @property() public notification?: HassNotification;\r\n\r\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\r\n    if (!this.hass || !this.notification || changedProps.has(\"notification\")) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  protected render(): TemplateResult | void {\r\n    if (!this.hass || !this.notification) {\r\n      return html``;\r\n    }\r\n\r\n    return this.notification.entity_id\r\n      ? html`\r\n          <hui-configurator-notification-item\r\n            .hass=\"${this.hass}\"\r\n            .notification=\"${this.notification}\"\r\n          ></hui-configurator-notification-item>\r\n        `\r\n      : html`\r\n          <hui-persistent-notification-item\r\n            .hass=\"${this.hass}\"\r\n            .notification=\"${this.notification}\"\r\n          ></hui-persistent-notification-item>\r\n        `;\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"hui-notification-item\": HuiNotificationItem;\r\n  }\r\n}\r\n","import { Constructor } from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { PaperIconButtonElement } from \"@polymer/paper-icon-button/paper-icon-button\";\n\nconst paperIconButtonClass = customElements.get(\n  \"paper-icon-button\"\n) as Constructor<PaperIconButtonElement>;\n\nexport class HaPaperIconButtonNext extends paperIconButtonClass {\n  public connectedCallback() {\n    this.icon =\n      window.getComputedStyle(this).direction === \"ltr\"\n        ? \"hass:chevron-right\"\n        : \"hass:chevron-left\";\n\n    // calling super after setting icon to have it consistently show the icon (otherwise not always shown)\n    super.connectedCallback();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-icon-button-next\": HaPaperIconButtonNext;\n  }\n}\n\ncustomElements.define(\"ha-paper-icon-button-next\", HaPaperIconButtonNext);\n","import \"@material/mwc-button\";\r\nimport \"@polymer/paper-icon-button/paper-icon-button\";\r\nimport \"@polymer/app-layout/app-toolbar/app-toolbar\";\r\n\r\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\r\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\r\n\r\nimport \"./hui-notification-item\";\r\nimport \"../../../../components/ha-paper-icon-button-next\";\r\n\r\nimport { EventsMixin } from \"../../../../mixins/events-mixin\";\r\nimport LocalizeMixin from \"../../../../mixins/localize-mixin\";\r\nimport { computeRTL } from \"../../../../common/util/compute_rtl\";\r\n\r\n/*\r\n * @appliesMixin EventsMixin\r\n * @appliesMixin LocalizeMixin\r\n */\r\nexport class HuiNotificationDrawer extends EventsMixin(\r\n  LocalizeMixin(PolymerElement)\r\n) {\r\n  static get template() {\r\n    return html`\r\n    <style include=\"paper-material-styles\">\r\n      :host {\r\n        bottom: 0;\r\n        left: 0;\r\n        position: absolute;\r\n        right: 0;\r\n        top: 0;\r\n      }\r\n\r\n      :host([hidden]) {\r\n        display: none;\r\n      }\r\n\r\n      .container {\r\n        align-items: stretch;\r\n        background: var(--sidebar-background-color, var(--primary-background-color));\r\n        bottom: 0;\r\n        box-shadow: var(--paper-material-elevation-1_-_box-shadow);\r\n        display: flex;\r\n        flex-direction: column;\r\n        overflow-y: hidden;\r\n        position: fixed;\r\n        top: 0;\r\n        transition: right .2s ease-in;\r\n        width: 500px;\r\n        z-index: 10;\r\n      }\r\n\r\n      :host([rtl]) .container {\r\n        transition: left .2s ease-in !important;\r\n      }\r\n\r\n      :host(:not(narrow)) .container {\r\n        right: -500px;\r\n      }\r\n\r\n      :host([rtl]:not(narrow)) .container {\r\n        left: -500px;\r\n      }\r\n\r\n      :host([narrow]) .container {\r\n        right: -100%;\r\n        width: 100%;\r\n      }\r\n\r\n      :host([rtl][narrow]) .container {\r\n        left: -100%;\r\n        width: 100%;\r\n      }\r\n\r\n      :host(.open) .container,\r\n      :host(.open[narrow]) .container {\r\n        right: 0;\r\n      }\r\n\r\n      :host([rtl].open) .container,\r\n      :host([rtl].open[narrow]) .container {\r\n        left: 0;\r\n      }\r\n\r\n      app-toolbar {\r\n        color: var(--primary-text-color);\r\n        border-bottom: 1px solid var(--divider-color);\r\n        background-color: var(--primary-background-color);\r\n        min-height: 64px;\r\n        width: calc(100% - 32px);\r\n        z-index: 11;\r\n      }\r\n\r\n      .overlay {\r\n        display: none;\r\n      }\r\n\r\n      :host(.open) .overlay {\r\n        bottom: 0;\r\n        display: block;\r\n        left: 0;\r\n        position: absolute;\r\n        right: 0;\r\n        top: 0;\r\n        z-index: 5;\r\n      }\r\n\r\n      .notifications {\r\n        overflow-y: auto;\r\n        padding-top: 16px;\r\n      }\r\n\r\n      .notification {\r\n        padding: 0 16px 16px;\r\n      }\r\n\r\n      .empty {\r\n        padding: 16px;\r\n        text-align: center;\r\n      }\r\n    </style>\r\n    <div class=\"overlay\" on-click=\"_closeDrawer\"></div>\r\n    <div class=\"container\">\r\n      <app-toolbar>\r\n        <div main-title>[[localize('ui.notification_drawer.title')]]</div>\r\n        <ha-paper-icon-button-next on-click=\"_closeDrawer\"></paper-icon-button>\r\n      </app-toolbar>\r\n      <div class=\"notifications\">\r\n        <template is=\"dom-if\" if=\"[[!_empty(notifications)]]\">\r\n          <dom-repeat items=\"[[notifications]]\">\r\n            <template>\r\n              <div class=\"notification\">\r\n                <hui-notification-item hass=\"[[hass]]\" notification=\"[[item]]\"></hui-notification-item>\r\n              </div>\r\n            </template>\r\n          </dom-repeat>\r\n        </template>\r\n        <template is=\"dom-if\" if=\"[[_empty(notifications)]]\">\r\n          <div class=\"empty\">[[localize('ui.notification_drawer.empty')]]<div>\r\n        </template>\r\n      </div>\r\n    </div>\r\n    `;\r\n  }\r\n\r\n  static get properties() {\r\n    return {\r\n      hass: Object,\r\n      narrow: {\r\n        type: Boolean,\r\n        reflectToAttribute: true,\r\n      },\r\n      open: {\r\n        type: Boolean,\r\n        notify: true,\r\n        observer: \"_openChanged\",\r\n      },\r\n      hidden: {\r\n        type: Boolean,\r\n        value: true,\r\n        reflectToAttribute: true,\r\n      },\r\n      notifications: {\r\n        type: Array,\r\n        value: [],\r\n      },\r\n      rtl: {\r\n        type: Boolean,\r\n        reflectToAttribute: true,\r\n        computed: \"_computeRTL(hass)\",\r\n      },\r\n    };\r\n  }\r\n\r\n  _closeDrawer(ev) {\r\n    ev.stopPropagation();\r\n    this.open = false;\r\n  }\r\n\r\n  _empty(notifications) {\r\n    return notifications.length === 0;\r\n  }\r\n\r\n  _openChanged(open) {\r\n    clearTimeout(this._openTimer);\r\n    if (open) {\r\n      // Render closed then animate open\r\n      this.hidden = false;\r\n      this._openTimer = setTimeout(() => {\r\n        this.classList.add(\"open\");\r\n      }, 50);\r\n    } else {\r\n      // Animate closed then hide\r\n      this.classList.remove(\"open\");\r\n      this._openTimer = setTimeout(() => {\r\n        this.hidden = true;\r\n      }, 250);\r\n    }\r\n  }\r\n\r\n  _computeRTL(hass) {\r\n    return computeRTL(hass);\r\n  }\r\n}\r\ncustomElements.define(\"hui-notification-drawer\", HuiNotificationDrawer);\r\n","import {\r\n  html,\r\n  LitElement,\r\n  TemplateResult,\r\n  css,\r\n  CSSResult,\r\n  property,\r\n} from \"lit-element\";\r\nimport \"@polymer/paper-icon-button/paper-icon-button\";\r\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\r\n\r\ndeclare global {\r\n  // tslint:disable-next-line\r\n  interface HASSDomEvents {\r\n    \"opened-changed\": { value: boolean };\r\n  }\r\n}\r\n\r\nclass HuiNotificationsButton extends LitElement {\r\n  @property() public notifications?: string[];\r\n  @property() public opened?: boolean;\r\n\r\n  protected render(): TemplateResult | void {\r\n    return html`\r\n      <paper-icon-button\r\n        aria-label=\"Show Notifications\"\r\n        icon=\"hass:bell\"\r\n        @click=\"${this._clicked}\"\r\n      ></paper-icon-button>\r\n      ${this.notifications && this.notifications.length > 0\r\n        ? html`\r\n            <span class=\"indicator\">\r\n              <div>${this.notifications.length}</div>\r\n            </span>\r\n          `\r\n        : \"\"}\r\n    `;\r\n  }\r\n\r\n  static get styles(): CSSResult[] {\r\n    return [\r\n      css`\r\n        :host {\r\n          position: relative;\r\n        }\r\n\r\n        .indicator {\r\n          position: absolute;\r\n          top: 0px;\r\n          right: -3px;\r\n          width: 20px;\r\n          height: 20px;\r\n          border-radius: 50%;\r\n          background: var(--accent-color);\r\n          pointer-events: none;\r\n          z-index: 1;\r\n        }\r\n\r\n        .indicator > div {\r\n          right: 7px;\r\n          top: 3px;\r\n          position: absolute;\r\n          font-size: 0.55em;\r\n        }\r\n      `,\r\n    ];\r\n  }\r\n\r\n  private _clicked() {\r\n    this.opened = true;\r\n    fireEvent(this, \"opened-changed\", { value: this.opened });\r\n  }\r\n}\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"hui-notifications-button\": HuiNotificationsButton;\r\n  }\r\n}\r\n\r\ncustomElements.define(\"hui-notifications-button\", HuiNotificationsButton);\r\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  property,\n  PropertyDeclarations,\n  TemplateResult,\n} from \"lit-element\";\n\nimport \"../../components/entity/ha-state-label-badge\";\n// This one is for types\n// tslint:disable-next-line\nimport { HaStateLabelBadge } from \"../../components/entity/ha-state-label-badge\";\n\nimport applyThemesOnElement from \"../../common/dom/apply_themes_on_element\";\n\nimport { LovelaceViewConfig, LovelaceCardConfig } from \"../../data/lovelace\";\nimport { HomeAssistant } from \"../../types\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport { Lovelace, LovelaceCard } from \"./types\";\nimport { createCardElement } from \"./common/create-card-element\";\nimport { computeCardSize } from \"./common/compute-card-size\";\nimport { showEditCardDialog } from \"./editor/card-editor/show-edit-card-dialog\";\nimport { HuiErrorCard } from \"./cards/hui-error-card\";\n\nimport { computeRTL } from \"../../common/util/compute_rtl\";\n\nlet editCodeLoaded = false;\n\n// Find column with < 5 entities, else column with lowest count\nconst getColumnIndex = (columnEntityCount: number[], size: number) => {\n  let minIndex = 0;\n  for (let i = 0; i < columnEntityCount.length; i++) {\n    if (columnEntityCount[i] < 5) {\n      minIndex = i;\n      break;\n    }\n    if (columnEntityCount[i] < columnEntityCount[minIndex]) {\n      minIndex = i;\n    }\n  }\n\n  columnEntityCount[minIndex] += size;\n\n  return minIndex;\n};\n\nexport class HUIView extends LitElement {\n  @property() public hass?: HomeAssistant;\n  \n  @property() public lovelace?: Lovelace;\n  \n  @property() public columns?: number;\n  \n  @property() public index?: number;\n  \n  private _cards: Array<LovelaceCard | HuiErrorCard>;\n  private _badges: Array<{ element: HaStateLabelBadge; entityId: string }>;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      hass: {},\n      lovelace: {},\n      columns: {},\n      index: {},\n      _cards: {},\n      _badges: {},\n    };\n  }\n\n  constructor() {\n    super();\n    this._cards = [];\n    this._badges = [];\n  }\n\n  // Public to make demo happy\n  public createCardElement(cardConfig: LovelaceCardConfig) {\n    const element = createCardElement(cardConfig) as LovelaceCard;\n    element.hass = this.hass;\n    element.addEventListener(\n      \"ll-rebuild\",\n      (ev) => {\n        // In edit mode let it go to hui-root and rebuild whole view.\n        if (!this.lovelace!.editMode) {\n          ev.stopPropagation();\n          this._rebuildCard(element, cardConfig);\n        }\n      },\n      { once: true }\n    );\n    return element;\n  }\n\n  protected render(): TemplateResult | void {\n    return html`\n      ${this.renderStyles()}\n      <div id=\"badges\"></div>\n      <div id=\"columns\"></div>\n      ${this.lovelace!.editMode\n        ? html`\n            <paper-fab\n              elevated=\"2\"\n              icon=\"hass:plus\"\n              title=\"${this.hass!.localize(\n                \"ui.panel.lovelace.editor.edit_card.add\"\n              )}\"\n              @click=\"${this._addCard}\"\n              class=\"${classMap({\n                rtl: computeRTL(this.hass!),\n              })}\"\n            ></paper-fab>\n          `\n        : \"\"}\n    `;\n  }\n\n  protected renderStyles(): TemplateResult {\n    return html`\n      <style>\n        :host {\n          display: block;\n          padding: 4px 4px 0;\n          transform: translateZ(0);\n          position: relative;\n          min-height: calc(100vh - 155px);\n        }\n\n        #badges {\n          margin: 8px 16px;\n          font-size: 85%;\n          text-align: center;\n        }\n\n        #columns {\n          display: flex;\n          flex-direction: row;\n          justify-content: center;\n        }\n\n        .column {\n          flex-basis: 0;\n          flex-grow: 1;\n          max-width: 500px;\n          overflow-x: hidden;\n        }\n\n        .column > * {\n          display: block;\n          margin: 4px 4px 8px;\n        }\n\n        paper-fab {\n          position: sticky;\n          float: right;\n          bottom: 16px;\n          right: 16px;\n          z-index: 1;\n        }\n\n        paper-fab.rtl {\n          float: left;\n          right: auto;\n          left: 16px;\n        }\n\n        @media (max-width: 500px) {\n          :host {\n            padding-left: 0;\n            padding-right: 0;\n          }\n\n          .column > * {\n            margin-left: 0;\n            margin-right: 0;\n          }\n        }\n\n        @media (max-width: 599px) {\n          .column {\n            max-width: 600px;\n          }\n        }\n      </style>\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    const lovelace = this.lovelace!;\n\n    if (lovelace.editMode && !editCodeLoaded) {\n      editCodeLoaded = true;\n      import(/* webpackChunkName: \"hui-view-editable\" */ \"./hui-view-editable\");\n    }\n\n    let editModeChanged = false;\n    let configChanged = false;\n\n    if (changedProperties.has(\"lovelace\")) {\n      const oldLovelace = changedProperties.get(\"lovelace\") as Lovelace;\n      editModeChanged =\n        !oldLovelace || lovelace.editMode !== oldLovelace.editMode;\n      configChanged = !oldLovelace || lovelace.config !== oldLovelace.config;\n    }\n\n    if (configChanged) {\n      this._createBadges(lovelace.config.views[this.index!]);\n    } else if (changedProperties.has(\"hass\")) {\n      this._badges.forEach((badge) => {\n        const { element, entityId } = badge;\n        element.hass = this.hass!;\n        element.state = this.hass!.states[entityId];\n      });\n    }\n\n    if (configChanged || editModeChanged || changedProperties.has(\"columns\")) {\n      this._createCards(lovelace.config.views[this.index!]);\n    } else if (changedProperties.has(\"hass\")) {\n      this._cards.forEach((element) => {\n        element.hass = this.hass;\n      });\n    }\n  }\n\n  private _addCard(): void {\n    showEditCardDialog(this, {\n      lovelace: this.lovelace!,\n      path: [this.index!],\n    });\n  }\n\n  private _createBadges(config: LovelaceViewConfig): void {\n    const root = this.shadowRoot!.getElementById(\"badges\")!;\n\n    while (root.lastChild) {\n      root.removeChild(root.lastChild);\n    }\n\n    if (!config || !config.badges || !Array.isArray(config.badges)) {\n      root.style.display = \"none\";\n      this._badges = [];\n      return;\n    }\n\n    const elements: HUIView[\"_badges\"] = [];\n    for (const entityId of config.badges) {\n      const element = document.createElement(\"ha-state-label-badge\");\n      element.hass = this.hass;\n      element.state = this.hass!.states[entityId];\n      elements.push({ element, entityId });\n      root.appendChild(element);\n    }\n    this._badges = elements;\n    root.style.display = elements.length > 0 ? \"block\" : \"none\";\n  }\n\n  private _createCards(config: LovelaceViewConfig): void {\n    const root = this.shadowRoot!.getElementById(\"columns\")!;\n\n    while (root.lastChild) {\n      root.removeChild(root.lastChild);\n    }\n\n    if (!config || !config.cards || !Array.isArray(config.cards)) {\n      this._cards = [];\n      return;\n    }\n\n    const elements: LovelaceCard[] = [];\n    const elementsToAppend: HTMLElement[] = [];\n    config.cards.forEach((cardConfig, cardIndex) => {\n      const element = this.createCardElement(cardConfig);\n      elements.push(element);\n\n      if (!this.lovelace!.editMode) {\n        elementsToAppend.push(element);\n        return;\n      }\n\n      const wrapper = document.createElement(\"hui-card-options\");\n      wrapper.hass = this.hass;\n      wrapper.lovelace = this.lovelace;\n      wrapper.path = [this.index!, cardIndex];\n      wrapper.appendChild(element);\n      elementsToAppend.push(wrapper);\n    });\n\n    let columns: HTMLElement[][] = [];\n    const columnEntityCount: number[] = [];\n    for (let i = 0; i < this.columns!; i++) {\n      columns.push([]);\n      columnEntityCount.push(0);\n    }\n\n    elements.forEach((el, index) => {\n      const cardSize = computeCardSize(el);\n      // Element to append might be the wrapped card when we're editing.\n      columns[getColumnIndex(columnEntityCount, cardSize)].push(\n        elementsToAppend[index]\n      );\n    });\n\n    // Remove empty columns\n    columns = columns.filter((val) => val.length > 0);\n\n    columns.forEach((column) => {\n      const columnEl = document.createElement(\"div\");\n      columnEl.classList.add(\"column\");\n      column.forEach((el) => columnEl.appendChild(el));\n      root.appendChild(columnEl);\n    });\n\n    this._cards = elements;\n\n    if (\"theme\" in config) {\n      applyThemesOnElement(root, this.hass!.themes, config.theme);\n    }\n  }\n\n  private _rebuildCard(\n    cardElToReplace: LovelaceCard,\n    config: LovelaceCardConfig\n  ): void {\n    const newCardEl = this.createCardElement(config);\n    cardElToReplace.parentElement!.replaceChild(newCardEl, cardElToReplace);\n    this._cards = this._cards!.map((curCardEl) =>\n      curCardEl === cardElToReplace ? newCardEl : curCardEl\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-view\": HUIView;\n  }\n}\n\ncustomElements.define(\"hui-view\", HUIView);\n","import { HASSDomEvent, fireEvent } from \"../../../../common/dom/fire_event\";\nimport { Lovelace } from \"../../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"reload-lovelace\": undefined;\n    \"show-edit-view\": EditViewDialogParams;\n  }\n  // for add event listener\n  interface HTMLElementEventMap {\n    \"reload-lovelace\": HASSDomEvent<undefined>;\n  }\n}\n\nlet registeredDialog = false;\nconst dialogShowEvent = \"show-edit-view\";\nconst dialogTag = \"hui-dialog-edit-view\";\n\nexport interface EditViewDialogParams {\n  lovelace: Lovelace;\n  viewIndex?: number;\n}\n\nconst registerEditViewDialog = (element: HTMLElement): Event =>\n  fireEvent(element, \"register-dialog\", {\n    dialogShowEvent,\n    dialogTag,\n    dialogImport: () =>\n      import(/* webpackChunkName: \"hui-dialog-edit-view\" */ \"./hui-dialog-edit-view\"),\n  });\n\nexport const showEditViewDialog = (\n  element: HTMLElement,\n  editViewDialogParams: EditViewDialogParams\n): void => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    registerEditViewDialog(element);\n  }\n  fireEvent(element, dialogShowEvent, editViewDialogParams);\n};\n","import { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { Lovelace } from \"../../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"show-edit-lovelace\": Lovelace;\n  }\n}\n\nlet registeredDialog = false;\nconst dialogShowEvent = \"show-edit-lovelace\";\nconst dialogTag = \"hui-dialog-edit-lovelace\";\n\nconst registerEditLovelaceDialog = (element: HTMLElement): Event =>\n  fireEvent(element, \"register-dialog\", {\n    dialogShowEvent,\n    dialogTag,\n    dialogImport: () =>\n      import(/* webpackChunkName: \"hui-dialog-edit-lovelace\" */ \"./hui-dialog-edit-lovelace\"),\n  });\n\nexport const showEditLovelaceDialog = (\n  element: HTMLElement,\n  lovelace: Lovelace\n): void => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    registerEditLovelaceDialog(element);\n  }\n  fireEvent(element, dialogShowEvent, lovelace);\n};\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n  property,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport \"@polymer/app-layout/app-header-layout/app-header-layout\";\nimport \"@polymer/app-layout/app-header/app-header\";\nimport \"@polymer/app-layout/app-scroll-effects/effects/waterfall\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar\";\nimport \"@polymer/app-route/app-route\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@material/mwc-button\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-listbox/paper-listbox\";\nimport \"@polymer/paper-menu-button/paper-menu-button\";\nimport \"@polymer/paper-tabs/paper-tab\";\nimport \"@polymer/paper-tabs/paper-tabs\";\nimport { HassEntities } from \"home-assistant-js-websocket\";\n\nimport scrollToTarget from \"../../common/dom/scroll-to-target\";\n\nimport \"../../layouts/ha-app-layout\";\nimport \"../../components/ha-start-voice-button\";\nimport \"../../components/ha-paper-icon-button-arrow-next\";\nimport \"../../components/ha-paper-icon-button-arrow-prev\";\nimport \"../../components/ha-icon\";\nimport { loadModule, loadCSS, loadJS } from \"../../common/dom/load_resource\";\nimport { subscribeNotifications } from \"../../data/ws-notifications\";\nimport { debounce } from \"../../common/util/debounce\";\nimport { HomeAssistant } from \"../../types\";\nimport { LovelaceConfig } from \"../../data/lovelace\";\nimport { navigate } from \"../../common/navigate\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { computeNotifications } from \"./common/compute-notifications\";\nimport { swapView } from \"./editor/config-util\";\n\nimport \"./components/notifications/hui-notification-drawer\";\nimport \"./components/notifications/hui-notifications-button\";\nimport \"./hui-view\";\n// Not a duplicate import, this one is for type\n// tslint:disable-next-line\nimport { HUIView } from \"./hui-view\";\nimport { createCardElement } from \"./common/create-card-element\";\nimport { showEditViewDialog } from \"./editor/view-editor/show-edit-view-dialog\";\nimport { showEditLovelaceDialog } from \"./editor/lovelace-editor/show-edit-lovelace-dialog\";\nimport { Lovelace } from \"./types\";\nimport { afterNextRender } from \"../../common/util/render-status\";\nimport { haStyle } from \"../../resources/styles\";\nimport { computeRTLDirection } from \"../../common/util/compute_rtl\";\n\n// CSS and JS should only be imported once. Modules and HTML are safe.\nconst CSS_CACHE = {};\nconst JS_CACHE = {};\n\nclass HUIRoot extends LitElement {\n  @property() public hass?: HomeAssistant;\n  @property() public lovelace?: Lovelace;\n  @property() public columns?: number;\n  @property() public narrow?: boolean;\n  @property() public route?: { path: string; prefix: string };\n  @property() private _routeData?: { view: string };\n  @property() private _curView?: number | \"hass-unused-entities\";\n  @property() private _notificationsOpen = false;\n  @property() private _persistentNotifications?: Notification[];\n  private _viewCache?: { [viewId: string]: HUIView };\n\n  private _debouncedConfigChanged: () => void;\n  private _unsubNotifications?: () => void;\n\n  constructor() {\n    super();\n    // The view can trigger a re-render when it knows that certain\n    // web components have been loaded.\n    this._debouncedConfigChanged = debounce(\n      () => this._selectView(this._curView, true),\n      100,\n      false\n    );\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._unsubNotifications = subscribeNotifications(\n      this.hass!.connection,\n      (notifications) => {\n        this._persistentNotifications = notifications;\n      }\n    );\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    if (this._unsubNotifications) {\n      this._unsubNotifications();\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    return html`\n    <app-route .route=\"${this.route}\" pattern=\"/:view\" data=\"${\n      this._routeData\n    }\" @data-changed=\"${this._routeDataChanged}\"></app-route>\n    <hui-notification-drawer\n      .hass=\"${this.hass}\"\n      .notifications=\"${this._notifications}\"\n      .open=\"${this._notificationsOpen}\"\n      @open-changed=\"${this._handleNotificationsOpenChanged}\"\n      .narrow=\"${this.narrow}\"\n    ></hui-notification-drawer>\n    <ha-app-layout id=\"layout\">\n      <app-header slot=\"header\" effects=\"waterfall\" class=\"${classMap({\n        \"edit-mode\": this._editMode,\n      })}\" fixed condenses>\n        ${\n          this._editMode\n            ? html`\n                <app-toolbar class=\"edit-mode\">\n                  <paper-icon-button\n                    icon=\"hass:close\"\n                    @click=\"${this._editModeDisable}\"\n                  ></paper-icon-button>\n                  <div main-title>\n                    ${this.config.title ||\n                      this.hass!.localize(\"ui.panel.lovelace.editor.header\")}\n                    <paper-icon-button\n                      icon=\"hass:pencil\"\n                      class=\"edit-icon\"\n                      @click=\"${this._editLovelace}\"\n                    ></paper-icon-button>\n                  </div>\n                  <paper-icon-button\n                    icon=\"hass:help-circle\"\n                    title=\"Help\"\n                    @click=\"${this._handleHelp}\"\n                  ></paper-icon-button>\n                  <paper-menu-button\n                    no-animations\n                    horizontal-align=\"right\"\n                    horizontal-offset=\"-5\"\n                  >\n                    <paper-icon-button\n                      aria-label=\"Open Lovelace menu\"\n                      icon=\"hass:dots-vertical\"\n                      slot=\"dropdown-trigger\"\n                    ></paper-icon-button>\n                    <paper-listbox\n                      @iron-select=\"${this._deselect}\"\n                      slot=\"dropdown-content\"\n                    >\n                      <paper-item @click=\"${this.lovelace!.enableFullEditMode}\"\n                        >${this.hass!.localize(\n                          \"ui.panel.lovelace.editor.menu.raw_editor\"\n                        )}</paper-item\n                      >\n                    </paper-listbox>\n                  </paper-menu-button>\n                </app-toolbar>\n              `\n            : /* IoB */ this._hideToolbar\n            ? \"\"\n            : html`\n                <app-toolbar>\n                  <!-- Disabled for IoB -->\n                  <!--ha-menu-button\n                    .hass=${this.hass}\n                    .narrow=${this.narrow}\n                  ></ha-menu-button-->\n                  <div main-title>${this.config.title || \"Home Assistant\"}</div>\n                  <hui-notifications-button\n                    .hass=\"${this.hass}\"\n                    .opened=\"${this._notificationsOpen}\"\n                    @opened-changed=\"${this._handleNotificationsOpenChanged}\"\n                    .notifications=\"${this._notifications}\"\n                  ></hui-notifications-button>\n                  <ha-start-voice-button\n                    .hass=\"${this.hass}\"\n                  ></ha-start-voice-button>\n                  <paper-menu-button\n                    no-animations\n                    horizontal-align=\"right\"\n                    horizontal-offset=\"-5\"\n                  >\n                    <paper-icon-button\n                      icon=\"hass:dots-vertical\"\n                      slot=\"dropdown-trigger\"\n                    ></paper-icon-button>\n                    <paper-listbox\n                      @iron-select=\"${this._deselect}\"\n                      slot=\"dropdown-content\"\n                    >\n                      ${this._yamlMode\n                        ? html`\n                            <paper-item @click=\"${this._handleRefresh}\"\n                              >${this.hass!.localize(\n                                \"ui.panel.lovelace.menu.refresh\"\n                              )}</paper-item\n                            >\n                          `\n                        : \"\"}\n                      ${__DEMO__ /* No unused entities available in the demo */\n                        ? \"\"\n                        : html`\n                            <paper-item @click=\"${this._handleUnusedEntities}\">\n                              ${this.hass!.localize(\n                                \"ui.panel.lovelace.menu.unused_entities\"\n                              )}\n                            </paper-item>\n                          `}\n                      <paper-item @click=\"${this._editModeEnable}\"\n                        >${this.hass!.localize(\n                          \"ui.panel.lovelace.menu.configure_ui\"\n                        )}</paper-item\n                      >\n                      <paper-item @click=\"${this._handleHelp}\"\n                        >${this.hass!.localize(\n                          \"ui.panel.lovelace.menu.help\"\n                        )}</paper-item\n                      >\n                    </paper-listbox>\n                  </paper-menu-button>\n                </app-toolbar>\n              `\n        }\n\n        ${\n          this.lovelace!.config.views.length > 1 || this._editMode\n            ? html`\n                <div sticky>\n                  <paper-tabs\n                    scrollable\n                    .selected=\"${this._curView}\"\n                    @iron-activate=\"${this._handleViewSelected}\"\n                    dir=\"${computeRTLDirection(this.hass!)}\"\n                  >\n                    ${this.lovelace!.config.views.map(\n                      (view) => html`\n                        <paper-tab aria-label=\"${view.title}\">\n                          ${this._editMode\n                            ? html`\n                                <ha-paper-icon-button-arrow-prev\n                                  title=\"Move view left\"\n                                  class=\"edit-icon view\"\n                                  @click=\"${this._moveViewLeft}\"\n                                  ?disabled=\"${this._curView === 0}\"\n                                ></ha-paper-icon-button-arrow-prev>\n                              `\n                            : \"\"}\n                          ${view.icon\n                            ? html`\n                                <ha-icon\n                                  title=\"${view.title}\"\n                                  .icon=\"${view.icon}\"\n                                ></ha-icon>\n                              `\n                            : view.title || \"Unnamed view\"}\n                          ${this._editMode\n                            ? html`\n                                <ha-icon\n                                  title=\"Edit view\"\n                                  class=\"edit-icon view\"\n                                  icon=\"hass:pencil\"\n                                  @click=\"${this._editView}\"\n                                ></ha-icon>\n                                <ha-paper-icon-button-arrow-next\n                                  title=\"Move view right\"\n                                  class=\"edit-icon view\"\n                                  @click=\"${this._moveViewRight}\"\n                                  ?disabled=\"${(this._curView! as number) +\n                                    1 ===\n                                    this.lovelace!.config.views.length}\"\n                                ></ha-paper-icon-button-arrow-next>\n                              `\n                            : \"\"}\n                        </paper-tab>\n                      `\n                    )}\n                    ${this._editMode\n                      ? html`\n                          <paper-icon-button\n                            id=\"add-view\"\n                            @click=\"${this._addView}\"\n                            title=\"${this.hass!.localize(\n                              \"ui.panel.lovelace.editor.edit_view.add\"\n                            )}\"\n                            icon=\"hass:plus\"\n                          ></paper-icon-button>\n                        `\n                      : \"\"}\n                  </paper-tabs>\n                </div>\n              `\n            : \"\"\n        }\n      </app-header>\n      <div id='view' class=\"${classMap({\n        \"tabs-hidden\": this.lovelace!.config.views.length < 2,\n      })}\" @ll-rebuild='${this._debouncedConfigChanged}'></div>\n    </app-header-layout>\n    `;\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      haStyle,\n      css`\n        :host {\n          -ms-user-select: none;\n          -webkit-user-select: none;\n          -moz-user-select: none;\n          --dark-color: #455a64;\n          --text-dark-color: #fff;\n        }\n\n        ha-app-layout {\n          min-height: 100%;\n        }\n        paper-menu-button {\n          padding: 0;\n        }\n        paper-tabs {\n          margin-left: 12px;\n          --paper-tabs-selection-bar-color: var(--text-primary-color, #fff);\n          text-transform: uppercase;\n        }\n        .edit-mode {\n          background-color: var(--dark-color, #455a64);\n          color: var(--text-dark-color);\n        }\n        .edit-mode div[main-title] {\n          pointer-events: auto;\n        }\n        paper-tab.iron-selected .edit-icon {\n          display: inline-flex;\n        }\n        .edit-icon {\n          color: var(--accent-color);\n          padding-left: 8px;\n        }\n        .edit-icon[disabled] {\n          color: var(--disabled-text-color);\n        }\n        .edit-icon.view {\n          display: none;\n        }\n        #add-view {\n          position: absolute;\n          height: 44px;\n        }\n        #add-view ha-icon {\n          background-color: var(--accent-color);\n          border-radius: 5px;\n          margin-top: 4px;\n        }\n        app-toolbar a {\n          color: var(--text-primary-color, white);\n        }\n        mwc-button.warning:not([disabled]) {\n          color: var(--google-red-500);\n        }\n        #view {\n          min-height: calc(100vh - 112px);\n          /**\n         * Since we only set min-height, if child nodes need percentage\n         * heights they must use absolute positioning so we need relative\n         * positioning here.\n         *\n         * https://www.w3.org/TR/CSS2/visudet.html#the-height-property\n         */\n          position: relative;\n        }\n        #view.tabs-hidden {\n          min-height: calc(100vh - 64px);\n        }\n        paper-item {\n          cursor: pointer;\n        }\n      `,\n    ];\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    const view = this._viewRoot;\n    const huiView = view.lastChild as HUIView;\n\n    if (changedProperties.has(\"columns\") && huiView) {\n      huiView.columns = this.columns;\n    }\n\n    if (changedProperties.has(\"hass\") && huiView) {\n      huiView.hass = this.hass;\n    }\n\n    let newSelectView;\n    let force = false;\n\n    if (changedProperties.has(\"route\")) {\n      const views = this.config && this.config.views;\n      if (\n        this.route!.path === \"\" &&\n        this.route!.prefix === \"/lovelace\" &&\n        views\n      ) {\n        navigate(this, `/lovelace/${views[0].path || 0}`, true);\n        newSelectView = 0;\n      } else if (this._routeData!.view === \"hass-unused-entities\") {\n        newSelectView = \"hass-unused-entities\";\n      } else if (this._routeData!.view) {\n        const selectedView = this._routeData!.view;\n        const selectedViewInt = parseInt(selectedView, 10);\n        let index = 0;\n        for (let i = 0; i < views.length; i++) {\n          if (views[i].path === selectedView || i === selectedViewInt) {\n            index = i;\n            break;\n          }\n        }\n        newSelectView = index;\n      }\n    }\n\n    if (changedProperties.has(\"lovelace\")) {\n      const oldLovelace = changedProperties.get(\"lovelace\") as\n        | Lovelace\n        | undefined;\n\n      if (!oldLovelace || oldLovelace.config !== this.lovelace!.config) {\n        this._loadResources(this.lovelace!.config.resources || []);\n        // On config change, recreate the current view from scratch.\n        force = true;\n        // Recalculate to see if we need to adjust content area for tab bar\n        fireEvent(this, \"iron-resize\");\n      }\n\n      if (!oldLovelace || oldLovelace.editMode !== this.lovelace!.editMode) {\n        // On edit mode change, recreate the current view from scratch\n        force = true;\n        // Recalculate to see if we need to adjust content area for tab bar\n        fireEvent(this, \"iron-resize\");\n      }\n    }\n\n    if (newSelectView !== undefined || force) {\n      if (force && newSelectView === undefined) {\n        newSelectView = this._curView;\n      }\n      // Will allow for ripples to start rendering\n      afterNextRender(() => this._selectView(newSelectView, force));\n    }\n  }\n\n  private get _notifications() {\n    return this._updateNotifications(\n      this.hass!.states,\n      this._persistentNotifications! || []\n    );\n  }\n\n  // IoB\n  private get _hideToolbar(): boolean {\n    return (\n      this.config.hideToolbar === true &&\n      window.location.search.indexOf(\"toolbar\") === -1\n    );\n  }\n\n  private get config(): LovelaceConfig {\n    return this.lovelace!.config;\n  }\n\n  private get _yamlMode(): boolean {\n    return this.lovelace!.mode === \"yaml\";\n  }\n\n  private get _editMode() {\n    return this.lovelace!.editMode;\n  }\n\n  private get _layout(): any {\n    return this.shadowRoot!.getElementById(\"layout\");\n  }\n\n  private get _viewRoot(): HTMLDivElement {\n    return this.shadowRoot!.getElementById(\"view\") as HTMLDivElement;\n  }\n\n  private _routeDataChanged(ev): void {\n    this._routeData = ev.detail.value;\n  }\n\n  private _handleNotificationsOpenChanged(ev): void {\n    this._notificationsOpen = ev.detail.value;\n  }\n\n  private _updateNotifications(\n    states: HassEntities,\n    persistent: unknown[]\n  ): unknown[] {\n    const configurator = computeNotifications(states);\n    return persistent.concat(configurator);\n  }\n\n  private _handleRefresh(): void {\n    fireEvent(this, \"config-refresh\");\n  }\n\n  private _handleUnusedEntities(): void {\n    navigate(this, `/lovelace/hass-unused-entities`);\n  }\n\n  private _deselect(ev): void {\n    ev.target.selected = null;\n  }\n\n  private _handleHelp(): void {\n    // window.open(\"https://www.home-assistant.io/lovelace/\", \"_blank\");\n    // IoB\n    window.open(\n      \"https://www.iobroker.net/#en/adapters/adapterref/iobroker.lovelace/README.md\",\n      \"_blank\"\n    );\n  }\n\n  private _editModeEnable(): void {\n    if (this._yamlMode) {\n      window.alert(\"The edit UI is not available when in YAML mode.\");\n      return;\n    }\n    this.lovelace!.setEditMode(true);\n    if (this.config.views.length < 2) {\n      fireEvent(this, \"iron-resize\");\n    }\n  }\n\n  private _editModeDisable(): void {\n    this.lovelace!.setEditMode(false);\n    if (this.config.views.length < 2) {\n      fireEvent(this, \"iron-resize\");\n    }\n  }\n\n  private _editLovelace() {\n    showEditLovelaceDialog(this, this.lovelace!);\n  }\n\n  private _editView() {\n    showEditViewDialog(this, {\n      lovelace: this.lovelace!,\n      viewIndex: this._curView as number,\n    });\n  }\n\n  private _moveViewLeft() {\n    const lovelace = this.lovelace!;\n    const oldIndex = this._curView as number;\n    const newIndex = (this._curView as number) - 1;\n    this._curView = newIndex;\n    lovelace.saveConfig(swapView(lovelace.config, oldIndex, newIndex));\n  }\n\n  private _moveViewRight() {\n    const lovelace = this.lovelace!;\n    const oldIndex = this._curView as number;\n    const newIndex = (this._curView as number) + 1;\n    this._curView = newIndex;\n    lovelace.saveConfig(swapView(lovelace.config, oldIndex, newIndex));\n  }\n\n  private _addView() {\n    showEditViewDialog(this, {\n      lovelace: this.lovelace!,\n    });\n  }\n\n  private _handleViewSelected(ev) {\n    const viewIndex = ev.detail.selected as number;\n\n    if (viewIndex !== this._curView) {\n      const path = this.config.views[viewIndex].path || viewIndex;\n      navigate(this, `/lovelace/${path}`);\n    }\n    scrollToTarget(this, this._layout.header.scrollTarget);\n  }\n\n  private _selectView(viewIndex: HUIRoot[\"_curView\"], force: boolean): void {\n    if (!force && this._curView === viewIndex) {\n      return;\n    }\n\n    viewIndex = viewIndex === undefined ? 0 : viewIndex;\n\n    this._curView = viewIndex;\n\n    if (force) {\n      this._viewCache = {};\n    }\n\n    // Recreate a new element to clear the applied themes.\n    const root = this._viewRoot;\n\n    if (root.lastChild) {\n      root.removeChild(root.lastChild);\n    }\n\n    if (viewIndex === \"hass-unused-entities\") {\n      const unusedEntities = document.createElement(\"hui-unused-entities\");\n      // Wait for promise to resolve so that the element has been upgraded.\n      import(\n        /* webpackChunkName: \"hui-unused-entities\" */ \"./hui-unused-entities\"\n      ).then(() => {\n        unusedEntities.setConfig(this.config);\n        unusedEntities.hass = this.hass!;\n      });\n      root.style.background = this.config.background || \"\";\n      root.append(unusedEntities);\n      return;\n    }\n\n    let view;\n    const viewConfig = this.config.views[viewIndex];\n\n    if (!viewConfig) {\n      this._editModeEnable();\n      return;\n    }\n\n    if (!force && this._viewCache![viewIndex]) {\n      view = this._viewCache![viewIndex];\n    } else {\n      if (viewConfig.panel && viewConfig.cards && viewConfig.cards.length > 0) {\n        view = createCardElement(viewConfig.cards[0]);\n        view.isPanel = true;\n      } else {\n        view = document.createElement(\"hui-view\");\n        view.lovelace = this.lovelace;\n        view.columns = this.columns;\n        view.index = viewIndex;\n      }\n      this._viewCache![viewIndex] = view;\n    }\n\n    view.hass = this.hass;\n    root.style.background =\n      viewConfig.background || this.config.background || \"\";\n    root.append(view);\n  }\n\n  private _loadResources(resources) {\n    resources.forEach((resource) => {\n      switch (resource.type) {\n        case \"css\":\n          if (resource.url in CSS_CACHE) {\n            break;\n          }\n          CSS_CACHE[resource.url] = loadCSS(resource.url);\n          break;\n\n        case \"js\":\n          if (resource.url in JS_CACHE) {\n            break;\n          }\n          JS_CACHE[resource.url] = loadJS(resource.url);\n          break;\n\n        case \"module\":\n          loadModule(resource.url);\n          break;\n\n        case \"html\":\n          import(\n            /* webpackChunkName: \"import-href-polyfill\" */ \"../../resources/html-import/import-href\"\n          ).then(({ importHref }) => importHref(resource.url));\n          break;\n\n        default:\n          // tslint:disable-next-line\n          console.warn(`Unknown resource type specified: ${resource.type}`);\n      }\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-root\": HUIRoot;\n  }\n}\n\ncustomElements.define(\"hui-root\", HUIRoot);\n","import { HassEntities, HassEntity } from \"home-assistant-js-websocket\";\r\n\r\nimport computeDomain from \"../../../common/entity/compute_domain\";\r\n\r\nexport const computeNotifications = (states: HassEntities): HassEntity[] => {\r\n  return Object.keys(states)\r\n    .filter((entityId) => computeDomain(entityId) === \"configurator\")\r\n    .map((entityId) => states[entityId]);\r\n};\r\n","/**\n * Scroll to a specific y coordinate.\n *\n * Copied from paper-scroll-header-panel.\n *\n * @method scroll\n * @param {number} top The coordinate to scroll to, along the y-axis.\n * @param {boolean} smooth true if the scroll position should be smoothly adjusted.\n */\nexport default function scrollToTarget(element, target) {\n  // the scroll event will trigger _updateScrollState directly,\n  // However, _updateScrollState relies on the previous `scrollTop` to update the states.\n  // Calling _updateScrollState will ensure that the states are synced correctly.\n  const top = 0;\n  const scroller = target;\n  const easingFn = function easeOutQuad(t, b, c, d) {\n    /* eslint-disable no-param-reassign, space-infix-ops, no-mixed-operators */\n    t /= d;\n    return -c * t * (t - 2) + b;\n    /* eslint-enable no-param-reassign, space-infix-ops, no-mixed-operators */\n  };\n  const animationId = Math.random();\n  const duration = 200;\n  const startTime = Date.now();\n  const currentScrollTop = scroller.scrollTop;\n  const deltaScrollTop = top - currentScrollTop;\n  element._currentAnimationId = animationId;\n  (function updateFrame() {\n    const now = Date.now();\n    const elapsedTime = now - startTime;\n    if (elapsedTime > duration) {\n      scroller.scrollTop = top;\n    } else if (element._currentAnimationId === animationId) {\n      scroller.scrollTop = easingFn(\n        elapsedTime,\n        currentScrollTop,\n        deltaScrollTop,\n        duration\n      );\n      requestAnimationFrame(updateFrame.bind(element));\n    }\n  }.call(element));\n}\n","import { fireEvent } from \"../../../common/dom/fire_event\";\nimport { Lovelace } from \"../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"show-save-config\": SaveDialogParams;\n  }\n}\n\nconst dialogShowEvent = \"show-save-config\";\nconst dialogTag = \"hui-dialog-save-config\";\n\nexport interface SaveDialogParams {\n  lovelace: Lovelace;\n}\n\nlet registeredDialog = false;\n\nexport const showSaveDialog = (\n  element: HTMLElement,\n  saveDialogParams: SaveDialogParams\n) => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    fireEvent(element, \"register-dialog\", {\n      dialogShowEvent,\n      dialogTag,\n      dialogImport: () =>\n        import(/* webpackChunkName: \"hui-dialog-save-config\" */ \"./hui-dialog-save-config\"),\n    });\n  }\n  fireEvent(element, dialogShowEvent, saveDialogParams);\n};\n","import { HassEntities } from \"home-assistant-js-websocket\";\nimport { DEFAULT_VIEW_ENTITY_ID } from \"../const\";\nimport { GroupEntity } from \"../../types\";\n\n// Return an ordered array of available views\nexport default function extractViews(entities: HassEntities): GroupEntity[] {\n  const views: GroupEntity[] = [];\n\n  Object.keys(entities).forEach((entityId) => {\n    const entity = entities[entityId];\n    if (entity.attributes.view) {\n      views.push(entity as GroupEntity);\n    }\n  });\n\n  views.sort((view1, view2) => {\n    if (view1.entity_id === DEFAULT_VIEW_ENTITY_ID) {\n      return -1;\n    }\n    if (view2.entity_id === DEFAULT_VIEW_ENTITY_ID) {\n      return 1;\n    }\n    return view1.attributes.order - view2.attributes.order;\n  });\n\n  return views;\n}\n","import { HassEntities } from \"home-assistant-js-websocket\";\nimport computeDomain from \"./compute_domain\";\nimport getGroupEntities from \"./get_group_entities\";\nimport { GroupEntity } from \"../../types\";\n\n// Return an object containing all entities that the view will show\n// including embedded groups.\nexport default function getViewEntities(\n  entities: HassEntities,\n  view: GroupEntity\n): HassEntities {\n  const viewEntities = {};\n\n  view.attributes.entity_id.forEach((entityId) => {\n    const entity = entities[entityId];\n\n    if (entity && !entity.attributes.hidden) {\n      viewEntities[entity.entity_id] = entity;\n\n      if (computeDomain(entity.entity_id) === \"group\") {\n        const groupEntities = getGroupEntities(entities, entity as GroupEntity);\n\n        Object.keys(groupEntities).forEach((grEntityId) => {\n          const grEntity = groupEntities[grEntityId];\n\n          if (!grEntity.attributes.hidden) {\n            viewEntities[grEntityId] = grEntity;\n          }\n        });\n      }\n    }\n  });\n\n  return viewEntities;\n}\n","import { HassEntities } from \"home-assistant-js-websocket\";\nimport { GroupEntity } from \"../../types\";\n\nexport default function getGroupEntities(\n  entities: HassEntities,\n  group: GroupEntity\n) {\n  const result = {};\n\n  group.attributes.entity_id.forEach((entityId) => {\n    const entity = entities[entityId];\n\n    if (entity) {\n      result[entity.entity_id] = entity;\n    }\n  });\n\n  return result;\n}\n","import { HomeAssistant, GroupEntity } from \"../../../types\";\nimport {\n  LovelaceConfig,\n  LovelaceCardConfig,\n  LovelaceViewConfig,\n} from \"../../../data/lovelace\";\nimport { HassEntity, HassEntities } from \"home-assistant-js-websocket\";\n\nimport extractViews from \"../../../common/entity/extract_views\";\nimport getViewEntities from \"../../../common/entity/get_view_entities\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport splitByGroups from \"../../../common/entity/split_by_groups\";\nimport computeObjectId from \"../../../common/entity/compute_object_id\";\nimport computeStateDomain from \"../../../common/entity/compute_state_domain\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nimport { EntityRowConfig, WeblinkConfig } from \"../entity-rows/types\";\nimport { LocalizeFunc } from \"../../../common/translations/localize\";\nimport { EntitiesCardConfig } from \"../cards/types\";\nimport {\n  subscribeAreaRegistry,\n  AreaRegistryEntry,\n} from \"../../../data/area_registry\";\nimport { subscribeOne } from \"../../../common/util/subscribe-one\";\nimport {\n  subscribeDeviceRegistry,\n  DeviceRegistryEntry,\n} from \"../../../data/device_registry\";\nimport {\n  subscribeEntityRegistry,\n  EntityRegistryEntry,\n} from \"../../../data/entity_registry\";\n\nconst DEFAULT_VIEW_ENTITY_ID = \"group.default_view\";\nconst DOMAINS_BADGES = [\n  \"binary_sensor\",\n  \"person\",\n  \"device_tracker\",\n  \"mailbox\",\n  \"sensor\",\n  \"sun\",\n  \"timer\",\n];\nconst HIDE_DOMAIN = new Set([\n  \"persistent_notification\",\n  \"configurator\",\n  \"geo_location\",\n]);\n\ninterface Registries {\n  areas: AreaRegistryEntry[];\n  devices: DeviceRegistryEntry[];\n  entities: EntityRegistryEntry[];\n}\n\nlet subscribedRegistries = false;\n\ninterface SplittedByAreas {\n  areasWithEntities: Array<[AreaRegistryEntry, HassEntity[]]>;\n  otherEntities: HassEntities;\n}\n\nconst splitByAreas = (\n  registries: Registries,\n  entities: HassEntities\n): SplittedByAreas => {\n  const allEntities = { ...entities };\n  const areasWithEntities: SplittedByAreas[\"areasWithEntities\"] = [];\n\n  for (const area of registries.areas) {\n    const areaEntities: HassEntity[] = [];\n    const areaDevices = new Set(\n      registries.devices\n        .filter((device) => device.area_id === area.area_id)\n        .map((device) => device.id)\n    );\n    for (const entity of registries.entities) {\n      if (\n        areaDevices.has(\n          // @ts-ignore\n          entity.device_id\n        ) &&\n        entity.entity_id in allEntities\n      ) {\n        areaEntities.push(allEntities[entity.entity_id]);\n        delete allEntities[entity.entity_id];\n      }\n    }\n    if (areaEntities.length > 0) {\n      areasWithEntities.push([area, areaEntities]);\n    }\n  }\n  return {\n    areasWithEntities,\n    otherEntities: allEntities,\n  };\n};\n\nconst computeCards = (\n  states: Array<[string, HassEntity]>,\n  entityCardOptions: Partial<EntitiesCardConfig>\n): LovelaceCardConfig[] => {\n  const cards: LovelaceCardConfig[] = [];\n\n  // For entity card\n  const entities: Array<string | EntityRowConfig> = [];\n\n  for (const [entityId, stateObj] of states) {\n    const domain = computeDomain(entityId);\n\n    if (domain === \"alarm_control_panel\") {\n      cards.push({\n        type: \"alarm-panel\",\n        entity: entityId,\n      });\n    } else if (domain === \"camera\") {\n      cards.push({\n        type: \"picture-entity\",\n        entity: entityId,\n      });\n    } else if (domain === \"climate\") {\n      cards.push({\n        type: \"thermostat\",\n        entity: entityId,\n      });\n    } else if (domain === \"history_graph\" && stateObj) {\n      cards.push({\n        type: \"history-graph\",\n        entities: stateObj.attributes.entity_id,\n        hours_to_show: stateObj.attributes.hours_to_show,\n        title: stateObj.attributes.friendly_name,\n        refresh_interval: stateObj.attributes.refresh,\n      });\n    } else if (domain === \"media_player\") {\n      cards.push({\n        type: \"media-control\",\n        entity: entityId,\n      });\n    } else if (domain === \"plant\") {\n      cards.push({\n        type: \"plant-status\",\n        entity: entityId,\n      });\n    } else if (domain === \"weather\") {\n      cards.push({\n        type: \"weather-forecast\",\n        entity: entityId,\n      });\n    } else if (domain === \"weblink\" && stateObj) {\n      const conf: WeblinkConfig = {\n        type: \"weblink\",\n        url: stateObj.state,\n        name: computeStateName(stateObj),\n      };\n      if (\"icon\" in stateObj.attributes) {\n        conf.icon = stateObj.attributes.icon;\n      }\n      entities.push(conf);\n    } else {\n      entities.push(entityId);\n    }\n  }\n\n  if (entities.length > 0) {\n    cards.unshift({\n      type: \"entities\",\n      entities,\n      ...entityCardOptions,\n    });\n  }\n\n  return cards;\n};\n\nconst computeDefaultViewStates = (hass: HomeAssistant): HassEntities => {\n  const states = {};\n  Object.keys(hass.states).forEach((entityId) => {\n    const stateObj = hass.states[entityId];\n    if (\n      !stateObj.attributes.hidden &&\n      !HIDE_DOMAIN.has(computeStateDomain(stateObj))\n    ) {\n      states[entityId] = hass.states[entityId];\n    }\n  });\n  return states;\n};\n\nconst generateDefaultViewConfig = (\n  hass: HomeAssistant,\n  registries: Registries\n): LovelaceViewConfig => {\n  const states = computeDefaultViewStates(hass);\n  const path = \"default_view\";\n  const title = \"Home\";\n  const icon = undefined;\n\n  // In the case of a default view, we want to use the group order attribute\n  const groupOrders = {};\n  Object.keys(states).forEach((entityId) => {\n    const stateObj = states[entityId];\n    if (stateObj.attributes.order) {\n      groupOrders[entityId] = stateObj.attributes.order;\n    }\n  });\n\n  const splittedByAreas = splitByAreas(registries, states);\n\n  const config = generateViewConfig(\n    hass.localize,\n    path,\n    title,\n    icon,\n    splittedByAreas.otherEntities,\n    groupOrders\n  );\n\n  const areaCards: LovelaceCardConfig[] = [];\n\n  splittedByAreas.areasWithEntities.forEach(([area, entities]) => {\n    areaCards.push(\n      ...computeCards(entities.map((entity) => [entity.entity_id, entity]), {\n        title: area.name,\n        show_header_toggle: true,\n      })\n    );\n  });\n\n  config.cards!.unshift(...areaCards);\n\n  return config;\n};\n\nconst generateViewConfig = (\n  localize: LocalizeFunc,\n  path: string,\n  title: string | undefined,\n  icon: string | undefined,\n  entities: HassEntities,\n  groupOrders: { [entityId: string]: number }\n): LovelaceViewConfig => {\n  const splitted = splitByGroups(entities);\n  splitted.groups.sort(\n    (gr1, gr2) => groupOrders[gr1.entity_id] - groupOrders[gr2.entity_id]\n  );\n\n  const badgeEntities: { [domain: string]: string[] } = {};\n  const ungroupedEntitites: { [domain: string]: string[] } = {};\n\n  // Organize ungrouped entities in badges/ungrouped things\n  Object.keys(splitted.ungrouped).forEach((entityId) => {\n    const state = splitted.ungrouped[entityId];\n    const domain = computeStateDomain(state);\n\n    const coll = DOMAINS_BADGES.includes(domain)\n      ? badgeEntities\n      : ungroupedEntitites;\n\n    if (!(domain in coll)) {\n      coll[domain] = [];\n    }\n\n    coll[domain].push(state.entity_id);\n  });\n\n  let badges: string[] = [];\n  DOMAINS_BADGES.forEach((domain) => {\n    if (domain in badgeEntities) {\n      badges = badges.concat(badgeEntities[domain]);\n    }\n  });\n\n  let cards: LovelaceCardConfig[] = [];\n\n  splitted.groups.forEach((groupEntity) => {\n    cards = cards.concat(\n      computeCards(\n        groupEntity.attributes.entity_id.map(\n          (entityId): [string, HassEntity] => [entityId, entities[entityId]]\n        ),\n        {\n          title: computeStateName(groupEntity),\n          show_header_toggle: groupEntity.attributes.control !== \"hidden\",\n        }\n      )\n    );\n  });\n\n  Object.keys(ungroupedEntitites)\n    .sort()\n    .forEach((domain) => {\n      cards = cards.concat(\n        computeCards(\n          ungroupedEntitites[domain].map(\n            (entityId): [string, HassEntity] => [entityId, entities[entityId]]\n          ),\n          {\n            title: localize(`domain.${domain}`),\n          }\n        )\n      );\n    });\n\n  const view: LovelaceViewConfig = {\n    path,\n    title,\n    badges,\n    cards,\n  };\n\n  if (icon) {\n    view.icon = icon;\n  }\n\n  return view;\n};\n\nexport const generateLovelaceConfig = async (\n  hass: HomeAssistant,\n  localize: LocalizeFunc\n): Promise<LovelaceConfig> => {\n  const viewEntities = extractViews(hass.states);\n\n  const views = viewEntities.map((viewEntity: GroupEntity) => {\n    const states = getViewEntities(hass.states, viewEntity);\n\n    // In the case of a normal view, we use group order as specified in view\n    const groupOrders = {};\n    Object.keys(states).forEach((entityId, idx) => {\n      groupOrders[entityId] = idx;\n    });\n\n    return generateViewConfig(\n      localize,\n      computeObjectId(viewEntity.entity_id),\n      computeStateName(viewEntity),\n      viewEntity.attributes.icon,\n      states,\n      groupOrders\n    );\n  });\n\n  let title = hass.config.location_name;\n\n  // User can override default view. If they didn't, we will add one\n  // that contains all entities.\n  if (\n    viewEntities.length === 0 ||\n    viewEntities[0].entity_id !== DEFAULT_VIEW_ENTITY_ID\n  ) {\n    // We want to keep the registry subscriptions alive after generating the UI\n    // so that we don't serve up stale data after changing areas.\n    if (!subscribedRegistries) {\n      subscribedRegistries = true;\n      subscribeAreaRegistry(hass.connection, () => undefined);\n      subscribeDeviceRegistry(hass.connection, () => undefined);\n      subscribeEntityRegistry(hass.connection, () => undefined);\n    }\n\n    const [areas, devices, entities] = await Promise.all([\n      subscribeOne(hass.connection, subscribeAreaRegistry),\n      subscribeOne(hass.connection, subscribeDeviceRegistry),\n      subscribeOne(hass.connection, subscribeEntityRegistry),\n    ]);\n    const registries = { areas, devices, entities };\n\n    views.unshift(generateDefaultViewConfig(hass, registries));\n\n    // Add map of geo locations to default view if loaded\n    if (hass.config.components.includes(\"geo_location\")) {\n      if (views[0] && views[0].cards) {\n        views[0].cards.push({\n          type: \"map\",\n          geo_location_sources: [\"all\"],\n        });\n      }\n    }\n\n    // Make sure we don't have Home as title and first tab.\n    if (views.length > 1 && title === \"Home\") {\n      title = \"Home Assistant\";\n    }\n  }\n\n  if (__DEMO__) {\n    views[0].cards!.unshift({\n      type: \"custom:ha-demo-card\",\n    });\n  }\n\n  // User has no entities\n  if (views.length === 1 && views[0].cards!.length === 0) {\n    import(/* webpackChunkName: \"hui-empty-state-card\" */ \"../cards/hui-empty-state-card\");\n    views[0].cards!.push({\n      type: \"custom:hui-empty-state-card\",\n    });\n  }\n\n  return {\n    title,\n    views,\n  };\n};\n","import computeDomain from \"./compute_domain\";\nimport { HassEntities } from \"home-assistant-js-websocket\";\nimport { GroupEntity } from \"../../types\";\n\n// Split a collection into a list of groups and a 'rest' list of ungrouped\n// entities.\n// Returns { groups: [], ungrouped: {} }\nexport default function splitByGroups(entities: HassEntities) {\n  const groups: GroupEntity[] = [];\n  const ungrouped: HassEntities = {};\n\n  Object.keys(entities).forEach((entityId) => {\n    const entity = entities[entityId];\n\n    if (computeDomain(entityId) === \"group\") {\n      groups.push(entity as GroupEntity);\n    } else {\n      ungrouped[entityId] = entity;\n    }\n  });\n\n  groups.forEach((group) =>\n    group.attributes.entity_id.forEach((entityId) => {\n      delete ungrouped[entityId];\n    })\n  );\n\n  return { groups, ungrouped };\n}\n","import \"@material/mwc-button\";\n\nimport {\n  fetchConfig,\n  LovelaceConfig,\n  saveConfig,\n  subscribeLovelaceUpdates,\n  WindowWithLovelaceProm,\n} from \"../../data/lovelace\";\nimport \"../../layouts/hass-loading-screen\";\nimport \"../../layouts/hass-error-screen\";\nimport \"./hui-root\";\nimport { HomeAssistant, PanelInfo, Route } from \"../../types\";\nimport { Lovelace } from \"./types\";\nimport {\n  LitElement,\n  html,\n  PropertyValues,\n  TemplateResult,\n  property,\n} from \"lit-element\";\nimport { showSaveDialog } from \"./editor/show-save-config-dialog\";\nimport { generateLovelaceConfig } from \"./common/generate-lovelace-config\";\nimport { showToast } from \"../../util/toast\";\n\ninterface LovelacePanelConfig {\n  mode: \"yaml\" | \"storage\";\n}\n\nlet editorLoaded = false;\n\nclass LovelacePanel extends LitElement {\n  @property() public panel?: PanelInfo<LovelacePanelConfig>;\n\n  @property() public hass?: HomeAssistant;\n\n  @property() public narrow?: boolean;\n\n  @property() public route?: Route;\n\n  @property() private _columns?: number;\n\n  @property()\n  private _state?: \"loading\" | \"loaded\" | \"error\" | \"yaml-editor\" = \"loading\";\n\n  @property() private _errorMsg?: string;\n\n  @property() private lovelace?: Lovelace;\n\n  private mqls?: MediaQueryList[];\n\n  private _saving: boolean = false;\n\n  constructor() {\n    super();\n    this._closeEditor = this._closeEditor.bind(this);\n  }\n\n  public render(): TemplateResult | void {\n    const state = this._state!;\n\n    if (state === \"loaded\") {\n      return html`\n        <hui-root\n          .hass=\"${this.hass}\"\n          .lovelace=\"${this.lovelace}\"\n          .route=\"${this.route}\"\n          .columns=\"${this._columns}\"\n          .narrow=${this.narrow}\n          @config-refresh=\"${this._forceFetchConfig}\"\n        ></hui-root>\n      `;\n    }\n\n    if (state === \"error\") {\n      return html`\n        <hass-error-screen title=\"Lovelace\" .error=\"${this._errorMsg}\">\n          <mwc-button on-click=\"_forceFetchConfig\"\n            >${this.hass!.localize(\n              \"ui.panel.lovelace.reload_lovelace\"\n            )}</mwc-button\n          >\n        </hass-error-screen>\n      `;\n    }\n\n    if (state === \"yaml-editor\") {\n      return html`\n        <hui-editor\n          .hass=\"${this.hass}\"\n          .lovelace=\"${this.lovelace}\"\n          .closeEditor=\"${this._closeEditor}\"\n        ></hui-editor>\n      `;\n    }\n\n    return html`\n      <hass-loading-screen\n        rootnav\n        .hass=${this.hass}\n        .narrow=${this.narrow}\n      ></hass-loading-screen>\n    `;\n  }\n\n  public updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    if (changedProps.has(\"narrow\")) {\n      this._updateColumns();\n      return;\n    }\n\n    if (!changedProps.has(\"hass\")) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as this[\"hass\"];\n\n    if (oldHass && this.hass!.dockedSidebar !== oldHass.dockedSidebar) {\n      this._updateColumns();\n    }\n  }\n\n  public firstUpdated() {\n    this._fetchConfig(false);\n    // we don't want to unsub as we want to stay informed of updates\n    subscribeLovelaceUpdates(this.hass!.connection, () =>\n      this._lovelaceChanged()\n    );\n    // reload lovelace on reconnect so we are sure we have the latest config\n    window.addEventListener(\"connection-status\", (ev) => {\n      if (ev.detail === \"connected\") {\n        this._fetchConfig(false);\n      }\n    });\n    this._updateColumns = this._updateColumns.bind(this);\n    this.mqls = [300, 600, 900, 1200].map((width) => {\n      const mql = matchMedia(`(min-width: ${width}px)`);\n      mql.addListener(this._updateColumns);\n      return mql;\n    });\n    this._updateColumns();\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (\n      this.lovelace &&\n      this.hass &&\n      this.lovelace.language !== this.hass.language\n    ) {\n      // language has been changed, rebuild UI\n      this._setLovelaceConfig(this.lovelace.config, this.lovelace.mode);\n    } else if (this.lovelace && this.lovelace.mode === \"generated\") {\n      // When lovelace is generated, we re-generate each time a user goes\n      // to the states panel to make sure new entities are shown.\n      this._state = \"loading\";\n      this._regenerateConfig();\n    }\n  }\n\n  private async _regenerateConfig() {\n    const conf = await generateLovelaceConfig(this.hass!, this.hass!.localize);\n    this._setLovelaceConfig(conf, \"generated\");\n    this._state = \"loaded\";\n  }\n\n  private _closeEditor() {\n    this._state = \"loaded\";\n  }\n\n  private _updateColumns() {\n    const matchColumns = this.mqls!.reduce(\n      (cols, mql) => cols + Number(mql.matches),\n      0\n    );\n    // Do -1 column if the menu is docked and open\n    this._columns = Math.max(\n      1,\n      matchColumns - Number(!this.narrow && this.hass!.dockedSidebar)\n    );\n  }\n\n  private _lovelaceChanged() {\n    if (this._saving) {\n      this._saving = false;\n    } else {\n      showToast(this, {\n        message: this.hass!.localize(\"ui.panel.lovelace.changed_toast.message\"),\n        action: {\n          action: () => this._fetchConfig(false),\n          text: this.hass!.localize(\"ui.panel.lovelace.changed_toast.refresh\"),\n        },\n        duration: 0,\n        dismissable: false,\n      });\n    }\n  }\n\n  private _forceFetchConfig() {\n    this._fetchConfig(true);\n  }\n\n  private async _fetchConfig(forceDiskRefresh) {\n    let conf: LovelaceConfig;\n    let confMode: Lovelace[\"mode\"] = this.panel!.config.mode;\n    let confProm: Promise<LovelaceConfig>;\n    const llWindow = window as WindowWithLovelaceProm;\n\n    // On first load, we speed up loading page by having LL promise ready\n    if (llWindow.llConfProm) {\n      confProm = llWindow.llConfProm;\n      llWindow.llConfProm = undefined;\n    } else {\n      confProm = fetchConfig(this.hass!.connection, forceDiskRefresh);\n    }\n\n    try {\n      conf = await confProm;\n    } catch (err) {\n      if (err.code !== \"config_not_found\") {\n        // tslint:disable-next-line\n        console.log(err);\n        this._state = \"error\";\n        this._errorMsg = err.message;\n        return;\n      }\n      conf = await generateLovelaceConfig(this.hass!, this.hass!.localize);\n      confMode = \"generated\";\n    }\n\n    this._state = \"loaded\";\n    this._setLovelaceConfig(conf, confMode);\n  }\n\n  private _setLovelaceConfig(config: LovelaceConfig, mode: Lovelace[\"mode\"]) {\n    this.lovelace = {\n      config,\n      mode,\n      editMode: this.lovelace ? this.lovelace.editMode : false,\n      language: this.hass!.language,\n      enableFullEditMode: () => {\n        if (!editorLoaded) {\n          editorLoaded = true;\n          import(/* webpackChunkName: \"lovelace-yaml-editor\" */ \"./hui-editor\");\n        }\n        this._state = \"yaml-editor\";\n      },\n      setEditMode: (editMode: boolean) => {\n        if (!editMode || this.lovelace!.mode !== \"generated\") {\n          this._updateLovelace({ editMode });\n          return;\n        }\n        showSaveDialog(this, {\n          lovelace: this.lovelace!,\n        });\n      },\n      saveConfig: async (newConfig: LovelaceConfig): Promise<void> => {\n        const { config: previousConfig, mode: previousMode } = this.lovelace!;\n        try {\n          // Optimistic update\n          this._updateLovelace({\n            config: newConfig,\n            mode: \"storage\",\n          });\n          this._saving = true;\n          await saveConfig(this.hass!, newConfig);\n        } catch (err) {\n          // tslint:disable-next-line\n          console.error(err);\n          // Rollback the optimistic update\n          this._updateLovelace({\n            config: previousConfig,\n            mode: previousMode,\n          });\n          throw err;\n        }\n      },\n    };\n  }\n\n  private _updateLovelace(props: Partial<Lovelace>) {\n    this.lovelace = {\n      ...this.lovelace!,\n      ...props,\n    };\n  }\n}\n\ncustomElements.define(\"ha-panel-lovelace\", LovelacePanel);\n","import { HomeAssistant } from \"../types\";\n\nexport interface AuthProvider {\n  name: string;\n  id: string;\n  type: string;\n}\n\nexport interface Credential {\n  type: string;\n}\n\nexport interface SignedPath {\n  path: string;\n}\n\nexport const hassUrl = `${location.protocol}//${location.host}`;\n\nexport const getSignedPath = (\n  hass: HomeAssistant,\n  path: string\n): Promise<SignedPath> => hass.callWS({ type: \"auth/sign_path\", path });\n\nexport const fetchAuthProviders = () =>\n  fetch(\"/auth/providers\", {\n    credentials: \"same-origin\",\n  });\n","// Load a resource and get a promise when loading done.\n// From: https://davidwalsh.name/javascript-loader\n\nconst _load = (\n  tag: \"link\" | \"script\" | \"img\",\n  url: string,\n  type?: \"module\"\n) => {\n  // This promise will be used by Promise.all to determine success or failure\n  return new Promise((resolve, reject) => {\n    const element = document.createElement(tag);\n    let attr = \"src\";\n    let parent = \"body\";\n\n    // Important success and error for the promise\n    element.onload = () => resolve(url);\n    element.onerror = () => reject(url);\n\n    // Need to set different attributes depending on tag type\n    switch (tag) {\n      case \"script\":\n        (element as HTMLScriptElement).async = true;\n        if (type) {\n          (element as HTMLScriptElement).type = type;\n        }\n        break;\n      case \"link\":\n        (element as HTMLLinkElement).type = \"text/css\";\n        (element as HTMLLinkElement).rel = \"stylesheet\";\n        attr = \"href\";\n        parent = \"head\";\n    }\n\n    // Inject into document to kick off loading\n    element[attr] = url;\n    document[parent].appendChild(element);\n  });\n};\n\nexport const loadCSS = (url: string) => _load(\"link\", url);\nexport const loadJS = (url: string) => _load(\"script\", url);\nexport const loadImg = (url: string) => _load(\"img\", url);\nexport const loadModule = (url: string) => _load(\"script\", url, \"module\");\n"],"sourceRoot":""}