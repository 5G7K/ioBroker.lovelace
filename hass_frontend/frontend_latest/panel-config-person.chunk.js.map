{"version":3,"sources":["webpack:///./node_modules/@polymer/paper-styles/element-styles/paper-material-styles.js","webpack:///./src/common/string/compare.ts","webpack:///./src/data/person.ts","webpack:///./src/data/user.ts","webpack:///./src/panels/config/ha-config-section.js","webpack:///./src/panels/config/person/ha-config-person.ts","webpack:///./src/panels/config/person/show-dialog-person-detail.ts"],"names":["template","html","setAttribute","document","head","appendChild","content","compare","a","b","caseInsensitiveCompare","toLowerCase","fetchPersons","hass","callWS","type","createPerson","values","updatePerson","personId","updates","person_id","deletePerson","SYSTEM_GROUP_ID_ADMIN","SYSTEM_GROUP_ID_USER","SYSTEM_GROUP_ID_READ_ONLY","fetchUsers","createUser","name","updateUser","userId","params","user_id","deleteUser","HaConfigSection","PolymerElement","properties","Object","narrow","Boolean","isWide","value","computeContentClasses","classes","computeClasses","customElements","define","HaConfigPerson","LitElement","_storageItems","_configItems","render","undefined","length","map","entry","_openEditEntry","_createPerson","firstUpdated","changedProps","_fetchData","loadPersonDetailDialog","_usersLoad","personData","storage","sort","ent1","ent2","config","_openDialog","ev","currentTarget","_allowedUsers","users","currentPerson","used","Set","coll","pers","add","currentUserId","filter","user","id","has","showPersonDetailDialog","createEntry","created","concat","updateEntry","updated","ent","removeEntry","confirm","err","styles","css","element","systemLogDetailParams","fireEvent","dialogTag","dialogImport","dialogParams"],"mappings":"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","file":"panel-config-person.chunk.js","sourcesContent":["/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\n/**\nMaterial design:\n[Cards](https://www.google.com/design/spec/components/cards.html)\n\nShared styles that you can apply to an element to renders two shadows on top\nof each other,that create the effect of a lifted piece of paper.\n\nExample:\n\n    <custom-style>\n      <style is=\"custom-style\" include=\"paper-material-styles\"></style>\n    </custom-style>\n\n    <div class=\"paper-material\" elevation=\"1\">\n      ... content ...\n    </div>\n\n@group Paper Elements\n@demo demo/index.html\n*/\n\nimport '@polymer/polymer/polymer-legacy.js';\nimport '../shadow.js';\n\nimport {html} from '@polymer/polymer/lib/utils/html-tag.js';\nconst template = html`\n<dom-module id=\"paper-material-styles\">\n  <template>\n    <style>\n      html {\n        --paper-material: {\n          display: block;\n          position: relative;\n        };\n        --paper-material-elevation-1: {\n          @apply --shadow-elevation-2dp;\n        };\n        --paper-material-elevation-2: {\n          @apply --shadow-elevation-4dp;\n        };\n        --paper-material-elevation-3: {\n          @apply --shadow-elevation-6dp;\n        };\n        --paper-material-elevation-4: {\n          @apply --shadow-elevation-8dp;\n        };\n        --paper-material-elevation-5: {\n          @apply --shadow-elevation-16dp;\n        };\n      }\n      .paper-material {\n        @apply --paper-material;\n      }\n      .paper-material[elevation=\"1\"] {\n        @apply --paper-material-elevation-1;\n      }\n      .paper-material[elevation=\"2\"] {\n        @apply --paper-material-elevation-2;\n      }\n      .paper-material[elevation=\"3\"] {\n        @apply --paper-material-elevation-3;\n      }\n      .paper-material[elevation=\"4\"] {\n        @apply --paper-material-elevation-4;\n      }\n      .paper-material[elevation=\"5\"] {\n        @apply --paper-material-elevation-5;\n      }\n\n      /* Duplicate the styles because of https://github.com/webcomponents/shadycss/issues/193 */\n      :host {\n        --paper-material: {\n          display: block;\n          position: relative;\n        };\n        --paper-material-elevation-1: {\n          @apply --shadow-elevation-2dp;\n        };\n        --paper-material-elevation-2: {\n          @apply --shadow-elevation-4dp;\n        };\n        --paper-material-elevation-3: {\n          @apply --shadow-elevation-6dp;\n        };\n        --paper-material-elevation-4: {\n          @apply --shadow-elevation-8dp;\n        };\n        --paper-material-elevation-5: {\n          @apply --shadow-elevation-16dp;\n        };\n      }\n      :host(.paper-material) {\n        @apply --paper-material;\n      }\n      :host(.paper-material[elevation=\"1\"]) {\n        @apply --paper-material-elevation-1;\n      }\n      :host(.paper-material[elevation=\"2\"]) {\n        @apply --paper-material-elevation-2;\n      }\n      :host(.paper-material[elevation=\"3\"]) {\n        @apply --paper-material-elevation-3;\n      }\n      :host(.paper-material[elevation=\"4\"]) {\n        @apply --paper-material-elevation-4;\n      }\n      :host(.paper-material[elevation=\"5\"]) {\n        @apply --paper-material-elevation-5;\n      }\n    </style>\n  </template>\n</dom-module>`;\ntemplate.setAttribute('style', 'display: none;');\ndocument.head.appendChild(template.content);\n","export const compare = (a: string, b: string) => {\n  if (a < b) {\n    return -1;\n  }\n  if (a > b) {\n    return 1;\n  }\n\n  return 0;\n};\n\nexport const caseInsensitiveCompare = (a: string, b: string) =>\n  compare(a.toLowerCase(), b.toLowerCase());\n","import { HomeAssistant } from \"../types\";\n\nexport interface Person {\n  id: string;\n  name: string;\n  user_id?: string;\n  device_trackers?: string[];\n}\n\nexport interface PersonMutableParams {\n  name: string;\n  user_id: string | null;\n  device_trackers: string[];\n}\n\nexport const fetchPersons = (hass: HomeAssistant) =>\n  hass.callWS<{\n    storage: Person[];\n    config: Person[];\n  }>({ type: \"person/list\" });\n\nexport const createPerson = (\n  hass: HomeAssistant,\n  values: PersonMutableParams\n) =>\n  hass.callWS<Person>({\n    type: \"person/create\",\n    ...values,\n  });\n\nexport const updatePerson = (\n  hass: HomeAssistant,\n  personId: string,\n  updates: Partial<PersonMutableParams>\n) =>\n  hass.callWS<Person>({\n    type: \"person/update\",\n    person_id: personId,\n    ...updates,\n  });\n\nexport const deletePerson = (hass: HomeAssistant, personId: string) =>\n  hass.callWS({\n    type: \"person/delete\",\n    person_id: personId,\n  });\n","import { HomeAssistant } from \"../types\";\nimport { Credential } from \"./auth\";\n\nexport const SYSTEM_GROUP_ID_ADMIN = \"system-admin\";\nexport const SYSTEM_GROUP_ID_USER = \"system-users\";\nexport const SYSTEM_GROUP_ID_READ_ONLY = \"system-read-only\";\n\nexport interface User {\n  id: string;\n  name: string;\n  is_owner: boolean;\n  is_active: boolean;\n  system_generated: boolean;\n  group_ids: string[];\n  credentials: Credential[];\n}\n\ninterface UpdateUserParams {\n  name?: User[\"name\"];\n  group_ids?: User[\"group_ids\"];\n}\n\nexport const fetchUsers = async (hass: HomeAssistant) =>\n  hass.callWS<User[]>({\n    type: \"config/auth/list\",\n  });\n\nexport const createUser = async (hass: HomeAssistant, name: string) =>\n  hass.callWS<{ user: User }>({\n    type: \"config/auth/create\",\n    name,\n  });\n\nexport const updateUser = async (\n  hass: HomeAssistant,\n  userId: string,\n  params: UpdateUserParams\n) =>\n  hass.callWS<{ user: User }>({\n    ...params,\n    type: \"config/auth/update\",\n    user_id: userId,\n  });\n\nexport const deleteUser = async (hass: HomeAssistant, userId: string) =>\n  hass.callWS<void>({\n    type: \"config/auth/delete\",\n    user_id: userId,\n  });\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"../../resources/ha-style\";\n\nclass HaConfigSection extends PolymerElement {\n  static get template() {\n    return html`\n      <style include=\"iron-flex ha-style\">\n        .content {\n          padding: 28px 20px 0;\n          max-width: 1040px;\n          margin: 0 auto;\n        }\n\n        .header {\n          @apply --paper-font-display1;\n          opacity: var(--dark-primary-opacity);\n        }\n\n        .together {\n          margin-top: 32px;\n        }\n\n        .intro {\n          @apply --paper-font-subhead;\n          width: 100%;\n          max-width: 400px;\n          margin-right: 40px;\n          opacity: var(--dark-primary-opacity);\n        }\n\n        .panel {\n          margin-top: -24px;\n        }\n\n        .panel ::slotted(*) {\n          margin-top: 24px;\n          display: block;\n        }\n\n        .narrow.content {\n          max-width: 640px;\n        }\n        .narrow .together {\n          margin-top: 20px;\n        }\n        .narrow .header {\n          @apply --paper-font-headline;\n        }\n        .narrow .intro {\n          font-size: 14px;\n          padding-bottom: 20px;\n          margin-right: 0;\n          max-width: 500px;\n        }\n      </style>\n      <div class$=\"[[computeContentClasses(isWide)]]\">\n        <div class=\"header\"><slot name=\"header\"></slot></div>\n        <div class$=\"[[computeClasses(isWide)]]\">\n          <div class=\"intro\"><slot name=\"introduction\"></slot></div>\n          <div class=\"panel flex-auto\"><slot></slot></div>\n        </div>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      narrow: {\n        type: Boolean,\n      },\n\n      isWide: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  computeContentClasses(isWide) {\n    var classes = \"content \";\n\n    return isWide ? classes : classes + \"narrow\";\n  }\n\n  computeClasses(isWide) {\n    var classes = \"together layout \";\n\n    return classes + (isWide ? \"horizontal\" : \"vertical narrow\");\n  }\n}\n\ncustomElements.define(\"ha-config-section\", HaConfigSection);\n","import {\n  LitElement,\n  TemplateResult,\n  html,\n  css,\n  CSSResult,\n  PropertyDeclarations,\n} from \"lit-element\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-item/paper-item-body\";\nimport \"@polymer/paper-fab/paper-fab\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport {\n  Person,\n  fetchPersons,\n  updatePerson,\n  deletePerson,\n  createPerson,\n} from \"../../../data/person\";\nimport \"../../../components/ha-card\";\nimport \"../../../layouts/hass-subpage\";\nimport \"../../../layouts/hass-loading-screen\";\nimport { compare } from \"../../../common/string/compare\";\nimport \"../ha-config-section\";\nimport {\n  showPersonDetailDialog,\n  loadPersonDetailDialog,\n} from \"./show-dialog-person-detail\";\nimport { User, fetchUsers } from \"../../../data/user\";\n\nclass HaConfigPerson extends LitElement {\n  public hass?: HomeAssistant;\n  public isWide?: boolean;\n  private _storageItems?: Person[];\n  private _configItems?: Person[];\n  private _usersLoad?: Promise<User[]>;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      hass: {},\n      isWide: {},\n      _storageItems: {},\n      _configItems: {},\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (\n      !this.hass ||\n      this._storageItems === undefined ||\n      this._configItems === undefined\n    ) {\n      return html`\n        <hass-loading-screen></hass-loading-screen>\n      `;\n    }\n    return html`\n      <hass-subpage header=\"Persons\">\n        <ha-config-section .isWide=${this.isWide}>\n          <span slot=\"header\">Persons</span>\n          <span slot=\"introduction\">\n            Here you can define each person of interest in Home Assistant.\n            ${this._configItems.length > 0\n              ? html`\n                  <p>\n                    Note: persons configured via configuration.yaml cannot be\n                    edited via the UI.\n                  </p>\n                `\n              : \"\"}\n          </span>\n          <ha-card class=\"storage\">\n            ${this._storageItems.map((entry) => {\n              return html`\n                <paper-item @click=${this._openEditEntry} .entry=${entry}>\n                  <paper-item-body>\n                    ${entry.name}\n                  </paper-item-body>\n                </paper-item>\n              `;\n            })}\n            ${this._storageItems.length === 0\n              ? html`\n                  <div class=\"empty\">\n                    Looks like you have not created any persons yet.\n                    <mwc-button @click=${this._createPerson}>\n                      CREATE PERSON</mwc-button\n                    >\n                  </div>\n                `\n              : html``}\n          </ha-card>\n          ${this._configItems.length > 0\n            ? html`\n                <ha-card header=\"Configuration.yaml persons\">\n                  ${this._configItems.map((entry) => {\n                    return html`\n                      <paper-item>\n                        <paper-item-body>\n                          ${entry.name}\n                        </paper-item-body>\n                      </paper-item>\n                    `;\n                  })}\n                </ha-card>\n              `\n            : \"\"}\n        </ha-config-section>\n      </hass-subpage>\n\n      <paper-fab\n        ?is-wide=${this.isWide}\n        icon=\"hass:plus\"\n        title=\"Create Area\"\n        @click=${this._createPerson}\n      ></paper-fab>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    this._fetchData();\n    loadPersonDetailDialog();\n  }\n\n  private async _fetchData() {\n    this._usersLoad = fetchUsers(this.hass!);\n    const personData = await fetchPersons(this.hass!);\n\n    this._storageItems = personData.storage.sort((ent1, ent2) =>\n      compare(ent1.name, ent2.name)\n    );\n    this._configItems = personData.config.sort((ent1, ent2) =>\n      compare(ent1.name, ent2.name)\n    );\n  }\n\n  private _createPerson() {\n    this._openDialog();\n  }\n\n  private _openEditEntry(ev: MouseEvent) {\n    const entry: Person = (ev.currentTarget! as any).entry;\n    this._openDialog(entry);\n  }\n\n  private _allowedUsers(users: User[], currentPerson?: Person) {\n    const used = new Set();\n    for (const coll of [this._configItems, this._storageItems]) {\n      for (const pers of coll!) {\n        if (pers.user_id) {\n          used.add(pers.user_id);\n        }\n      }\n    }\n    const currentUserId = currentPerson ? currentPerson.user_id : undefined;\n    return users.filter(\n      (user) => user.id === currentUserId || !used.has(user.id)\n    );\n  }\n\n  private async _openDialog(entry?: Person) {\n    const users = await this._usersLoad!;\n\n    showPersonDetailDialog(this, {\n      entry,\n      users: this._allowedUsers(users, entry),\n      createEntry: async (values) => {\n        const created = await createPerson(this.hass!, values);\n        this._storageItems = this._storageItems!.concat(created).sort(\n          (ent1, ent2) => compare(ent1.name, ent2.name)\n        );\n      },\n      updateEntry: async (values) => {\n        const updated = await updatePerson(this.hass!, entry!.id, values);\n        this._storageItems = this._storageItems!.map((ent) =>\n          ent === entry ? updated : ent\n        );\n      },\n      removeEntry: async () => {\n        if (\n          !confirm(`Are you sure you want to delete this person?\n\nAll devices belonging to this person will become unassigned.`)\n        ) {\n          return false;\n        }\n\n        try {\n          await deletePerson(this.hass!, entry!.id);\n          this._storageItems = this._storageItems!.filter(\n            (ent) => ent !== entry\n          );\n          return true;\n        } catch (err) {\n          return false;\n        }\n      },\n    });\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      a {\n        color: var(--primary-color);\n      }\n      ha-card {\n        max-width: 600px;\n        margin: 16px auto;\n        overflow: hidden;\n      }\n      .empty {\n        text-align: center;\n        padding: 8px;\n      }\n      paper-item {\n        padding-top: 4px;\n        padding-bottom: 4px;\n      }\n      ha-card.storage paper-item {\n        cursor: pointer;\n      }\n      paper-fab {\n        position: fixed;\n        bottom: 16px;\n        right: 16px;\n        z-index: 1;\n      }\n\n      paper-fab[is-wide] {\n        bottom: 24px;\n        right: 24px;\n      }\n    `;\n  }\n}\n\ncustomElements.define(\"ha-config-person\", HaConfigPerson);\n","import { fireEvent } from \"../../../common/dom/fire_event\";\nimport { Person, PersonMutableParams } from \"../../../data/person\";\nimport { User } from \"../../../data/user\";\n\nexport interface PersonDetailDialogParams {\n  entry?: Person;\n  users: User[];\n  createEntry: (values: PersonMutableParams) => Promise<unknown>;\n  updateEntry: (updates: Partial<PersonMutableParams>) => Promise<unknown>;\n  removeEntry: () => Promise<boolean>;\n}\n\nexport const loadPersonDetailDialog = () =>\n  import(/* webpackChunkName: \"person-detail-dialog\" */ \"./dialog-person-detail\");\n\nexport const showPersonDetailDialog = (\n  element: HTMLElement,\n  systemLogDetailParams: PersonDetailDialogParams\n): void => {\n  fireEvent(element, \"show-dialog\", {\n    dialogTag: \"dialog-person-detail\",\n    dialogImport: loadPersonDetailDialog,\n    dialogParams: systemLogDetailParams,\n  });\n};\n"],"sourceRoot":""}