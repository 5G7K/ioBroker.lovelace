{"version":3,"sources":["webpack:///./src/mixins/events-mixin.js","webpack:///./src/common/util/subscribe-one.ts","webpack:///./src/data/lovelace.ts","webpack:///./src/components/ha-markdown.js","webpack:///./src/mixins/localize-mixin.js","webpack:///./src/common/entity/compute_state_name.ts","webpack:///./src/components/ha-icon.ts","webpack:///./src/panels/lovelace/common/has-changed.ts","webpack:///./src/components/ha-card.ts","webpack:///./src/panels/lovelace/components/hui-warning.ts","webpack:///./src/common/entity/compute_state_domain.ts","webpack:///./src/components/entity/state-badge.ts","webpack:///./src/common/entity/supports-feature.ts","webpack:///./src/common/util/debounce.ts","webpack:///./src/common/entity/compute_state_display.ts","webpack:///./src/common/entity/domain_icon.ts","webpack:///./src/components/ha-relative-time.js","webpack:///./src/util/cover-model.js","webpack:///./src/common/datetime/format_date_time.ts","webpack:///./src/components/ha-paper-dropdown-menu.ts","webpack:///./src/common/entity/sensor_icon.ts","webpack:///./src/common/entity/state_icon.ts","webpack:///./src/common/entity/binary_sensor_icon.ts","webpack:///./src/common/entity/cover_icon.ts","webpack:///./src/common/entity/input_dateteime_icon.ts","webpack:///./src/components/entity/ha-entity-toggle.ts","webpack:///./src/common/datetime/format_time.ts","webpack:///./src/panels/lovelace/editor/config-util.ts","webpack:///./src/common/datetime/relative_time.ts","webpack:///./src/panels/lovelace/common/process-config-entities.ts","webpack:///./src/data/history.ts","webpack:///./src/common/config/is_component_loaded.ts","webpack:///./src/panels/lovelace/cards/hui-error-card.ts","webpack:///./src/common/string/compare.ts","webpack:///./src/common/entity/compute_object_id.ts","webpack:///./src/common/datetime/seconds_to_duration.ts","webpack:///./src/panels/lovelace/common/compute-card-size.ts","webpack:///./src/components/ha-cover-tilt-controls.js","webpack:///./src/common/datetime/format_date.ts","webpack:///./src/common/util/time-cache-function-promise.ts","webpack:///./src/util/hass-media-player-model.js","webpack:///./src/data/camera.ts","webpack:///./src/data/area_registry.ts","webpack:///./src/data/device_registry.ts","webpack:///./src/panels/lovelace/cards/hui-alarm-panel-card.ts","webpack:///./src/data/alarm_control_panel.ts","webpack:///./src/panels/lovelace/common/validate-condition.ts","webpack:///./src/panels/lovelace/cards/hui-conditional-card.ts","webpack:///./src/panels/lovelace/common/directives/long-press-directive.ts","webpack:///./src/panels/lovelace/common/entity/turn-on-off-entity.ts","webpack:///./src/panels/lovelace/common/entity/toggle-entity.ts","webpack:///./src/panels/lovelace/common/handle-click.ts","webpack:///./src/panels/lovelace/cards/hui-entity-button-card.ts","webpack:///./src/panels/lovelace/cards/hui-entity-filter-card.ts","webpack:///./src/panels/lovelace/components/hui-warning-element.ts","webpack:///./src/panels/lovelace/cards/hui-glance-card.ts","webpack:///./src/panels/lovelace/cards/hui-history-graph-card.js","webpack:///./src/panels/lovelace/cards/hui-stack-card.ts","webpack:///./src/panels/lovelace/cards/hui-horizontal-stack-card.ts","webpack:///./src/panels/lovelace/cards/hui-iframe-card.ts","webpack:///./src/resources/jquery.roundslider.ondemand.ts","webpack:///./src/panels/lovelace/cards/hui-light-card.ts","webpack:///./src/panels/map/ha-entity-marker.js","webpack:///./src/common/util/parse-aspect-ratio.ts","webpack:///./src/panels/lovelace/cards/hui-map-card.ts","webpack:///./src/panels/lovelace/cards/hui-markdown-card.ts","webpack:///./src/cards/ha-media_player-card.js","webpack:///./src/panels/lovelace/cards/hui-legacy-wrapper-card.js","webpack:///./src/panels/lovelace/cards/hui-media-control-card.js","webpack:///./src/panels/lovelace/cards/hui-picture-card.ts","webpack:///./src/panels/lovelace/elements/hui-conditional-element.ts","webpack:///./src/panels/lovelace/common/compute-tooltip.ts","webpack:///./src/panels/lovelace/elements/hui-icon-element.ts","webpack:///./src/panels/lovelace/components/hui-image.ts","webpack:///./src/panels/lovelace/elements/hui-image-element.ts","webpack:///./src/components/buttons/ha-progress-button.js","webpack:///./src/components/buttons/ha-call-service-button.js","webpack:///./src/panels/lovelace/elements/hui-service-button-element.ts","webpack:///./src/panels/lovelace/elements/hui-state-badge-element.ts","webpack:///./src/panels/lovelace/elements/hui-state-icon-element.ts","webpack:///./src/panels/lovelace/elements/hui-state-label-element.ts","webpack:///./src/panels/lovelace/common/create-hui-element.ts","webpack:///./src/panels/lovelace/cards/picture-elements/create-styled-hui-element.ts","webpack:///./src/panels/lovelace/cards/hui-picture-elements-card.ts","webpack:///./src/panels/lovelace/cards/hui-picture-entity-card.ts","webpack:///./src/data/entity.ts","webpack:///./src/panels/lovelace/cards/hui-picture-glance-card.ts","webpack:///./src/panels/lovelace/cards/hui-plant-status-card.ts","webpack:///./src/panels/lovelace/cards/hui-sensor-card.ts","webpack:///./src/panels/lovelace/cards/hui-vertical-stack-card.ts","webpack:///./src/data/shopping-list.ts","webpack:///./src/panels/lovelace/cards/hui-shopping-list-card.ts","webpack:///./src/panels/lovelace/cards/hui-thermostat-card.ts","webpack:///./src/cards/ha-weather-card.js","webpack:///./src/panels/lovelace/cards/hui-weather-forecast-card.js","webpack:///./src/panels/lovelace/cards/hui-gauge-card.ts","webpack:///./src/panels/lovelace/common/create-card-element.ts","webpack:///./src/components/entity/ha-chart-base.js","webpack:///./src/components/state-history-chart-line.js","webpack:///./src/components/state-history-chart-timeline.js","webpack:///./src/components/state-history-charts.js","webpack:///./src/data/cached-history.ts","webpack:///./src/data/ha-state-history-data.js","webpack:///./src/common/entity/timer_time_remaining.ts","webpack:///./src/common/datetime/duration_to_seconds.ts","webpack:///./src/components/entity/ha-state-label-badge.ts","webpack:///./src/common/entity/valid_entity_id.ts","webpack:///./src/components/ha-climate-state.js","webpack:///./src/components/ha-cover-controls.js","webpack:///./src/components/paper-time-input.js","webpack:///./src/components/ha-slider.js","webpack:///./src/data/input-select.ts","webpack:///./src/common/dom/stop_propagation.ts","webpack:///./src/common/dom/setup-leaflet-map.ts","webpack:///./src/data/entity_registry.ts","webpack:///./src/components/ha-label-badge.ts","webpack:///./src/data/media-player.ts","webpack:///./src/panels/lovelace/editor/card-editor/show-edit-card-dialog.ts","webpack:///./src/common/util/render-status.ts","webpack:///./src/panels/lovelace/components/hui-entities-toggle.ts","webpack:///./src/panels/lovelace/common/entity/turn-on-off-entities.ts","webpack:///./src/panels/lovelace/components/hui-generic-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-climate-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-cover-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-group-entity-row.ts","webpack:///./src/components/ha-date-input.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-datetime-entity-row.ts","webpack:///./src/data/input_datetime.ts","webpack:///./src/data/input_text.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-number-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-select-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-text-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-lock-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-media-player-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-scene-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-script-entity-row.ts","webpack:///./src/panels/lovelace/components/hui-timestamp-display.ts","webpack:///./src/panels/lovelace/entity-rows/hui-sensor-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-text-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-timer-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-toggle-entity-row.ts","webpack:///./src/panels/lovelace/special-rows/hui-call-service-row.ts","webpack:///./src/panels/lovelace/common/call-service.ts","webpack:///./src/panels/lovelace/special-rows/hui-divider-row.ts","webpack:///./src/panels/lovelace/special-rows/hui-section-row.ts","webpack:///./src/panels/lovelace/special-rows/hui-weblink-row.ts","webpack:///./src/panels/lovelace/common/create-row-element.ts","webpack:///./src/panels/lovelace/cards/hui-entities-card.ts","webpack:///./src/layouts/ha-app-layout.js","webpack:///./src/components/ha-start-voice-button.js","webpack:///./src/components/ha-paper-icon-button-arrow-next.ts","webpack:///./src/data/ws-notifications.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notification-item-template.ts","webpack:///./src/panels/lovelace/components/notifications/hui-configurator-notification-item.ts","webpack:///./src/panels/lovelace/components/notifications/hui-persistent-notification-item.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notification-item.ts","webpack:///./src/components/ha-paper-icon-button-next.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notification-drawer.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notifications-button.ts","webpack:///./src/panels/lovelace/hui-view.ts","webpack:///./src/panels/lovelace/editor/view-editor/show-edit-view-dialog.ts","webpack:///./src/panels/lovelace/editor/lovelace-editor/show-edit-lovelace-dialog.ts","webpack:///./src/panels/lovelace/hui-root.ts","webpack:///./src/panels/lovelace/common/compute-notifications.ts","webpack:///./src/common/dom/scroll-to-target.ts","webpack:///./src/panels/lovelace/editor/show-save-config-dialog.ts","webpack:///./src/panels/lovelace/common/generate-lovelace-config.ts","webpack:///./src/common/entity/split_by_groups.ts","webpack:///./src/common/entity/extract_views.ts","webpack:///./src/common/entity/get_view_entities.ts","webpack:///./src/common/entity/get_group_entities.ts","webpack:///./src/panels/lovelace/ha-panel-lovelace.ts","webpack:///./src/data/auth.ts","webpack:///./src/common/dom/load_resource.ts"],"names":["__webpack_require__","d","__webpack_exports__","EventsMixin","_polymer_polymer_lib_utils_mixin__WEBPACK_IMPORTED_MODULE_0__","_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_1__","dedupingMixin","superClass","fire","type","detail","options","fireEvent","node","this","subscribeOne","async","conn","subscribe","Promise","resolve","unsub","items","fetchConfig","saveConfig","subscribeLovelaceUpdates","force","sendMessagePromise","hass","config","callWS","onChange","subscribeEvents","_polymer_polymer_polymer_element__WEBPACK_IMPORTED_MODULE_0__","_mixins_events_mixin__WEBPACK_IMPORTED_MODULE_1__","loaded","svgWhiteList","customElements","define","PolymerElement","properties","content","String","observer","allowSvg","Boolean","value","connectedCallback","super","_scriptLoaded","_renderScheduled","_resize","all","e","then","bind","marked","filterXSS","_render","innerHTML","gfm","tables","breaks","onIgnoreTag","tag","html","indexOf","walker","document","createTreeWalker","nextNode","currentNode","tagName","host","location","target","addEventListener","innerText","Object","localize","Function","computed","__computeLocalize","_compute_object_id__WEBPACK_IMPORTED_MODULE_0__","stateObj","undefined","attributes","friendly_name","computeObjectId","entity_id","replace","ironIconClass","get","HaIcon","[object Object]","args","listen","eventName","methodName","_iconsetName","hasConfigOrEntityChanged","element","changedProps","has","oldHass","states","_config","entity","HaCard","_LitElement","_initialize","property","css","header","LitElement","_decorate","customElement","F","kind","key","static","computeStateDomain","_compute_domain__WEBPACK_IMPORTED_MODULE_0__","computeDomain","StateBadge","query","state","overrideIcon","stateIcon","iconStyle","color","filter","hostStyle","backgroundImage","entity_picture","display","hs_color","hue","sat","brightness","errorMessage","console","warn","assign","_icon","style","supportsFeature","feature","supported_features","debounce","func","wait","immediate","timeout","context","callNow","clearTimeout","setTimeout","apply","_compute_state_domain__WEBPACK_IMPORTED_MODULE_0__","_datetime_format_date_time__WEBPACK_IMPORTED_MODULE_1__","_datetime_format_date__WEBPACK_IMPORTED_MODULE_2__","_datetime_format_time__WEBPACK_IMPORTED_MODULE_3__","language","domain","device_class","unit_of_measurement","includes","date","has_time","has_date","Date","year","month","day","hour","minute","formatDateTime","now","getFullYear","getMonth","getDay","formatTime","formatDate","query_stage","domainIcon","_const__WEBPACK_IMPORTED_MODULE_0__","fixedIcons","alert","alexa","automation","calendar","camera","climate","configurator","conversation","device_tracker","fan","google_assistant","group","history_graph","homeassistant","homekit","image_processing","input_boolean","input_datetime","input_number","input_select","input_text","light","mailbox","notify","person","plant","proximity","remote","scene","script","sensor","simple_alarm","sun","switch","timer","updater","vacuum","water_heater","weather","weblink","DEFAULT_DOMAIN_ICON","_polymer_polymer_lib_legacy_polymer_dom__WEBPACK_IMPORTED_MODULE_0__","_polymer_polymer_polymer_element__WEBPACK_IMPORTED_MODULE_1__","_common_datetime_relative_time__WEBPACK_IMPORTED_MODULE_2__","_mixins_localize_mixin__WEBPACK_IMPORTED_MODULE_3__","LocalizeMixin","datetime","datetimeObj","parsedDateTime","constructor","updateRelative","updateInterval","setInterval","disconnectedCallback","clearInterval","datetimeChanged","newVal","datetimeObjChanged","root","dom","relativeTime","CoverEntity","isTiltOnly","_common_entity_supports_feature__WEBPACK_IMPORTED_MODULE_0__","_attr","_feat","isFullyOpen","current_position","isFullyClosed","isFullyOpenTilt","current_tilt_position","isFullyClosedTilt","isOpening","isClosing","supportsOpen","supportsClose","supportsSetPosition","supportsStop","supportsOpenTilt","supportsCloseTilt","supportsStopTilt","supportsSetTiltPosition","supportsCover","openCover","callService","closeCover","stopCover","openCoverTilt","closeCoverTilt","stopCoverTilt","setCoverPosition","position","setCoverTiltPosition","tiltPosition","tilt_position","service","data","fecha__WEBPACK_IMPORTED_MODULE_0__","toLocaleStringSupportsOptions","toLocaleString","name","dateObj","locales","fecha","format","paperDropdownClass","ready","window","getComputedStyle","direction","textAlign","fixedDeviceClassIcons","humidity","illuminance","temperature","pressure","power","signal_strength","domainIcons","binary_sensor","activated","cover","open","dclass","battery","Number","isNaN","batteryRound","Math","round","unit","UNIT_C","UNIT_F","icon","isOn","STATES_OFF","HaEntityToggle","assumed_state","computeStateName","_turnOff","_isOn","_turnOn","_toggleChanged","_get","_getPrototypeOf","prototype","call","ev","stopPropagation","checked","_callService","turnOn","forwardHaptic","stateDomain","serviceDomain","currentState","toLocaleTimeStringSupportsOptions","toLocaleTimeString","addCard","replaceCard","deleteCard","swapCard","moveCard","addView","replaceView","swapView","deleteView","path","cardConfig","viewIndex","views","forEach","viewConf","index","push","cards","cardIndex","map","origConf","ind","_origConf","path1","path2","card1","card2","origView1","newView1","origCard","origView2","newView2","origView","fromPath","toPath","Error","fromView","card","toView","viewConfig","concat","view1","view2","_origView","tests","langKey","delta","compareTime","getTime","tense","timeDesc","abs","i","length","floor","includeTense","processConfigEntities","_common_entity_valid_entity_id__WEBPACK_IMPORTED_MODULE_0__","entities","Array","isArray","entityConf","isValidEntityId","fetchRecent","fetchDate","computeHistory","_common_entity_compute_state_name__WEBPACK_IMPORTED_MODULE_0__","_common_entity_compute_state_domain__WEBPACK_IMPORTED_MODULE_1__","_common_entity_compute_state_display__WEBPACK_IMPORTED_MODULE_2__","DOMAINS_USE_LAST_UPDATED","LINE_ATTRIBUTES_TO_KEEP","entityId","startTime","endTime","skipInitialState","url","toISOString","callApi","equalState","obj1","obj2","every","attr","stateHistory","lineChartDevices","timelineDevices","stateInfo","stateWithUnit","find","unit_system","state_localize","computeStateDisplay","last_changed","processTimelineEntity","line","keys","last","processedStates","processedState","last_updated","identifier","join","processLineChartEntities","timeline","isComponentLoaded","component","components","createErrorCardElement","el","createElement","setConfig","createErrorCardConfig","error","origConfig","decorators","_toStr","JSON","stringify","compare","caseInsensitiveCompare","a","b","toLowerCase","substr","secondsToDuration","leftPad","num","h","m","s","computeCardSize","getCardSize","_polymer_polymer_lib_utils_html_tag__WEBPACK_IMPORTED_MODULE_2__","_polymer_polymer_polymer_element__WEBPACK_IMPORTED_MODULE_3__","_util_cover_model__WEBPACK_IMPORTED_MODULE_4__","template","entityObj","computeEntityObj","computeOpenDisabled","assumedState","computeClosedDisabled","onOpenTiltTap","onCloseTiltTap","onStopTiltTap","toLocaleDateStringSupportsOptions","toLocaleDateString","timeCachePromiseFunc","cacheKey","cacheTime","cache","lastResult","result","MediaPlayerEntity","isOff","isIdle","isMuted","is_volume_muted","isPaused","isPlaying","isMusic","media_content_type","isTVShow","hasMediaControl","volumeSliderValue","volume_level","showProgress","currentProgress","progress","media_position","media_position_updated_at","supportsPause","supportsVolumeSet","supportsVolumeMute","supportsPreviousTrack","supportsNextTrack","supportsTurnOn","supportsTurnOff","supportsPlayMedia","supportsVolumeButtons","supportsSelectSource","supportsSelectSoundMode","supportsPlay","primaryTitle","media_title","secondaryTitle","media_artist","text","media_series_title","media_season","media_episode","app_name","source","sourceList","source_list","soundMode","sound_mode","soundModeList","sound_mode_list","mediaPlayPause","nextTrack","playbackControl","previousTrack","setVolume","volume","togglePower","turnOff","volumeDown","volumeMute","mute","volumeUp","selectSource","selectSoundMode","CAMERA_SUPPORT_STREAM","computeMJPEGStreamUrl","fetchThumbnailUrlWithCache","fetchStreamUrl","fetchCameraPrefs","updateCameraPrefs","_common_util_time_cache_function_promise__WEBPACK_IMPORTED_MODULE_0__","_auth__WEBPACK_IMPORTED_MODULE_1__","access_token","fetchThumbnailUrl","getSignedPath","prefs","createAreaRegistryEntry","subscribeAreaRegistry","home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_0__","_common_string_compare__WEBPACK_IMPORTED_MODULE_1__","_common_util_debounce__WEBPACK_IMPORTED_MODULE_2__","values","fetchAreaRegistry","areas","sort","ent1","ent2","subscribeAreaRegistryUpdates","store","setState","createCollection","updateDeviceRegistryEntry","subscribeDeviceRegistry","_common_util_debounce__WEBPACK_IMPORTED_MODULE_1__","deviceId","updates","device_id","fetchDeviceRegistry","subscribeDeviceRegistryUpdates","devices","ICONS","armed_away","armed_custom_bypass","armed_home","armed_night","disarmed","pending","triggered","BUTTONS","code_format","split","_code","_label","classMap","_stateIconLabel","_handleActionClick","_handlePadClick","stateLabel","pop","val","currentTarget","action","code","checkConditionsMet","conditions","c","state_not","validateConditionalConfig","HTMLElement","_defineProperty","_card","parentElement","removeChild","createCardElement","update","_hass","visible","appendChild","setProperty","isTouch","navigator","maxTouchPoints","msMaxTouchPoints","long_press_directive_defineProperty","holdTime","ripple","held","cooldownStart","cooldownEnd","borderRadius","width","height","transform","pointerEvents","stopAnimation","passive","longPress","event","preventDefault","cancelBubble","returnValue","clickStart","x","y","touches","pageX","pageY","startAnimation","clickEnd","dispatchEvent","Event","left","top","holdDown","simulatedRipple","longPressBind","longpress","body","querySelector","getLongPress","directive","part","committer","toggleEntity","turnOnOffEntity","handleClick","hold","actionConfig","hold_action","tap_action","camera_image","navigation_path","navigate","service_data","HuiEntityButtonCard","show_icon","show_name","theme","DOMAINS_TOGGLE","_handleTap","_handleHold","styleMap","_computeBrightness","_computeColor","icon_height","themes","applyThemesOnElement","hui_entity_filter_card_defineProperty","_element","state_filter","_configEntities","_baseCardConfig","lastChild","entitiesList","show_empty","_cardElement","isPanel","hui_warning_element_decorate","label","hui_glance_card_decorate","HuiGlanceCard","title","ceil","columns","min","requestUpdate","no-header","renderEntity","changedProperties","hui_glance_card_get","hui_glance_card_getPrototypeOf","show_state","_names","_entities","_stateHistory","_stateHistoryLoading","_cacheConfig","setProperties","hoursToShow","hours_to_show","refresh","refresh_interval","HuiStackCard","hui_stack_card_defineProperty","_cards","_createCardElement","render","renderStyle","_rebuildCard","once","cardElToReplace","newCardEl","replaceChild","curCardEl","totalSize","elementSize","hui_iframe_card_decorate","aspect_ratio","aspectRatio","padding-top","loadRoundslider","lightConfig","radius","step","circleShape","startAngle","max","sliderType","lineCap","handleSize","showTooltip","animation","hui_light_card_decorate","HuiLightCard","_handleMoreInfo","_roundSliderStyle","roundSliderStyle","_jQuery","jQuery","shadowRoot","roundSlider","change","_setBrightness","drag","_dragEvent","start","_showBrightness","stop","_hideBrightness","hui_light_card_get","hui_light_card_getPrototypeOf","attrs","_brightnessTimout","classList","add","remove","brightness_pct","entityName","entityPicture","badgeTap","parseOrThrow","parsed","parseFloat","parseAspectRatio","input","endsWith","w","arr","err","HuiMapCard","reflect","_leafletMap","invalidateSize","geo_location_sources","ratio","ar","toFixed","hui_map_card_get","hui_map_card_getPrototypeOf","_connected","hasUpdated","loadMap","_attachObserver","Leaflet","_resizeObserver","unobserve","_mapEl","removeEventListener","_debouncedResizeListener","_fitMap","getElementById","paddingBottom","_drawEntities","setupLeafletMap","dark_mode","zoom","default_zoom","_mapItems","setView","LatLng","latitude","longitude","bounds","latLngBounds","item","getLatLng","fitBounds","pad","getZoom","setZoom","marker","mapItems","allEntities","includesAll","gps_accuracy","gpsAccuracy","divIcon","iconSize","className","interactive","circle","addLayer","ResizeObserver","observe","hui_markdown_card_decorate","playerObj","playbackControlIcon","playbackPosition","_coverShowing","_coverLoadError","oldPlayerObj","_positionTracking","updatePlaybackPosition","picture","oldPicture","$","content_type","contentType","fetchMediaPlayerThumbnailWithCache","computeBannerClasses","coverShowing","coverLoadError","cls","computeHideProgress","computeHidePowerButton","computePlayerObj","HassMediaPlayerEntity","computePrimaryText","computePlaybackControlIcon","_computeStateName","handleNext","handleOpenMoreInfo","handlePlaybackControl","handlePrevious","handleTogglePower","LegacyWrapperCard","_tag","toUpperCase","_domain","_ensureElement","hui_picture_card_decorate","image","clickable","hui_conditional_element_defineProperty","elements","_elements","elementConfig","createStyledHuiElement","updateElements","computeTooltip","stateName","tooltip","tapTooltip","computeActionTooltip","holdTooltip","isHold","hui_icon_element_decorate","hui_image_decorate","HuiImage","hui_image_get","hui_image_getPrototypeOf","_attached","cameraImage","cameraView","_startUpdateCameraInterval","_stopUpdateCameraInterval","imageSrc","cameraObj","imageFallback","stateImage","_cameraImageSrc","stateFilter","_onImageError","_onImageLoad","_loadError","_lastImageHeight","_updateCameraImageSrc","_cameraUpdater","updateComplete","_image","offsetHeight","hui_image_element_decorate","toggle","state_image","disabled","tempClass","container","buttonTapped","actionSuccess","actionError","computeDisabled","serviceData","eventData","success","hui_service_button_element_decorate","_service","hui_state_badge_element_decorate","hui_state_icon_element_decorate","_handleClick","prefix","suffix","ELEMENT_TYPES","Set","TIMEOUT","_createElement","deepClone","_createErrorElement","message","createHuiElement","startsWith","_hideErrorElement","whenDefined","prop","querySelectorAll","camera_view","footer","_entitiesDialog","_entitiesToggle","force_dialog","dialog","_openDialog","state-on","SENSORS","moisture","conductivity","computeAttributes","computeIcon","problem","unit_of_measurement_dict","batLvl","sensors","midPoint","_Ax","_Ay","_Bx","_By","coordinates","history","hours","reduce","res","point","age","toString","entry","coords","yRatio","xRatio","isFinite","getCoords","offset","depth","subItem","average","sum","margin","calcPoints","HuiSensorCard","graph","_history","svg","_date","hui_sensor_card_get","hui_sensor_card_getPrototypeOf","_getHistory","setHours","getHours","next","Z","coord","getPath","updateItem","itemId","item_id","HuiShoppingListCard","_uncheckedItems","_checkedItems","_fetchData","hui_shopping_list_card_get","hui_shopping_list_card_getPrototypeOf","_unsubEvents","connection","_addItem","_addKeyPress","repeat","id","complete","_completeItem","_saveEdit","_clearItems","checkedItems","uncheckedItems","fetchItems","catch","blur","clearItems","newItem","_newItem","addItem","focus","keyCode","thermostatConfig","modeIcons","auto","manual","heat","cool","off","fan_only","eco","dry","idle","hui_thermostat_card_decorate","HuiThermostatCard","hui_thermostat_card_get","hui_thermostat_card_getPrototypeOf","_updated","_loaded","_initialLoad","mode","operation_mode","large","_broadCard","small","current_temperature","operation_list","modeItem","_renderIcon","isConnected","sliderValue","uiValue","_genSliderValue","_updateSetTemp","target_temp_step","clientWidth","_sliderType","target_temp_low","target_temp_high","min_temp","max_temp","_setTemperature","_stepSize","formatTemp","handle","currentMode","selected-icon","_handleModeClick","temps","spaceStepSize","stepSize","forecast","rtl","reflectToAttribute","cardinalDirections","weatherIcons","clear-night","cloudy","fog","hail","lightning","lightning-rainy","partlycloudy","pouring","rainy","snowy","snowy-rainy","sunny","windy","windy-variant","_onClick","computeForecast","slice","getUnit","measure","lengthUnit","computeState","match","computeName","showWeatherIcon","condition","showWeatherImg","iconURL","showWeatherAsCondition","getWeatherIcon","windBearingToText","degree","degreenum","parseInt","getWindSpeed","speed","getWindBearing","bearing","cardinalDirection","_showValue","computeDate","weekday","computeTime","_computeRTL","computeRTL","severityMap","red","green","yellow","normal","HuiGaugeCard","hui_gauge_card_get","hui_gauge_card_getPrototypeOf","_setBaseUnit","--base-unit","_baseUnit","_translateTurn","background-color","_computeSeverity","baseUnit","_computeBaseUnit","numberValue","sections","severity","sortable","CARD_TYPES","scriptsLoaded","mixinBehaviors","IronResizableBehavior","chart","_chart","rendered","readOnly","metas","opacity","xPadding","yPadding","observers","_isAttached","onPropsChange","_resizeListener","_debouncer","Debouncer","timeOut","after","resizeChart","resizeObserver","entries","chartTarget","ChartModule","ChartClass","default","_resizeTimer","drawChart","_customTooltips","set","yAlign","bodyLines","n","lines","colors","labelColors","borderColor","bgColor","backgroundColor","parentWidth","positionX","caretX","positionY","canvas","offsetTop","caretY","offsetLeft","_legendClick","srcElement","nodeName","model","itemsIndex","meta","getDatasetMeta","hidden","datasets","isDatasetVisible","_drawLegend","preserveVisibility","_oldIdentifier","updateNeeded","_formatTickValue","ctx","chartCanvas","cnt","getColorList","loopI","rgbString","alpha","rgbaString","duration","isTimeline","scales","yAxes","gridLines","legend","plugins","afterRender","_setRendered","responsive","maintainAspectRatio","hover","animationDuration","responsiveAnimationDuration","tooltips","enabled","custom","spanGaps","font","ticks","fontFamily","Chart","helpers","merge","xAxes","callback","_colorFunc","getColorGenerator","staticColors","staticColorIndex","colorFunction","chartData","_resizeChart","resize","areaTop","chartArea","areaBot","bottom","height1","clientHeight","_axisHeight","targetHeight","count","processL","h1","Color","hsl","startIndex","palette","getColorIndex","idx","colorDict","colorIndex","c1","__","ret","name1","names","isSingleDevice","dataChanged","_onRenderedChanged","animateHeight","requestAnimationFrame","scrollHeight","deviceStates","safeParseFloat","devSts","prevValues","pushData","timestamp","datavalues","addColumn","nameY","fill","dataFill","dataStep","steppedLine","pointRadius","unitText","hasTargetRange","some","hasHeat","hasCool","curTemp","series","targetHigh","targetLow","lastValue","lastDate","lastNullDate","dateTime","lastNullDateTime","lastDateTime","chartOptions","major","fontStyle","maxTicksLimit","callbacks","datasetIndex","layout","padding","tension","borderWidth","hitRadius","filler","propagate","labels","noSingle","minTime","maxTime","newLastChanged","prevState","locState","prevLastChanged","entityDisplay","dataRow","newState","end","afterSetDimensions","yaxe","maxWidth","on","unavailable","unknown","historyData","isLoadingData","upToNow","_computeIsSingleLineChart","_computeIsEmpty","historyDataEmpty","_computeIsLoading","isLoading","_computeEndTime","RECENT_CACHE","stateHistoryCache","getRecent","created","prom","getRecentWithCache","cacheConfig","toFetchStartTime","appendingToCache","getEmptyCache","curCacheProm","fetchedHistory","mergeLine","mergeTimeline","pruneStartTime","genProm","historyLines","cacheLines","oldLine","cacheLine","oldEntity","cacheEntity","historyTimelines","cacheTimelines","oldTimeline","cacheTimeline","pruneArray","originalStartTime","changedAfterStartTime","findIndex","updateIndex","cacheData","filterType","filterChangedDebouncer","_refreshTimeoutId","hassChanged","newHass","_madeFirstCall","_debounceFilterChanged","filterChanged","dateHistory","getRecentWithCacheRefresh","_setIsLoading","_setData","timerTimeRemaining","timeRemaining","parts","durationToSeconds","remaining","madeActive","HaStateLabelBadge","startInterval","has-unit_of_measurement","_computeValue","_computeIcon","_computeLabel","_timerTimeRemaining","_clearInterval","arguments","_updateRemaining","calculateTimerRemaining","validEntityId","test","_polymer_polymer_lib_utils_html_tag__WEBPACK_IMPORTED_MODULE_0__","_mixins_localize_mixin__WEBPACK_IMPORTED_MODULE_2__","currentStatus","computeCurrentStatus","current_humidity","computeTarget","target_humidity_low","target_humidity_high","_hasKnownState","_localizeState","_polymer_polymer_lib_utils_html_tag__WEBPACK_IMPORTED_MODULE_1__","_polymer_polymer_polymer_element__WEBPACK_IMPORTED_MODULE_2__","_util_cover_model__WEBPACK_IMPORTED_MODULE_3__","onOpenTap","onCloseTap","onStopTap","_polymer_polymer_lib_utils_html_tag__WEBPACK_IMPORTED_MODULE_4__","_polymer_polymer_polymer_element__WEBPACK_IMPORTED_MODULE_5__","autoValidate","hideLabel","amPm","validate","valid","dropdown","_computeTime","_formatMin","_shouldFormatHour","_computeHourMax","_equal","n1","n2","PaperSliderClass","subTemplate","cloneNode","createTextNode","_calcStep","numSteps","stepStr","stepPointAt","precision","setInputSelectOption","option","mapElement","darkMode","parentNode","t","Icon","Default","imagePath","setAttribute","tileLayer","Browser","retina","attribution","subdomains","minZoom","maxZoom","addTo","updateEntityRegistryEntry","subscribeEntityRegistry","fetchEntityRegistry","subscribeEntityRegistryUpdates","description","big","styles","updated","SUPPORT_PAUSE","SUPPORT_NEXT_TRACK","SUPPORTS_PLAY","OFF_STATES","fetchMediaPlayerThumbnail","showEditCardDialog","_common_dom_fire_event__WEBPACK_IMPORTED_MODULE_0__","registeredDialog","editCardDialogParams","dialogShowEvent","dialogTag","dialogImport","registerEditCardDialog","afterNextRender","cb","HuiEntitiesToggle","_toggleEntities","entityIds","domainsToCall","turnOnOffEntities","HuiGenericEntityRow","showSecondary","secondary_info","hui_generic_entity_row_get","hui_generic_entity_row_getPrototypeOf","toggleAttribute","_computeCanToggle","ha_date_input_decorate","_formatYear","_formatMonth","_formatDay","yearElement","monthElement","dayElement","_selectedValueChanged","_stopEventPropagation","time","_timeInputEl","trim","_dateInputEl","param","setInputDateTimeValue","setValue","HuiInputNumberEntityRow","hui_input_number_entity_row_get","hui_input_number_entity_row_getPrototypeOf","computeRTLDirection","_inputElement","HuiInputSelectEntityRow","_selectedChanged","hui_input_select_entity_row_get","hui_input_select_entity_row_getPrototypeOf","selected","selectedItem","pattern","_inputEl","_computeControlIcon","_playPause","_nextTrack","_computeMediaTitle","can_cancel","FORMATS","format_date","format_date_time","format_time","INTERVAL_FORMAT","HuiTimestampDisplay","hui_timestamp_display_get","hui_timestamp_display_getPrototypeOf","_startInterval","ts","_format","_relative","_updateRelative","_interval","HuiTimerEntityRow","hui_timer_entity_row_get","hui_timer_entity_row_getPrototypeOf","_computeDisplay","_calculateRemaining","_timeRemaining","action_name","SPECIAL_TYPES","DOMAIN_TO_ELEMENT_TYPE","lock","media_player","createRowElement","HuiEntitiesCard","entitiesToggle","hui_entities_card_get","hui_entities_card_getPrototypeOf","show_header_toggle","conf","DOMAINS_HIDE_MORE_INFO","canListen","computeCanListen","handleListenClick","paperIconButtonClass","fetchNotifications","subscribeUpdates","ntf","hui_configurator_notification_item_decorate","notification","hui_persistent_notification_item_decorate","_computeTitle","created_at","_computeTooltip","_handleDismiss","notification_id","hui_notification_item_decorate","narrow","notifications","_closeDrawer","_empty","_openChanged","_openTimer","HuiNotificationsButton","_clicked","opened","editCodeLoaded","HUIView","hui_view_decorate","_badges","lovelace","editMode","renderStyles","_addCard","editModeChanged","configChanged","oldLovelace","_createBadges","badge","_createCards","badges","elementsToAppend","wrapper","columnEntityCount","cardSize","size","minIndex","getColumnIndex","column","columnEl","showEditViewDialog","editViewDialogParams","registerEditViewDialog","showEditLovelaceDialog","registerEditLovelaceDialog","CSS_CACHE","JS_CACHE","HUIRoot","_debouncedConfigChanged","_selectView","_curView","hui_root_get","hui_root_getPrototypeOf","_unsubNotifications","subscribeNotifications","_persistentNotifications","route","_routeData","_routeDataChanged","_notifications","_notificationsOpen","_handleNotificationsOpenChanged","edit-mode","_editMode","_editModeDisable","_editLovelace","_handleHelp","_deselect","enableFullEditMode","_hideToolbar","_yamlMode","_handleRefresh","_handleUnusedEntities","_editModeEnable","_handleViewSelected","view","_moveViewLeft","_editView","_moveViewRight","_addView","tabs-hidden","haStyle","huiView","_viewRoot","newSelectView","selectedView","selectedViewInt","_loadResources","resources","_updateNotifications","hideToolbar","search","persistent","computeNotifications","setEditMode","oldIndex","newIndex","scroller","animationId","random","currentScrollTop","scrollTop","deltaScrollTop","_currentAnimationId","updateFrame","elapsedTime","scrollToTarget","_layout","scrollTarget","_viewCache","unusedEntities","background","append","panel","resource","loadCSS","loadJS","loadModule","importHref","DOMAINS_BADGES","HIDE_DOMAIN","subscribedRegistries","computeCards","entityCardOptions","unshift","generateDefaultViewConfig","registries","computeDefaultViewStates","groupOrders","order","splittedByAreas","areasWithEntities","area","areaEntities","areaDevices","device","area_id","otherEntities","splitByAreas","generateViewConfig","areaCards","splitted","groups","ungrouped","splitByGroups","gr1","gr2","badgeEntities","ungroupedEntitites","coll","groupEntity","control","generateLovelaceConfig","viewEntities","DEFAULT_VIEW_ENTITY_ID","extractViews","viewEntity","groupEntities","getGroupEntities","grEntityId","grEntity","getViewEntities","location_name","editorLoaded","LovelacePanel","_closeEditor","_state","_columns","_forceFetchConfig","_errorMsg","ha_panel_lovelace_get","ha_panel_lovelace_getPrototypeOf","_updateColumns","dockedSidebar","_fetchConfig","_lovelaceChanged","mqls","mql","matchMedia","addListener","_setLovelaceConfig","_regenerateConfig","matchColumns","cols","matches","_saving","showToast","dismissable","forceDiskRefresh","confProm","confMode","llWindow","llConfProm","log","saveDialogParams","showSaveDialog","_updateLovelace","previousConfig","previousMode","newConfig","props","hassUrl","fetchAuthProviders","protocol","fetch","credentials","_load","reject","parent","onload","onerror","rel"],"mappings":"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","file":"chunk.6dc7d6f1a780e2957f5c.js","sourcesContent":["import { dedupingMixin } from \"@polymer/polymer/lib/utils/mixin\";\n\nimport { fireEvent } from \"../common/dom/fire_event\";\n\n// Polymer legacy event helpers used courtesy of the Polymer project.\n//\n// Copyright (c) 2017 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n//    * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n//    * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n//    * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\n/* @polymerMixin */\nexport const EventsMixin = dedupingMixin(\n  (superClass) =>\n    class extends superClass {\n      /**\n   * Dispatches a custom event with an optional detail value.\n   *\n   * @param {string} type Name of event type.\n   * @param {*=} detail Detail value containing event-specific\n   *   payload.\n   * @param {{ bubbles: (boolean|undefined),\n               cancelable: (boolean|undefined),\n                composed: (boolean|undefined) }=}\n    *  options Object specifying options.  These may include:\n    *  `bubbles` (boolean, defaults to `true`),\n    *  `cancelable` (boolean, defaults to false), and\n    *  `node` on which to fire the event (HTMLElement, defaults to `this`).\n    * @return {Event} The new event that was fired.\n    */\n      fire(type, detail, options) {\n        options = options || {};\n        return fireEvent(options.node || this, type, detail, options);\n      }\n    }\n);\n","import { UnsubscribeFunc, Connection } from \"home-assistant-js-websocket\";\n\nexport const subscribeOne = async <T>(\n  conn: Connection,\n  subscribe: (conn: Connection, onChange: (items: T) => void) => UnsubscribeFunc\n) =>\n  new Promise<T>((resolve) => {\n    const unsub = subscribe(conn, (items) => {\n      unsub();\n      resolve(items);\n    });\n  });\n","import { HomeAssistant } from \"../types\";\nimport { Connection } from \"home-assistant-js-websocket\";\n\nexport interface LovelaceConfig {\n  title?: string;\n  hideToolbar?: boolean; // IoB\n  views: LovelaceViewConfig[];\n  background?: string;\n  resources?: Array<{ type: \"css\" | \"js\" | \"module\" | \"html\"; url: string }>;\n}\n\nexport interface LovelaceViewConfig {\n  index?: number;\n  title?: string;\n  badges?: string[];\n  cards?: LovelaceCardConfig[];\n  path?: string;\n  icon?: string;\n  theme?: string;\n  panel?: boolean;\n  background?: string;\n}\n\nexport interface LovelaceCardConfig {\n  index?: number;\n  view_index?: number;\n  type: string;\n  [key: string]: any;\n}\n\nexport interface ToggleActionConfig {\n  action: \"toggle\";\n}\n\nexport interface CallServiceActionConfig {\n  action: \"call-service\";\n  service: string;\n  service_data?: {\n    entity_id?: string | [string];\n    [key: string]: any;\n  };\n}\n\nexport interface NavigateActionConfig {\n  action: \"navigate\";\n  navigation_path: string;\n}\n\nexport interface MoreInfoActionConfig {\n  action: \"more-info\";\n}\n\nexport interface NoActionConfig {\n  action: \"none\";\n}\n\nexport type ActionConfig =\n  | ToggleActionConfig\n  | CallServiceActionConfig\n  | NavigateActionConfig\n  | MoreInfoActionConfig\n  | NoActionConfig;\n\nexport const fetchConfig = (\n  conn: Connection,\n  force: boolean\n): Promise<LovelaceConfig> =>\n  conn.sendMessagePromise({\n    type: \"lovelace/config\",\n    force,\n  });\n\nexport const saveConfig = (\n  hass: HomeAssistant,\n  config: LovelaceConfig\n): Promise<void> =>\n  hass.callWS({\n    type: \"lovelace/config/save\",\n    config,\n  });\n\nexport const subscribeLovelaceUpdates = (\n  conn: Connection,\n  onChange: () => void\n) => conn.subscribeEvents(onChange, \"lovelace_updated\");\n\nexport interface WindowWithLovelaceProm extends Window {\n  llConfProm?: Promise<LovelaceConfig>;\n}\n","import { PolymerElement } from \"@polymer/polymer/polymer-element\";\nimport { EventsMixin } from \"../mixins/events-mixin\";\n\nlet loaded = null;\n\n/**\n * White list allowed svg tag.\n * Only put in the tag used in QR code, can be extend in future.\n */\nconst svgWhiteList = [\"svg\", \"path\"];\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaMarkdown extends EventsMixin(PolymerElement) {\n  static get properties() {\n    return {\n      content: {\n        type: String,\n        observer: \"_render\",\n      },\n      allowSvg: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    // 0 = not loaded, 1 = success, 2 = error\n    this._scriptLoaded = 0;\n    this._renderScheduled = false;\n    this._resize = () => this.fire(\"iron-resize\");\n\n    if (!loaded) {\n      loaded = import(/* webpackChunkName: \"load_markdown\" */ \"../resources/load_markdown\");\n    }\n    loaded\n      .then(\n        ({ marked, filterXSS }) => {\n          this.marked = marked;\n          this.filterXSS = filterXSS;\n          this._scriptLoaded = 1;\n        },\n        () => {\n          this._scriptLoaded = 2;\n        }\n      )\n      .then(() => this._render());\n  }\n\n  _render() {\n    if (this._scriptLoaded === 0 || this._renderScheduled) return;\n\n    this._renderScheduled = true;\n\n    // debounce it to next microtask.\n    Promise.resolve().then(() => {\n      this._renderScheduled = false;\n\n      if (this._scriptLoaded === 1) {\n        this.innerHTML = this.filterXSS(\n          this.marked(this.content, {\n            gfm: true,\n            tables: true,\n            breaks: true,\n          }),\n          {\n            onIgnoreTag: this.allowSvg\n              ? (tag, html) => (svgWhiteList.indexOf(tag) >= 0 ? html : null)\n              : null,\n          }\n        );\n        this._resize();\n\n        const walker = document.createTreeWalker(\n          this,\n          1 /* SHOW_ELEMENT */,\n          null,\n          false\n        );\n\n        while (walker.nextNode()) {\n          const node = walker.currentNode;\n\n          // Open external links in a new window\n          if (node.tagName === \"A\" && node.host !== document.location.host) {\n            node.target = \"_blank\";\n\n            // Fire a resize event when images loaded to notify content resized\n          } else if (node.tagName === \"IMG\") {\n            node.addEventListener(\"load\", this._resize);\n          }\n        }\n      } else if (this._scriptLoaded === 2) {\n        this.innerText = this.content;\n      }\n    });\n  }\n}\n\ncustomElements.define(\"ha-markdown\", HaMarkdown);\n","import { dedupingMixin } from \"@polymer/polymer/lib/utils/mixin\";\n/**\n * Polymer Mixin to enable a localize function powered by language/resources from hass object.\n *\n * @polymerMixin\n */\nexport default dedupingMixin(\n  (superClass) =>\n    class extends superClass {\n      static get properties() {\n        return {\n          hass: Object,\n\n          /**\n           * Translates a string to the current `language`. Any parameters to the\n           * string should be passed in order, as follows:\n           * `localize(stringKey, param1Name, param1Value, param2Name, param2Value)`\n           */\n          localize: {\n            type: Function,\n            computed: \"__computeLocalize(hass.localize)\",\n          },\n        };\n      }\n\n      __computeLocalize(localize) {\n        return localize;\n      }\n    }\n);\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport computeObjectId from \"./compute_object_id\";\n\nexport default (stateObj: HassEntity): string =>\n  stateObj.attributes.friendly_name === undefined\n    ? computeObjectId(stateObj.entity_id).replace(/_/g, \" \")\n    : stateObj.attributes.friendly_name || \"\";\n","import { Constructor } from \"lit-element\";\nimport \"@polymer/iron-icon/iron-icon\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { IronIconElement } from \"@polymer/iron-icon/iron-icon\";\n\nconst ironIconClass = customElements.get(\"iron-icon\") as Constructor<\n  IronIconElement\n>;\n\nlet loaded = false;\n\nexport class HaIcon extends ironIconClass {\n  private _iconsetName?: string;\n\n  public listen(\n    node: EventTarget | null,\n    eventName: string,\n    methodName: string\n  ): void {\n    super.listen(node, eventName, methodName);\n\n    if (!loaded && this._iconsetName === \"mdi\") {\n      loaded = true;\n      import(/* webpackChunkName: \"mdi-icons\" */ \"../resources/mdi-icons\");\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-icon\": HaIcon;\n  }\n}\n\ncustomElements.define(\"ha-icon\", HaIcon);\n","import { HomeAssistant } from \"../../../types\";\nimport { PropertyValues } from \"lit-element\";\n\n// Check if config or Entity changed\nexport function hasConfigOrEntityChanged(\n  element: any,\n  changedProps: PropertyValues\n): boolean {\n  if (changedProps.has(\"_config\")) {\n    return true;\n  }\n\n  const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n  if (oldHass) {\n    return (\n      oldHass.states[element._config!.entity] !==\n      element.hass!.states[element._config!.entity]\n    );\n  }\n\n  return true;\n}\n","import {\n  css,\n  CSSResult,\n  html,\n  LitElement,\n  property,\n  TemplateResult,\n} from \"lit-element\";\n\nclass HaCard extends LitElement {\n  @property() public header?: string;\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        background: var(\n          --ha-card-background,\n          var(--paper-card-background-color, white)\n        );\n        border-radius: var(--ha-card-border-radius, 2px);\n        box-shadow: var(\n          --ha-card-box-shadow,\n          0 2px 2px 0 rgba(0, 0, 0, 0.14),\n          0 1px 5px 0 rgba(0, 0, 0, 0.12),\n          0 3px 1px -2px rgba(0, 0, 0, 0.2)\n        );\n        color: var(--primary-text-color);\n        display: block;\n        transition: all 0.3s ease-out;\n        position: relative;\n      }\n\n      .card-header,\n      :host ::slotted(.card-header) {\n        color: var(--ha-card-header-color, --primary-text-color);\n        font-family: var(--ha-card-header-font-family, inherit);\n        font-size: var(--ha-card-header-font-size, 24px);\n        letter-spacing: -0.012em;\n        line-height: 32px;\n        padding: 24px 16px 16px;\n        display: block;\n      }\n\n      :host ::slotted(.card-content:not(:first-child)),\n      slot:not(:first-child)::slotted(.card-content) {\n        padding-top: 0px;\n        margin-top: -8px;\n      }\n\n      :host ::slotted(.card-content) {\n        padding: 16px;\n      }\n\n      :host ::slotted(.card-actions) {\n        border-top: 1px solid #e8e8e8;\n        padding: 5px 16px;\n      }\n    `;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      ${this.header\n        ? html`\n            <div class=\"card-header\">${this.header}</div>\n          `\n        : html``}\n      <slot></slot>\n    `;\n  }\n}\n\ncustomElements.define(\"ha-card\", HaCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResult,\n  css,\n  customElement,\n} from \"lit-element\";\n\n@customElement(\"hui-warning\")\nexport class HuiWarning extends LitElement {\n  protected render(): TemplateResult | void {\n    return html`\n      <slot></slot>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        color: black;\n        background-color: #fce588;\n        padding: 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-warning\": HuiWarning;\n  }\n}\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport computeDomain from \"./compute_domain\";\n\nexport default function computeStateDomain(stateObj: HassEntity) {\n  return computeDomain(stateObj.entity_id);\n}\n","import {\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  html,\n  property,\n  PropertyValues,\n  query,\n} from \"lit-element\";\nimport \"../ha-icon\";\nimport computeStateDomain from \"../../common/entity/compute_state_domain\";\nimport stateIcon from \"../../common/entity/state_icon\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { HaIcon } from \"../ha-icon\";\n\nclass StateBadge extends LitElement {\n  @property() public stateObj?: HassEntity;\n  @property() public overrideIcon?: string;\n  @query(\"ha-icon\") private _icon!: HaIcon;\n\n  protected render(): TemplateResult | void {\n    const stateObj = this.stateObj;\n\n    if (!stateObj) {\n      return html``;\n    }\n\n    return html`\n      <ha-icon\n        id=\"icon\"\n        data-domain=${computeStateDomain(stateObj)}\n        data-state=${stateObj.state}\n        .icon=${this.overrideIcon || stateIcon(stateObj)}\n      ></ha-icon>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    if (!changedProps.has(\"stateObj\") || !this.stateObj) {\n      return;\n    }\n    const stateObj = this.stateObj;\n\n    const iconStyle: Partial<CSSStyleDeclaration> = {\n      color: \"\",\n      filter: \"\",\n    };\n    const hostStyle: Partial<CSSStyleDeclaration> = {\n      backgroundImage: \"\",\n    };\n    if (stateObj) {\n      // hide icon if we have entity picture\n      if (stateObj.attributes.entity_picture && !this.overrideIcon) {\n        hostStyle.backgroundImage =\n          \"url(\" + stateObj.attributes.entity_picture + \")\";\n        iconStyle.display = \"none\";\n      } else {\n        if (stateObj.attributes.hs_color) {\n          const hue = stateObj.attributes.hs_color[0];\n          const sat = stateObj.attributes.hs_color[1];\n          if (sat > 10) {\n            iconStyle.color = `hsl(${hue}, 100%, ${100 - sat / 2}%)`;\n          }\n        }\n        if (stateObj.attributes.brightness) {\n          const brightness = stateObj.attributes.brightness;\n          if (typeof brightness !== \"number\") {\n            const errorMessage = `Type error: state-badge expected number, but type of ${\n              stateObj.entity_id\n            }.attributes.brightness is ${typeof brightness} (${brightness})`;\n            // tslint:disable-next-line\n            console.warn(errorMessage);\n          }\n          // lowest brighntess will be around 50% (that's pretty dark)\n          iconStyle.filter = `brightness(${(brightness + 245) / 5}%)`;\n        }\n      }\n    }\n    Object.assign(this._icon.style, iconStyle);\n    Object.assign(this.style, hostStyle);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        position: relative;\n        display: inline-block;\n        width: 40px;\n        color: var(--paper-item-icon-color, #44739e);\n        border-radius: 50%;\n        height: 40px;\n        text-align: center;\n        background-size: cover;\n        line-height: 40px;\n      }\n\n      ha-icon {\n        transition: color 0.3s ease-in-out, filter 0.3s ease-in-out;\n      }\n\n      /* Color the icon if light or sun is on */\n      ha-icon[data-domain=\"light\"][data-state=\"on\"],\n      ha-icon[data-domain=\"switch\"][data-state=\"on\"],\n      ha-icon[data-domain=\"binary_sensor\"][data-state=\"on\"],\n      ha-icon[data-domain=\"fan\"][data-state=\"on\"],\n      ha-icon[data-domain=\"sun\"][data-state=\"above_horizon\"] {\n        color: var(--paper-item-icon-active-color, #fdd835);\n      }\n\n      /* Color the icon if unavailable */\n      ha-icon[data-state=\"unavailable\"] {\n        color: var(--state-icon-unavailable-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"state-badge\": StateBadge;\n  }\n}\n\ncustomElements.define(\"state-badge\", StateBadge);\n","import { HassEntity } from \"home-assistant-js-websocket\";\n\nexport const supportsFeature = (\n  stateObj: HassEntity,\n  feature: number\n): boolean => {\n  // tslint:disable-next-line:no-bitwise\n  return (stateObj.attributes.supported_features! & feature) !== 0;\n};\n","// From: https://davidwalsh.name/javascript-debounce-function\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// tslint:disable-next-line: ban-types\nexport const debounce = <T extends Function>(\n  func: T,\n  wait,\n  immediate = false\n): T => {\n  let timeout;\n  // @ts-ignore\n  return function(...args) {\n    // tslint:disable:no-this-assignment\n    // @ts-ignore\n    const context = this;\n    const later = () => {\n      timeout = null;\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n};\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport computeStateDomain from \"./compute_state_domain\";\nimport formatDateTime from \"../datetime/format_date_time\";\nimport formatDate from \"../datetime/format_date\";\nimport formatTime from \"../datetime/format_time\";\nimport { LocalizeFunc } from \"../translations/localize\";\n\nexport default (\n  localize: LocalizeFunc,\n  stateObj: HassEntity,\n  language: string\n): string => {\n  let display: string | undefined;\n  const domain = computeStateDomain(stateObj);\n\n  if (domain === \"binary_sensor\") {\n    // Try device class translation, then default binary sensor translation\n    if (stateObj.attributes.device_class) {\n      display = localize(\n        `state.${domain}.${stateObj.attributes.device_class}.${stateObj.state}`\n      );\n    }\n\n    if (!display) {\n      display = localize(`state.${domain}.default.${stateObj.state}`);\n    }\n  } else if (\n    stateObj.attributes.unit_of_measurement &&\n    ![\"unknown\", \"unavailable\"].includes(stateObj.state)\n  ) {\n    display = stateObj.state + \" \" + stateObj.attributes.unit_of_measurement;\n  } else if (domain === \"input_datetime\") {\n    let date: Date;\n    if (!stateObj.attributes.has_time) {\n      date = new Date(\n        stateObj.attributes.year,\n        stateObj.attributes.month - 1,\n        stateObj.attributes.day\n      );\n      display = formatDate(date, language);\n    } else if (!stateObj.attributes.has_date) {\n      const now = new Date();\n      date = new Date(\n        // Due to bugs.chromium.org/p/chromium/issues/detail?id=797548\n        // don't use artificial 1970 year.\n        now.getFullYear(),\n        now.getMonth(),\n        now.getDay(),\n        stateObj.attributes.hour,\n        stateObj.attributes.minute\n      );\n      display = formatTime(date, language);\n    } else {\n      date = new Date(\n        stateObj.attributes.year,\n        stateObj.attributes.month - 1,\n        stateObj.attributes.day,\n        stateObj.attributes.hour,\n        stateObj.attributes.minute\n      );\n      display = formatDateTime(date, language);\n    }\n  } else if (domain === \"zwave\") {\n    if ([\"initializing\", \"dead\"].includes(stateObj.state)) {\n      display = localize(\n        `state.zwave.query_stage.${stateObj.state}`,\n        \"query_stage\",\n        stateObj.attributes.query_stage\n      );\n    } else {\n      display = localize(`state.zwave.default.${stateObj.state}`);\n    }\n  } else {\n    display = localize(`state.${domain}.${stateObj.state}`);\n  }\n\n  // Fall back to default, component backend translation, or raw state if nothing else matches.\n  if (!display) {\n    display =\n      localize(`state.default.${stateObj.state}`) ||\n      localize(`component.${domain}.state.${stateObj.state}`) ||\n      stateObj.state;\n  }\n\n  return display;\n};\n","/**\n * Return the icon to be used for a domain.\n *\n * Optionally pass in a state to influence the domain icon.\n */\nimport { DEFAULT_DOMAIN_ICON } from \"../const\";\n\nconst fixedIcons = {\n  alert: \"hass:alert\",\n  alexa: \"hass:amazon-alexa\",\n  automation: \"hass:playlist-play\",\n  calendar: \"hass:calendar\",\n  camera: \"hass:video\",\n  climate: \"hass:thermostat\",\n  configurator: \"hass:settings\",\n  conversation: \"hass:text-to-speech\",\n  device_tracker: \"hass:account\",\n  fan: \"hass:fan\",\n  google_assistant: \"hass:google-assistant\",\n  group: \"hass:google-circles-communities\",\n  history_graph: \"hass:chart-line\",\n  homeassistant: \"hass:home-assistant\",\n  homekit: \"hass:home-automation\",\n  image_processing: \"hass:image-filter-frames\",\n  input_boolean: \"hass:drawing\",\n  input_datetime: \"hass:calendar-clock\",\n  input_number: \"hass:ray-vertex\",\n  input_select: \"hass:format-list-bulleted\",\n  input_text: \"hass:textbox\",\n  light: \"hass:lightbulb\",\n  mailbox: \"hass:mailbox\",\n  notify: \"hass:comment-alert\",\n  person: \"hass:account\",\n  plant: \"hass:flower\",\n  proximity: \"hass:apple-safari\",\n  remote: \"hass:remote\",\n  scene: \"hass:google-pages\",\n  script: \"hass:file-document\",\n  sensor: \"hass:eye\",\n  simple_alarm: \"hass:bell\",\n  sun: \"hass:white-balance-sunny\",\n  switch: \"hass:flash\",\n  timer: \"hass:timer\",\n  updater: \"hass:cloud-upload\",\n  vacuum: \"hass:robot-vacuum\",\n  water_heater: \"hass:thermometer\",\n  weather: \"hass:weather-cloudy\",\n  weblink: \"hass:open-in-new\",\n};\n\nexport default function domainIcon(domain: string, state?: string): string {\n  if (domain in fixedIcons) {\n    return fixedIcons[domain];\n  }\n\n  switch (domain) {\n    case \"alarm_control_panel\":\n      switch (state) {\n        case \"armed_home\":\n          return \"hass:bell-plus\";\n        case \"armed_night\":\n          return \"hass:bell-sleep\";\n        case \"disarmed\":\n          return \"hass:bell-outline\";\n        case \"triggered\":\n          return \"hass:bell-ring\";\n        default:\n          return \"hass:bell\";\n      }\n\n    case \"binary_sensor\":\n      return state && state === \"off\"\n        ? \"hass:radiobox-blank\"\n        : \"hass:checkbox-marked-circle\";\n\n    case \"cover\":\n      return state === \"closed\" ? \"hass:window-closed\" : \"hass:window-open\";\n\n    case \"lock\":\n      return state && state === \"unlocked\" ? \"hass:lock-open\" : \"hass:lock\";\n\n    case \"media_player\":\n      return state && state !== \"off\" && state !== \"idle\"\n        ? \"hass:cast-connected\"\n        : \"hass:cast\";\n\n    case \"zwave\":\n      switch (state) {\n        case \"dead\":\n          return \"hass:emoticon-dead\";\n        case \"sleeping\":\n          return \"hass:sleep\";\n        case \"initializing\":\n          return \"hass:timer-sand\";\n        default:\n          return \"hass:z-wave\";\n      }\n\n    default:\n      // tslint:disable-next-line\n      console.warn(\n        \"Unable to find icon for domain \" + domain + \" (\" + state + \")\"\n      );\n      return DEFAULT_DOMAIN_ICON;\n  }\n}\n","import { dom } from \"@polymer/polymer/lib/legacy/polymer.dom\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport relativeTime from \"../common/datetime/relative_time\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaRelativeTime extends LocalizeMixin(PolymerElement) {\n  static get properties() {\n    return {\n      hass: Object,\n      datetime: {\n        type: String,\n        observer: \"datetimeChanged\",\n      },\n\n      datetimeObj: {\n        type: Object,\n        observer: \"datetimeObjChanged\",\n      },\n\n      parsedDateTime: Object,\n    };\n  }\n\n  constructor() {\n    super();\n    this.updateRelative = this.updateRelative.bind(this);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    // update every 60 seconds\n    this.updateInterval = setInterval(this.updateRelative, 60000);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    clearInterval(this.updateInterval);\n  }\n\n  datetimeChanged(newVal) {\n    this.parsedDateTime = newVal ? new Date(newVal) : null;\n\n    this.updateRelative();\n  }\n\n  datetimeObjChanged(newVal) {\n    this.parsedDateTime = newVal;\n\n    this.updateRelative();\n  }\n\n  updateRelative() {\n    const root = dom(this);\n    if (!this.parsedDateTime) {\n      root.innerHTML = this.localize(\"ui.components.relative_time.never\");\n    } else {\n      root.innerHTML = relativeTime(this.parsedDateTime, this.localize);\n    }\n  }\n}\n\ncustomElements.define(\"ha-relative-time\", HaRelativeTime);\n","import { supportsFeature } from \"../common/entity/supports-feature\";\n\n/* eslint-enable no-bitwise */\nexport default class CoverEntity {\n  constructor(hass, stateObj) {\n    this.hass = hass;\n    this.stateObj = stateObj;\n    this._attr = stateObj.attributes;\n    this._feat = this._attr.supported_features;\n  }\n\n  get isFullyOpen() {\n    if (this._attr.current_position !== undefined) {\n      return this._attr.current_position === 100;\n    }\n    return this.stateObj.state === \"open\";\n  }\n\n  get isFullyClosed() {\n    if (this._attr.current_position !== undefined) {\n      return this._attr.current_position === 0;\n    }\n    return this.stateObj.state === \"closed\";\n  }\n\n  get isFullyOpenTilt() {\n    return this._attr.current_tilt_position === 100;\n  }\n\n  get isFullyClosedTilt() {\n    return this._attr.current_tilt_position === 0;\n  }\n\n  get isOpening() {\n    return this.stateObj.state === \"opening\";\n  }\n\n  get isClosing() {\n    return this.stateObj.state === \"closing\";\n  }\n\n  get supportsOpen() {\n    return supportsFeature(this.stateObj, 1);\n  }\n\n  get supportsClose() {\n    return supportsFeature(this.stateObj, 2);\n  }\n\n  get supportsSetPosition() {\n    return supportsFeature(this.stateObj, 4);\n  }\n\n  get supportsStop() {\n    return supportsFeature(this.stateObj, 8);\n  }\n\n  get supportsOpenTilt() {\n    return supportsFeature(this.stateObj, 16);\n  }\n\n  get supportsCloseTilt() {\n    return supportsFeature(this.stateObj, 32);\n  }\n\n  get supportsStopTilt() {\n    return supportsFeature(this.stateObj, 64);\n  }\n\n  get supportsSetTiltPosition() {\n    return supportsFeature(this.stateObj, 128);\n  }\n\n  get isTiltOnly() {\n    const supportsCover =\n      this.supportsOpen || this.supportsClose || this.supportsStop;\n    const supportsTilt =\n      this.supportsOpenTilt || this.supportsCloseTilt || this.supportsStopTilt;\n    return supportsTilt && !supportsCover;\n  }\n\n  openCover() {\n    this.callService(\"open_cover\");\n  }\n\n  closeCover() {\n    this.callService(\"close_cover\");\n  }\n\n  stopCover() {\n    this.callService(\"stop_cover\");\n  }\n\n  openCoverTilt() {\n    this.callService(\"open_cover_tilt\");\n  }\n\n  closeCoverTilt() {\n    this.callService(\"close_cover_tilt\");\n  }\n\n  stopCoverTilt() {\n    this.callService(\"stop_cover_tilt\");\n  }\n\n  setCoverPosition(position) {\n    this.callService(\"set_cover_position\", { position });\n  }\n\n  setCoverTiltPosition(tiltPosition) {\n    this.callService(\"set_cover_tilt_position\", {\n      tilt_position: tiltPosition,\n    });\n  }\n\n  // helper method\n\n  callService(service, data = {}) {\n    data.entity_id = this.stateObj.entity_id;\n    this.hass.callService(\"cover\", service, data);\n  }\n}\n\nexport const supportsOpen = (stateObj) => supportsFeature(stateObj, 1);\n\nexport const supportsClose = (stateObj) => supportsFeature(stateObj, 2);\n\nexport const supportsSetPosition = (stateObj) => supportsFeature(stateObj, 4);\n\nexport const supportsStop = (stateObj) => supportsFeature(stateObj, 8);\n\nexport const supportsOpenTilt = (stateObj) => supportsFeature(stateObj, 16);\n\nexport const supportsCloseTilt = (stateObj) => supportsFeature(stateObj, 32);\n\nexport const supportsStopTilt = (stateObj) => supportsFeature(stateObj, 64);\n\nexport const supportsSetTiltPosition = (stateObj) =>\n  supportsFeature(stateObj, 128);\n\nexport function isTiltOnly(stateObj) {\n  const supportsCover =\n    supportsOpen(stateObj) || supportsClose(stateObj) || supportsStop(stateObj);\n  const supportsTilt =\n    supportsOpenTilt(stateObj) ||\n    supportsCloseTilt(stateObj) ||\n    supportsStopTilt(stateObj);\n  return supportsTilt && !supportsCover;\n}\n","import fecha from \"fecha\";\n\n// Check for support of native locale string options\nfunction toLocaleStringSupportsOptions() {\n  try {\n    new Date().toLocaleString(\"i\");\n  } catch (e) {\n    return e.name === \"RangeError\";\n  }\n  return false;\n}\n\nexport default (toLocaleStringSupportsOptions()\n  ? (dateObj: Date, locales: string) =>\n      dateObj.toLocaleString(locales, {\n        year: \"numeric\",\n        month: \"long\",\n        day: \"numeric\",\n        hour: \"numeric\",\n        minute: \"2-digit\",\n      })\n  : (dateObj: Date) => fecha.format(dateObj, \"haDateTime\"));\n","import \"@polymer/paper-dropdown-menu/paper-dropdown-menu\";\nimport { Constructor } from \"lit-element\";\nimport { PolymerElement } from \"@polymer/polymer\";\n\nconst paperDropdownClass = customElements.get(\n  \"paper-dropdown-menu\"\n) as Constructor<PolymerElement>;\n\n// patches paper drop down to properly support RTL - https://github.com/PolymerElements/paper-dropdown-menu/issues/183\nexport class HaPaperDropdownClass extends paperDropdownClass {\n  public ready() {\n    super.ready();\n    // wait to check for direction since otherwise direction is wrong even though top level is RTL\n    setTimeout(() => {\n      if (window.getComputedStyle(this).direction === \"rtl\") {\n        this.style.textAlign = \"right\";\n      }\n    }, 100);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-dropdown-menu\": HaPaperDropdownClass;\n  }\n}\n\ncustomElements.define(\"ha-paper-dropdown-menu\", HaPaperDropdownClass);\n","/** Return an icon representing a sensor state. */\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { UNIT_C, UNIT_F } from \"../const\";\nimport domainIcon from \"./domain_icon\";\n\nconst fixedDeviceClassIcons = {\n  humidity: \"hass:water-percent\",\n  illuminance: \"hass:brightness-5\",\n  temperature: \"hass:thermometer\",\n  pressure: \"hass:gauge\",\n  power: \"hass:flash\",\n  signal_strength: \"hass:wifi\",\n};\n\nexport default function sensorIcon(state: HassEntity) {\n  const dclass = state.attributes.device_class;\n\n  if (dclass && dclass in fixedDeviceClassIcons) {\n    return fixedDeviceClassIcons[dclass];\n  }\n  if (dclass === \"battery\") {\n    const battery = Number(state.state);\n    if (isNaN(battery)) {\n      return \"hass:battery-unknown\";\n    }\n    const batteryRound = Math.round(battery / 10) * 10;\n    if (batteryRound >= 100) {\n      return \"hass:battery\";\n    }\n    if (batteryRound <= 0) {\n      return \"hass:battery-alert\";\n    }\n    // Will return one of the following icons: (listed so extractor picks up)\n    // hass:battery-10\n    // hass:battery-20\n    // hass:battery-30\n    // hass:battery-40\n    // hass:battery-50\n    // hass:battery-60\n    // hass:battery-70\n    // hass:battery-80\n    // hass:battery-90\n    // We obscure 'hass' in iconname so this name does not get picked up\n    return `${\"hass\"}:battery-${batteryRound}`;\n  }\n\n  const unit = state.attributes.unit_of_measurement;\n  if (unit === UNIT_C || unit === UNIT_F) {\n    return \"hass:thermometer\";\n  }\n  return domainIcon(\"sensor\");\n}\n","/** Return an icon representing a state. */\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { DEFAULT_DOMAIN_ICON } from \"../const\";\n\nimport computeDomain from \"./compute_domain\";\nimport domainIcon from \"./domain_icon\";\n\nimport binarySensorIcon from \"./binary_sensor_icon\";\nimport coverIcon from \"./cover_icon\";\nimport sensorIcon from \"./sensor_icon\";\nimport inputDateTimeIcon from \"./input_dateteime_icon\";\n\nconst domainIcons = {\n  binary_sensor: binarySensorIcon,\n  cover: coverIcon,\n  sensor: sensorIcon,\n  input_datetime: inputDateTimeIcon,\n};\n\nexport default function stateIcon(state: HassEntity) {\n  if (!state) {\n    return DEFAULT_DOMAIN_ICON;\n  }\n  if (state.attributes.icon) {\n    return state.attributes.icon;\n  }\n\n  const domain = computeDomain(state.entity_id);\n\n  if (domain in domainIcons) {\n    return domainIcons[domain](state);\n  }\n  return domainIcon(domain, state.state);\n}\n","import { HassEntity } from \"home-assistant-js-websocket\";\n\n/** Return an icon representing a binary sensor state. */\n\nexport default function binarySensorIcon(state: HassEntity) {\n  const activated = state.state && state.state === \"off\";\n  switch (state.attributes.device_class) {\n    case \"battery\":\n      return activated ? \"hass:battery\" : \"hass:battery-outline\";\n    case \"cold\":\n      return activated ? \"hass:thermometer\" : \"hass:snowflake\";\n    case \"connectivity\":\n      return activated ? \"hass:server-network-off\" : \"hass:server-network\";\n    case \"door\":\n      return activated ? \"hass:door-closed\" : \"hass:door-open\";\n    case \"garage_door\":\n      return activated ? \"hass:garage\" : \"hass:garage-open\";\n    case \"gas\":\n    case \"power\":\n    case \"problem\":\n    case \"safety\":\n    case \"smoke\":\n      return activated ? \"hass:shield-check\" : \"hass:alert\";\n    case \"heat\":\n      return activated ? \"hass:thermometer\" : \"hass:fire\";\n    case \"light\":\n      return activated ? \"hass:brightness-5\" : \"hass:brightness-7\";\n    case \"lock\":\n      return activated ? \"hass:lock\" : \"hass:lock-open\";\n    case \"moisture\":\n      return activated ? \"hass:water-off\" : \"hass:water\";\n    case \"motion\":\n      return activated ? \"hass:walk\" : \"hass:run\";\n    case \"occupancy\":\n      return activated ? \"hass:home-outline\" : \"hass:home\";\n    case \"opening\":\n      return activated ? \"hass:square\" : \"hass:square-outline\";\n    case \"plug\":\n      return activated ? \"hass:power-plug-off\" : \"hass:power-plug\";\n    case \"presence\":\n      return activated ? \"hass:home-outline\" : \"hass:home\";\n    case \"sound\":\n      return activated ? \"hass:music-note-off\" : \"hass:music-note\";\n    case \"vibration\":\n      return activated ? \"hass:crop-portrait\" : \"hass:vibrate\";\n    case \"window\":\n      return activated ? \"hass:window-closed\" : \"hass:window-open\";\n    default:\n      return activated ? \"hass:radiobox-blank\" : \"hass:checkbox-marked-circle\";\n  }\n}\n","/** Return an icon representing a cover state. */\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport domainIcon from \"./domain_icon\";\n\nexport default function coverIcon(state: HassEntity): string {\n  const open = state.state !== \"closed\";\n  switch (state.attributes.device_class) {\n    case \"garage\":\n      return open ? \"hass:garage-open\" : \"hass:garage\";\n    default:\n      return domainIcon(\"cover\", state.state);\n  }\n}\n","/** Return an icon representing an input datetime state. */\nimport domainIcon from \"./domain_icon\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\n\nexport default function inputDateTimeIcon(state: HassEntity): string {\n  if (!state.attributes.has_date) {\n    return \"hass:clock\";\n  }\n  if (!state.attributes.has_time) {\n    return \"hass:calendar\";\n  }\n  return domainIcon(\"input_datetime\");\n}\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button\";\n\nimport { STATES_OFF } from \"../../common/const\";\nimport computeStateDomain from \"../../common/entity/compute_state_domain\";\nimport {\n  LitElement,\n  TemplateResult,\n  html,\n  CSSResult,\n  css,\n  property,\n  PropertyValues,\n} from \"lit-element\";\nimport { HomeAssistant } from \"../../types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { forwardHaptic } from \"../../data/haptics\";\nimport computeStateName from \"../../common/entity/compute_state_name\";\n\nconst isOn = (stateObj?: HassEntity) =>\n  stateObj !== undefined && !STATES_OFF.includes(stateObj.state);\n\nclass HaEntityToggle extends LitElement {\n  // hass is not a property so that we only re-render on stateObj changes\n  public hass?: HomeAssistant;\n  @property() public stateObj?: HassEntity;\n  @property() private _isOn: boolean = false;\n\n  protected render(): TemplateResult | void {\n    if (!this.stateObj) {\n      return html`\n        <paper-toggle-button disabled></paper-toggle-button>\n      `;\n    }\n\n    if (this.stateObj.attributes.assumed_state) {\n      return html`\n        <paper-icon-button\n          aria-label=${`Turn ${computeStateName(this.stateObj)} off`}\n          icon=\"hass:flash-off\"\n          @click=${this._turnOff}\n          ?state-active=${!this._isOn}\n        ></paper-icon-button>\n        <paper-icon-button\n          aria-label=${`Turn ${computeStateName(this.stateObj)} on`}\n          icon=\"hass:flash\"\n          @click=${this._turnOn}\n          ?state-active=${this._isOn}\n        ></paper-icon-button>\n      `;\n    }\n\n    return html`\n      <paper-toggle-button\n        aria-label=${`Toggle ${computeStateName(this.stateObj)} ${\n          this._isOn ? \"off\" : \"on\"\n        }`}\n        .checked=${this._isOn}\n        @change=${this._toggleChanged}\n      ></paper-toggle-button>\n    `;\n  }\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    this.addEventListener(\"click\", (ev) => ev.stopPropagation());\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    if (changedProps.has(\"stateObj\")) {\n      this._isOn = isOn(this.stateObj);\n    }\n  }\n\n  private _toggleChanged(ev) {\n    const newVal = ev.target.checked;\n\n    if (newVal !== this._isOn) {\n      this._callService(newVal);\n    }\n  }\n\n  private _turnOn() {\n    this._callService(true);\n  }\n\n  private _turnOff() {\n    this._callService(false);\n  }\n\n  // We will force a re-render after a successful call to re-sync the toggle\n  // with the state. It will be out of sync if our service call did not\n  // result in the entity to be turned on. Since the state is not changing,\n  // the resync is not called automatic.\n  private async _callService(turnOn): Promise<void> {\n    if (!this.hass || !this.stateObj) {\n      return;\n    }\n    forwardHaptic(\"light\");\n    const stateDomain = computeStateDomain(this.stateObj);\n    let serviceDomain;\n    let service;\n\n    if (stateDomain === \"lock\") {\n      serviceDomain = \"lock\";\n      service = turnOn ? \"unlock\" : \"lock\";\n    } else if (stateDomain === \"cover\") {\n      serviceDomain = \"cover\";\n      service = turnOn ? \"open_cover\" : \"close_cover\";\n    } else if (stateDomain === \"group\") {\n      serviceDomain = \"homeassistant\";\n      service = turnOn ? \"turn_on\" : \"turn_off\";\n    } else {\n      serviceDomain = stateDomain;\n      service = turnOn ? \"turn_on\" : \"turn_off\";\n    }\n\n    const currentState = this.stateObj;\n\n    // Optimistic update.\n    this._isOn = turnOn;\n\n    await this.hass.callService(serviceDomain, service, {\n      entity_id: this.stateObj.entity_id,\n    });\n\n    setTimeout(async () => {\n      // If after 2 seconds we have not received a state update\n      // reset the switch to it's original state.\n      if (this.stateObj === currentState) {\n        this._isOn = isOn(this.stateObj);\n      }\n    }, 2000);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        white-space: nowrap;\n        min-width: 38px;\n      }\n      paper-icon-button {\n        color: var(\n          --paper-icon-button-inactive-color,\n          var(--primary-text-color)\n        );\n        transition: color 0.5s;\n      }\n      paper-icon-button[state-active] {\n        color: var(--paper-icon-button-active-color, var(--primary-color));\n      }\n      paper-toggle-button {\n        cursor: pointer;\n        --paper-toggle-button-label-spacing: 0;\n        padding: 13px 5px;\n        margin: -4px -5px;\n      }\n    `;\n  }\n}\n\ncustomElements.define(\"ha-entity-toggle\", HaEntityToggle);\n","import fecha from \"fecha\";\n\n// Check for support of native locale string options\nfunction toLocaleTimeStringSupportsOptions() {\n  try {\n    new Date().toLocaleTimeString(\"i\");\n  } catch (e) {\n    return e.name === \"RangeError\";\n  }\n  return false;\n}\n\nexport default (toLocaleTimeStringSupportsOptions()\n  ? (dateObj: Date, locales: string) =>\n      dateObj.toLocaleTimeString(locales, {\n        hour: \"numeric\",\n        minute: \"2-digit\",\n      })\n  : (dateObj: Date) => fecha.format(dateObj, \"shortTime\"));\n","import {\n  LovelaceConfig,\n  LovelaceCardConfig,\n  LovelaceViewConfig,\n} from \"../../../data/lovelace\";\n\nexport const addCard = (\n  config: LovelaceConfig,\n  path: [number],\n  cardConfig: LovelaceCardConfig\n): LovelaceConfig => {\n  const [viewIndex] = path;\n  const views: LovelaceViewConfig[] = [];\n\n  config.views.forEach((viewConf, index) => {\n    if (index !== viewIndex) {\n      views.push(config.views[index]);\n      return;\n    }\n\n    const cards = viewConf.cards\n      ? [...viewConf.cards, cardConfig]\n      : [cardConfig];\n\n    views.push({\n      ...viewConf,\n      cards,\n    });\n  });\n\n  return {\n    ...config,\n    views,\n  };\n};\n\nexport const replaceCard = (\n  config: LovelaceConfig,\n  path: [number, number],\n  cardConfig: LovelaceCardConfig\n): LovelaceConfig => {\n  const [viewIndex, cardIndex] = path;\n  const views: LovelaceViewConfig[] = [];\n\n  config.views.forEach((viewConf, index) => {\n    if (index !== viewIndex) {\n      views.push(config.views[index]);\n      return;\n    }\n\n    views.push({\n      ...viewConf,\n      cards: (viewConf.cards || []).map((origConf, ind) =>\n        ind === cardIndex ? cardConfig : origConf\n      ),\n    });\n  });\n\n  return {\n    ...config,\n    views,\n  };\n};\n\nexport const deleteCard = (\n  config: LovelaceConfig,\n  path: [number, number]\n): LovelaceConfig => {\n  const [viewIndex, cardIndex] = path;\n  const views: LovelaceViewConfig[] = [];\n\n  config.views.forEach((viewConf, index) => {\n    if (index !== viewIndex) {\n      views.push(config.views[index]);\n      return;\n    }\n\n    views.push({\n      ...viewConf,\n      cards: (viewConf.cards || []).filter(\n        (_origConf, ind) => ind !== cardIndex\n      ),\n    });\n  });\n\n  return {\n    ...config,\n    views,\n  };\n};\n\nexport const swapCard = (\n  config: LovelaceConfig,\n  path1: [number, number],\n  path2: [number, number]\n): LovelaceConfig => {\n  const card1 = config.views[path1[0]].cards![path1[1]];\n  const card2 = config.views[path2[0]].cards![path2[1]];\n\n  const origView1 = config.views[path1[0]];\n  const newView1 = {\n    ...origView1,\n    cards: origView1.cards!.map((origCard, index) =>\n      index === path1[1] ? card2 : origCard\n    ),\n  };\n\n  const origView2 = path1[0] === path2[0] ? newView1 : config.views[path2[0]];\n  const newView2 = {\n    ...origView2,\n    cards: origView2.cards!.map((origCard, index) =>\n      index === path2[1] ? card1 : origCard\n    ),\n  };\n\n  return {\n    ...config,\n    views: config.views.map((origView, index) =>\n      index === path2[0] ? newView2 : index === path1[0] ? newView1 : origView\n    ),\n  };\n};\n\nexport const moveCard = (\n  config: LovelaceConfig,\n  fromPath: [number, number],\n  toPath: [number]\n): LovelaceConfig => {\n  if (fromPath[0] === toPath[0]) {\n    throw new Error(\"You can not move a card to the view it is in.\");\n  }\n  const fromView = config.views[fromPath[0]];\n  const card = fromView.cards![fromPath[1]];\n\n  const newView1 = {\n    ...fromView,\n    cards: (fromView.cards || []).filter(\n      (_origConf, ind) => ind !== fromPath[1]\n    ),\n  };\n\n  const toView = config.views[toPath[0]];\n  const cards = toView.cards ? [...toView.cards, card] : [card];\n\n  const newView2 = {\n    ...toView,\n    cards,\n  };\n\n  return {\n    ...config,\n    views: config.views.map((origView, index) =>\n      index === toPath[0]\n        ? newView2\n        : index === fromPath[0]\n        ? newView1\n        : origView\n    ),\n  };\n};\n\nexport const addView = (\n  config: LovelaceConfig,\n  viewConfig: LovelaceViewConfig\n): LovelaceConfig => ({\n  ...config,\n  views: config.views.concat(viewConfig),\n});\n\nexport const replaceView = (\n  config: LovelaceConfig,\n  viewIndex: number,\n  viewConfig: LovelaceViewConfig\n): LovelaceConfig => ({\n  ...config,\n  views: config.views.map((origView, index) =>\n    index === viewIndex ? viewConfig : origView\n  ),\n});\n\nexport const swapView = (\n  config: LovelaceConfig,\n  path1: number,\n  path2: number\n): LovelaceConfig => {\n  const view1 = config.views[path1];\n  const view2 = config.views[path2];\n\n  return {\n    ...config,\n    views: config.views.map((origView, index) =>\n      index === path2 ? view1 : index === path1 ? view2 : origView\n    ),\n  };\n};\n\nexport const deleteView = (\n  config: LovelaceConfig,\n  viewIndex: number\n): LovelaceConfig => ({\n  ...config,\n  views: config.views.filter((_origView, index) => index !== viewIndex),\n});\n","import { LocalizeFunc } from \"../translations/localize\";\n\n/**\n * Calculate a string representing a date object as relative time from now.\n *\n * Example output: 5 minutes ago, in 3 days.\n */\nconst tests = [60, 60, 24, 7];\nconst langKey = [\"second\", \"minute\", \"hour\", \"day\"];\n\nexport default function relativeTime(\n  dateObj: Date,\n  localize: LocalizeFunc,\n  options: {\n    compareTime?: Date;\n    includeTense?: boolean;\n  } = {}\n): string {\n  const compareTime = options.compareTime || new Date();\n  let delta = (compareTime.getTime() - dateObj.getTime()) / 1000;\n  const tense = delta >= 0 ? \"past\" : \"future\";\n  delta = Math.abs(delta);\n\n  let timeDesc;\n\n  for (let i = 0; i < tests.length; i++) {\n    if (delta < tests[i]) {\n      delta = Math.floor(delta);\n      timeDesc = localize(\n        `ui.components.relative_time.duration.${langKey[i]}`,\n        \"count\",\n        delta\n      );\n      break;\n    }\n\n    delta /= tests[i];\n  }\n\n  if (timeDesc === undefined) {\n    delta = Math.floor(delta);\n    timeDesc = localize(\n      \"ui.components.relative_time.duration.week\",\n      \"count\",\n      delta\n    );\n  }\n\n  return options.includeTense === false\n    ? timeDesc\n    : localize(`ui.components.relative_time.${tense}`, \"time\", timeDesc);\n}\n","// Parse array of entity objects from config\nimport isValidEntityId from \"../../../common/entity/valid_entity_id\";\nimport { EntityConfig } from \"../entity-rows/types\";\n\nexport const processConfigEntities = <T extends EntityConfig>(\n  entities: Array<T | string>\n): T[] => {\n  if (!entities || !Array.isArray(entities)) {\n    throw new Error(\"Entities need to be an array\");\n  }\n\n  return entities.map(\n    (entityConf, index): T => {\n      if (\n        typeof entityConf === \"object\" &&\n        !Array.isArray(entityConf) &&\n        entityConf.type\n      ) {\n        return entityConf;\n      }\n\n      let config: T;\n\n      if (typeof entityConf === \"string\") {\n        // tslint:disable-next-line:no-object-literal-type-assertion\n        config = { entity: entityConf } as T;\n      } else if (typeof entityConf === \"object\" && !Array.isArray(entityConf)) {\n        if (!entityConf.entity) {\n          throw new Error(\n            `Entity object at position ${index} is missing entity field.`\n          );\n        }\n        config = entityConf as T;\n      } else {\n        throw new Error(`Invalid entity specified at position ${index}.`);\n      }\n\n      if (!isValidEntityId(config.entity)) {\n        throw new Error(\n          `Invalid entity ID at position ${index}: ${config.entity}`\n        );\n      }\n\n      return config;\n    }\n  );\n};\n","import computeStateName from \"../common/entity/compute_state_name\";\nimport computeStateDomain from \"../common/entity/compute_state_domain\";\nimport computeStateDisplay from \"../common/entity/compute_state_display\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { HomeAssistant } from \"../types\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\n\nconst DOMAINS_USE_LAST_UPDATED = [\"climate\", \"water_heater\"];\nconst LINE_ATTRIBUTES_TO_KEEP = [\n  \"temperature\",\n  \"current_temperature\",\n  \"target_temp_low\",\n  \"target_temp_high\",\n];\n\nexport interface LineChartState {\n  state: string;\n  last_changed: string;\n  attributes?: { [key: string]: any };\n}\n\nexport interface LineChartEntity {\n  domain: string;\n  name: string;\n  entity_id: string;\n  states: LineChartState[];\n}\n\nexport interface LineChartUnit {\n  unit: string;\n  identifier: string;\n  data: LineChartEntity[];\n}\n\nexport interface TimelineState {\n  state_localize: string;\n  state: string;\n  last_changed: string;\n}\n\nexport interface TimelineEntity {\n  name: string;\n  entity_id: string;\n  data: TimelineState[];\n}\n\nexport interface HistoryResult {\n  line: LineChartUnit[];\n  timeline: TimelineEntity[];\n}\n\nexport const fetchRecent = (\n  hass,\n  entityId,\n  startTime,\n  endTime,\n  skipInitialState = false\n): Promise<HassEntity[][]> => {\n  let url = \"history/period\";\n  if (startTime) {\n    url += \"/\" + startTime.toISOString();\n  }\n  url += \"?filter_entity_id=\" + entityId;\n  if (endTime) {\n    url += \"&end_time=\" + endTime.toISOString();\n  }\n  if (skipInitialState) {\n    url += \"&skip_initial_state\";\n  }\n\n  return hass.callApi(\"GET\", url);\n};\n\nexport const fetchDate = (\n  hass: HomeAssistant,\n  startTime: Date,\n  endTime: Date\n): Promise<HassEntity[][]> => {\n  return hass.callApi(\n    \"GET\",\n    `history/period/${startTime.toISOString()}?end_time=${endTime.toISOString()}`\n  );\n};\n\nconst equalState = (obj1: LineChartState, obj2: LineChartState) =>\n  obj1.state === obj2.state &&\n  // They either both have an attributes object or not\n  (!obj1.attributes ||\n    LINE_ATTRIBUTES_TO_KEEP.every(\n      (attr) => obj1.attributes![attr] === obj2.attributes![attr]\n    ));\n\nconst processTimelineEntity = (\n  localize: LocalizeFunc,\n  language: string,\n  states: HassEntity[]\n): TimelineEntity => {\n  const data: TimelineState[] = [];\n\n  for (const state of states) {\n    if (data.length > 0 && state.state === data[data.length - 1].state) {\n      continue;\n    }\n\n    data.push({\n      state_localize: computeStateDisplay(localize, state, language),\n      state: state.state,\n      last_changed: state.last_changed,\n    });\n  }\n\n  return {\n    name: computeStateName(states[0]),\n    entity_id: states[0].entity_id,\n    data,\n  };\n};\n\nconst processLineChartEntities = (\n  unit,\n  entities: HassEntity[][]\n): LineChartUnit => {\n  const data: LineChartEntity[] = [];\n\n  for (const states of entities) {\n    const last: HassEntity = states[states.length - 1];\n    const domain = computeStateDomain(last);\n    const processedStates: LineChartState[] = [];\n\n    for (const state of states) {\n      let processedState: LineChartState;\n\n      if (DOMAINS_USE_LAST_UPDATED.includes(domain)) {\n        processedState = {\n          state: state.state,\n          last_changed: state.last_updated,\n          attributes: {},\n        };\n\n        for (const attr of LINE_ATTRIBUTES_TO_KEEP) {\n          if (attr in state.attributes) {\n            processedState.attributes![attr] = state.attributes[attr];\n          }\n        }\n      } else {\n        processedState = state;\n      }\n\n      if (\n        processedStates.length > 1 &&\n        equalState(\n          processedState,\n          processedStates[processedStates.length - 1]\n        ) &&\n        equalState(processedState, processedStates[processedStates.length - 2])\n      ) {\n        continue;\n      }\n\n      processedStates.push(processedState);\n    }\n\n    data.push({\n      domain,\n      name: computeStateName(last),\n      entity_id: last.entity_id,\n      states: processedStates,\n    });\n  }\n\n  return {\n    unit,\n    identifier: entities.map((states) => states[0].entity_id).join(\"\"),\n    data,\n  };\n};\n\nexport const computeHistory = (\n  hass: HomeAssistant,\n  stateHistory: HassEntity[][],\n  localize: LocalizeFunc,\n  language: string\n): HistoryResult => {\n  const lineChartDevices: { [unit: string]: HassEntity[][] } = {};\n  const timelineDevices: TimelineEntity[] = [];\n  if (!stateHistory) {\n    return { line: [], timeline: [] };\n  }\n\n  stateHistory.forEach((stateInfo) => {\n    if (stateInfo.length === 0) {\n      return;\n    }\n\n    const stateWithUnit = stateInfo.find(\n      (state) => \"unit_of_measurement\" in state.attributes\n    );\n\n    let unit: string | undefined;\n\n    if (stateWithUnit) {\n      unit = stateWithUnit.attributes.unit_of_measurement;\n    } else if (computeStateDomain(stateInfo[0]) === \"climate\") {\n      unit = hass.config.unit_system.temperature;\n    } else if (computeStateDomain(stateInfo[0]) === \"water_heater\") {\n      unit = hass.config.unit_system.temperature;\n    }\n\n    if (!unit) {\n      timelineDevices.push(\n        processTimelineEntity(localize, language, stateInfo)\n      );\n    } else if (unit in lineChartDevices) {\n      lineChartDevices[unit].push(stateInfo);\n    } else {\n      lineChartDevices[unit] = [stateInfo];\n    }\n  });\n\n  const unitStates = Object.keys(lineChartDevices).map((unit) =>\n    processLineChartEntities(unit, lineChartDevices[unit])\n  );\n\n  return { line: unitStates, timeline: timelineDevices };\n};\n","import { HomeAssistant } from \"../../types\";\n\n/** Return if a component is loaded. */\nexport default function isComponentLoaded(\n  hass: HomeAssistant,\n  component: string\n): boolean {\n  return hass && hass.config.components.indexOf(component) !== -1;\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\nimport { HomeAssistant } from \"../../../types\";\nimport { ErrorCardConfig } from \"./types\";\n\nexport const createErrorCardElement = (config) => {\n  const el = document.createElement(\"hui-error-card\");\n  el.setConfig(config);\n  return el;\n};\n\nexport const createErrorCardConfig = (error, origConfig) => ({\n  type: \"error\",\n  error,\n  origConfig,\n});\n\n@customElement(\"hui-error-card\")\nexport class HuiErrorCard extends LitElement implements LovelaceCard {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: ErrorCardConfig;\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: ErrorCardConfig): void {\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      ${this._config.error}\n      <pre>${this._toStr(this._config.origConfig)}</pre>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        background-color: #ef5350;\n        color: white;\n        padding: 8px;\n        font-weight: 500;\n      }\n    `;\n  }\n\n  private _toStr(config: LovelaceCardConfig): string {\n    return JSON.stringify(config, null, 2);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-error-card\": HuiErrorCard;\n  }\n}\n","export const compare = (a: string, b: string) => {\n  if (a < b) {\n    return -1;\n  }\n  if (a > b) {\n    return 1;\n  }\n\n  return 0;\n};\n\nexport const caseInsensitiveCompare = (a: string, b: string) =>\n  compare(a.toLowerCase(), b.toLowerCase());\n","/** Compute the object ID of a state. */\nexport default function computeObjectId(entityId: string): string {\n  return entityId.substr(entityId.indexOf(\".\") + 1);\n}\n","const leftPad = (num: number) => (num < 10 ? `0${num}` : num);\n\nexport default function secondsToDuration(d: number) {\n  const h = Math.floor(d / 3600);\n  const m = Math.floor((d % 3600) / 60);\n  const s = Math.floor((d % 3600) % 60);\n\n  if (h > 0) {\n    return `${h}:${leftPad(m)}:${leftPad(s)}`;\n  }\n  if (m > 0) {\n    return `${m}:${leftPad(s)}`;\n  }\n  if (s > 0) {\n    return \"\" + s;\n  }\n  return null;\n}\n","import { LovelaceCard } from \"../types\";\n\nexport const computeCardSize = (card: LovelaceCard): number => {\n  return typeof card.getCardSize === \"function\" ? card.getCardSize() : 1;\n};\n","import \"@polymer/iron-flex-layout/iron-flex-layout-classes\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport CoverEntity from \"../util/cover-model\";\n\nclass HaCoverTiltControls extends PolymerElement {\n  static get template() {\n    return html`\n      <style include=\"iron-flex\"></style>\n      <style>\n        :host {\n          white-space: nowrap;\n        }\n        [invisible] {\n          visibility: hidden !important;\n        }\n      </style>\n      <paper-icon-button\n        icon=\"hass:arrow-top-right\"\n        on-click=\"onOpenTiltTap\"\n        title=\"Open tilt\"\n        invisible$=\"[[!entityObj.supportsOpenTilt]]\"\n        disabled=\"[[computeOpenDisabled(stateObj, entityObj)]]\"\n      ></paper-icon-button>\n      <paper-icon-button\n        icon=\"hass:stop\"\n        on-click=\"onStopTiltTap\"\n        invisible$=\"[[!entityObj.supportsStopTilt]]\"\n        title=\"Stop tilt\"\n      ></paper-icon-button>\n      <paper-icon-button\n        icon=\"hass:arrow-bottom-left\"\n        on-click=\"onCloseTiltTap\"\n        title=\"Close tilt\"\n        invisible$=\"[[!entityObj.supportsCloseTilt]]\"\n        disabled=\"[[computeClosedDisabled(stateObj, entityObj)]]\"\n      ></paper-icon-button>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n      stateObj: {\n        type: Object,\n      },\n      entityObj: {\n        type: Object,\n        computed: \"computeEntityObj(hass, stateObj)\",\n      },\n    };\n  }\n\n  computeEntityObj(hass, stateObj) {\n    return new CoverEntity(hass, stateObj);\n  }\n\n  computeOpenDisabled(stateObj, entityObj) {\n    var assumedState = stateObj.attributes.assumed_state === true;\n    return entityObj.isFullyOpenTilt && !assumedState;\n  }\n\n  computeClosedDisabled(stateObj, entityObj) {\n    var assumedState = stateObj.attributes.assumed_state === true;\n    return entityObj.isFullyClosedTilt && !assumedState;\n  }\n\n  onOpenTiltTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.openCoverTilt();\n  }\n\n  onCloseTiltTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.closeCoverTilt();\n  }\n\n  onStopTiltTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.stopCoverTilt();\n  }\n}\n\ncustomElements.define(\"ha-cover-tilt-controls\", HaCoverTiltControls);\n","import fecha from \"fecha\";\n\n// Check for support of native locale string options\nfunction toLocaleDateStringSupportsOptions() {\n  try {\n    new Date().toLocaleDateString(\"i\");\n  } catch (e) {\n    return e.name === \"RangeError\";\n  }\n  return false;\n}\n\nexport default (toLocaleDateStringSupportsOptions()\n  ? (dateObj: Date, locales: string) =>\n      dateObj.toLocaleDateString(locales, {\n        year: \"numeric\",\n        month: \"long\",\n        day: \"numeric\",\n      })\n  : (dateObj: Date) => fecha.format(dateObj, \"mediumDate\"));\n","import { HomeAssistant } from \"../../types\";\n\ninterface ResultCache<T> {\n  [entityId: string]: Promise<T> | undefined;\n}\n\nexport const timeCachePromiseFunc = async <T>(\n  cacheKey: string,\n  cacheTime: number,\n  func: (\n    hass: HomeAssistant,\n    entityId: string,\n    ...args: unknown[]\n  ) => Promise<T>,\n  hass: HomeAssistant,\n  entityId: string,\n  ...args: unknown[]\n): Promise<T> => {\n  let cache: ResultCache<T> | undefined = (hass as any)[cacheKey];\n\n  if (!cache) {\n    cache = hass[cacheKey] = {};\n  }\n\n  const lastResult = cache[entityId];\n\n  if (lastResult) {\n    return lastResult;\n  }\n\n  const result = func(hass, entityId, ...args);\n  cache[entityId] = result;\n\n  result.then(\n    // When successful, set timer to clear cache\n    () =>\n      setTimeout(() => {\n        cache![entityId] = undefined;\n      }, cacheTime),\n    // On failure, clear cache right away\n    () => {\n      cache![entityId] = undefined;\n    }\n  );\n\n  return result;\n};\n","import { supportsFeature } from \"../common/entity/supports-feature\";\n\nexport default class MediaPlayerEntity {\n  constructor(hass, stateObj) {\n    this.hass = hass;\n    this.stateObj = stateObj;\n    this._attr = stateObj.attributes;\n    this._feat = this._attr.supported_features;\n  }\n\n  get isOff() {\n    return this.stateObj.state === \"off\";\n  }\n\n  get isIdle() {\n    return this.stateObj.state === \"idle\";\n  }\n\n  get isMuted() {\n    return this._attr.is_volume_muted;\n  }\n\n  get isPaused() {\n    return this.stateObj.state === \"paused\";\n  }\n\n  get isPlaying() {\n    return this.stateObj.state === \"playing\";\n  }\n\n  get isMusic() {\n    return this._attr.media_content_type === \"music\";\n  }\n\n  get isTVShow() {\n    return this._attr.media_content_type === \"tvshow\";\n  }\n\n  get hasMediaControl() {\n    return (\n      [\"playing\", \"paused\", \"unknown\", \"on\"].indexOf(this.stateObj.state) !== -1\n    );\n  }\n\n  get volumeSliderValue() {\n    return this._attr.volume_level * 100;\n  }\n\n  get showProgress() {\n    return (\n      (this.isPlaying || this.isPaused) &&\n      \"media_duration\" in this.stateObj.attributes &&\n      \"media_position\" in this.stateObj.attributes &&\n      \"media_position_updated_at\" in this.stateObj.attributes\n    );\n  }\n\n  get currentProgress() {\n    var progress = this._attr.media_position;\n    if (this.isPlaying) {\n      progress +=\n        (Date.now() -\n          new Date(this._attr.media_position_updated_at).getTime()) /\n        1000.0;\n    }\n    return progress;\n  }\n\n  get supportsPause() {\n    return supportsFeature(this.stateObj, 1);\n  }\n\n  get supportsVolumeSet() {\n    return supportsFeature(this.stateObj, 4);\n  }\n\n  get supportsVolumeMute() {\n    return supportsFeature(this.stateObj, 8);\n  }\n\n  get supportsPreviousTrack() {\n    return supportsFeature(this.stateObj, 16);\n  }\n\n  get supportsNextTrack() {\n    return supportsFeature(this.stateObj, 32);\n  }\n\n  get supportsTurnOn() {\n    return supportsFeature(this.stateObj, 128);\n  }\n\n  get supportsTurnOff() {\n    return supportsFeature(this.stateObj, 256);\n  }\n\n  get supportsPlayMedia() {\n    return supportsFeature(this.stateObj, 512);\n  }\n\n  get supportsVolumeButtons() {\n    return supportsFeature(this.stateObj, 1024);\n  }\n\n  get supportsSelectSource() {\n    return supportsFeature(this.stateObj, 2048);\n  }\n\n  get supportsSelectSoundMode() {\n    return supportsFeature(this.stateObj, 65536);\n  }\n\n  get supportsPlay() {\n    return supportsFeature(this.stateObj, 16384);\n  }\n\n  get primaryTitle() {\n    return this._attr.media_title;\n  }\n\n  get secondaryTitle() {\n    if (this.isMusic) {\n      return this._attr.media_artist;\n    }\n    if (this.isTVShow) {\n      var text = this._attr.media_series_title;\n\n      if (this._attr.media_season) {\n        text += \" S\" + this._attr.media_season;\n\n        if (this._attr.media_episode) {\n          text += \"E\" + this._attr.media_episode;\n        }\n      }\n\n      return text;\n    }\n    if (this._attr.app_name) {\n      return this._attr.app_name;\n    }\n    return \"\";\n  }\n\n  get source() {\n    return this._attr.source;\n  }\n\n  get sourceList() {\n    return this._attr.source_list;\n  }\n\n  get soundMode() {\n    return this._attr.sound_mode;\n  }\n\n  get soundModeList() {\n    return this._attr.sound_mode_list;\n  }\n\n  mediaPlayPause() {\n    this.callService(\"media_play_pause\");\n  }\n\n  nextTrack() {\n    this.callService(\"media_next_track\");\n  }\n\n  playbackControl() {\n    this.callService(\"media_play_pause\");\n  }\n\n  previousTrack() {\n    this.callService(\"media_previous_track\");\n  }\n\n  setVolume(volume) {\n    this.callService(\"volume_set\", { volume_level: volume });\n  }\n\n  togglePower() {\n    if (this.isOff) {\n      this.turnOn();\n    } else {\n      this.turnOff();\n    }\n  }\n\n  turnOff() {\n    this.callService(\"turn_off\");\n  }\n\n  turnOn() {\n    this.callService(\"turn_on\");\n  }\n\n  volumeDown() {\n    this.callService(\"volume_down\");\n  }\n\n  volumeMute(mute) {\n    if (!this.supportsVolumeMute) {\n      throw new Error(\"Muting volume not supported\");\n    }\n    this.callService(\"volume_mute\", { is_volume_muted: mute });\n  }\n\n  volumeUp() {\n    this.callService(\"volume_up\");\n  }\n\n  selectSource(source) {\n    this.callService(\"select_source\", { source });\n  }\n\n  selectSoundMode(soundMode) {\n    this.callService(\"select_sound_mode\", { sound_mode: soundMode });\n  }\n\n  // helper method\n\n  callService(service, data = {}) {\n    data.entity_id = this.stateObj.entity_id;\n    this.hass.callService(\"media_player\", service, data);\n  }\n}\n","import { HomeAssistant, CameraEntity } from \"../types\";\nimport { timeCachePromiseFunc } from \"../common/util/time-cache-function-promise\";\nimport { getSignedPath } from \"./auth\";\n\nexport const CAMERA_SUPPORT_ON_OFF = 1;\nexport const CAMERA_SUPPORT_STREAM = 2;\n\nexport interface CameraPreferences {\n  preload_stream: boolean;\n}\n\nexport interface CameraThumbnail {\n  content_type: string;\n  content: string;\n}\n\nexport interface Stream {\n  url: string;\n}\n\nexport const computeMJPEGStreamUrl = (entity: CameraEntity) =>\n  `/api/camera_proxy_stream/${entity.entity_id}?token=${\n    entity.attributes.access_token\n  }`;\n\nexport const fetchThumbnailUrlWithCache = (\n  hass: HomeAssistant,\n  entityId: string\n) =>\n  timeCachePromiseFunc(\n    \"_cameraTmbUrl\",\n    9000,\n    fetchThumbnailUrl,\n    hass,\n    entityId\n  );\n\nexport const fetchThumbnailUrl = (hass: HomeAssistant, entityId: string) =>\n  getSignedPath(hass, `/api/camera_proxy/${entityId}`).then(({ path }) => path);\n\nexport const fetchThumbnail = (hass: HomeAssistant, entityId: string) => {\n  // tslint:disable-next-line: no-console\n  console.warn(\"This method has been deprecated.\");\n  return hass.callWS<CameraThumbnail>({\n    type: \"camera_thumbnail\",\n    entity_id: entityId,\n  });\n};\n\nexport const fetchStreamUrl = (\n  hass: HomeAssistant,\n  entityId: string,\n  format?: \"hls\"\n) => {\n  const data = {\n    type: \"camera/stream\",\n    entity_id: entityId,\n  };\n  if (format) {\n    // @ts-ignore\n    data.format = format;\n  }\n  return hass.callWS<Stream>(data);\n};\n\nexport const fetchCameraPrefs = (hass: HomeAssistant, entityId: string) =>\n  hass.callWS<CameraPreferences>({\n    type: \"camera/get_prefs\",\n    entity_id: entityId,\n  });\n\nexport const updateCameraPrefs = (\n  hass: HomeAssistant,\n  entityId: string,\n  prefs: {\n    preload_stream?: boolean;\n  }\n) =>\n  hass.callWS<CameraPreferences>({\n    type: \"camera/update_prefs\",\n    entity_id: entityId,\n    ...prefs,\n  });\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { HomeAssistant } from \"../types\";\nimport { compare } from \"../common/string/compare\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport interface AreaRegistryEntry {\n  area_id: string;\n  name: string;\n}\n\nexport interface AreaRegistryEntryMutableParams {\n  name: string;\n}\n\nexport const createAreaRegistryEntry = (\n  hass: HomeAssistant,\n  values: AreaRegistryEntryMutableParams\n) =>\n  hass.callWS<AreaRegistryEntry>({\n    type: \"config/area_registry/create\",\n    ...values,\n  });\n\nexport const updateAreaRegistryEntry = (\n  hass: HomeAssistant,\n  areaId: string,\n  updates: Partial<AreaRegistryEntryMutableParams>\n) =>\n  hass.callWS<AreaRegistryEntry>({\n    type: \"config/area_registry/update\",\n    area_id: areaId,\n    ...updates,\n  });\n\nexport const deleteAreaRegistryEntry = (hass: HomeAssistant, areaId: string) =>\n  hass.callWS({\n    type: \"config/area_registry/delete\",\n    area_id: areaId,\n  });\n\nconst fetchAreaRegistry = (conn) =>\n  conn\n    .sendMessagePromise({\n      type: \"config/area_registry/list\",\n    })\n    .then((areas) => areas.sort((ent1, ent2) => compare(ent1.name, ent2.name)));\n\nconst subscribeAreaRegistryUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchAreaRegistry(conn).then((areas) => store.setState(areas, true)),\n      500,\n      true\n    ),\n    \"area_registry_updated\"\n  );\n\nexport const subscribeAreaRegistry = (\n  conn: Connection,\n  onChange: (areas: AreaRegistryEntry[]) => void\n) =>\n  createCollection<AreaRegistryEntry[]>(\n    \"_areaRegistry\",\n    fetchAreaRegistry,\n    subscribeAreaRegistryUpdates,\n    conn,\n    onChange\n  );\n","import { HomeAssistant } from \"../types\";\nimport { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport interface DeviceRegistryEntry {\n  id: string;\n  config_entries: string[];\n  connections: Array<[string, string]>;\n  manufacturer: string;\n  model?: string;\n  name?: string;\n  sw_version?: string;\n  via_device_id?: string;\n  area_id?: string;\n  name_by_user?: string;\n}\n\nexport interface DeviceRegistryEntryMutableParams {\n  area_id?: string | null;\n  name_by_user?: string | null;\n}\n\nexport const updateDeviceRegistryEntry = (\n  hass: HomeAssistant,\n  deviceId: string,\n  updates: Partial<DeviceRegistryEntryMutableParams>\n) =>\n  hass.callWS<DeviceRegistryEntry>({\n    type: \"config/device_registry/update\",\n    device_id: deviceId,\n    ...updates,\n  });\n\nconst fetchDeviceRegistry = (conn) =>\n  conn.sendMessagePromise({\n    type: \"config/device_registry/list\",\n  });\n\nconst subscribeDeviceRegistryUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchDeviceRegistry(conn).then((devices) =>\n          store.setState(devices, true)\n        ),\n      500,\n      true\n    ),\n    \"device_registry_updated\"\n  );\n\nexport const subscribeDeviceRegistry = (\n  conn: Connection,\n  onChange: (devices: DeviceRegistryEntry[]) => void\n) =>\n  createCollection<DeviceRegistryEntry[]>(\n    \"_dr\",\n    fetchDeviceRegistry,\n    subscribeDeviceRegistryUpdates,\n    conn,\n    onChange\n  );\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n  property,\n  customElement,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-label-badge\";\nimport \"../components/hui-warning\";\n\nimport { LovelaceCard } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport {\n  callAlarmAction,\n  FORMAT_NUMBER,\n} from \"../../../data/alarm_control_panel\";\nimport { AlarmPanelCardConfig } from \"./types\";\n\nconst ICONS = {\n  armed_away: \"hass:shield-lock\",\n  armed_custom_bypass: \"hass:security\",\n  armed_home: \"hass:shield-home\",\n  armed_night: \"hass:shield-home\",\n  disarmed: \"hass:shield-check\",\n  pending: \"hass:shield-outline\",\n  triggered: \"hass:bell-ring\",\n};\n\nconst BUTTONS = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"\", \"0\", \"clear\"];\n\n@customElement(\"hui-alarm-panel-card\")\nclass HuiAlarmPanelCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement() {\n    await import(/* webpackChunkName: \"hui-alarm-panel-card-editor\" */ \"../editor/config-elements/hui-alarm-panel-card-editor\");\n    return document.createElement(\"hui-alarm-panel-card-editor\");\n  }\n\n  public static getStubConfig() {\n    return { states: [\"arm_home\", \"arm_away\"] };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: AlarmPanelCardConfig;\n\n  @property() private _code?: string;\n\n  public getCardSize(): number {\n    if (!this._config || !this.hass) {\n      return 0;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    return !stateObj || stateObj.attributes.code_format !== FORMAT_NUMBER\n      ? 3\n      : 8;\n  }\n\n  public setConfig(config: AlarmPanelCardConfig): void {\n    if (\n      !config ||\n      !config.entity ||\n      config.entity.split(\".\")[0] !== \"alarm_control_panel\"\n    ) {\n      throw new Error(\"Invalid card configuration\");\n    }\n\n    const defaults = {\n      states: [\"arm_away\", \"arm_home\"],\n    };\n\n    this._config = { ...defaults, ...config };\n    this._code = \"\";\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\") || changedProps.has(\"_code\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (oldHass) {\n      return (\n        oldHass.states[this._config!.entity] !==\n        this.hass!.states[this._config!.entity]\n      );\n    }\n    return true;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.name || this._label(stateObj.state)}\">\n        <ha-label-badge\n          class=\"${classMap({ [stateObj.state]: true })}\"\n          .icon=\"${ICONS[stateObj.state] || \"hass:shield-outline\"}\"\n          .label=\"${this._stateIconLabel(stateObj.state)}\"\n        ></ha-label-badge>\n        <div id=\"armActions\" class=\"actions\">\n          ${(stateObj.state === \"disarmed\"\n            ? this._config.states!\n            : [\"disarm\"]\n          ).map((state) => {\n            return html`\n              <mwc-button\n                .action=\"${state}\"\n                @click=\"${this._handleActionClick}\"\n                outlined\n              >\n                ${this._label(state)}\n              </mwc-button>\n            `;\n          })}\n        </div>\n        ${!stateObj.attributes.code_format\n          ? html``\n          : html`\n              <paper-input\n                label=\"Alarm Code\"\n                type=\"password\"\n                .value=\"${this._code}\"\n              ></paper-input>\n            `}\n        ${stateObj.attributes.code_format !== FORMAT_NUMBER\n          ? html``\n          : html`\n              <div id=\"keypad\">\n                ${BUTTONS.map((value) => {\n                  return value === \"\"\n                    ? html`\n                        <mwc-button disabled></mwc-button>\n                      `\n                    : html`\n                        <mwc-button\n                          .value=\"${value}\"\n                          @click=\"${this._handlePadClick}\"\n                          dense\n                        >\n                          ${value === \"clear\"\n                            ? this._label(\"clear_code\")\n                            : value}\n                        </mwc-button>\n                      `;\n                })}\n              </div>\n            `}\n      </ha-card>\n    `;\n  }\n\n  private _stateIconLabel(state: string): string {\n    const stateLabel = state.split(\"_\").pop();\n    return stateLabel === \"disarmed\" ||\n      stateLabel === \"triggered\" ||\n      !stateLabel\n      ? \"\"\n      : stateLabel;\n  }\n\n  private _label(state: string): string {\n    return (\n      this.hass!.localize(`state.alarm_control_panel.${state}`) ||\n      this.hass!.localize(`ui.card.alarm_control_panel.${state}`)\n    );\n  }\n\n  private _handlePadClick(e: MouseEvent): void {\n    const val = (e.currentTarget! as any).value;\n    this._code = val === \"clear\" ? \"\" : this._code + val;\n  }\n\n  private _handleActionClick(e: MouseEvent): void {\n    callAlarmAction(\n      this.hass!,\n      this._config!.entity,\n      (e.currentTarget! as any).action,\n      this._code!\n    );\n    this._code = \"\";\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        padding-bottom: 16px;\n        position: relative;\n        --alarm-color-disarmed: var(--label-badge-green);\n        --alarm-color-pending: var(--label-badge-yellow);\n        --alarm-color-triggered: var(--label-badge-red);\n        --alarm-color-armed: var(--label-badge-red);\n        --alarm-color-autoarm: rgba(0, 153, 255, 0.1);\n        --alarm-state-color: var(--alarm-color-armed);\n        --base-unit: 15px;\n        font-size: calc(var(--base-unit));\n      }\n\n      ha-label-badge {\n        --ha-label-badge-color: var(--alarm-state-color);\n        --label-badge-text-color: var(--alarm-state-color);\n        --label-badge-background-color: var(--paper-card-background-color);\n        color: var(--alarm-state-color);\n        position: absolute;\n        right: 12px;\n        top: 12px;\n      }\n\n      .disarmed {\n        --alarm-state-color: var(--alarm-color-disarmed);\n      }\n\n      .triggered {\n        --alarm-state-color: var(--alarm-color-triggered);\n        animation: pulse 1s infinite;\n      }\n\n      .arming {\n        --alarm-state-color: var(--alarm-color-pending);\n        animation: pulse 1s infinite;\n      }\n\n      .pending {\n        --alarm-state-color: var(--alarm-color-pending);\n        animation: pulse 1s infinite;\n      }\n\n      @keyframes pulse {\n        0% {\n          --ha-label-badge-color: var(--alarm-state-color);\n        }\n        100% {\n          --ha-label-badge-color: rgba(255, 153, 0, 0.3);\n        }\n      }\n\n      paper-input {\n        margin: 0 auto 8px;\n        max-width: 150px;\n        font-size: calc(var(--base-unit));\n        text-align: center;\n      }\n\n      .state {\n        margin-left: 16px;\n        font-size: calc(var(--base-unit) * 0.9);\n        position: relative;\n        bottom: 16px;\n        color: var(--alarm-state-color);\n        animation: none;\n      }\n\n      #keypad {\n        display: flex;\n        justify-content: center;\n        flex-wrap: wrap;\n        margin: auto;\n        width: 300px;\n      }\n\n      #keypad mwc-button {\n        margin-bottom: 5%;\n        width: 30%;\n        padding: calc(var(--base-unit));\n        font-size: calc(var(--base-unit) * 1.1);\n        box-sizing: border-box;\n      }\n\n      .actions {\n        margin: 0 8px;\n        padding-top: 20px;\n        display: flex;\n        flex-wrap: wrap;\n        justify-content: center;\n        font-size: calc(var(--base-unit) * 1);\n      }\n\n      .actions mwc-button {\n        min-width: calc(var(--base-unit) * 9);\n        margin: 0 4px 4px;\n      }\n\n      mwc-button#disarm {\n        color: var(--google-red-500);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-alarm-panel-card\": HuiAlarmPanelCard;\n  }\n}\n","import { HomeAssistant } from \"../types\";\n\nexport const FORMAT_TEXT = \"text\";\nexport const FORMAT_NUMBER = \"number\";\n\nexport const callAlarmAction = (\n  hass: HomeAssistant,\n  entity: string,\n  action:\n    | \"arm_away\"\n    | \"arm_home\"\n    | \"arm_night\"\n    | \"arm_custom_bypass\"\n    | \"disarm\",\n  code: string\n) => {\n  hass!.callService(\"alarm_control_panel\", \"alarm_\" + action, {\n    entity_id: entity,\n    code,\n  });\n};\n","import { HomeAssistant } from \"../../../types\";\n\nexport interface Condition {\n  entity: string;\n  state?: string;\n  state_not?: string;\n}\n\nexport function checkConditionsMet(\n  conditions: Condition[],\n  hass: HomeAssistant\n): boolean {\n  return conditions.every((c) => {\n    const state = hass.states[c.entity]\n      ? hass!.states[c.entity].state\n      : \"unavailable\";\n\n    return c.state ? state === c.state : state !== c.state_not;\n  });\n}\n\nexport function validateConditionalConfig(conditions: Condition[]): boolean {\n  return conditions.every(\n    (c) => ((c.entity && (c.state || c.state_not)) as unknown) as boolean\n  );\n}\n","import { createCardElement } from \"../common/create-card-element\";\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport {\n  checkConditionsMet,\n  validateConditionalConfig,\n} from \"../../lovelace/common/validate-condition\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard } from \"../types\";\nimport { ConditionalCardConfig } from \"./types\";\n\nclass HuiConditionalCard extends HTMLElement implements LovelaceCard {\n  private _hass?: HomeAssistant;\n  private _config?: ConditionalCardConfig;\n  private _card?: LovelaceCard;\n\n  public setConfig(config) {\n    if (\n      !config.card ||\n      !config.conditions ||\n      !Array.isArray(config.conditions) ||\n      !validateConditionalConfig(config.conditions)\n    ) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    if (this._card && this._card.parentElement) {\n      this.removeChild(this._card);\n    }\n\n    this._config = config;\n    this._card = createCardElement(config.card);\n\n    this.update();\n  }\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n\n    this.update();\n  }\n\n  public getCardSize() {\n    return computeCardSize(this._card!);\n  }\n\n  private update() {\n    if (!this._card || !this._hass) {\n      return;\n    }\n\n    const visible =\n      this._config && checkConditionsMet(this._config.conditions, this._hass);\n\n    if (visible) {\n      this._card.hass = this._hass;\n      if (!this._card.parentElement) {\n        this.appendChild(this._card);\n      }\n    } else if (this._card.parentElement) {\n      this.removeChild(this._card);\n    }\n    // This will hide the complete card so it won't get styled by parent\n    this.style.setProperty(\"display\", visible ? \"\" : \"none\");\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-conditional-card\": HuiConditionalCard;\n  }\n}\n\ncustomElements.define(\"hui-conditional-card\", HuiConditionalCard);\n","import { directive, PropertyPart } from \"lit-html\";\n// See https://github.com/home-assistant/home-assistant-polymer/pull/2457\n// on how to undo mwc -> paper migration\n// import \"@material/mwc-ripple\";\nimport \"@polymer/paper-ripple\";\n\nconst isTouch =\n  \"ontouchstart\" in window ||\n  navigator.maxTouchPoints > 0 ||\n  navigator.msMaxTouchPoints > 0;\n\ninterface LongPress extends HTMLElement {\n  holdTime: number;\n  bind(element: Element): void;\n}\ninterface LongPressElement extends Element {\n  longPress?: boolean;\n}\n\nclass LongPress extends HTMLElement implements LongPress {\n  public holdTime: number;\n  protected ripple: any;\n  protected timer: number | undefined;\n  protected held: boolean;\n  protected cooldownStart: boolean;\n  protected cooldownEnd: boolean;\n\n  constructor() {\n    super();\n    this.holdTime = 500;\n    this.ripple = document.createElement(\"paper-ripple\");\n    this.timer = undefined;\n    this.held = false;\n    this.cooldownStart = false;\n    this.cooldownEnd = false;\n  }\n\n  public connectedCallback() {\n    Object.assign(this.style, {\n      borderRadius: \"50%\", // paper-ripple\n      position: \"absolute\",\n      width: isTouch ? \"100px\" : \"50px\",\n      height: isTouch ? \"100px\" : \"50px\",\n      transform: \"translate(-50%, -50%)\",\n      pointerEvents: \"none\",\n    });\n\n    this.appendChild(this.ripple);\n    this.ripple.style.color = \"#03a9f4\"; // paper-ripple\n    this.ripple.style.color = \"var(--primary-color)\"; // paper-ripple\n    // this.ripple.primary = true;\n\n    [\n      \"touchcancel\",\n      \"mouseout\",\n      \"mouseup\",\n      \"touchmove\",\n      \"mousewheel\",\n      \"wheel\",\n      \"scroll\",\n    ].forEach((ev) => {\n      document.addEventListener(\n        ev,\n        () => {\n          clearTimeout(this.timer);\n          this.stopAnimation();\n          this.timer = undefined;\n        },\n        { passive: true }\n      );\n    });\n  }\n\n  public bind(element: LongPressElement) {\n    if (element.longPress) {\n      return;\n    }\n    element.longPress = true;\n\n    element.addEventListener(\"contextmenu\", (ev: Event) => {\n      const e = ev || window.event;\n      if (e.preventDefault) {\n        e.preventDefault();\n      }\n      if (e.stopPropagation) {\n        e.stopPropagation();\n      }\n      e.cancelBubble = true;\n      e.returnValue = false;\n      return false;\n    });\n\n    const clickStart = (ev: Event) => {\n      if (this.cooldownStart) {\n        return;\n      }\n      this.held = false;\n      let x;\n      let y;\n      if ((ev as TouchEvent).touches) {\n        x = (ev as TouchEvent).touches[0].pageX;\n        y = (ev as TouchEvent).touches[0].pageY;\n      } else {\n        x = (ev as MouseEvent).pageX;\n        y = (ev as MouseEvent).pageY;\n      }\n      this.timer = window.setTimeout(() => {\n        this.startAnimation(x, y);\n        this.held = true;\n      }, this.holdTime);\n\n      this.cooldownStart = true;\n      window.setTimeout(() => (this.cooldownStart = false), 100);\n    };\n\n    const clickEnd = (ev: Event) => {\n      if (\n        this.cooldownEnd ||\n        ([\"touchend\", \"touchcancel\"].includes(ev.type) &&\n          this.timer === undefined)\n      ) {\n        return;\n      }\n      clearTimeout(this.timer);\n      this.stopAnimation();\n      this.timer = undefined;\n      if (this.held) {\n        element.dispatchEvent(new Event(\"ha-hold\"));\n      } else {\n        element.dispatchEvent(new Event(\"ha-click\"));\n      }\n      this.cooldownEnd = true;\n      window.setTimeout(() => (this.cooldownEnd = false), 100);\n    };\n\n    element.addEventListener(\"touchstart\", clickStart, { passive: true });\n    element.addEventListener(\"touchend\", clickEnd);\n    element.addEventListener(\"touchcancel\", clickEnd);\n    element.addEventListener(\"mousedown\", clickStart, { passive: true });\n    element.addEventListener(\"click\", clickEnd);\n  }\n\n  private startAnimation(x: number, y: number) {\n    Object.assign(this.style, {\n      left: `${x}px`,\n      top: `${y}px`,\n      display: null,\n    });\n    this.ripple.holdDown = true; // paper-ripple\n    this.ripple.simulatedRipple(); // paper-ripple\n    // this.ripple.disabled = false;\n    // this.ripple.active = true;\n    // this.ripple.unbounded = true;\n  }\n\n  private stopAnimation() {\n    this.ripple.holdDown = false; // paper-ripple\n    // this.ripple.active = false;\n    // this.ripple.disabled = true;\n    this.style.display = \"none\";\n  }\n}\n\ncustomElements.define(\"long-press\", LongPress);\n\nconst getLongPress = (): LongPress => {\n  const body = document.body;\n  if (body.querySelector(\"long-press\")) {\n    return body.querySelector(\"long-press\") as LongPress;\n  }\n\n  const longpress = document.createElement(\"long-press\");\n  body.appendChild(longpress);\n\n  return longpress as LongPress;\n};\n\nexport const longPressBind = (element: LongPressElement) => {\n  const longpress: LongPress = getLongPress();\n  if (!longpress) {\n    return;\n  }\n  longpress.bind(element);\n};\n\nexport const longPress = directive(() => (part: PropertyPart) => {\n  longPressBind(part.committer.element);\n});\n","import computeDomain from \"../../../../common/entity/compute_domain\";\nimport { HomeAssistant } from \"../../../../types\";\n\nexport const turnOnOffEntity = (\n  hass: HomeAssistant,\n  entityId: string,\n  turnOn = true\n): Promise<void> => {\n  const stateDomain = computeDomain(entityId);\n  const serviceDomain = stateDomain === \"group\" ? \"homeassistant\" : stateDomain;\n\n  let service;\n  switch (stateDomain) {\n    case \"lock\":\n      service = turnOn ? \"unlock\" : \"lock\";\n      break;\n    case \"cover\":\n      service = turnOn ? \"open_cover\" : \"close_cover\";\n      break;\n    default:\n      service = turnOn ? \"turn_on\" : \"turn_off\";\n  }\n\n  return hass.callService(serviceDomain, service, { entity_id: entityId });\n};\n","import { STATES_OFF } from \"../../../../common/const\";\nimport { turnOnOffEntity } from \"./turn-on-off-entity\";\nimport { HomeAssistant } from \"../../../../types\";\nexport const toggleEntity = (\n  hass: HomeAssistant,\n  entityId: string\n): Promise<void> => {\n  const turnOn = STATES_OFF.includes(hass.states[entityId].state);\n  return turnOnOffEntity(hass, entityId, turnOn);\n};\n","import { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { navigate } from \"../../../common/navigate\";\nimport { toggleEntity } from \"../../../../src/panels/lovelace/common/entity/toggle-entity\";\nimport { ActionConfig } from \"../../../data/lovelace\";\n\nexport const handleClick = (\n  node: HTMLElement,\n  hass: HomeAssistant,\n  config: {\n    entity?: string;\n    camera_image?: string;\n    hold_action?: ActionConfig;\n    tap_action?: ActionConfig;\n  },\n  hold: boolean\n): void => {\n  let actionConfig: ActionConfig | undefined;\n\n  if (hold && config.hold_action) {\n    actionConfig = config.hold_action;\n  } else if (!hold && config.tap_action) {\n    actionConfig = config.tap_action;\n  }\n\n  if (!actionConfig) {\n    actionConfig = {\n      action: \"more-info\",\n    };\n  }\n\n  switch (actionConfig.action) {\n    case \"more-info\":\n      if (config.entity || config.camera_image) {\n        fireEvent(node, \"hass-more-info\", {\n          entityId: config.entity ? config.entity : config.camera_image!,\n        });\n      }\n      break;\n    case \"navigate\":\n      if (actionConfig.navigation_path) {\n        navigate(node, actionConfig.navigation_path);\n      }\n      break;\n    case \"toggle\":\n      if (config.entity) {\n        toggleEntity(hass, config.entity!);\n      }\n      break;\n    case \"call-service\": {\n      if (!actionConfig.service) {\n        return;\n      }\n      const [domain, service] = actionConfig.service.split(\".\", 2);\n      hass.callService(domain, service, actionConfig.service_data);\n    }\n  }\n};\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n  customElement,\n  property,\n} from \"lit-element\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport \"@material/mwc-ripple\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-warning\";\n\nimport isValidEntityId from \"../../../common/entity/valid_entity_id\";\nimport stateIcon from \"../../../common/entity/state_icon\";\nimport computeStateDomain from \"../../../common/entity/compute_state_domain\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nimport { HomeAssistant, LightEntity } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { handleClick } from \"../common/handle-click\";\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { EntityButtonCardConfig } from \"./types\";\n\n@customElement(\"hui-entity-button-card\")\nclass HuiEntityButtonCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-entity-button-card-editor\" */ \"../editor/config-elements/hui-entity-button-card-editor\");\n    return document.createElement(\"hui-entity-button-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {\n      tap_action: { action: \"toggle\" },\n      hold_action: { action: \"more-info\" },\n      show_icon: true,\n      show_name: true,\n    };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityButtonCardConfig;\n\n  public getCardSize(): number {\n    return 2;\n  }\n\n  public setConfig(config: EntityButtonCardConfig): void {\n    if (!isValidEntityId(config.entity)) {\n      throw new Error(\"Invalid Entity\");\n    }\n\n    this._config = {\n      theme: \"default\",\n      hold_action: { action: \"more-info\" },\n      show_icon: true,\n      show_name: true,\n      ...config,\n    };\n\n    if (DOMAINS_TOGGLE.has(computeDomain(config.entity))) {\n      this._config = {\n        tap_action: {\n          action: \"toggle\",\n        },\n        ...this._config,\n      };\n    } else {\n      this._config = {\n        tap_action: {\n          action: \"more-info\",\n        },\n        ...this._config,\n      };\n    }\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (oldHass) {\n      return (\n        oldHass.states[this._config!.entity] !==\n        this.hass!.states[this._config!.entity]\n      );\n    }\n    return true;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      >\n        ${this._config.show_icon\n          ? html`\n              <ha-icon\n                data-domain=\"${computeStateDomain(stateObj)}\"\n                data-state=\"${stateObj.state}\"\n                .icon=\"${this._config.icon || stateIcon(stateObj)}\"\n                style=\"${styleMap({\n                  filter: this._computeBrightness(stateObj),\n                  color: this._computeColor(stateObj),\n                  height: this._config.icon_height\n                    ? this._config.icon_height\n                    : \"auto\",\n                })}\"\n              ></ha-icon>\n            `\n          : \"\"}\n        ${this._config.show_name\n          ? html`\n              <span>\n                ${this._config.name || computeStateName(stateObj)}\n              </span>\n            `\n          : \"\"}\n        <mwc-ripple></mwc-ripple>\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        cursor: pointer;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        text-align: center;\n        padding: 4% 0;\n        font-size: 1.2rem;\n      }\n\n      ha-icon {\n        width: 40%;\n        height: auto;\n        color: var(--paper-item-icon-color, #44739e);\n      }\n\n      ha-icon[data-domain=\"light\"][data-state=\"on\"],\n      ha-icon[data-domain=\"switch\"][data-state=\"on\"],\n      ha-icon[data-domain=\"binary_sensor\"][data-state=\"on\"],\n      ha-icon[data-domain=\"fan\"][data-state=\"on\"],\n      ha-icon[data-domain=\"sun\"][data-state=\"above_horizon\"] {\n        color: var(--paper-item-icon-active-color, #fdd835);\n      }\n\n      ha-icon[data-state=\"unavailable\"] {\n        color: var(--state-icon-unavailable-color);\n      }\n    `;\n  }\n\n  private _computeBrightness(stateObj: HassEntity | LightEntity): string {\n    if (!stateObj.attributes.brightness) {\n      return \"\";\n    }\n    const brightness = stateObj.attributes.brightness;\n    return `brightness(${(brightness + 245) / 5}%)`;\n  }\n\n  private _computeColor(stateObj: HassEntity | LightEntity): string {\n    if (!stateObj.attributes.hs_color) {\n      return \"\";\n    }\n    const [hue, sat] = stateObj.attributes.hs_color;\n    if (sat <= 10) {\n      return \"\";\n    }\n    return `hsl(${hue}, 100%, ${100 - sat / 2}%)`;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entity-button-card\": HuiEntityButtonCard;\n  }\n}\n","import { createCardElement } from \"../common/create-card-element\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\nimport { EntityConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityFilterCardConfig } from \"./types\";\n\nclass EntityFilterCard extends HTMLElement implements LovelaceCard {\n  public isPanel?: boolean;\n  private _element?: LovelaceCard;\n  private _config?: EntityFilterCardConfig;\n  private _configEntities?: EntityConfig[];\n  private _baseCardConfig?: LovelaceCardConfig;\n\n  public getCardSize(): number {\n    return this._element ? this._element.getCardSize() : 1;\n  }\n\n  public setConfig(config: EntityFilterCardConfig): void {\n    if (!config.state_filter || !Array.isArray(config.state_filter)) {\n      throw new Error(\"Incorrect filter config.\");\n    }\n\n    this._config = config;\n    this._configEntities = undefined;\n    this._baseCardConfig = {\n      type: \"entities\",\n      entities: [],\n      ...this._config.card,\n    };\n\n    if (this.lastChild) {\n      this.removeChild(this.lastChild);\n      this._element = undefined;\n    }\n  }\n\n  set hass(hass: HomeAssistant) {\n    if (!hass || !this._config) {\n      return;\n    }\n\n    if (!this._configEntities) {\n      this._configEntities = processConfigEntities(this._config.entities);\n    }\n\n    const entitiesList = this._configEntities.filter((entityConf) => {\n      const stateObj = hass.states[entityConf.entity];\n      return stateObj && this._config!.state_filter.includes(stateObj.state);\n    });\n\n    if (entitiesList.length === 0 && this._config.show_empty === false) {\n      this.style.display = \"none\";\n      return;\n    }\n\n    const element = this._cardElement();\n\n    if (!element) {\n      return;\n    }\n\n    if (element.tagName !== \"HUI-ERROR-CARD\") {\n      element.setConfig({ ...this._baseCardConfig!, entities: entitiesList });\n      element.isPanel = this.isPanel;\n      element.hass = hass;\n    }\n\n    // Attach element if it has never been attached.\n    if (!this.lastChild) {\n      this.appendChild(element);\n    }\n\n    this.style.display = \"block\";\n  }\n\n  private _cardElement(): LovelaceCard | undefined {\n    if (!this._element && this._config) {\n      const element = createCardElement(this._baseCardConfig!);\n      this._element = element;\n    }\n\n    return this._element;\n  }\n}\ncustomElements.define(\"hui-entity-filter-card\", EntityFilterCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResult,\n  css,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport \"../../../components/ha-icon\";\n\n@customElement(\"hui-warning-element\")\nexport class HuiWarningElement extends LitElement {\n  @property() public label?: string;\n\n  protected render(): TemplateResult | void {\n    return html`\n      <ha-icon icon=\"hass:alert\" .title=\"${this.label}\"></ha-icon>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-icon {\n        color: #fce588;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-warning-element\": HuiWarningElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\n\nimport \"../../../components/entity/state-badge\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning-element\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { handleClick } from \"../common/handle-click\";\nimport { GlanceCardConfig, ConfigEntity } from \"./types\";\n\n@customElement(\"hui-glance-card\")\nexport class HuiGlanceCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-glance-card-editor\" */ \"../editor/config-elements/hui-glance-card-editor\");\n    return document.createElement(\"hui-glance-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { entities: [] };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: GlanceCardConfig;\n\n  private _configEntities?: ConfigEntity[];\n\n  public getCardSize(): number {\n    return (\n      (this._config!.title ? 1 : 0) +\n      Math.ceil(this._configEntities!.length / 5)\n    );\n  }\n\n  public setConfig(config: GlanceCardConfig): void {\n    this._config = { theme: \"default\", ...config };\n    const entities = processConfigEntities<ConfigEntity>(config.entities);\n\n    for (const entity of entities) {\n      if (\n        (entity.tap_action &&\n          entity.tap_action.action === \"call-service\" &&\n          !entity.tap_action.service) ||\n        (entity.hold_action &&\n          entity.hold_action.action === \"call-service\" &&\n          !entity.hold_action.service)\n      ) {\n        throw new Error(\n          'Missing required property \"service\" when tap_action or hold_action is call-service'\n        );\n      }\n    }\n\n    const columns = config.columns || Math.min(config.entities.length, 5);\n    this.style.setProperty(\"--glance-column-width\", `${100 / columns}%`);\n\n    this._configEntities = entities;\n\n    if (this.hass) {\n      this.requestUpdate();\n    }\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (oldHass && this._configEntities) {\n      for (const entity of this._configEntities) {\n        if (\n          oldHass.states[entity.entity] !== this.hass!.states[entity.entity]\n        ) {\n          return true;\n        }\n      }\n      return false;\n    }\n    return true;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const { title } = this._config;\n\n    return html`\n      <ha-card .header=\"${title}\">\n        <div class=\"${classMap({ entities: true, \"no-header\": !title })}\">\n          ${this._configEntities!.map((entityConf) =>\n            this.renderEntity(entityConf)\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProperties.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .entities {\n        display: flex;\n        padding: 0 16px 4px;\n        flex-wrap: wrap;\n      }\n      .entities.no-header {\n        padding-top: 16px;\n      }\n      .entity {\n        box-sizing: border-box;\n        padding: 0 4px;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        cursor: pointer;\n        margin-bottom: 12px;\n        width: var(--glance-column-width, 20%);\n      }\n      .entity div {\n        width: 100%;\n        text-align: center;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .name {\n        min-height: var(--paper-font-body1_-_line-height, 20px);\n      }\n      state-badge {\n        margin: 8px 0;\n      }\n    `;\n  }\n\n  private renderEntity(entityConf): TemplateResult {\n    const stateObj = this.hass!.states[entityConf.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass!.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            entityConf.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <div\n        class=\"entity\"\n        .entityConf=\"${entityConf}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      >\n        ${this._config!.show_name !== false\n          ? html`\n              <div class=\"name\">\n                ${\"name\" in entityConf\n                  ? entityConf.name\n                  : computeStateName(stateObj)}\n              </div>\n            `\n          : \"\"}\n        ${this._config!.show_icon !== false\n          ? html`\n              <state-badge\n                .stateObj=\"${stateObj}\"\n                .overrideIcon=\"${entityConf.icon}\"\n              ></state-badge>\n            `\n          : \"\"}\n        ${this._config!.show_state !== false\n          ? html`\n              <div>\n                ${computeStateDisplay(\n                  this.hass!.localize,\n                  stateObj,\n                  this.hass!.language\n                )}\n              </div>\n            `\n          : \"\"}\n      </div>\n    `;\n  }\n\n  private _handleTap(ev: MouseEvent): void {\n    const config = (ev.currentTarget as any).entityConf as ConfigEntity;\n    handleClick(this, this.hass!, config, false);\n  }\n\n  private _handleHold(ev: MouseEvent): void {\n    const config = (ev.currentTarget as any).entityConf as ConfigEntity;\n    handleClick(this, this.hass!, config, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-glance-card\": HuiGlanceCard;\n  }\n}\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/state-history-charts\";\nimport \"../../../data/ha-state-history-data\";\n\nimport { processConfigEntities } from \"../common/process-config-entities\";\n\nclass HuiHistoryGraphCard extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        .content {\n          padding: 16px;\n        }\n        [header] .content {\n          padding-top: 0;\n        }\n      </style>\n\n      <ha-card header$=\"[[_config.title]]\">\n        <div class=\"content\">\n          <ha-state-history-data\n            hass=\"[[hass]]\"\n            filter-type=\"recent-entity\"\n            entity-id=\"[[_entities]]\"\n            data=\"{{_stateHistory}}\"\n            is-loading=\"{{_stateHistoryLoading}}\"\n            cache-config=\"[[_cacheConfig]]\"\n          ></ha-state-history-data>\n          <state-history-charts\n            hass=\"[[hass]]\"\n            history-data=\"[[_stateHistory]]\"\n            is-loading-data=\"[[_stateHistoryLoading]]\"\n            names=\"[[_names]]\"\n            up-to-now\n            no-single\n          ></state-history-charts>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      _config: Object,\n      _names: Object,\n      _entities: Array,\n\n      _stateHistory: Object,\n      _stateHistoryLoading: Boolean,\n      _cacheConfig: Object,\n    };\n  }\n\n  getCardSize() {\n    return 4;\n  }\n\n  setConfig(config) {\n    const entities = processConfigEntities(config.entities);\n\n    this._config = config;\n\n    const _entities = [];\n    const _names = {};\n    for (const entity of entities) {\n      _entities.push(entity.entity);\n      if (entity.name) {\n        _names[entity.entity] = entity.name;\n      }\n    }\n\n    this.setProperties({\n      _cacheConfig: {\n        cacheKey: _entities.sort().join(),\n        hoursToShow: config.hours_to_show || 24,\n        refresh: config.refresh_interval || 0,\n      },\n      _entities,\n      _names,\n    });\n  }\n}\n\ncustomElements.define(\"hui-history-graph-card\", HuiHistoryGraphCard);\n","import { html, LitElement, TemplateResult } from \"lit-element\";\n\nimport { createCardElement } from \"../common/create-card-element\";\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\nimport { HomeAssistant } from \"../../../types\";\nimport { StackCardConfig } from \"./types\";\n\nexport abstract class HuiStackCard extends LitElement implements LovelaceCard {\n  static get properties() {\n    return {\n      _config: {},\n    };\n  }\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n\n    if (!this._cards) {\n      return;\n    }\n\n    for (const element of this._cards) {\n      element.hass = this._hass;\n    }\n  }\n  protected _cards?: LovelaceCard[];\n  private _config?: StackCardConfig;\n  private _hass?: HomeAssistant;\n\n  public abstract getCardSize(): number;\n\n  public setConfig(config: StackCardConfig): void {\n    if (!config || !config.cards || !Array.isArray(config.cards)) {\n      throw new Error(\"Card config incorrect\");\n    }\n    this._config = config;\n    this._cards = config.cards.map((card) => {\n      const element = this._createCardElement(card) as LovelaceCard;\n      return element;\n    });\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      ${this.renderStyle()}\n      <div id=\"root\">${this._cards}</div>\n    `;\n  }\n\n  protected abstract renderStyle(): TemplateResult;\n\n  private _createCardElement(cardConfig: LovelaceCardConfig) {\n    const element = createCardElement(cardConfig) as LovelaceCard;\n    if (this._hass) {\n      element.hass = this._hass;\n    }\n    element.addEventListener(\n      \"ll-rebuild\",\n      (ev) => {\n        ev.stopPropagation();\n        this._rebuildCard(element, cardConfig);\n      },\n      { once: true }\n    );\n    return element;\n  }\n\n  private _rebuildCard(\n    cardElToReplace: LovelaceCard,\n    config: LovelaceCardConfig\n  ): void {\n    const newCardEl = this._createCardElement(config);\n    cardElToReplace.parentElement!.replaceChild(newCardEl, cardElToReplace);\n    this._cards = this._cards!.map((curCardEl) =>\n      curCardEl === cardElToReplace ? newCardEl : curCardEl\n    );\n  }\n}\n","import { html, TemplateResult } from \"lit-element\";\n\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport { HuiStackCard } from \"./hui-stack-card\";\n\nclass HuiHorizontalStackCard extends HuiStackCard {\n  public getCardSize(): number {\n    let totalSize = 0;\n\n    if (this._cards) {\n      for (const element of this._cards) {\n        const elementSize = computeCardSize(element);\n        totalSize = elementSize > totalSize ? elementSize : totalSize;\n      }\n    }\n\n    return totalSize;\n  }\n\n  protected renderStyle(): TemplateResult {\n    return html`\n      <style>\n        #root {\n          display: flex;\n        }\n        #root > * {\n          flex: 1 1 0;\n          margin: 0 4px;\n          min-width: 0;\n        }\n        #root > *:first-child {\n          margin-left: 0;\n        }\n        #root > *:last-child {\n          margin-right: 0;\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-horitzontal-stack-card\": HuiHorizontalStackCard;\n  }\n}\n\ncustomElements.define(\"hui-horizontal-stack-card\", HuiHorizontalStackCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../components/ha-card\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport { IframeCardConfig } from \"./types\";\n\n@customElement(\"hui-iframe-card\")\nexport class HuiIframeCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-iframe-card-editor\" */ \"../editor/config-elements/hui-iframe-card-editor\");\n    return document.createElement(\"hui-iframe-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return { url: \"https://www.home-assistant.io\", aspect_ratio: \"50%\" };\n  }\n\n  @property() protected _config?: IframeCardConfig;\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 3;\n    }\n    const aspectRatio = this._config.aspect_ratio\n      ? Number(this._config.aspect_ratio.replace(\"%\", \"\"))\n      : 50;\n    return 1 + aspectRatio / 25;\n  }\n\n  public setConfig(config: IframeCardConfig): void {\n    if (!config.url) {\n      throw new Error(\"URL required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    const aspectRatio = this._config.aspect_ratio || \"50%\";\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <div\n          id=\"root\"\n          style=\"${styleMap({\n            \"padding-top\": aspectRatio,\n          })}\"\n        >\n          <iframe src=\"${this._config.url}\"></iframe>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        overflow: hidden;\n      }\n\n      #root {\n        width: 100%;\n        position: relative;\n      }\n\n      iframe {\n        position: absolute;\n        border: none;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-iframe-card\": HuiIframeCard;\n  }\n}\n","import { TemplateResult } from \"lit-element\";\n\ntype LoadedRoundSlider = Promise<{\n  roundSliderStyle: TemplateResult;\n  jQuery: any;\n}>;\n\nlet loaded: LoadedRoundSlider;\n\nexport const loadRoundslider = async (): LoadedRoundSlider => {\n  if (!loaded) {\n    loaded = import(/* webpackChunkName: \"jquery-roundslider\" */ \"./jquery.roundslider\");\n  }\n  return loaded;\n};\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n\nimport stateIcon from \"../../../common/entity/state_icon\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport { HomeAssistant, LightEntity } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { loadRoundslider } from \"../../../resources/jquery.roundslider.ondemand\";\nimport { toggleEntity } from \"../common/entity/toggle-entity\";\nimport { LightCardConfig } from \"./types\";\n\nconst lightConfig = {\n  radius: 80,\n  step: 1,\n  circleShape: \"pie\",\n  startAngle: 315,\n  width: 5,\n  min: 1,\n  max: 100,\n  sliderType: \"min-range\",\n  lineCap: \"round\",\n  handleSize: \"+12\",\n  showTooltip: false,\n  animation: false,\n};\n\n@customElement(\"hui-light-card\")\nexport class HuiLightCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-light-card-editor\" */ \"../editor/config-elements/hui-light-card-editor\");\n    return document.createElement(\"hui-light-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: LightCardConfig;\n\n  @property() private _roundSliderStyle?: TemplateResult;\n\n  @property() private _jQuery?: any;\n\n  private _brightnessTimout?: number;\n\n  public getCardSize(): number {\n    return 2;\n  }\n\n  public setConfig(config: LightCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"light\") {\n      throw new Error(\"Specify an entity from within the light domain.\");\n    }\n\n    this._config = { theme: \"default\", ...config };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config!.entity] as LightEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      ${this.renderStyle()}\n      <ha-card>\n        <paper-icon-button\n          icon=\"hass:dots-vertical\"\n          class=\"more-info\"\n          @click=\"${this._handleMoreInfo}\"\n        ></paper-icon-button>\n        <div id=\"light\"></div>\n        <div id=\"tooltip\">\n          <div class=\"icon-state\">\n            <ha-icon\n              class=\"light-icon\"\n              data-state=\"${stateObj.state}\"\n              .icon=\"${stateIcon(stateObj)}\"\n              style=\"${styleMap({\n                filter: this._computeBrightness(stateObj),\n                color: this._computeColor(stateObj),\n              })}\"\n              @click=\"${this._handleTap}\"\n            ></ha-icon>\n            <div class=\"brightness\" @ha-click=\"${this._handleTap}\"></div>\n            <div class=\"name\">\n              ${this._config.name || computeStateName(stateObj)}\n            </div>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected async firstUpdated(): Promise<void> {\n    const loaded = await loadRoundslider();\n\n    this._roundSliderStyle = loaded.roundSliderStyle;\n    this._jQuery = loaded.jQuery;\n\n    const stateObj = this.hass!.states[this._config!.entity] as LightEntity;\n\n    if (!stateObj) {\n      // Card will require refresh to work again\n      return;\n    }\n\n    const brightness = stateObj.attributes.brightness || 0;\n\n    this._jQuery(\"#light\", this.shadowRoot).roundSlider({\n      ...lightConfig,\n      change: (value) => this._setBrightness(value),\n      drag: (value) => this._dragEvent(value),\n      start: () => this._showBrightness(),\n      stop: () => this._hideBrightness(),\n    });\n    this.shadowRoot!.querySelector(\".brightness\")!.innerHTML =\n      (Math.round((brightness / 254) * 100) || 0) + \"%\";\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass || !this._jQuery) {\n      return;\n    }\n\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (!stateObj) {\n      return;\n    }\n\n    const attrs = stateObj.attributes;\n\n    this._jQuery(\"#light\", this.shadowRoot).roundSlider({\n      value: Math.round((attrs.brightness / 254) * 100) || 0,\n    });\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  private renderStyle(): TemplateResult {\n    return html`\n      ${this._roundSliderStyle}\n      <style>\n        :host {\n          display: block;\n        }\n\n        ha-card {\n          position: relative;\n          overflow: hidden;\n          --brightness-font-color: white;\n          --brightness-font-text-shadow: -1px -1px 0 #000, 1px -1px 0 #000,\n            -1px 1px 0 #000, 1px 1px 0 #000;\n          --name-font-size: 1.2rem;\n          --brightness-font-size: 1.2rem;\n          --rail-border-color: transparent;\n        }\n\n        #tooltip {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 100%;\n          text-align: center;\n          z-index: 15;\n        }\n\n        .icon-state {\n          display: block;\n          margin: auto;\n          width: 100%;\n          height: 100%;\n          transform: translate(0, 25%);\n        }\n\n        #light {\n          margin: 0 auto;\n          padding-top: 16px;\n          padding-bottom: 16px;\n        }\n\n        #light .rs-bar.rs-transition.rs-first,\n        .rs-bar.rs-transition.rs-second {\n          z-index: 20 !important;\n        }\n\n        #light .rs-range-color {\n          background-color: var(--primary-color);\n        }\n\n        #light .rs-path-color {\n          background-color: var(--disabled-text-color);\n        }\n\n        #light .rs-handle {\n          background-color: var(--paper-card-background-color, white);\n          padding: 7px;\n          border: 2px solid var(--disabled-text-color);\n        }\n\n        #light .rs-handle.rs-focus {\n          border-color: var(--primary-color);\n        }\n\n        #light .rs-handle:after {\n          border-color: var(--primary-color);\n          background-color: var(--primary-color);\n        }\n\n        #light .rs-border {\n          border-color: var(--rail-border-color);\n        }\n\n        #light .rs-inner.rs-bg-color.rs-border,\n        #light .rs-overlay.rs-transition.rs-bg-color {\n          background-color: var(--paper-card-background-color, white);\n        }\n\n        .light-icon {\n          margin: auto;\n          width: 76px;\n          height: 76px;\n          color: var(--paper-item-icon-color, #44739e);\n          cursor: pointer;\n        }\n\n        .light-icon[data-state=\"on\"] {\n          color: var(--paper-item-icon-active-color, #fdd835);\n        }\n\n        .light-icon[data-state=\"unavailable\"] {\n          color: var(--state-icon-unavailable-color);\n        }\n\n        .name {\n          padding-top: 40px;\n          font-size: var(--name-font-size);\n        }\n\n        .brightness {\n          font-size: var(--brightness-font-size);\n          position: absolute;\n          margin: 0 auto;\n          left: 50%;\n          top: 10%;\n          transform: translate(-50%);\n          opacity: 0;\n          transition: opacity 0.5s ease-in-out;\n          -moz-transition: opacity 0.5s ease-in-out;\n          -webkit-transition: opacity 0.5s ease-in-out;\n          cursor: pointer;\n          color: var(--brightness-font-color);\n          text-shadow: var(--brightness-font-text-shadow);\n          pointer-events: none;\n        }\n\n        .show_brightness {\n          opacity: 1;\n        }\n\n        .more-info {\n          position: absolute;\n          cursor: pointer;\n          top: 0;\n          right: 0;\n          z-index: 25;\n          color: var(--secondary-text-color);\n        }\n      </style>\n    `;\n  }\n\n  private _dragEvent(e: any): void {\n    this.shadowRoot!.querySelector(\".brightness\")!.innerHTML = e.value + \"%\";\n  }\n\n  private _showBrightness(): void {\n    clearTimeout(this._brightnessTimout);\n    this.shadowRoot!.querySelector(\".brightness\")!.classList.add(\n      \"show_brightness\"\n    );\n  }\n\n  private _hideBrightness(): void {\n    this._brightnessTimout = window.setTimeout(() => {\n      this.shadowRoot!.querySelector(\".brightness\")!.classList.remove(\n        \"show_brightness\"\n      );\n    }, 500);\n  }\n\n  private _setBrightness(e: any): void {\n    this.hass!.callService(\"light\", \"turn_on\", {\n      entity_id: this._config!.entity,\n      brightness_pct: e.value,\n    });\n  }\n\n  private _computeBrightness(stateObj: LightEntity): string {\n    if (!stateObj.attributes.brightness) {\n      return \"\";\n    }\n    const brightness = stateObj.attributes.brightness;\n    return `brightness(${(brightness + 245) / 5}%)`;\n  }\n\n  private _computeColor(stateObj: LightEntity): string {\n    if (!stateObj.attributes.hs_color) {\n      return \"\";\n    }\n    const [hue, sat] = stateObj.attributes.hs_color;\n    if (sat <= 10) {\n      return \"\";\n    }\n    return `hsl(${hue}, 100%, ${100 - sat / 2}%)`;\n  }\n\n  private _handleTap() {\n    toggleEntity(this.hass!, this._config!.entity!);\n  }\n\n  private _handleMoreInfo() {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-light-card\": HuiLightCard;\n  }\n}\n","import \"@polymer/iron-image/iron-image\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport { EventsMixin } from \"../../mixins/events-mixin\";\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaEntityMarker extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style include=\"iron-positioning\"></style>\n      <style>\n        .marker {\n          vertical-align: top;\n          position: relative;\n          display: block;\n          margin: 0 auto;\n          width: 2.5em;\n          text-align: center;\n          height: 2.5em;\n          line-height: 2.5em;\n          font-size: 1.5em;\n          border-radius: 50%;\n          border: 0.1em solid\n            var(--ha-marker-color, var(--default-primary-color));\n          color: rgb(76, 76, 76);\n          background-color: white;\n        }\n        iron-image {\n          border-radius: 50%;\n        }\n      </style>\n\n      <div class=\"marker\">\n        <template is=\"dom-if\" if=\"[[entityName]]\"\n          >[[entityName]]</template\n        >\n        <template is=\"dom-if\" if=\"[[entityPicture]]\">\n          <iron-image\n            sizing=\"cover\"\n            class=\"fit\"\n            src=\"[[entityPicture]]\"\n          ></iron-image>\n        </template>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      entityId: {\n        type: String,\n        value: \"\",\n      },\n\n      entityName: {\n        type: String,\n        value: null,\n      },\n\n      entityPicture: {\n        type: String,\n        value: null,\n      },\n    };\n  }\n\n  ready() {\n    super.ready();\n    this.addEventListener(\"click\", (ev) => this.badgeTap(ev));\n  }\n\n  badgeTap(ev) {\n    ev.stopPropagation();\n    if (this.entityId) {\n      this.fire(\"hass-more-info\", { entityId: this.entityId });\n    }\n  }\n}\n\ncustomElements.define(\"ha-entity-marker\", HaEntityMarker);\n","// Handle 16x9, 16:9, 1.78x1, 1.78:1, 1.78\n// Ignore everything else\nconst parseOrThrow = (num) => {\n  const parsed = parseFloat(num);\n  if (isNaN(parsed)) {\n    throw new Error(`${num} is not a number`);\n  }\n  return parsed;\n};\n\nexport default function parseAspectRatio(input: string) {\n  if (!input) {\n    return null;\n  }\n  try {\n    if (input.endsWith(\"%\")) {\n      return { w: 100, h: parseOrThrow(input.substr(0, input.length - 1)) };\n    }\n\n    const arr = input.replace(\":\", \"x\").split(\"x\");\n    if (arr.length === 0) {\n      return null;\n    }\n\n    return arr.length === 1\n      ? { w: parseOrThrow(arr[0]), h: 1 }\n      : { w: parseOrThrow(arr[0]), h: parseOrThrow(arr[1]) };\n  } catch (err) {\n    // Ignore the error\n  }\n  return null;\n}\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport { Layer, Marker, Circle, Map } from \"leaflet\";\nimport {\n  LitElement,\n  TemplateResult,\n  css,\n  html,\n  property,\n  PropertyValues,\n  CSSResult,\n  customElement,\n} from \"lit-element\";\n\nimport \"../../map/ha-entity-marker\";\n\nimport {\n  setupLeafletMap,\n  LeafletModuleType,\n} from \"../../../common/dom/setup-leaflet-map\";\nimport computeStateDomain from \"../../../common/entity/compute_state_domain\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport { debounce } from \"../../../common/util/debounce\";\nimport parseAspectRatio from \"../../../common/util/parse-aspect-ratio\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard } from \"../types\";\nimport { EntityConfig } from \"../entity-rows/types\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { MapCardConfig } from \"./types\";\n\n@customElement(\"hui-map-card\")\nclass HuiMapCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement() {\n    await import(\n      /* webpackChunkName: \"hui-map-card-editor\" */ \"../editor/config-elements/hui-map-card-editor\"\n    );\n    return document.createElement(\"hui-map-card-editor\");\n  }\n\n  public static getStubConfig() {\n    return { entities: [] };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property({ type: Boolean, reflect: true })\n  public isPanel = false;\n\n  @property()\n  private _config?: MapCardConfig;\n  private _configEntities?: EntityConfig[];\n  // tslint:disable-next-line\n  private Leaflet?: LeafletModuleType;\n  private _leafletMap?: Map;\n  // @ts-ignore\n  private _resizeObserver?: ResizeObserver;\n  private _debouncedResizeListener = debounce(\n    () => {\n      if (!this._leafletMap) {\n        return;\n      }\n      this._leafletMap.invalidateSize();\n    },\n    100,\n    false\n  );\n  private _mapItems: Array<Marker | Circle> = [];\n  private _connected = false;\n\n  public setConfig(config: MapCardConfig): void {\n    if (!config) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    if (!config.entities && !config.geo_location_sources) {\n      throw new Error(\n        \"Either entities or geo_location_sources must be defined\"\n      );\n    }\n    if (config.entities && !Array.isArray(config.entities)) {\n      throw new Error(\"Entities need to be an array\");\n    }\n    if (\n      config.geo_location_sources &&\n      !Array.isArray(config.geo_location_sources)\n    ) {\n      throw new Error(\"Geo_location_sources needs to be an array\");\n    }\n\n    this._config = config;\n    this._configEntities = config.entities\n      ? processConfigEntities(config.entities)\n      : [];\n  }\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 3;\n    }\n    const ratio = parseAspectRatio(this._config.aspect_ratio);\n    const ar =\n      ratio && ratio.w > 0 && ratio.h > 0\n        ? `${((100 * ratio.h) / ratio.w).toFixed(2)}`\n        : \"100\";\n    return 1 + Math.floor(Number(ar) / 25) || 3;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._connected = true;\n    if (this.hasUpdated) {\n      this.loadMap();\n      this._attachObserver();\n    }\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._connected = false;\n\n    if (this._leafletMap) {\n      this._leafletMap.remove();\n      this._leafletMap = undefined;\n      this.Leaflet = undefined;\n    }\n\n    if (this._resizeObserver) {\n      this._resizeObserver.unobserve(this._mapEl);\n    } else {\n      window.removeEventListener(\"resize\", this._debouncedResizeListener);\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n    return html`\n      <ha-card id=\"card\" .header=${this._config.title}>\n        <div id=\"root\">\n          <div id=\"map\"></div>\n          <paper-icon-button\n            @click=${this._fitMap}\n            icon=\"hass:image-filter-center-focus\"\n            title=\"Reset focus\"\n          ></paper-icon-button>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues): void {\n    super.firstUpdated(changedProps);\n    this.loadMap();\n    const root = this.shadowRoot!.getElementById(\"root\");\n\n    if (!this._config || this.isPanel || !root) {\n      return;\n    }\n\n    if (this._connected) {\n      this._attachObserver();\n    }\n\n    const ratio = parseAspectRatio(this._config.aspect_ratio);\n\n    root.style.paddingBottom =\n      ratio && ratio.w > 0 && ratio.h > 0\n        ? `${((100 * ratio.h) / ratio.w).toFixed(2)}%`\n        : (root.style.paddingBottom = \"100%\");\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    if (changedProps.has(\"hass\")) {\n      this._drawEntities();\n    }\n  }\n\n  private get _mapEl(): HTMLDivElement {\n    return this.shadowRoot!.getElementById(\"map\") as HTMLDivElement;\n  }\n\n  private async loadMap(): Promise<void> {\n    [this._leafletMap, this.Leaflet] = await setupLeafletMap(\n      this._mapEl,\n      this._config !== undefined ? this._config.dark_mode === true : false\n    );\n    this._drawEntities();\n    this._leafletMap.invalidateSize();\n    this._fitMap();\n  }\n\n  private _fitMap(): void {\n    if (!this._leafletMap || !this.Leaflet || !this._config || !this.hass) {\n      return;\n    }\n    const zoom = this._config.default_zoom;\n    if (this._mapItems.length === 0) {\n      this._leafletMap.setView(\n        new this.Leaflet.LatLng(\n          this.hass.config.latitude,\n          this.hass.config.longitude\n        ),\n        zoom || 14\n      );\n      return;\n    }\n\n    const bounds = this.Leaflet.latLngBounds(\n      this._mapItems ? this._mapItems.map((item) => item.getLatLng()) : []\n    );\n    this._leafletMap.fitBounds(bounds.pad(0.5));\n\n    if (zoom && this._leafletMap.getZoom() > zoom) {\n      this._leafletMap.setZoom(zoom);\n    }\n  }\n\n  private _drawEntities(): void {\n    const hass = this.hass;\n    const map = this._leafletMap;\n    const config = this._config;\n    const Leaflet = this.Leaflet;\n    if (!hass || !map || !config || !Leaflet) {\n      return;\n    }\n\n    if (this._mapItems) {\n      this._mapItems.forEach((marker) => marker.remove());\n    }\n    const mapItems: Layer[] = (this._mapItems = []);\n\n    const allEntities = this._configEntities!.concat();\n\n    // Calculate visible geo location sources\n    if (config.geo_location_sources) {\n      const includesAll = config.geo_location_sources.includes(\"all\");\n      for (const entityId of Object.keys(hass.states)) {\n        const stateObj = hass.states[entityId];\n        if (\n          computeDomain(entityId) === \"geo_location\" &&\n          (includesAll ||\n            config.geo_location_sources.includes(stateObj.attributes.source))\n        ) {\n          allEntities.push({ entity: entityId });\n        }\n      }\n    }\n\n    for (const entity of allEntities) {\n      const entityId = entity.entity;\n      const stateObj = hass.states[entityId];\n      if (!stateObj) {\n        continue;\n      }\n      const title = computeStateName(stateObj);\n      const {\n        latitude,\n        longitude,\n        passive,\n        icon,\n        radius,\n        entity_picture: entityPicture,\n        gps_accuracy: gpsAccuracy,\n      } = stateObj.attributes;\n\n      if (!(latitude && longitude)) {\n        continue;\n      }\n\n      if (computeStateDomain(stateObj) === \"zone\") {\n        // DRAW ZONE\n        if (passive) {\n          continue;\n        }\n\n        // create marker with the icon\n        mapItems.push(\n          Leaflet.marker([latitude, longitude], {\n            icon: Leaflet.divIcon({\n              html: icon ? `<ha-icon icon=\"${icon}\"></ha-icon>` : title,\n              iconSize: [24, 24],\n              className: \"\",\n            }),\n            interactive: false,\n            title,\n          })\n        );\n\n        // create circle around it\n        mapItems.push(\n          Leaflet.circle([latitude, longitude], {\n            interactive: false,\n            color: \"#FF9800\",\n            radius,\n          })\n        );\n\n        continue;\n      }\n\n      // DRAW ENTITY\n      // create icon\n      const entityName = title\n        .split(\" \")\n        .map((part) => part[0])\n        .join(\"\")\n        .substr(0, 3);\n\n      // create market with the icon\n      mapItems.push(\n        Leaflet.marker([latitude, longitude], {\n          icon: Leaflet.divIcon({\n            // Leaflet clones this element before adding it to the map. This messes up\n            // our Polymer object and we can't pass data through. Thus we hack like this.\n            html: `\n              <ha-entity-marker\n                entity-id=\"${entityId}\"\n                entity-name=\"${entityName}\"\n                entity-picture=\"${entityPicture || \"\"}\"\n              ></ha-entity-marker>\n            `,\n            iconSize: [48, 48],\n            className: \"\",\n          }),\n          title: computeStateName(stateObj),\n        })\n      );\n\n      // create circle around if entity has accuracy\n      if (gpsAccuracy) {\n        mapItems.push(\n          Leaflet.circle([latitude, longitude], {\n            interactive: false,\n            color: \"#0288D1\",\n            radius: gpsAccuracy,\n          })\n        );\n      }\n    }\n\n    this._mapItems.forEach((marker) => map.addLayer(marker));\n  }\n\n  private _attachObserver(): void {\n    // Observe changes to map size and invalidate to prevent broken rendering\n    // Uses ResizeObserver in Chrome, otherwise window resize event\n\n    // @ts-ignore\n    if (typeof ResizeObserver === \"function\") {\n      // @ts-ignore\n      this._resizeObserver = new ResizeObserver(() =>\n        this._debouncedResizeListener()\n      );\n      this._resizeObserver.observe(this._mapEl);\n    } else {\n      window.addEventListener(\"resize\", this._debouncedResizeListener);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host([ispanel]) ha-card {\n        left: 0;\n        top: 0;\n        width: 100%;\n        /**\n       * In panel mode we want a full height map. Since parent #view\n       * only sets min-height, we need absolute positioning here\n       */\n        height: 100%;\n        position: absolute;\n      }\n\n      ha-card {\n        overflow: hidden;\n      }\n\n      #map {\n        z-index: 0;\n        border: none;\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n      }\n\n      paper-icon-button {\n        position: absolute;\n        top: 75px;\n        left: 7px;\n      }\n\n      #root {\n        position: relative;\n      }\n\n      :host([ispanel]) #root {\n        height: 100%;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-map-card\": HuiMapCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-markdown\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { MarkdownCardConfig } from \"./types\";\n\n@customElement(\"hui-markdown-card\")\nexport class HuiMarkdownCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-markdown-card-editor\" */ \"../editor/config-elements/hui-markdown-card-editor\");\n    return document.createElement(\"hui-markdown-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { content: \" \" };\n  }\n\n  @property() private _config?: MarkdownCardConfig;\n\n  public getCardSize(): number {\n    return this._config!.content.split(\"\\n\").length;\n  }\n\n  public setConfig(config: MarkdownCardConfig): void {\n    if (!config.content) {\n      throw new Error(\"Invalid Configuration: Content Required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <ha-markdown\n          class=\"markdown ${classMap({\n            \"no-header\": !this._config.title,\n          })}\"\n          .content=\"${this._config.content}\"\n        ></ha-markdown>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        /* start paper-font-body1 style */\n        font-family: \"Roboto\", \"Noto\", sans-serif;\n        -webkit-font-smoothing: antialiased; /* OS X subpixel AA bleed bug */\n        font-size: 14px;\n        font-weight: 400;\n        line-height: 20px;\n        /* end paper-font-body1 style */\n      }\n      ha-markdown {\n        display: block;\n        padding: 0 16px 16px;\n        -ms-user-select: initial;\n        -webkit-user-select: initial;\n        -moz-user-select: initial;\n      }\n      .markdown.no-header {\n        padding-top: 16px;\n      }\n      ha-markdown > *:first-child {\n        margin-top: 0;\n      }\n      ha-markdown > *:last-child {\n        margin-bottom: 0;\n      }\n      ha-markdown a {\n        color: var(--primary-color);\n      }\n      ha-markdown img {\n        max-width: 100%;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-markdown-card\": HuiMarkdownCard;\n  }\n}\n","import \"@polymer/iron-flex-layout/iron-flex-layout-classes\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@polymer/paper-progress/paper-progress\";\nimport \"@polymer/paper-styles/element-styles/paper-material-styles\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport HassMediaPlayerEntity from \"../util/hass-media-player-model\";\nimport { fetchMediaPlayerThumbnailWithCache } from \"../data/media-player\";\n\nimport computeStateName from \"../common/entity/compute_state_name\";\nimport { EventsMixin } from \"../mixins/events-mixin\";\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\n/*\n * @appliesMixin LocalizeMixin\n * @appliesMixin EventsMixin\n */\nclass HaMediaPlayerCard extends LocalizeMixin(EventsMixin(PolymerElement)) {\n  static get template() {\n    return html`\n      <style\n        include=\"paper-material-styles iron-flex iron-flex-alignment iron-positioning\"\n      >\n        :host {\n          @apply --paper-material-elevation-1;\n          display: block;\n          position: relative;\n          font-size: 0px;\n          border-radius: 2px;\n        }\n\n        .banner {\n          position: relative;\n          background-color: white;\n          border-top-left-radius: 2px;\n          border-top-right-radius: 2px;\n        }\n\n        .banner:before {\n          display: block;\n          content: \"\";\n          width: 100%;\n          /* removed .25% from 16:9 ratio to fix YT black bars */\n          padding-top: 56%;\n          transition: padding-top 0.8s;\n        }\n\n        .banner.no-cover {\n          background-position: center center;\n          background-image: url(/static/images/card_media_player_bg.png);\n          background-repeat: no-repeat;\n          background-color: var(--primary-color);\n        }\n\n        .banner.content-type-music:before {\n          padding-top: 100%;\n        }\n\n        .banner.content-type-game:before {\n          padding-top: 100%;\n        }\n\n        .banner.no-cover:before {\n          padding-top: 88px;\n        }\n\n        .banner > .cover {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n\n          border-top-left-radius: 2px;\n          border-top-right-radius: 2px;\n\n          background-position: center center;\n          background-size: cover;\n          transition: opacity 0.8s;\n          opacity: 1;\n        }\n\n        .banner.is-off > .cover {\n          opacity: 0;\n        }\n\n        .banner > .caption {\n          @apply --paper-font-caption;\n\n          position: absolute;\n          left: 0;\n          right: 0;\n          bottom: 0;\n\n          background-color: rgba(0, 0, 0, var(--dark-secondary-opacity));\n\n          padding: 8px 16px;\n\n          font-size: 14px;\n          font-weight: 500;\n          color: white;\n\n          transition: background-color 0.5s;\n        }\n\n        .banner.is-off > .caption {\n          background-color: initial;\n        }\n\n        .banner > .caption .title {\n          @apply --paper-font-common-nowrap;\n          font-size: 1.2em;\n          margin: 8px 0 4px;\n        }\n\n        .progress {\n          width: 100%;\n          height: var(--paper-progress-height, 4px);\n          margin-top: calc(-1 * var(--paper-progress-height, 4px));\n          --paper-progress-active-color: var(--accent-color);\n          --paper-progress-container-color: rgba(200, 200, 200, 0.5);\n        }\n\n        .controls {\n          position: relative;\n          @apply --paper-font-body1;\n          padding: 8px;\n          border-bottom-left-radius: 2px;\n          border-bottom-right-radius: 2px;\n          background-color: var(--paper-card-background-color, white);\n        }\n\n        .controls paper-icon-button {\n          width: 44px;\n          height: 44px;\n        }\n\n        .playback-controls {\n          direction: ltr;\n        }\n\n        paper-icon-button {\n          opacity: var(--dark-primary-opacity);\n        }\n\n        paper-icon-button[disabled] {\n          opacity: var(--dark-disabled-opacity);\n        }\n\n        paper-icon-button.primary {\n          width: 56px !important;\n          height: 56px !important;\n          background-color: var(--primary-color);\n          color: white;\n          border-radius: 50%;\n          padding: 8px;\n          transition: background-color 0.5s;\n        }\n\n        paper-icon-button.primary[disabled] {\n          background-color: rgba(0, 0, 0, var(--dark-disabled-opacity));\n        }\n\n        [invisible] {\n          visibility: hidden !important;\n        }\n      </style>\n\n      <div\n        class$=\"[[computeBannerClasses(playerObj, _coverShowing, _coverLoadError)]]\"\n      >\n        <div class=\"cover\" id=\"cover\"></div>\n\n        <div class=\"caption\">\n          [[_computeStateName(stateObj)]]\n          <div class=\"title\">[[computePrimaryText(localize, playerObj)]]</div>\n          [[playerObj.secondaryTitle]]<br />\n        </div>\n      </div>\n\n      <paper-progress\n        max=\"[[stateObj.attributes.media_duration]]\"\n        value=\"[[playbackPosition]]\"\n        hidden$=\"[[computeHideProgress(playerObj)]]\"\n        class=\"progress\"\n      ></paper-progress>\n\n      <div class=\"controls layout horizontal justified\">\n        <paper-icon-button\n          aria-label=\"Turn off\"\n          icon=\"hass:power\"\n          on-click=\"handleTogglePower\"\n          invisible$=\"[[computeHidePowerButton(playerObj)]]\"\n          class=\"self-center secondary\"\n        ></paper-icon-button>\n\n        <div class=\"playback-controls\">\n          <paper-icon-button\n            aria-label=\"Previous track\"\n            icon=\"hass:skip-previous\"\n            invisible$=\"[[!playerObj.supportsPreviousTrack]]\"\n            disabled=\"[[playerObj.isOff]]\"\n            on-click=\"handlePrevious\"\n          ></paper-icon-button>\n          <paper-icon-button\n            aria-label=\"Play or Pause\"\n            class=\"primary\"\n            icon=\"[[computePlaybackControlIcon(playerObj)]]\"\n            invisible$=\"[[!computePlaybackControlIcon(playerObj)]]\"\n            disabled=\"[[playerObj.isOff]]\"\n            on-click=\"handlePlaybackControl\"\n          ></paper-icon-button>\n          <paper-icon-button\n            aria-label=\"Next track\"\n            icon=\"hass:skip-next\"\n            invisible$=\"[[!playerObj.supportsNextTrack]]\"\n            disabled=\"[[playerObj.isOff]]\"\n            on-click=\"handleNext\"\n          ></paper-icon-button>\n        </div>\n\n        <paper-icon-button\n          aria-label=\"More information.\"\n          icon=\"hass:dots-vertical\"\n          on-click=\"handleOpenMoreInfo\"\n          class=\"self-center secondary\"\n        ></paper-icon-button>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      stateObj: Object,\n      playerObj: {\n        type: Object,\n        computed: \"computePlayerObj(hass, stateObj)\",\n        observer: \"playerObjChanged\",\n      },\n      playbackControlIcon: {\n        type: String,\n        computed: \"computePlaybackControlIcon(playerObj)\",\n      },\n      playbackPosition: Number,\n      _coverShowing: {\n        type: Boolean,\n        value: false,\n      },\n      _coverLoadError: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  async playerObjChanged(playerObj, oldPlayerObj) {\n    if (playerObj.isPlaying && playerObj.showProgress) {\n      if (!this._positionTracking) {\n        this._positionTracking = setInterval(\n          () => this.updatePlaybackPosition(),\n          1000\n        );\n      }\n    } else if (this._positionTracking) {\n      clearInterval(this._positionTracking);\n      this._positionTracking = null;\n    }\n    if (playerObj.showProgress) {\n      this.updatePlaybackPosition();\n    }\n\n    const picture = playerObj.stateObj.attributes.entity_picture;\n    const oldPicture =\n      oldPlayerObj && oldPlayerObj.stateObj.attributes.entity_picture;\n\n    if (picture !== oldPicture && !picture) {\n      this.$.cover.style.backgroundImage = \"\";\n      return;\n    }\n    if (picture === oldPicture) {\n      return;\n    }\n\n    // We have a new picture url\n    // If entity picture is non-relative, we use that url directly.\n    if (picture.substr(0, 1) !== \"/\") {\n      this._coverShowing = true;\n      this._coverLoadError = false;\n      this.$.cover.style.backgroundImage = `url(${picture})`;\n      return;\n    }\n\n    try {\n      const {\n        content_type: contentType,\n        content,\n      } = await fetchMediaPlayerThumbnailWithCache(\n        this.hass,\n        playerObj.stateObj.entity_id\n      );\n      this._coverShowing = true;\n      this._coverLoadError = false;\n      this.$.cover.style.backgroundImage = `url(data:${contentType};base64,${content})`;\n    } catch (err) {\n      this._coverShowing = false;\n      this._coverLoadError = true;\n      this.$.cover.style.backgroundImage = \"\";\n    }\n  }\n\n  updatePlaybackPosition() {\n    this.playbackPosition = this.playerObj.currentProgress;\n  }\n\n  computeBannerClasses(playerObj, coverShowing, coverLoadError) {\n    var cls = \"banner\";\n\n    if (playerObj.isOff || playerObj.isIdle) {\n      cls += \" is-off no-cover\";\n    } else if (\n      !playerObj.stateObj.attributes.entity_picture ||\n      coverLoadError ||\n      !coverShowing\n    ) {\n      cls += \" no-cover\";\n    } else if (playerObj.stateObj.attributes.media_content_type === \"music\") {\n      cls += \" content-type-music\";\n    } else if (playerObj.stateObj.attributes.media_content_type === \"game\") {\n      cls += \" content-type-game\";\n    }\n    return cls;\n  }\n\n  computeHideProgress(playerObj) {\n    return !playerObj.showProgress;\n  }\n\n  computeHidePowerButton(playerObj) {\n    return playerObj.isOff\n      ? !playerObj.supportsTurnOn\n      : !playerObj.supportsTurnOff;\n  }\n\n  computePlayerObj(hass, stateObj) {\n    return new HassMediaPlayerEntity(hass, stateObj);\n  }\n\n  computePrimaryText(localize, playerObj) {\n    return (\n      playerObj.primaryTitle ||\n      localize(`state.media_player.${playerObj.stateObj.state}`) ||\n      localize(`state.default.${playerObj.stateObj.state}`) ||\n      playerObj.stateObj.state\n    );\n  }\n\n  computePlaybackControlIcon(playerObj) {\n    if (playerObj.isPlaying) {\n      return playerObj.supportsPause ? \"hass:pause\" : \"hass:stop\";\n    }\n    if (playerObj.hasMediaControl || playerObj.isOff || playerObj.isIdle) {\n      if (\n        playerObj.hasMediaControl &&\n        playerObj.supportsPause &&\n        !playerObj.isPaused\n      ) {\n        return \"hass:play-pause\";\n      }\n      return playerObj.supportsPlay ? \"hass:play\" : null;\n    }\n    return \"\";\n  }\n\n  _computeStateName(stateObj) {\n    return computeStateName(stateObj);\n  }\n\n  handleNext(ev) {\n    ev.stopPropagation();\n    this.playerObj.nextTrack();\n  }\n\n  handleOpenMoreInfo(ev) {\n    ev.stopPropagation();\n    this.fire(\"hass-more-info\", { entityId: this.stateObj.entity_id });\n  }\n\n  handlePlaybackControl(ev) {\n    ev.stopPropagation();\n    this.playerObj.mediaPlayPause();\n  }\n\n  handlePrevious(ev) {\n    ev.stopPropagation();\n    this.playerObj.previousTrack();\n  }\n\n  handleTogglePower(ev) {\n    ev.stopPropagation();\n    this.playerObj.togglePower();\n  }\n}\ncustomElements.define(\"ha-media_player-card\", HaMediaPlayerCard);\n","import { createErrorCardConfig } from \"./hui-error-card\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nexport default class LegacyWrapperCard extends HTMLElement {\n  constructor(tag, domain) {\n    super();\n    this._tag = tag.toUpperCase();\n    this._domain = domain;\n    this._element = null;\n  }\n\n  getCardSize() {\n    return 3;\n  }\n\n  setConfig(config) {\n    if (!config.entity) {\n      throw new Error(\"No entity specified\");\n    }\n\n    if (computeDomain(config.entity) !== this._domain) {\n      throw new Error(\n        `Specified entity needs to be of domain ${this._domain}.`\n      );\n    }\n\n    this._config = config;\n  }\n\n  set hass(hass) {\n    const entityId = this._config.entity;\n\n    if (entityId in hass.states) {\n      this._ensureElement(this._tag);\n      this.lastChild.hass = hass;\n      this.lastChild.stateObj = hass.states[entityId];\n      this.lastChild.config = this._config;\n    } else {\n      this._ensureElement(\"HUI-ERROR-CARD\");\n      this.lastChild.setConfig(\n        createErrorCardConfig(\n          `No state available for ${entityId}`,\n          this._config\n        )\n      );\n    }\n  }\n\n  _ensureElement(tag) {\n    if (this.lastChild && this.lastChild.tagName === tag) return;\n\n    if (this.lastChild) {\n      this.removeChild(this.lastChild);\n    }\n\n    this.appendChild(document.createElement(tag));\n  }\n}\n","import \"../../../cards/ha-media_player-card\";\n\nimport LegacyWrapperCard from \"./hui-legacy-wrapper-card\";\n\nclass HuiMediaControlCard extends LegacyWrapperCard {\n  static async getConfigElement() {\n    await import(/* webpackChunkName: \"hui-media-control-card-editor\" */ \"../editor/config-elements/hui-media-control-card-editor\");\n    return document.createElement(\"hui-media-control-card-editor\");\n  }\n\n  static getStubConfig() {\n    return {};\n  }\n\n  constructor() {\n    super(\"ha-media_player-card\", \"media_player\");\n  }\n}\n\ncustomElements.define(\"hui-media-control-card\", HuiMediaControlCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../components/ha-card\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { PictureCardConfig } from \"./types\";\n\n@customElement(\"hui-picture-card\")\nexport class HuiPictureCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-picture-card-editor\" */ \"../editor/config-elements/hui-picture-card-editor\");\n    return document.createElement(\"hui-picture-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return {\n      image:\n        \"https://www.home-assistant.io/images/merchandise/shirt-frontpage.png\",\n      tap_action: { action: \"none\" },\n      hold_action: { action: \"none\" },\n    };\n  }\n\n  public hass?: HomeAssistant;\n\n  @property() protected _config?: PictureCardConfig;\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PictureCardConfig): void {\n    if (!config || !config.image) {\n      throw new Error(\"Invalid Configuration: 'image' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-card\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n        class=\"${classMap({\n          clickable: Boolean(\n            this._config.tap_action || this._config.hold_action\n          ),\n        })}\"\n      >\n        <img src=\"${this._config.image}\" />\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        overflow: hidden;\n      }\n\n      ha-card.clickable {\n        cursor: pointer;\n      }\n\n      img {\n        display: block;\n        width: 100%;\n      }\n    `;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-card\": HuiPictureCard;\n  }\n}\n","import {\n  checkConditionsMet,\n  validateConditionalConfig,\n} from \"../../lovelace/common/validate-condition\";\nimport { createStyledHuiElement } from \"../cards/picture-elements/create-styled-hui-element\";\nimport {\n  LovelaceElement,\n  LovelaceElementConfig,\n  ConditionalElementConfig,\n} from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\nclass HuiConditionalElement extends HTMLElement implements LovelaceElement {\n  public _hass?: HomeAssistant;\n  private _config?: ConditionalElementConfig;\n  private _elements: LovelaceElement[] = [];\n\n  public setConfig(config: ConditionalElementConfig): void {\n    if (\n      !config.conditions ||\n      !Array.isArray(config.conditions) ||\n      !config.elements ||\n      !Array.isArray(config.elements) ||\n      !validateConditionalConfig(config.conditions)\n    ) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    if (this._elements.length > 0) {\n      this._elements.map((el: LovelaceElement) => {\n        if (el.parentElement) {\n          el.parentElement.removeChild(el);\n        }\n      });\n\n      this._elements = [];\n    }\n\n    this._config = config;\n\n    this._config.elements.map((elementConfig: LovelaceElementConfig) => {\n      this._elements.push(createStyledHuiElement(elementConfig));\n    });\n\n    this.updateElements();\n  }\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n\n    this.updateElements();\n  }\n\n  private updateElements() {\n    if (!this._hass || !this._config) {\n      return;\n    }\n\n    const visible = checkConditionsMet(this._config.conditions, this._hass);\n\n    this._elements.map((el: LovelaceElement) => {\n      if (visible) {\n        el.hass = this._hass;\n        if (!el.parentElement) {\n          this.appendChild(el);\n        }\n      } else if (el.parentElement) {\n        el.parentElement.removeChild(el);\n      }\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-conditional-element\": HuiConditionalElement;\n  }\n}\n\ncustomElements.define(\"hui-conditional-element\", HuiConditionalElement);\n","import computeStateName from \"../../../common/entity/compute_state_name\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceElementConfig } from \"../elements/types\";\nimport { ActionConfig } from \"../../../data/lovelace\";\n\ninterface Config extends LovelaceElementConfig {\n  entity?: string;\n  title?: string;\n  tap_action?: ActionConfig;\n  hold_action?: ActionConfig;\n}\n\nexport const computeTooltip = (hass: HomeAssistant, config: Config): string => {\n  if (config.title === null) {\n    return \"\";\n  }\n\n  if (config.title) {\n    return config.title;\n  }\n\n  let stateName = \"\";\n  let tooltip = \"\";\n\n  if (config.entity) {\n    stateName =\n      config.entity in hass.states\n        ? computeStateName(hass.states[config.entity])\n        : config.entity;\n  }\n\n  const tapTooltip = config.tap_action\n    ? computeActionTooltip(hass, stateName, config.tap_action, false)\n    : \"\";\n  const holdTooltip = config.hold_action\n    ? computeActionTooltip(hass, stateName, config.hold_action, true)\n    : \"\";\n\n  const newline = tapTooltip && holdTooltip ? \"\\n\" : \"\";\n\n  tooltip = tapTooltip + newline + holdTooltip;\n\n  return tooltip;\n};\n\nfunction computeActionTooltip(\n  hass: HomeAssistant,\n  state: string,\n  config: ActionConfig,\n  isHold: boolean\n) {\n  if (!config || !config.action || config.action === \"none\") {\n    return \"\";\n  }\n\n  let tooltip =\n    (isHold\n      ? hass.localize(\"ui.panel.lovelace.cards.picture-elements.hold\")\n      : hass.localize(\"ui.panel.lovelace.cards.picture-elements.tap\")) + \" \";\n\n  switch (config.action) {\n    case \"navigate\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.navigate_to\",\n        \"location\",\n        config.navigation_path\n      )}`;\n      break;\n    case \"toggle\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.toggle\",\n        \"name\",\n        state\n      )}`;\n      break;\n    case \"call-service\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.call_service\",\n        \"name\",\n        config.service\n      )}`;\n      break;\n    case \"more-info\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.more_info\",\n        \"name\",\n        state\n      )}`;\n      break;\n  }\n\n  return tooltip;\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n} from \"lit-element\";\n\nimport \"../../../components/ha-icon\";\n\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, IconElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-icon-element\")\nexport class HuiIconElement extends LitElement implements LovelaceElement {\n  public hass?: HomeAssistant;\n  @property() private _config?: IconElementConfig;\n\n  public setConfig(config: IconElementConfig): void {\n    if (!config.icon) {\n      throw Error(\"Invalid Configuration: 'icon' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-icon\n        .icon=\"${this._config.icon}\"\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      ></ha-icon>\n    `;\n  }\n\n  private _handleTap(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-icon-element\": HuiIconElement;\n  }\n}\n","import \"@polymer/paper-toggle-button/paper-toggle-button\";\n\nimport { STATES_OFF } from \"../../../common/const\";\n\nimport parseAspectRatio from \"../../../common/util/parse-aspect-ratio\";\nimport {\n  LitElement,\n  TemplateResult,\n  html,\n  property,\n  CSSResult,\n  css,\n  PropertyValues,\n  query,\n  customElement,\n} from \"lit-element\";\nimport { HomeAssistant, CameraEntity } from \"../../../types\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { fetchThumbnailUrlWithCache } from \"../../../data/camera\";\n\nconst UPDATE_INTERVAL = 10000;\nconst DEFAULT_FILTER = \"grayscale(100%)\";\n\nexport interface StateSpecificConfig {\n  [state: string]: string;\n}\n\n@customElement(\"hui-image\")\nexport class HuiImage extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public entity?: string;\n\n  @property() public image?: string;\n\n  @property() public stateImage?: StateSpecificConfig;\n\n  @property() public cameraImage?: string;\n\n  @property() public cameraView?: \"live\" | \"auto\";\n\n  @property() public aspectRatio?: string;\n\n  @property() public filter?: string;\n\n  @property() public stateFilter?: StateSpecificConfig;\n\n  @property() private _loadError?: boolean;\n\n  @property() private _cameraImageSrc?: string;\n\n  @query(\"img\") private _image!: HTMLImageElement;\n\n  private _lastImageHeight?: number;\n\n  private _cameraUpdater?: number;\n\n  private _attached?: boolean;\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._attached = true;\n    if (this.cameraImage && this.cameraView !== \"live\") {\n      this._startUpdateCameraInterval();\n    }\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._attached = false;\n    this._stopUpdateCameraInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    const ratio = this.aspectRatio ? parseAspectRatio(this.aspectRatio) : null;\n    const stateObj =\n      this.hass && this.entity ? this.hass.states[this.entity] : undefined;\n    const state = stateObj ? stateObj.state : \"unavailable\";\n\n    // Figure out image source to use\n    let imageSrc: string | undefined;\n    let cameraObj: CameraEntity | undefined;\n    // Track if we are we using a fallback image, used for filter.\n    let imageFallback = !this.stateImage;\n\n    if (this.cameraImage) {\n      if (this.cameraView === \"live\") {\n        cameraObj =\n          this.hass && (this.hass.states[this.cameraImage] as CameraEntity);\n      } else {\n        imageSrc = this._cameraImageSrc;\n      }\n    } else if (this.stateImage) {\n      const stateImage = this.stateImage[state];\n\n      if (stateImage) {\n        imageSrc = stateImage;\n      } else {\n        imageSrc = this.image;\n        imageFallback = true;\n      }\n    } else {\n      imageSrc = this.image;\n    }\n\n    // Figure out filter to use\n    let filter = this.filter || \"\";\n\n    if (this.stateFilter && this.stateFilter[state]) {\n      filter = this.stateFilter[state];\n    }\n\n    if (!filter && this.entity) {\n      const isOff = !stateObj || STATES_OFF.includes(state);\n      filter = isOff && imageFallback ? DEFAULT_FILTER : \"\";\n    }\n\n    return html`\n      <div\n        style=${styleMap({\n          paddingBottom:\n            ratio && ratio.w > 0 && ratio.h > 0\n              ? `${((100 * ratio.h) / ratio.w).toFixed(2)}%`\n              : \"\",\n        })}\n        class=${classMap({\n          ratio: Boolean(ratio && ratio.w > 0 && ratio.h > 0),\n        })}\n      >\n        ${this.cameraImage && this.cameraView === \"live\"\n          ? html`\n              <ha-camera-stream\n                .hass=\"${this.hass}\"\n                .stateObj=\"${cameraObj}\"\n              ></ha-camera-stream>\n            `\n          : html`\n              <img\n                id=\"image\"\n                src=${imageSrc}\n                @error=${this._onImageError}\n                @load=${this._onImageLoad}\n                style=${styleMap({\n                  filter,\n                  display: this._loadError ? \"none\" : \"block\",\n                })}\n              />\n            `}\n        <div\n          id=\"brokenImage\"\n          style=${styleMap({\n            height: `${this._lastImageHeight || \"100\"}px`,\n            display: this._loadError ? \"block\" : \"none\",\n          })}\n        ></div>\n      </div>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    if (changedProps.has(\"cameraImage\") && this.cameraView !== \"live\") {\n      this._updateCameraImageSrc();\n      this._startUpdateCameraInterval();\n      return;\n    }\n  }\n\n  private _startUpdateCameraInterval(): void {\n    this._stopUpdateCameraInterval();\n    if (this.cameraImage && this._attached) {\n      this._cameraUpdater = window.setInterval(\n        () => this._updateCameraImageSrc(),\n        UPDATE_INTERVAL\n      );\n    }\n  }\n\n  private _stopUpdateCameraInterval(): void {\n    if (this._cameraUpdater) {\n      clearInterval(this._cameraUpdater);\n    }\n  }\n\n  private _onImageError(): void {\n    this._loadError = true;\n  }\n\n  private async _onImageLoad(): Promise<void> {\n    this._loadError = false;\n    await this.updateComplete;\n    this._lastImageHeight = this._image.offsetHeight;\n  }\n\n  private async _updateCameraImageSrc(): Promise<void> {\n    if (!this.hass || !this.cameraImage) {\n      return;\n    }\n\n    const cameraState = this.hass.states[this.cameraImage] as\n      | CameraEntity\n      | undefined;\n\n    if (!cameraState) {\n      this._onImageError();\n      return;\n    }\n\n    this._cameraImageSrc = await fetchThumbnailUrlWithCache(\n      this.hass,\n      this.cameraImage\n    );\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      img {\n        display: block;\n        height: auto;\n        transition: filter 0.2s linear;\n        width: 100%;\n      }\n\n      .ratio {\n        position: relative;\n        width: 100%;\n        height: 0;\n      }\n\n      .ratio img,\n      .ratio div {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n      }\n\n      #brokenImage {\n        background: grey url(\"/static/images/image-broken.svg\") center/36px\n          no-repeat;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-image\": HuiImage;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../components/hui-image\";\n\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, ImageElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-image-element\")\nexport class HuiImageElement extends LitElement implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: ImageElementConfig;\n\n  public setConfig(config: ImageElementConfig): void {\n    if (!config) {\n      throw Error(\"Error in element configuration\");\n    }\n\n    this.classList.toggle(\n      \"clickable\",\n      config.tap_action && config.tap_action.action !== \"none\"\n    );\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <hui-image\n        .hass=\"${this.hass}\"\n        .entity=\"${this._config.entity}\"\n        .image=\"${this._config.image}\"\n        .stateImage=\"${this._config.state_image}\"\n        .cameraImage=\"${this._config.camera_image}\"\n        .filter=\"${this._config.filter}\"\n        .stateFilter=\"${this._config.state_filter}\"\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        .aspectRatio=\"${this._config.aspect_ratio}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      ></hui-image>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host(.clickable) {\n        cursor: pointer;\n        overflow: hidden;\n        -webkit-touch-callout: none !important;\n      }\n      hui-image {\n        -webkit-user-select: none !important;\n      }\n    `;\n  }\n\n  private _handleTap(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-image-element\": HuiImageElement;\n  }\n}\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-spinner/paper-spinner\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nclass HaProgressButton extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        .container {\n          position: relative;\n          display: inline-block;\n        }\n\n        mwc-button {\n          transition: all 1s;\n        }\n\n        .success mwc-button {\n          --mdc-theme-primary: white;\n          background-color: var(--google-green-500);\n          transition: none;\n        }\n\n        .error mwc-button {\n          --mdc-theme-primary: white;\n          background-color: var(--google-red-500);\n          transition: none;\n        }\n\n        .progress {\n          @apply --layout;\n          @apply --layout-center-center;\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n        }\n      </style>\n      <div class=\"container\" id=\"container\">\n        <mwc-button\n          id=\"button\"\n          disabled=\"[[computeDisabled(disabled, progress)]]\"\n          on-click=\"buttonTapped\"\n        >\n          <slot></slot>\n        </mwc-button>\n        <template is=\"dom-if\" if=\"[[progress]]\">\n          <div class=\"progress\"><paper-spinner active=\"\"></paper-spinner></div>\n        </template>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      progress: {\n        type: Boolean,\n        value: false,\n      },\n\n      disabled: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  tempClass(className) {\n    var classList = this.$.container.classList;\n    classList.add(className);\n    setTimeout(() => {\n      classList.remove(className);\n    }, 1000);\n  }\n\n  ready() {\n    super.ready();\n    this.addEventListener(\"click\", (ev) => this.buttonTapped(ev));\n  }\n\n  buttonTapped(ev) {\n    if (this.progress) ev.stopPropagation();\n  }\n\n  actionSuccess() {\n    this.tempClass(\"success\");\n  }\n\n  actionError() {\n    this.tempClass(\"error\");\n  }\n\n  computeDisabled(disabled, progress) {\n    return disabled || progress;\n  }\n}\n\ncustomElements.define(\"ha-progress-button\", HaProgressButton);\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"./ha-progress-button\";\nimport { EventsMixin } from \"../../mixins/events-mixin\";\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaCallServiceButton extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <ha-progress-button\n        id=\"progress\"\n        progress=\"[[progress]]\"\n        on-click=\"buttonTapped\"\n        ><slot></slot\n      ></ha-progress-button>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      progress: {\n        type: Boolean,\n        value: false,\n      },\n\n      domain: {\n        type: String,\n      },\n\n      service: {\n        type: String,\n      },\n\n      serviceData: {\n        type: Object,\n        value: {},\n      },\n    };\n  }\n\n  buttonTapped() {\n    this.progress = true;\n    var el = this;\n    var eventData = {\n      domain: this.domain,\n      service: this.service,\n      serviceData: this.serviceData,\n    };\n\n    this.hass\n      .callService(this.domain, this.service, this.serviceData)\n      .then(\n        function() {\n          el.progress = false;\n          el.$.progress.actionSuccess();\n          eventData.success = true;\n        },\n        function() {\n          el.progress = false;\n          el.$.progress.actionError();\n          eventData.success = false;\n        }\n      )\n      .then(function() {\n        el.fire(\"hass-service-called\", eventData);\n      });\n  }\n}\n\ncustomElements.define(\"ha-call-service-button\", HaCallServiceButton);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  CSSResult,\n  css,\n} from \"lit-element\";\n\nimport \"../../../components/buttons/ha-call-service-button\";\n\nimport { LovelaceElement, ServiceButtonElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-service-button-element\")\nexport class HuiServiceButtonElement extends LitElement\n  implements LovelaceElement {\n  public hass?: HomeAssistant;\n  @property() private _config?: ServiceButtonElementConfig;\n  private _domain?: string;\n  private _service?: string;\n\n  static get properties() {\n    return { _config: {} };\n  }\n\n  public setConfig(config: ServiceButtonElementConfig): void {\n    if (!config || !config.service) {\n      throw Error(\"Invalid Configuration: 'service' required\");\n    }\n\n    [this._domain, this._service] = config.service.split(\".\", 2);\n\n    if (!this._domain) {\n      throw Error(\"Invalid Configuration: 'service' does not have a domain\");\n    }\n\n    if (!this._service) {\n      throw Error(\n        \"Invalid Configuration: 'service' does not have a service name\"\n      );\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-call-service-button\n        .hass=\"${this.hass}\"\n        .domain=\"${this._domain}\"\n        .service=\"${this._service}\"\n        .serviceData=\"${this._config.service_data}\"\n        >${this._config.title}</ha-call-service-button\n      >\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-call-service-button {\n        color: var(--primary-color);\n        white-space: nowrap;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-service-button-element\": HuiServiceButtonElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/entity/ha-state-label-badge\";\nimport \"../components/hui-warning-element\";\n\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport { LovelaceElement, StateBadgeElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-state-badge-element\")\nexport class HuiStateBadgeElement extends LitElement\n  implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: StateBadgeElementConfig;\n\n  public setConfig(config: StateBadgeElementConfig): void {\n    if (!config.entity) {\n      throw Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity!];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=\"${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}\"\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <ha-state-label-badge\n        .hass=\"${this.hass}\"\n        .state=\"${stateObj}\"\n        .title=\"${this._config.title === undefined\n          ? computeStateName(stateObj)\n          : this._config.title === null\n          ? \"\"\n          : this._config.title}\"\n      ></ha-state-label-badge>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-state-badge-element\": HuiStateBadgeElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/entity/state-badge\";\nimport \"../components/hui-warning-element\";\n\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, StateIconElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-state-icon-element\")\nexport class HuiStateIconElement extends LitElement implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: StateIconElementConfig;\n\n  public setConfig(config: StateIconElementConfig): void {\n    if (!config.entity) {\n      throw Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity!];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <state-badge\n        .stateObj=\"${stateObj}\"\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        @ha-click=\"${this._handleClick}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n        .overrideIcon=${this._config.icon}\n      ></state-badge>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n    `;\n  }\n\n  private _handleClick(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-state-icon-element\": HuiStateIconElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/entity/ha-state-label-badge\";\nimport \"../components/hui-warning-element\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, StateLabelElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-state-label-element\")\nclass HuiStateLabelElement extends LitElement implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: StateLabelElementConfig;\n\n  public setConfig(config: StateLabelElementConfig): void {\n    if (!config.entity) {\n      throw Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity!];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <div\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      >\n        ${this._config.prefix}${stateObj\n          ? computeStateDisplay(\n              this.hass.localize,\n              stateObj,\n              this.hass.language\n            )\n          : \"-\"}${this._config.suffix}\n      </div>\n    `;\n  }\n\n  private _handleTap(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n      div {\n        padding: 8px;\n        white-space: nowrap;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-state-label-element\": HuiStateLabelElement;\n  }\n}\n","import deepClone from \"deep-clone-simple\";\n\nimport \"../elements/hui-conditional-element\";\nimport \"../elements/hui-icon-element\";\nimport \"../elements/hui-image-element\";\nimport \"../elements/hui-service-button-element\";\nimport \"../elements/hui-state-badge-element\";\nimport \"../elements/hui-state-icon-element\";\nimport \"../elements/hui-state-label-element\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport {\n  createErrorCardElement,\n  createErrorCardConfig,\n  HuiErrorCard,\n} from \"../cards/hui-error-card\";\nimport { LovelaceElementConfig, LovelaceElement } from \"../elements/types\";\n\nconst CUSTOM_TYPE_PREFIX = \"custom:\";\nconst ELEMENT_TYPES = new Set([\n  \"conditional\",\n  \"icon\",\n  \"image\",\n  \"service-button\",\n  \"state-badge\",\n  \"state-icon\",\n  \"state-label\",\n]);\nconst TIMEOUT = 2000;\n\nconst _createElement = (\n  tag: string,\n  config: LovelaceElementConfig\n): LovelaceElement | HuiErrorCard => {\n  const element = document.createElement(tag) as LovelaceElement;\n  try {\n    element.setConfig(deepClone(config));\n  } catch (err) {\n    // tslint:disable-next-line\n    console.error(tag, err);\n    return _createErrorElement(err.message, config);\n  }\n  return element;\n};\n\nconst _createErrorElement = (\n  error: string,\n  config: LovelaceElementConfig\n): HuiErrorCard => createErrorCardElement(createErrorCardConfig(error, config));\n\nfunction _hideErrorElement(element) {\n  element.style.display = \"None\";\n  return window.setTimeout(() => {\n    element.style.display = \"\";\n  }, TIMEOUT);\n}\n\nexport const createHuiElement = (\n  config: LovelaceElementConfig\n): LovelaceElement | HuiErrorCard => {\n  if (!config || typeof config !== \"object\" || !config.type) {\n    return _createErrorElement(\"No element type configured.\", config);\n  }\n\n  if (config.type.startsWith(CUSTOM_TYPE_PREFIX)) {\n    const tag = config.type.substr(CUSTOM_TYPE_PREFIX.length);\n\n    if (customElements.get(tag)) {\n      return _createElement(tag, config);\n    }\n    const element = _createErrorElement(\n      `Custom element doesn't exist: ${tag}.`,\n      config\n    );\n    const timer = _hideErrorElement(element);\n\n    customElements.whenDefined(tag).then(() => {\n      clearTimeout(timer);\n      fireEvent(element, \"ll-rebuild\");\n    });\n\n    return element;\n  }\n\n  if (!ELEMENT_TYPES.has(config.type)) {\n    return _createErrorElement(\n      `Unknown element type encountered: ${config.type}.`,\n      config\n    );\n  }\n\n  return _createElement(`hui-${config.type}-element`, config);\n};\n","import { LovelaceElement, LovelaceElementConfig } from \"../../elements/types\";\nimport { createHuiElement } from \"../../common/create-hui-element\";\n\nexport function createStyledHuiElement(\n  elementConfig: LovelaceElementConfig\n): LovelaceElement {\n  const element = createHuiElement(elementConfig) as LovelaceElement;\n  // keep conditional card as a transparent container so let its position remain static\n  if (element.tagName !== \"HUI-CONDITIONAL-ELEMENT\") {\n    element.classList.add(\"element\");\n  }\n\n  if (elementConfig.style) {\n    Object.keys(elementConfig.style).forEach((prop) => {\n      element.style.setProperty(prop, elementConfig.style[prop]);\n    });\n  }\n\n  return element;\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { createStyledHuiElement } from \"./picture-elements/create-styled-hui-element\";\nimport { LovelaceCard } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceElementConfig, LovelaceElement } from \"../elements/types\";\nimport { PictureElementsCardConfig } from \"./types\";\n\n@customElement(\"hui-picture-elements-card\")\nclass HuiPictureElementsCard extends LitElement implements LovelaceCard {\n  @property() private _config?: PictureElementsCardConfig;\n\n  private _hass?: HomeAssistant;\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n    for (const el of this.shadowRoot!.querySelectorAll(\"#root > *\")) {\n      const element = el as LovelaceElement;\n      element.hass = this._hass;\n    }\n  }\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: PictureElementsCardConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid Configuration\");\n    } else if (\n      !(config.image || config.camera_image || config.state_image) ||\n      (config.state_image && !config.entity)\n    ) {\n      throw new Error(\"Invalid Configuration: image required\");\n    } else if (!Array.isArray(config.elements)) {\n      throw new Error(\"Invalid Configuration: elements required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <div id=\"root\">\n          <hui-image\n            .hass=\"${this._hass}\"\n            .image=\"${this._config.image}\"\n            .stateImage=\"${this._config.state_image}\"\n            .cameraImage=\"${this._config.camera_image}\"\n            .cameraView=\"${this._config.camera_view}\"\n            .entity=\"${this._config.entity}\"\n            .aspectRatio=\"${this._config.aspect_ratio}\"\n          ></hui-image>\n          ${this._config.elements.map(\n            (elementConfig: LovelaceElementConfig) => {\n              const element = createStyledHuiElement(elementConfig);\n              element.hass = this._hass;\n\n              return element;\n            }\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      #root {\n        position: relative;\n      }\n\n      .element {\n        position: absolute;\n        transform: translate(-50%, -50%);\n      }\n\n      ha-card {\n        overflow: hidden;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-elements-card\": HuiPictureElementsCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-image\";\nimport \"../components/hui-warning\";\n\nimport computeDomain from \"../../../common/entity/compute_domain\";\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard } from \"../types\";\nimport { handleClick } from \"../common/handle-click\";\nimport { UNAVAILABLE } from \"../../../data/entity\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { PictureEntityCardConfig } from \"./types\";\n\n@customElement(\"hui-picture-entity-card\")\nclass HuiPictureEntityCard extends LitElement implements LovelaceCard {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: PictureEntityCardConfig;\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PictureEntityCardConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    if (\n      computeDomain(config.entity) !== \"camera\" &&\n      (!config.image && !config.state_image && !config.camera_image)\n    ) {\n      throw new Error(\"No image source configured.\");\n    }\n\n    this._config = { show_name: true, show_state: true, ...config };\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    const name = this._config.name || computeStateName(stateObj);\n    const state = computeStateDisplay(\n      this.hass!.localize,\n      stateObj,\n      this.hass.language\n    );\n\n    let footer: TemplateResult | string = \"\";\n    if (this._config.show_name && this._config.show_state) {\n      footer = html`\n        <div class=\"footer both\">\n          <div>${name}</div>\n          <div>${state}</div>\n        </div>\n      `;\n    } else if (this._config.show_name) {\n      footer = html`\n        <div class=\"footer\">${name}</div>\n      `;\n    } else if (this._config.show_state) {\n      footer = html`\n        <div class=\"footer state\">${state}</div>\n      `;\n    }\n\n    return html`\n      <ha-card>\n        <hui-image\n          .hass=\"${this.hass}\"\n          .image=\"${this._config.image}\"\n          .stateImage=\"${this._config.state_image}\"\n          .cameraImage=\"${computeDomain(this._config.entity) === \"camera\"\n            ? this._config.entity\n            : this._config.camera_image}\"\n          .cameraView=\"${this._config.camera_view}\"\n          .entity=\"${this._config.entity}\"\n          .aspectRatio=\"${this._config.aspect_ratio}\"\n          @ha-click=\"${this._handleTap}\"\n          @ha-hold=\"${this._handleHold}\"\n          .longPress=\"${longPress()}\"\n          class=\"${classMap({\n            clickable: stateObj.state !== UNAVAILABLE,\n          })}\"\n        ></hui-image>\n        ${footer}\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        min-height: 75px;\n        overflow: hidden;\n        position: relative;\n      }\n\n      hui-image.clickable {\n        cursor: pointer;\n      }\n\n      .footer {\n        /* start paper-font-common-nowrap style */\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        /* end paper-font-common-nowrap style */\n\n        position: absolute;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: rgba(0, 0, 0, 0.3);\n        padding: 16px;\n        font-size: 16px;\n        line-height: 16px;\n        color: white;\n      }\n\n      .both {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .state {\n        text-align: right;\n      }\n    `;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-entity-card\": HuiPictureEntityCard;\n  }\n}\n","export const UNAVAILABLE = \"unavailable\";\n\nexport const ENTITY_COMPONENT_DOMAINS = [\n  \"air_quality\",\n  \"alarm_control_panel\",\n  \"automation\",\n  \"binary_sensor\",\n  \"calendar\",\n  \"counter\",\n  \"cover\",\n  \"dominos\",\n  \"fan\",\n  \"geo_location\",\n  \"group\",\n  \"history_graph\",\n  \"image_processing\",\n  \"input_boolean\",\n  \"input_datetime\",\n  \"input_number\",\n  \"input_select\",\n  \"input_text\",\n  \"light\",\n  \"lock\",\n  \"mailbox\",\n  \"media_player\",\n  \"person\",\n  \"plant\",\n  \"remember_the_milk\",\n  \"remote\",\n  \"scene\",\n  \"script\",\n  \"sensor\",\n  \"switch\",\n  \"timer\",\n  \"utility_meter\",\n  \"vacuum\",\n  \"weather\",\n  \"wink\",\n  \"zha\",\n  \"zwave\",\n];\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\nimport stateIcon from \"../../../common/entity/state_icon\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-image\";\nimport \"../components/hui-warning-element\";\n\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { LovelaceCard } from \"../types\";\nimport { EntityConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { handleClick } from \"../common/handle-click\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { toggleEntity } from \"../common/entity/toggle-entity\";\nimport { PictureGlanceCardConfig } from \"./types\";\n\nconst STATES_OFF = new Set([\"closed\", \"locked\", \"not_home\", \"off\"]);\n\n@customElement(\"hui-picture-glance-card\")\nclass HuiPictureGlanceCard extends LitElement implements LovelaceCard {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: PictureGlanceCardConfig;\n\n  private _entitiesDialog?: EntityConfig[];\n\n  private _entitiesToggle?: EntityConfig[];\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PictureGlanceCardConfig): void {\n    if (\n      !config ||\n      !config.entities ||\n      !Array.isArray(config.entities) ||\n      !(config.image || config.camera_image || config.state_image) ||\n      (config.state_image && !config.entity)\n    ) {\n      throw new Error(\"Invalid card configuration\");\n    }\n\n    const entities = processConfigEntities(config.entities);\n    this._entitiesDialog = [];\n    this._entitiesToggle = [];\n\n    entities.forEach((item) => {\n      if (\n        config.force_dialog ||\n        !DOMAINS_TOGGLE.has(computeDomain(item.entity))\n      ) {\n        this._entitiesDialog!.push(item);\n      } else {\n        this._entitiesToggle!.push(item);\n      }\n    });\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass) {\n      return true;\n    }\n\n    if (this._entitiesDialog) {\n      for (const entity of this._entitiesDialog) {\n        if (\n          oldHass.states[entity.entity] !== this.hass!.states[entity.entity]\n        ) {\n          return true;\n        }\n      }\n    }\n\n    if (this._entitiesToggle) {\n      for (const entity of this._entitiesToggle) {\n        if (\n          oldHass.states[entity.entity] !== this.hass!.states[entity.entity]\n        ) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-card>\n        <hui-image\n          class=\"${classMap({\n            clickable: Boolean(\n              this._config.tap_action ||\n                this._config.hold_action ||\n                this._config.camera_image\n            ),\n          })}\"\n          @ha-click=\"${this._handleTap}\"\n          @ha-hold=\"${this._handleHold}\"\n          .longPress=\"${longPress()}\"\n          .hass=\"${this.hass}\"\n          .image=\"${this._config.image}\"\n          .stateImage=\"${this._config.state_image}\"\n          .cameraImage=\"${this._config.camera_image}\"\n          .cameraView=\"${this._config.camera_view}\"\n          .entity=\"${this._config.entity}\"\n          .aspectRatio=\"${this._config.aspect_ratio}\"\n        ></hui-image>\n        <div class=\"box\">\n          ${this._config.title\n            ? html`\n                <div class=\"title\">${this._config.title}</div>\n              `\n            : \"\"}\n          <div>\n            ${this._entitiesDialog!.map((entityConf) =>\n              this.renderEntity(entityConf, true)\n            )}\n          </div>\n          <div>\n            ${this._entitiesToggle!.map((entityConf) =>\n              this.renderEntity(entityConf, false)\n            )}\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  private renderEntity(\n    entityConf: EntityConfig,\n    dialog: boolean\n  ): TemplateResult {\n    const stateObj = this.hass!.states[entityConf.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass!.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            entityConf.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <ha-icon\n        .entity=\"${stateObj.entity_id}\"\n        @click=\"${dialog ? this._openDialog : this._callService}\"\n        class=\"${classMap({\n          \"state-on\": !STATES_OFF.has(stateObj.state),\n        })}\"\n        .icon=\"${entityConf.icon || stateIcon(stateObj)}\"\n        title=\"${`\n            ${computeStateName(stateObj)} : ${computeStateDisplay(\n          this.hass!.localize,\n          stateObj,\n          this.hass!.language\n        )}\n          `}\"\n      ></ha-icon>\n    `;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n\n  private _openDialog(ev: MouseEvent): void {\n    fireEvent(this, \"hass-more-info\", { entityId: (ev.target as any).entity });\n  }\n\n  private _callService(ev: MouseEvent): void {\n    toggleEntity(this.hass!, (ev.target as any).entity);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        position: relative;\n        min-height: 48px;\n        overflow: hidden;\n      }\n\n      hui-image.clickable {\n        cursor: pointer;\n      }\n\n      .box {\n        /* start paper-font-common-nowrap style */\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        /* end paper-font-common-nowrap style */\n\n        position: absolute;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: rgba(0, 0, 0, 0.3);\n        padding: 4px 8px;\n        font-size: 16px;\n        line-height: 40px;\n        color: white;\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .box .title {\n        font-weight: 500;\n        margin-left: 8px;\n      }\n\n      ha-icon {\n        cursor: pointer;\n        padding: 8px;\n        color: #a9a9a9;\n      }\n\n      ha-icon.state-on {\n        color: white;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-glance-card\": HuiPictureGlanceCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\n\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { LovelaceCardEditor, LovelaceCard } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { PlantStatusCardConfig, PlantAttributeTarget } from \"./types\";\n\nconst SENSORS = {\n  moisture: \"hass:water\",\n  temperature: \"hass:thermometer\",\n  brightness: \"hass:white-balance-sunny\",\n  conductivity: \"hass:emoticon-poop\",\n  battery: \"hass:battery\",\n};\n\n@customElement(\"hui-plant-status-card\")\nclass HuiPlantStatusCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-plant-status-card-editor\" */ \"../editor/config-elements/hui-plant-status-card-editor\");\n    return document.createElement(\"hui-plant-status-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: PlantStatusCardConfig;\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PlantStatusCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"plant\") {\n      throw new Error(\"Specify an entity from within the plant domain.\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config!.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card\n        class=\"${stateObj.attributes.entity_picture ? \"has-plant-image\" : \"\"}\"\n      >\n        <div\n          class=\"banner\"\n          style=\"background-image:url(${stateObj.attributes.entity_picture})\"\n        >\n          <div class=\"header\">\n            ${this._config.name || computeStateName(stateObj)}\n          </div>\n        </div>\n        <div class=\"content\">\n          ${this.computeAttributes(stateObj).map(\n            (item) => html`\n              <div\n                class=\"attributes\"\n                @click=\"${this._handleMoreInfo}\"\n                .value=\"${item}\"\n              >\n                <div>\n                  <ha-icon\n                    icon=\"${this.computeIcon(\n                      item,\n                      stateObj.attributes.battery\n                    )}\"\n                  ></ha-icon>\n                </div>\n                <div\n                  class=\"${stateObj.attributes.problem.indexOf(item) === -1\n                    ? \"\"\n                    : \"problem\"}\"\n                >\n                  ${stateObj.attributes[item]}\n                </div>\n                <div class=\"uom\">\n                  ${stateObj.attributes.unit_of_measurement_dict[item] || \"\"}\n                </div>\n              </div>\n            `\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .banner {\n        display: flex;\n        align-items: flex-end;\n        background-repeat: no-repeat;\n        background-size: cover;\n        background-position: center;\n        padding-top: 12px;\n      }\n\n      .has-plant-image .banner {\n        padding-top: 30%;\n      }\n\n      .header {\n        /* start paper-font-headline style */\n        font-family: \"Roboto\", \"Noto\", sans-serif;\n        -webkit-font-smoothing: antialiased; /* OS X subpixel AA bleed bug */\n        text-rendering: optimizeLegibility;\n        font-size: 24px;\n        font-weight: 400;\n        letter-spacing: -0.012em;\n        /* end paper-font-headline style */\n\n        line-height: 40px;\n        padding: 8px 16px;\n      }\n\n      .has-plant-image .header {\n        font-size: 16px;\n        font-weight: 500;\n        line-height: 16px;\n        padding: 16px;\n        color: white;\n        width: 100%;\n        background: rgba(0, 0, 0, var(--dark-secondary-opacity));\n      }\n\n      .content {\n        display: flex;\n        justify-content: space-between;\n        padding: 16px 32px 24px 32px;\n      }\n\n      .has-plant-image .content {\n        padding-bottom: 16px;\n      }\n\n      ha-icon {\n        color: var(--paper-item-icon-color);\n        margin-bottom: 8px;\n      }\n\n      .attributes {\n        cursor: pointer;\n      }\n\n      .attributes div {\n        text-align: center;\n      }\n\n      .problem {\n        color: var(--google-red-500);\n        font-weight: bold;\n      }\n\n      .uom {\n        color: var(--secondary-text-color);\n      }\n    `;\n  }\n\n  private computeAttributes(stateObj: HassEntity): string[] {\n    return Object.keys(SENSORS).filter((key) => key in stateObj.attributes);\n  }\n\n  private computeIcon(attr: string, batLvl: number): string {\n    const icon = SENSORS[attr];\n    if (attr === \"battery\") {\n      if (batLvl <= 5) {\n        return `${icon}-alert`;\n      }\n      if (batLvl < 95) {\n        return `${icon}-${Math.round(batLvl / 10 - 0.01) * 10}`;\n      }\n    }\n    return icon;\n  }\n\n  private _handleMoreInfo(ev: Event): void {\n    const target = ev.currentTarget! as PlantAttributeTarget;\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (target.value) {\n      fireEvent(this, \"hass-more-info\", {\n        entityId: stateObj.attributes.sensors[target.value],\n      });\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-plant-status-card\": HuiPlantStatusCard;\n  }\n}\n","import {\n  html,\n  svg,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport \"@polymer/paper-spinner/paper-spinner\";\n\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport stateIcon from \"../../../common/entity/state_icon\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { fetchRecent } from \"../../../data/history\";\nimport { SensorCardConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\nconst midPoint = (\n  _Ax: number,\n  _Ay: number,\n  _Bx: number,\n  _By: number\n): number[] => {\n  const _Zx = (_Ax - _Bx) / 2 + _Bx;\n  const _Zy = (_Ay - _By) / 2 + _By;\n  return [_Zx, _Zy];\n};\n\nconst getPath = (coords: number[][]): string => {\n  let next;\n  let Z;\n  const X = 0;\n  const Y = 1;\n  let path = \"\";\n  let last = coords.filter(Boolean)[0];\n\n  path += `M ${last[X]},${last[Y]}`;\n\n  for (const coord of coords) {\n    next = coord;\n    Z = midPoint(last[X], last[Y], next[X], next[Y]);\n    path += ` ${Z[X]},${Z[Y]}`;\n    path += ` Q${next[X]},${next[Y]}`;\n    last = next;\n  }\n\n  path += ` ${next[X]},${next[Y]}`;\n  return path;\n};\n\nconst calcPoints = (\n  history: any,\n  hours: number,\n  width: number,\n  detail: number,\n  min: number,\n  max: number\n): number[][] => {\n  const coords = [] as number[][];\n  const margin = 5;\n  const height = 80;\n  width -= 10;\n  let yRatio = (max - min) / height;\n  yRatio = yRatio !== 0 ? yRatio : height;\n  let xRatio = width / (hours - (detail === 1 ? 1 : 0));\n  xRatio = isFinite(xRatio) ? xRatio : width;\n  const getCoords = (item, i, offset = 0, depth = 1) => {\n    if (depth > 1) {\n      return item.forEach((subItem, index) =>\n        getCoords(subItem, i, index, depth - 1)\n      );\n    }\n    const average =\n      item.reduce((sum, entry) => sum + parseFloat(entry.state), 0) /\n      item.length;\n\n    const x = xRatio * (i + offset / 6) + margin;\n    const y = height - (average - min) / yRatio + margin * 2;\n    return coords.push([x, y]);\n  };\n\n  history.forEach((item, i) => getCoords(item, i, 0, detail));\n  if (coords.length === 1) {\n    coords[1] = [width + margin, coords[0][1]];\n  }\n\n  coords.push([width + margin, coords[coords.length - 1][1]]);\n  return coords;\n};\n\nconst coordinates = (\n  history: any,\n  hours: number,\n  width: number,\n  detail: number\n): number[][] => {\n  history.forEach((item) => (item.state = Number(item.state)));\n  history = history.filter((item) => !Number.isNaN(item.state));\n\n  const min = Math.min.apply(Math, history.map((item) => item.state));\n  const max = Math.max.apply(Math, history.map((item) => item.state));\n  const now = new Date().getTime();\n\n  const reduce = (res, item, point) => {\n    const age = now - new Date(item.last_changed).getTime();\n\n    let key = Math.abs(age / (1000 * 3600) - hours);\n    if (point) {\n      key = (key - Math.floor(key)) * 60;\n      key = Number((Math.round(key / 10) * 10).toString()[0]);\n    } else {\n      key = Math.floor(key);\n    }\n    if (!res[key]) {\n      res[key] = [];\n    }\n    res[key].push(item);\n    return res;\n  };\n\n  history = history.reduce((res, item) => reduce(res, item, false), []);\n  if (detail > 1) {\n    history = history.map((entry) =>\n      entry.reduce((res, item) => reduce(res, item, true), [])\n    );\n  }\n  return calcPoints(history, hours, width, detail, min, max);\n};\n\n@customElement(\"hui-sensor-card\")\nclass HuiSensorCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-sensor-card-editor\" */ \"../editor/config-elements/hui-sensor-card-editor\");\n    return document.createElement(\"hui-sensor-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: SensorCardConfig;\n\n  @property() private _history?: any;\n\n  private _date?: Date;\n\n  public setConfig(config: SensorCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"sensor\") {\n      throw new Error(\"Specify an entity from within the sensor domain.\");\n    }\n\n    const cardConfig = {\n      detail: 1,\n      theme: \"default\",\n      hours_to_show: 24,\n      ...config,\n    };\n\n    cardConfig.hours_to_show = Number(cardConfig.hours_to_show);\n    cardConfig.detail =\n      cardConfig.detail === 1 || cardConfig.detail === 2\n        ? cardConfig.detail\n        : 1;\n\n    this._config = cardConfig;\n  }\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    let graph;\n\n    if (stateObj && this._config.graph === \"line\") {\n      if (!stateObj.attributes.unit_of_measurement) {\n        return html`\n          <hui-warning\n            >Entity: ${this._config.entity} - Has no Unit of Measurement and\n            therefore can not display a line graph.</hui-warning\n          >\n        `;\n      } else if (!this._history) {\n        graph = svg`\n          <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 500 100\"></svg>\n        `;\n      } else {\n        graph = svg`\n          <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 500 100\">\n            <path\n              d=\"${this._history}\"\n              fill=\"none\"\n              stroke=\"var(--accent-color)\"\n              stroke-width=\"5\"\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n            />\n          </svg>\n        `;\n      }\n    } else {\n      graph = \"\";\n    }\n    return html`\n      <ha-card @click=\"${this._handleClick}\">\n        <div class=\"flex\">\n          <div class=\"icon\">\n            <ha-icon\n              .icon=\"${this._config.icon || stateIcon(stateObj)}\"\n            ></ha-icon>\n          </div>\n          <div class=\"header\">\n            <span class=\"name\"\n              >${this._config.name || computeStateName(stateObj)}</span\n            >\n          </div>\n        </div>\n        <div class=\"flex info\">\n          <span id=\"value\">${stateObj.state}</span>\n          <span id=\"measurement\"\n            >${this._config.unit ||\n              stateObj.attributes.unit_of_measurement}</span\n          >\n        </div>\n        <div class=\"graph\"><div>${graph}</div></div>\n      </ha-card>\n    `;\n  }\n\n  protected firstUpdated(): void {\n    this._date = new Date();\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_history\")) {\n      return true;\n    }\n\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n    if (!this._config || this._config.graph !== \"line\" || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config!.theme);\n    }\n\n    const minute = 60000;\n    if (changedProps.has(\"_config\")) {\n      this._getHistory();\n    } else if (Date.now() - this._date!.getTime() >= minute) {\n      this._getHistory();\n    }\n  }\n\n  private _handleClick(): void {\n    fireEvent(this, \"hass-more-info\", { entityId: this._config!.entity });\n  }\n\n  private async _getHistory(): Promise<void> {\n    const endTime = new Date();\n    const startTime = new Date();\n    startTime.setHours(endTime.getHours() - this._config!.hours_to_show!);\n\n    const stateHistory = await fetchRecent(\n      this.hass,\n      this._config!.entity,\n      startTime,\n      endTime\n    );\n\n    if (stateHistory.length < 1 || stateHistory[0].length < 1) {\n      return;\n    }\n\n    const coords = coordinates(\n      stateHistory[0],\n      this._config!.hours_to_show!,\n      500,\n      this._config!.detail!\n    );\n\n    this._history = getPath(coords);\n    this._date = new Date();\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        flex-direction: column;\n      }\n\n      ha-card {\n        display: flex;\n        flex-direction: column;\n        flex: 1;\n        padding: 16px;\n        position: relative;\n        cursor: pointer;\n      }\n\n      .flex {\n        display: flex;\n      }\n\n      .header {\n        align-items: center;\n        display: flex;\n        min-width: 0;\n        opacity: 0.8;\n        position: relative;\n      }\n\n      .name {\n        display: block;\n        display: -webkit-box;\n        font-size: 1.2rem;\n        font-weight: 500;\n        max-height: 1.4rem;\n        margin-top: 2px;\n        opacity: 0.8;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        -webkit-line-clamp: 1;\n        -webkit-box-orient: vertical;\n        word-wrap: break-word;\n        word-break: break-all;\n      }\n\n      .icon {\n        color: var(--paper-item-icon-color, #44739e);\n        display: inline-block;\n        flex: 0 0 40px;\n        line-height: 40px;\n        position: relative;\n        text-align: center;\n        width: 40px;\n      }\n\n      .info {\n        flex-wrap: wrap;\n        margin: 16px 0 16px 8px;\n      }\n\n      #value {\n        display: inline-block;\n        font-size: 2rem;\n        font-weight: 400;\n        line-height: 1em;\n        margin-right: 4px;\n      }\n\n      #measurement {\n        align-self: flex-end;\n        display: inline-block;\n        font-size: 1.3rem;\n        line-height: 1.2em;\n        margin-top: 0.1em;\n        opacity: 0.6;\n        vertical-align: bottom;\n      }\n\n      .graph {\n        align-self: flex-end;\n        margin: auto;\n        margin-bottom: 0px;\n        position: relative;\n        width: 100%;\n      }\n\n      .graph > div {\n        align-self: flex-end;\n        margin: auto 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-sensor-card\": HuiSensorCard;\n  }\n}\n","import { html, TemplateResult } from \"lit-element\";\n\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport { HuiStackCard } from \"./hui-stack-card\";\n\nclass HuiVerticalStackCard extends HuiStackCard {\n  public getCardSize() {\n    let totalSize = 0;\n\n    if (!this._cards) {\n      return totalSize;\n    }\n\n    for (const element of this._cards) {\n      totalSize += computeCardSize(element);\n    }\n\n    return totalSize;\n  }\n\n  protected renderStyle(): TemplateResult {\n    return html`\n      <style>\n        #root {\n          display: flex;\n          flex-direction: column;\n        }\n        #root > * {\n          margin: 4px 0 4px 0;\n        }\n        #root > *:first-child {\n          margin-top: 0;\n        }\n        #root > *:last-child {\n          margin-bottom: 0;\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-vertical-stack-card\": HuiVerticalStackCard;\n  }\n}\n\ncustomElements.define(\"hui-vertical-stack-card\", HuiVerticalStackCard);\n","import { HomeAssistant } from \"../types\";\n\nexport interface ShoppingListItem {\n  id: number;\n  name: string;\n  complete: boolean;\n}\n\nexport const fetchItems = (hass: HomeAssistant): Promise<ShoppingListItem[]> =>\n  hass.callWS({\n    type: \"shopping_list/items\",\n  });\n\nexport const updateItem = (\n  hass: HomeAssistant,\n  itemId: number,\n  item: {\n    name?: string;\n    complete?: boolean;\n  }\n): Promise<ShoppingListItem> =>\n  hass.callWS({\n    type: \"shopping_list/items/update\",\n    item_id: itemId,\n    ...item,\n  });\n\nexport const clearItems = (hass: HomeAssistant): Promise<void> =>\n  hass.callWS({\n    type: \"shopping_list/items/clear\",\n  });\n\nexport const addItem = (\n  hass: HomeAssistant,\n  name: string\n): Promise<ShoppingListItem> =>\n  hass.callWS({\n    type: \"shopping_list/items/add\",\n    name,\n  });\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport { repeat } from \"lit-html/directives/repeat\";\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-checkbox/paper-checkbox\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport {\n  fetchItems,\n  updateItem,\n  ShoppingListItem,\n  clearItems,\n  addItem,\n} from \"../../../data/shopping-list\";\nimport { ShoppingListCardConfig } from \"./types\";\n\n@customElement(\"hui-shopping-list-card\")\nclass HuiShoppingListCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-shopping-list-editor\" */ \"../editor/config-elements/hui-shopping-list-editor\");\n    return document.createElement(\"hui-shopping-list-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: ShoppingListCardConfig;\n\n  @property() private _uncheckedItems?: ShoppingListItem[];\n\n  @property() private _checkedItems?: ShoppingListItem[];\n\n  private _unsubEvents?: Promise<() => Promise<void>>;\n\n  public getCardSize(): number {\n    return (this._config ? (this._config.title ? 1 : 0) : 0) + 3;\n  }\n\n  public setConfig(config: ShoppingListCardConfig): void {\n    this._config = config;\n    this._uncheckedItems = [];\n    this._checkedItems = [];\n    this._fetchData();\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (this.hass) {\n      this._unsubEvents = this.hass.connection.subscribeEvents(\n        () => this._fetchData(),\n        \"shopping_list_updated\"\n      );\n      this._fetchData();\n    }\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n\n    if (this._unsubEvents) {\n      this._unsubEvents.then((unsub) => unsub());\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <div class=\"addRow\">\n          <ha-icon\n            class=\"addButton\"\n            @click=\"${this._addItem}\"\n            icon=\"hass:plus\"\n            .title=\"${this.hass!.localize(\n              \"ui.panel.lovelace.cards.shopping-list.add_item\"\n            )}\"\n          >\n          </ha-icon>\n          <paper-item-body>\n            <paper-input\n              no-label-float\n              class=\"addBox\"\n              placeholder=\"${this.hass!.localize(\n                \"ui.panel.lovelace.cards.shopping-list.add_item\"\n              )}\"\n              @keydown=\"${this._addKeyPress}\"\n            ></paper-input>\n          </paper-item-body>\n        </div>\n        ${repeat(\n          this._uncheckedItems!,\n          (item) => item.id,\n          (item, index) =>\n            html`\n              <div class=\"editRow\">\n                <paper-checkbox\n                  slot=\"item-icon\"\n                  id=\"${index}\"\n                  ?checked=\"${item.complete}\"\n                  .itemId=\"${item.id}\"\n                  @click=\"${this._completeItem}\"\n                  tabindex=\"0\"\n                ></paper-checkbox>\n                <paper-item-body>\n                  <paper-input\n                    no-label-float\n                    .value=\"${item.name}\"\n                    .itemId=\"${item.id}\"\n                    @change=\"${this._saveEdit}\"\n                  ></paper-input>\n                </paper-item-body>\n              </div>\n            `\n        )}\n        ${this._checkedItems!.length > 0\n          ? html`\n              <div class=\"divider\"></div>\n              <div class=\"checked\">\n                <span class=\"label\">\n                  ${this.hass!.localize(\n                    \"ui.panel.lovelace.cards.shopping-list.checked_items\"\n                  )}\n                </span>\n                <ha-icon\n                  class=\"clearall\"\n                  @click=\"${this._clearItems}\"\n                  icon=\"hass:notification-clear-all\"\n                  .title=\"${this.hass!.localize(\n                    \"ui.panel.lovelace.cards.shopping-list.clear_items\"\n                  )}\"\n                >\n                </ha-icon>\n              </div>\n              ${repeat(\n                this._checkedItems!,\n                (item) => item.id,\n                (item, index) =>\n                  html`\n                    <div class=\"editRow\">\n                      <paper-checkbox\n                        slot=\"item-icon\"\n                        id=\"${index}\"\n                        ?checked=\"${item.complete}\"\n                        .itemId=\"${item.id}\"\n                        @click=\"${this._completeItem}\"\n                        tabindex=\"0\"\n                      ></paper-checkbox>\n                      <paper-item-body>\n                        <paper-input\n                          no-label-float\n                          .value=\"${item.name}\"\n                          .itemId=\"${item.id}\"\n                          @change=\"${this._saveEdit}\"\n                        ></paper-input>\n                      </paper-item-body>\n                    </div>\n                  `\n              )}\n            `\n          : \"\"}\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .editRow,\n      .addRow {\n        display: flex;\n        flex-direction: row;\n      }\n\n      .addButton {\n        padding: 9px 15px 11px 15px;\n        cursor: pointer;\n      }\n\n      paper-item-body {\n        width: 75%;\n      }\n\n      paper-checkbox {\n        padding: 11px 11px 11px 18px;\n      }\n\n      paper-input {\n        --paper-input-container-underline: {\n          display: none;\n        }\n        --paper-input-container-underline-focus: {\n          display: none;\n        }\n        --paper-input-container-underline-disabled: {\n          display: none;\n        }\n        position: relative;\n        top: 1px;\n      }\n\n      .checked {\n        margin-left: 17px;\n        margin-bottom: 11px;\n        margin-top: 11px;\n      }\n\n      .label {\n        color: var(--primary-color);\n      }\n\n      .divider {\n        height: 1px;\n        background-color: var(--divider-color);\n        margin: 10px;\n      }\n\n      .clearall {\n        cursor: pointer;\n        margin-bottom: 3px;\n        float: right;\n        padding-right: 10px;\n      }\n\n      .addRow > ha-icon {\n        color: var(--secondary-text-color);\n      }\n    `;\n  }\n\n  private async _fetchData(): Promise<void> {\n    if (this.hass) {\n      const checkedItems: ShoppingListItem[] = [];\n      const uncheckedItems: ShoppingListItem[] = [];\n      const items = await fetchItems(this.hass);\n      for (const key in items) {\n        if (items[key].complete) {\n          checkedItems.push(items[key]);\n        } else {\n          uncheckedItems.push(items[key]);\n        }\n      }\n      this._checkedItems = checkedItems;\n      this._uncheckedItems = uncheckedItems;\n    }\n  }\n\n  private _completeItem(ev): void {\n    updateItem(this.hass!, ev.target.itemId, {\n      complete: ev.target.checked,\n    }).catch(() => this._fetchData());\n  }\n\n  private _saveEdit(ev): void {\n    updateItem(this.hass!, ev.target.itemId, {\n      name: ev.target.value,\n    }).catch(() => this._fetchData());\n\n    ev.target.blur();\n  }\n\n  private _clearItems(): void {\n    if (this.hass) {\n      clearItems(this.hass).catch(() => this._fetchData());\n    }\n  }\n\n  private get _newItem(): PaperInputElement {\n    return this.shadowRoot!.querySelector(\".addBox\") as PaperInputElement;\n  }\n\n  private _addItem(ev): void {\n    const newItem = this._newItem;\n\n    if (newItem.value!.length > 0) {\n      addItem(this.hass!, newItem.value!).catch(() => this._fetchData());\n    }\n\n    newItem.value = \"\";\n    if (ev) {\n      newItem.focus();\n    }\n  }\n\n  private _addKeyPress(ev): void {\n    if (ev.keyCode === 13) {\n      this._addItem(null);\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-shopping-list-card\": HuiShoppingListCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { HomeAssistant, ClimateEntity } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { loadRoundslider } from \"../../../resources/jquery.roundslider.ondemand\";\nimport { UNIT_F } from \"../../../common/const\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { ThermostatCardConfig } from \"./types\";\n\nconst thermostatConfig = {\n  radius: 150,\n  circleShape: \"pie\",\n  startAngle: 315,\n  width: 5,\n  lineCap: \"round\",\n  handleSize: \"+10\",\n  showTooltip: false,\n  animation: false,\n};\n\nconst modeIcons = {\n  auto: \"hass:autorenew\",\n  manual: \"hass:cursor-pointer\",\n  heat: \"hass:fire\",\n  cool: \"hass:snowflake\",\n  off: \"hass:power\",\n  fan_only: \"hass:fan\",\n  eco: \"hass:leaf\",\n  dry: \"hass:water-percent\",\n  idle: \"hass:power-sleep\",\n};\n\n@customElement(\"hui-thermostat-card\")\nexport class HuiThermostatCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-thermostat-card-editor\" */ \"../editor/config-elements/hui-thermostat-card-editor\");\n    return document.createElement(\"hui-thermostat-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { entity: \"\" };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: ThermostatCardConfig;\n\n  @property() private _roundSliderStyle?: TemplateResult;\n\n  @property() private _jQuery?: any;\n\n  private _broadCard?: boolean;\n\n  private _loaded?: boolean;\n\n  private _updated?: boolean;\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: ThermostatCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"climate\") {\n      throw new Error(\"Specify an entity from within the climate domain.\");\n    }\n\n    this._config = { theme: \"default\", ...config };\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (this._updated && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n    const stateObj = this.hass.states[this._config.entity] as ClimateEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    const mode = modeIcons[stateObj.attributes.operation_mode || \"\"]\n      ? stateObj.attributes.operation_mode!\n      : \"unknown-mode\";\n    return html`\n      ${this.renderStyle()}\n      <ha-card\n        class=\"${classMap({\n          [mode]: true,\n          large: this._broadCard!,\n          small: !this._broadCard,\n        })}\">\n        <div id=\"root\">\n          <paper-icon-button\n            icon=\"hass:dots-vertical\"\n            class=\"more-info\"\n            @click=\"${this._handleMoreInfo}\"\n          ></paper-icon-button>\n          <div id=\"thermostat\"></div>\n          <div id=\"tooltip\">\n            <div class=\"title\">${this._config.name ||\n              computeStateName(stateObj)}</div>\n            <div class=\"current-temperature\">\n              <span class=\"current-temperature-text\">\n                ${stateObj.attributes.current_temperature}\n                ${\n                  stateObj.attributes.current_temperature\n                    ? html`\n                        <span class=\"uom\"\n                          >${this.hass.config.unit_system.temperature}</span\n                        >\n                      `\n                    : \"\"\n                }\n              </span>\n            </div>\n            <div class=\"climate-info\">\n            <div id=\"set-temperature\"></div>\n            <div class=\"current-mode\">${this.hass!.localize(\n              `state.climate.${stateObj.state}`\n            )}</div>\n            <div class=\"modes\">\n              ${(stateObj.attributes.operation_list || []).map((modeItem) =>\n                this._renderIcon(modeItem, mode)\n              )}\n            </div>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected firstUpdated(): void {\n    this._updated = true;\n    if (this.isConnected && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass || !changedProps.has(\"hass\")) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as ClimateEntity;\n\n    if (!stateObj) {\n      return;\n    }\n\n    if (\n      this._jQuery &&\n      // If jQuery changed, we just rendered in firstUpdated\n      !changedProps.has(\"_jQuery\") &&\n      (!oldHass || oldHass.states[this._config.entity] !== stateObj)\n    ) {\n      const [sliderValue, uiValue] = this._genSliderValue(stateObj);\n\n      this._jQuery(\"#thermostat\", this.shadowRoot).roundSlider({\n        value: sliderValue,\n      });\n      this._updateSetTemp(uiValue);\n    }\n  }\n\n  private get _stepSize(): number {\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (stateObj.attributes.target_temp_step) {\n      return stateObj.attributes.target_temp_step;\n    }\n    return this.hass!.config.unit_system.temperature === UNIT_F ? 1 : 0.5;\n  }\n\n  private async _initialLoad(): Promise<void> {\n    const stateObj = this.hass!.states[this._config!.entity] as ClimateEntity;\n\n    if (!stateObj) {\n      // Card will require refresh to work again\n      return;\n    }\n\n    this._loaded = true;\n\n    await this.updateComplete;\n\n    let radius = this.clientWidth / 3.2;\n    this._broadCard = this.clientWidth > 390;\n\n    if (radius === 0) {\n      radius = 100;\n    }\n\n    (this.shadowRoot!.querySelector(\n      \"#thermostat\"\n    ) as HTMLElement)!.style.height = radius * 2 + \"px\";\n\n    const loaded = await loadRoundslider();\n\n    this._roundSliderStyle = loaded.roundSliderStyle;\n    this._jQuery = loaded.jQuery;\n\n    const _sliderType =\n      stateObj.attributes.target_temp_low &&\n      stateObj.attributes.target_temp_high\n        ? \"range\"\n        : \"min-range\";\n\n    const [sliderValue, uiValue] = this._genSliderValue(stateObj);\n\n    this._jQuery(\"#thermostat\", this.shadowRoot).roundSlider({\n      ...thermostatConfig,\n      radius,\n      min: stateObj.attributes.min_temp,\n      max: stateObj.attributes.max_temp,\n      sliderType: _sliderType,\n      change: (value) => this._setTemperature(value),\n      drag: (value) => this._dragEvent(value),\n      value: sliderValue,\n      step: this._stepSize,\n    });\n    this._updateSetTemp(uiValue);\n  }\n\n  private _genSliderValue(stateObj: ClimateEntity): [string | number, string] {\n    let sliderValue: string | number;\n    let uiValue: string;\n\n    if (\n      stateObj.attributes.target_temp_low &&\n      stateObj.attributes.target_temp_high\n    ) {\n      sliderValue = `${stateObj.attributes.target_temp_low}, ${\n        stateObj.attributes.target_temp_high\n      }`;\n      uiValue = this.formatTemp(\n        [\n          String(stateObj.attributes.target_temp_low),\n          String(stateObj.attributes.target_temp_high),\n        ],\n        false\n      );\n    } else {\n      sliderValue = stateObj.attributes.temperature;\n      uiValue =\n        stateObj.attributes.temperature !== null\n          ? String(stateObj.attributes.temperature)\n          : \"\";\n    }\n\n    return [sliderValue, uiValue];\n  }\n\n  private _updateSetTemp(value: string): void {\n    this.shadowRoot!.querySelector(\"#set-temperature\")!.innerHTML = value;\n  }\n\n  private _dragEvent(e): void {\n    this._updateSetTemp(this.formatTemp(String(e.value).split(\",\"), true));\n  }\n\n  private _setTemperature(e): void {\n    const stateObj = this.hass!.states[this._config!.entity] as ClimateEntity;\n    if (\n      stateObj.attributes.target_temp_low &&\n      stateObj.attributes.target_temp_high\n    ) {\n      if (e.handle.index === 1) {\n        this.hass!.callService(\"climate\", \"set_temperature\", {\n          entity_id: this._config!.entity,\n          target_temp_low: e.handle.value,\n          target_temp_high: stateObj.attributes.target_temp_high,\n        });\n      } else {\n        this.hass!.callService(\"climate\", \"set_temperature\", {\n          entity_id: this._config!.entity,\n          target_temp_low: stateObj.attributes.target_temp_low,\n          target_temp_high: e.handle.value,\n        });\n      }\n    } else {\n      this.hass!.callService(\"climate\", \"set_temperature\", {\n        entity_id: this._config!.entity,\n        temperature: e.value,\n      });\n    }\n  }\n\n  private _renderIcon(mode: string, currentMode: string): TemplateResult {\n    if (!modeIcons[mode]) {\n      return html``;\n    }\n    return html`\n      <ha-icon\n        class=\"${classMap({ \"selected-icon\": currentMode === mode })}\"\n        .mode=\"${mode}\"\n        .icon=\"${modeIcons[mode]}\"\n        @click=\"${this._handleModeClick}\"\n      ></ha-icon>\n    `;\n  }\n\n  private _handleMoreInfo() {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this._config!.entity,\n    });\n  }\n\n  private _handleModeClick(e: MouseEvent): void {\n    this.hass!.callService(\"climate\", \"set_operation_mode\", {\n      entity_id: this._config!.entity,\n      operation_mode: (e.currentTarget as any).mode,\n    });\n  }\n\n  private formatTemp(temps: string[], spaceStepSize: boolean): string {\n    temps = temps.filter(Boolean);\n\n    // If we are sliding the slider, append 0 to the temperatures if we're\n    // having a 0.5 step size, so that the text doesn't jump while sliding\n    if (spaceStepSize) {\n      const stepSize = this._stepSize;\n      temps = temps.map((val) =>\n        val.includes(\".\") || stepSize === 1 ? val : `${val}.0`\n      );\n    }\n\n    return temps.join(\"-\");\n  }\n\n  private renderStyle(): TemplateResult {\n    return html`\n      ${this._roundSliderStyle}\n      <style>\n        :host {\n          display: block;\n        }\n        ha-card {\n          overflow: hidden;\n          --rail-border-color: transparent;\n          --auto-color: green;\n          --eco-color: springgreen;\n          --cool-color: #2b9af9;\n          --heat-color: #ff8100;\n          --manual-color: #44739e;\n          --off-color: #8a8a8a;\n          --fan_only-color: #8a8a8a;\n          --dry-color: #efbd07;\n          --idle-color: #8a8a8a;\n          --unknown-color: #bac;\n        }\n        #root {\n          position: relative;\n          overflow: hidden;\n        }\n        .auto {\n          --mode-color: var(--auto-color);\n        }\n        .cool {\n          --mode-color: var(--cool-color);\n        }\n        .heat {\n          --mode-color: var(--heat-color);\n        }\n        .manual {\n          --mode-color: var(--manual-color);\n        }\n        .off {\n          --mode-color: var(--off-color);\n        }\n        .fan_only {\n          --mode-color: var(--fan_only-color);\n        }\n        .eco {\n          --mode-color: var(--eco-color);\n        }\n        .dry {\n          --mode-color: var(--dry-color);\n        }\n        .idle {\n          --mode-color: var(--idle-color);\n        }\n        .unknown-mode {\n          --mode-color: var(--unknown-color);\n        }\n        .no-title {\n          --title-position-top: 33% !important;\n        }\n        .large {\n          --thermostat-padding-top: 25px;\n          --thermostat-margin-bottom: 25px;\n          --title-font-size: 28px;\n          --title-position-top: 27%;\n          --climate-info-position-top: 81%;\n          --set-temperature-font-size: 25px;\n          --current-temperature-font-size: 71px;\n          --current-temperature-position-top: 10%;\n          --current-temperature-text-padding-left: 15px;\n          --uom-font-size: 20px;\n          --uom-margin-left: -18px;\n          --current-mode-font-size: 18px;\n          --set-temperature-margin-bottom: -5px;\n        }\n        .small {\n          --thermostat-padding-top: 15px;\n          --thermostat-margin-bottom: 15px;\n          --title-font-size: 18px;\n          --title-position-top: 28%;\n          --climate-info-position-top: 79%;\n          --set-temperature-font-size: 16px;\n          --current-temperature-font-size: 25px;\n          --current-temperature-position-top: 5%;\n          --current-temperature-text-padding-left: 7px;\n          --uom-font-size: 12px;\n          --uom-margin-left: -5px;\n          --current-mode-font-size: 14px;\n          --set-temperature-margin-bottom: 0px;\n        }\n        #thermostat {\n          margin: 0 auto var(--thermostat-margin-bottom);\n          padding-top: var(--thermostat-padding-top);\n        }\n        #thermostat .rs-range-color {\n          background-color: var(--mode-color, var(--disabled-text-color));\n        }\n        #thermostat .rs-path-color {\n          background-color: var(--disabled-text-color);\n        }\n        #thermostat .rs-handle {\n          background-color: var(--paper-card-background-color, white);\n          padding: 7px;\n          border: 2px solid var(--disabled-text-color);\n        }\n        #thermostat .rs-handle.rs-focus {\n          border-color: var(--mode-color, var(--disabled-text-color));\n        }\n        #thermostat .rs-handle:after {\n          border-color: var(--mode-color, var(--disabled-text-color));\n          background-color: var(--mode-color, var(--disabled-text-color));\n        }\n        #thermostat .rs-border {\n          border-color: var(--rail-border-color);\n        }\n        #thermostat .rs-bar.rs-transition.rs-first,\n        .rs-bar.rs-transition.rs-second {\n          z-index: 20 !important;\n        }\n        #thermostat .rs-inner.rs-bg-color.rs-border,\n        #thermostat .rs-overlay.rs-transition.rs-bg-color {\n          background-color: var(--paper-card-background-color, white);\n        }\n        #tooltip {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 100%;\n          text-align: center;\n          z-index: 15;\n          color: var(--primary-text-color);\n        }\n        #set-temperature {\n          font-size: var(--set-temperature-font-size);\n          margin-bottom: var(--set-temperature-margin-bottom);\n        }\n        .title {\n          font-size: var(--title-font-size);\n          position: absolute;\n          top: var(--title-position-top);\n          left: 50%;\n          transform: translate(-50%, -50%);\n        }\n        .climate-info {\n          position: absolute;\n          top: var(--climate-info-position-top);\n          left: 50%;\n          transform: translate(-50%, -50%);\n          width: 100%;\n        }\n        .current-mode {\n          font-size: var(--current-mode-font-size);\n          color: var(--secondary-text-color);\n        }\n        .modes {\n          margin-top: 16px;\n        }\n        .modes ha-icon {\n          color: var(--disabled-text-color);\n          cursor: pointer;\n          display: inline-block;\n          margin: 0 10px;\n        }\n        .modes ha-icon.selected-icon {\n          color: var(--mode-color);\n        }\n        .current-temperature {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          font-size: var(--current-temperature-font-size);\n        }\n        .current-temperature-text {\n          padding-left: var(--current-temperature-text-padding-left);\n        }\n        .uom {\n          font-size: var(--uom-font-size);\n          vertical-align: top;\n          margin-left: var(--uom-margin-left);\n        }\n        .more-info {\n          position: absolute;\n          cursor: pointer;\n          top: 0;\n          right: 0;\n          z-index: 25;\n          color: var(--secondary-text-color);\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-thermostat-card\": HuiThermostatCard;\n  }\n}\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport computeStateName from \"../common/entity/compute_state_name\";\n\nimport \"../components/ha-card\";\nimport \"../components/ha-icon\";\n\nimport { EventsMixin } from \"../mixins/events-mixin\";\nimport LocalizeMixin from \"../mixins/localize-mixin\";\nimport { computeRTL } from \"../common/util/compute_rtl\";\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaWeatherCard extends LocalizeMixin(EventsMixin(PolymerElement)) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          cursor: pointer;\n        }\n\n        .content {\n          padding: 0 20px 20px;\n        }\n\n        ha-icon,\n        .ha-img {\n          color: var(--paper-item-icon-color);\n        }\n\n        .header {\n          font-family: var(--paper-font-headline_-_font-family);\n          -webkit-font-smoothing: var(\n            --paper-font-headline_-_-webkit-font-smoothing\n          );\n          font-size: var(--paper-font-headline_-_font-size);\n          font-weight: var(--paper-font-headline_-_font-weight);\n          letter-spacing: var(--paper-font-headline_-_letter-spacing);\n          line-height: var(--paper-font-headline_-_line-height);\n          text-rendering: var(\n            --paper-font-common-expensive-kerning_-_text-rendering\n          );\n          opacity: var(--dark-primary-opacity);\n          padding: 24px 16px 16px;\n          display: flex;\n          align-items: baseline;\n        }\n\n        .name {\n          margin-left: 16px;\n          font-size: 16px;\n          color: var(--secondary-text-color);\n        }\n\n        :host([rtl]) .name {\n          margin-left: 0px;\n          margin-right: 16px;\n        }\n\n        .now {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          flex-wrap: wrap;\n        }\n\n        .main {\n          display: flex;\n          align-items: center;\n          margin-right: 32px;\n        }\n\n        :host([rtl]) .main {\n          margin-right: 0px;\n        }\n\n        .main ha-icon,\n        .main .ha-img {\n          --iron-icon-height: 72px;\n          --iron-icon-width: 72px;\n          margin-right: 8px;\n        }\n\n        :host([rtl]) .main ha-icon {\n          margin-right: 0px;\n        }\n\n        :host([rtl]) .main .ha-img {\n          margin-right: 0px;\n        }\n\n        .main .temp {\n          font-size: 52px;\n          line-height: 1em;\n          position: relative;\n        }\n\n        :host([rtl]) .main .temp {\n          direction: ltr;\n          margin-right: 28px;\n        }\n\n        .main .temp span {\n          font-size: 24px;\n          line-height: 1em;\n          position: absolute;\n          top: 4px;\n        }\n\n        .measurand {\n          display: inline-block;\n        }\n\n        :host([rtl]) .measurand {\n          direction: ltr;\n        }\n\n        .forecast {\n          margin-top: 16px;\n          display: flex;\n          justify-content: space-between;\n        }\n\n        .forecast div {\n          flex: 0 0 auto;\n          text-align: center;\n        }\n\n        .forecast .icon,\n        .forecast .icon-image {\n          margin: 4px 0;\n          text-align: center;\n        }\n\n        .forecast .icon-image {\n          width: 32px;\n        }\n\n        :host([rtl]) .forecast .temp {\n          direction: ltr;\n        }\n\n        .weekday {\n          font-weight: bold;\n        }\n\n        .attributes,\n        .templow,\n        .precipitation {\n          color: var(--secondary-text-color);\n        }\n\n        :host([rtl]) .precipitation {\n          direction: ltr;\n        }\n      </style>\n      <ha-card>\n        <div class=\"header\">\n          [[computeState(stateObj.state, localize)]]\n          <div class=\"name\">[[computeName(stateObj)]]</div>\n        </div>\n        <div class=\"content\">\n          <div class=\"now\">\n            <div class=\"main\">\n              <template is=\"dom-if\" if=\"[[showWeatherIcon(stateObj.state)]]\">\n                <ha-icon icon=\"[[getWeatherIcon(stateObj.state)]]\"></ha-icon>\n              </template>\n              <template is=\"dom-if\" if=\"[[showWeatherImg(stateObj.state)]]\">\n                <img class=\"ha-img\" src=\"[[stateObj.state]]\" alt=\"state\" />\n              </template>\n              <div class=\"temp\">\n                [[stateObj.attributes.temperature]]<span\n                  >[[getUnit('temperature')]]</span\n                >\n              </div>\n            </div>\n            <div class=\"attributes\">\n              <template\n                is=\"dom-if\"\n                if=\"[[_showValue(stateObj.attributes.pressure)]]\"\n              >\n                <div>\n                  [[localize('ui.card.weather.attributes.air_pressure')]]:\n                  <span class=\"measurand\">\n                    [[stateObj.attributes.pressure]] [[getUnit('air_pressure')]]\n                  </span>\n                </div>\n              </template>\n              <template\n                is=\"dom-if\"\n                if=\"[[_showValue(stateObj.attributes.humidity)]]\"\n              >\n                <div>\n                  [[localize('ui.card.weather.attributes.humidity')]]:\n                  <span class=\"measurand\"\n                    >[[stateObj.attributes.humidity]] %</span\n                  >\n                </div>\n              </template>\n              <template\n                is=\"dom-if\"\n                if=\"[[_showValue(stateObj.attributes.wind_speed)]]\"\n              >\n                <div>\n                  [[localize('ui.card.weather.attributes.wind_speed')]]:\n                  <span class=\"measurand\">\n                    [[getWindSpeed(stateObj.attributes.wind_speed)]]\n                  </span>\n                  [[getWindBearing(stateObj.attributes.wind_bearing, localize)]]\n                </div>\n              </template>\n            </div>\n          </div>\n          <template is=\"dom-if\" if=\"[[forecast]]\">\n            <div class=\"forecast\">\n              <template is=\"dom-repeat\" items=\"[[forecast]]\">\n                <div>\n                  <div class=\"weekday\">\n                    [[computeDate(item.datetime)]]<br />\n                    <template is=\"dom-if\" if=\"[[!_showValue(item.templow)]]\">\n                      [[computeTime(item.datetime)]]\n                    </template>\n                  </div>\n                  <template\n                    is=\"dom-if\"\n                    if=\"[[showWeatherAsCondition(item.condition)]]\"\n                  >\n                    <div class=\"icon\">\n                      <ha-icon\n                        icon=\"[[getWeatherIcon(item.condition)]]\"\n                      ></ha-icon>\n                    </div>\n                  </template>\n                  <template\n                    is=\"dom-if\"\n                    if=\"[[showWeatherImg(item.condition)]]\"\n                  >\n                    <div class=\"icon\">\n                      <img\n                        class=\"icon-image\"\n                        src=\"[[item.condition]]\"\n                        alt=\"state\"\n                      />\n                    </div>\n                  </template>\n                  <template is=\"dom-if\" if=\"[[_showValue(item.temperature)]]\">\n                    <div class=\"temp\">\n                      [[item.temperature]] [[getUnit('temperature')]]\n                    </div>\n                  </template>\n                  <template is=\"dom-if\" if=\"[[_showValue(item.templow)]]\">\n                    <div class=\"templow\">\n                      [[item.templow]] [[getUnit('temperature')]]\n                    </div>\n                  </template>\n                  <template is=\"dom-if\" if=\"[[_showValue(item.precipitation)]]\">\n                    <div class=\"precipitation\">\n                      [[item.precipitation]] [[getUnit('precipitation')]]\n                    </div>\n                  </template>\n                </div>\n              </template>\n            </div>\n          </template>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      config: Object,\n      stateObj: Object,\n      forecast: {\n        type: Array,\n        computed: \"computeForecast(stateObj.attributes.forecast)\",\n      },\n      rtl: {\n        type: Boolean,\n        reflectToAttribute: true,\n        computed: \"_computeRTL(hass)\",\n      },\n    };\n  }\n\n  constructor() {\n    super();\n    this.cardinalDirections = [\n      \"N\",\n      \"NNE\",\n      \"NE\",\n      \"ENE\",\n      \"E\",\n      \"ESE\",\n      \"SE\",\n      \"SSE\",\n      \"S\",\n      \"SSW\",\n      \"SW\",\n      \"WSW\",\n      \"W\",\n      \"WNW\",\n      \"NW\",\n      \"NNW\",\n      \"N\",\n    ];\n    this.weatherIcons = {\n      \"clear-night\": \"hass:weather-night\",\n      cloudy: \"hass:weather-cloudy\",\n      fog: \"hass:weather-fog\",\n      hail: \"hass:weather-hail\",\n      lightning: \"hass:weather-lightning\",\n      \"lightning-rainy\": \"hass:weather-lightning-rainy\",\n      partlycloudy: \"hass:weather-partlycloudy\",\n      pouring: \"hass:weather-pouring\",\n      rainy: \"hass:weather-rainy\",\n      snowy: \"hass:weather-snowy\",\n      \"snowy-rainy\": \"hass:weather-snowy-rainy\",\n      sunny: \"hass:weather-sunny\",\n      windy: \"hass:weather-windy\",\n      \"windy-variant\": \"hass:weather-windy-variant\",\n    };\n  }\n\n  ready() {\n    this.addEventListener(\"click\", this._onClick);\n    super.ready();\n  }\n\n  _onClick() {\n    this.fire(\"hass-more-info\", { entityId: this.stateObj.entity_id });\n  }\n\n  computeForecast(forecast) {\n    return forecast && forecast.slice(0, 5);\n  }\n\n  getUnit(measure) {\n    const lengthUnit = this.hass.config.unit_system.length || \"\";\n    switch (measure) {\n      case \"air_pressure\":\n        return lengthUnit === \"km\" ? \"hPa\" : \"inHg\";\n      case \"length\":\n        return lengthUnit;\n      case \"precipitation\":\n        return lengthUnit === \"km\" ? \"mm\" : \"in\";\n      default:\n        return this.hass.config.unit_system[measure] || \"\";\n    }\n  }\n\n  computeState(state, localize) {\n    return (\n      localize(`state.weather.${state}`) ||\n      ((state || \"\").toString().match(/\\.png|\\.svg|\\.jpg|\\.jpeg/i) ? \"\" : state)\n    );\n  }\n\n  computeName(stateObj) {\n    return (this.config && this.config.name) || computeStateName(stateObj);\n  }\n\n  showWeatherIcon(condition) {\n    return condition in this.weatherIcons;\n  }\n\n  showWeatherImg(iconURL) {\n    return (iconURL || \"\").toString().match(/\\.png|\\.svg|\\.jpg|\\.jpeg/i);\n  }\n\n  showWeatherAsCondition(condition) {\n    return condition\n      ? !(condition || \"\").toString().match(/\\.png|\\.svg|\\.jpg|\\.jpeg/i)\n      : false;\n  }\n\n  getWeatherIcon(condition) {\n    return this.weatherIcons[condition];\n  }\n\n  windBearingToText(degree) {\n    const degreenum = parseInt(degree);\n    if (isFinite(degreenum)) {\n      return this.cardinalDirections[(((degreenum + 11.25) / 22.5) | 0) % 16];\n    }\n    return degree;\n  }\n\n  getWindSpeed(speed) {\n    return `${speed} ${this.getUnit(\"length\")}/h`;\n  }\n\n  getWindBearing(bearing, localize) {\n    if (bearing != null) {\n      const cardinalDirection = this.windBearingToText(bearing);\n      return `(${localize(\n        `ui.card.weather.cardinal_direction.${cardinalDirection.toLowerCase()}`\n      ) || cardinalDirection})`;\n    }\n    return ``;\n  }\n\n  _showValue(item) {\n    return typeof item !== \"undefined\" && item !== null;\n  }\n\n  computeDate(data) {\n    const date = new Date(data);\n    return date.toLocaleDateString(this.hass.language, { weekday: \"short\" });\n  }\n\n  computeTime(data) {\n    const date = new Date(data);\n    return date.toLocaleTimeString(this.hass.language, { hour: \"numeric\" });\n  }\n\n  _computeRTL(hass) {\n    return computeRTL(hass);\n  }\n}\ncustomElements.define(\"ha-weather-card\", HaWeatherCard);\n","import \"../../../cards/ha-weather-card\";\n\nimport LegacyWrapperCard from \"./hui-legacy-wrapper-card\";\n\nclass HuiWeatherForecastCard extends LegacyWrapperCard {\n  static async getConfigElement() {\n    await import(/* webpackChunkName: \"hui-weather-forecast-card-editor\" */ \"../editor/config-elements/hui-weather-forecast-card-editor\");\n    return document.createElement(\"hui-weather-forecast-card-editor\");\n  }\n\n  static getStubConfig() {\n    return {};\n  }\n\n  constructor() {\n    super(\"ha-weather-card\", \"weather\");\n  }\n\n  getCardSize() {\n    return 4;\n  }\n}\n\ncustomElements.define(\"hui-weather-forecast-card\", HuiWeatherForecastCard);\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport { styleMap } from \"lit-html/directives/style-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-warning\";\n\nimport isValidEntityId from \"../../../common/entity/valid_entity_id\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { GaugeCardConfig } from \"./types\";\n\nexport const severityMap = {\n  red: \"var(--label-badge-red)\",\n  green: \"var(--label-badge-green)\",\n  yellow: \"var(--label-badge-yellow)\",\n  normal: \"var(--label-badge-blue)\",\n};\n\n@customElement(\"hui-gauge-card\")\nclass HuiGaugeCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-gauge-card-editor\" */ \"../editor/config-elements/hui-gauge-card-editor\");\n    return document.createElement(\"hui-gauge-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _baseUnit = \"50px\";\n  @property() private _config?: GaugeCardConfig;\n\n  private _updated?: boolean;\n\n  public getCardSize(): number {\n    return 2;\n  }\n\n  public setConfig(config: GaugeCardConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid card configuration\");\n    }\n    if (!isValidEntityId(config.entity)) {\n      throw new Error(\"Invalid Entity\");\n    }\n    this._config = { min: 0, max: 100, theme: \"default\", ...config };\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._setBaseUnit();\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    const state = Number(stateObj.state);\n\n    if (isNaN(state)) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_non_numeric\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card\n        @click=\"${this._handleClick}\"\n        style=${styleMap({\n          \"--base-unit\": this._baseUnit,\n        })}\n      >\n        <div class=\"container\">\n          <div class=\"gauge-a\"></div>\n          <div class=\"gauge-b\"></div>\n          <div\n            class=\"gauge-c\"\n            style=${styleMap({\n              transform: `rotate(${this._translateTurn(state)}turn)`,\n              \"background-color\": this._computeSeverity(state),\n            })}\n          ></div>\n          <div class=\"gauge-data\">\n            <div id=\"percent\">\n              ${stateObj.state}\n              ${this._config.unit ||\n                stateObj.attributes.unit_of_measurement ||\n                \"\"}\n            </div>\n            <div id=\"name\">\n              ${this._config.name || computeStateName(stateObj)}\n            </div>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected firstUpdated(): void {\n    this._updated = true;\n    this._setBaseUnit();\n    this.classList.add(\"init\");\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  private _setBaseUnit(): void {\n    if (!this.isConnected || !this._updated) {\n      return;\n    }\n    const baseUnit = this._computeBaseUnit();\n    if (baseUnit !== \"0px\") {\n      this._baseUnit = baseUnit;\n    }\n  }\n\n  private _computeSeverity(numberValue: number): string {\n    const sections = this._config!.severity;\n\n    if (!sections) {\n      return severityMap.normal;\n    }\n\n    const sectionsArray = Object.keys(sections);\n    const sortable = sectionsArray.map((severity) => [\n      severity,\n      sections[severity],\n    ]);\n\n    for (const severity of sortable) {\n      if (severityMap[severity[0]] == null || isNaN(severity[1])) {\n        return severityMap.normal;\n      }\n    }\n    sortable.sort((a, b) => a[1] - b[1]);\n\n    if (numberValue >= sortable[0][1] && numberValue < sortable[1][1]) {\n      return severityMap[sortable[0][0]];\n    }\n    if (numberValue >= sortable[1][1] && numberValue < sortable[2][1]) {\n      return severityMap[sortable[1][0]];\n    }\n    if (numberValue >= sortable[2][1]) {\n      return severityMap[sortable[2][0]];\n    }\n    return severityMap.normal;\n  }\n\n  private _translateTurn(value: number): number {\n    const { min, max } = this._config!;\n    const maxTurnValue = Math.min(Math.max(value, min!), max!);\n    return (5 * (maxTurnValue - min!)) / (max! - min!) / 10;\n  }\n\n  private _computeBaseUnit(): string {\n    return this.clientWidth < 200 ? this.clientWidth / 5 + \"px\" : \"50px\";\n  }\n\n  private _handleClick(): void {\n    fireEvent(this, \"hass-more-info\", { entityId: this._config!.entity });\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        height: calc(var(--base-unit) * 3);\n        position: relative;\n        cursor: pointer;\n      }\n      .container {\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2);\n        position: absolute;\n        top: calc(var(--base-unit) * 1.5);\n        left: 50%;\n        overflow: hidden;\n        text-align: center;\n        transform: translate(-50%, -50%);\n      }\n      .gauge-a {\n        z-index: 1;\n        position: absolute;\n        background-color: var(--primary-background-color);\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2);\n        top: 0%;\n        border-radius: calc(var(--base-unit) * 2.5) calc(var(--base-unit) * 2.5)\n          0px 0px;\n      }\n      .gauge-b {\n        z-index: 3;\n        position: absolute;\n        background-color: var(--paper-card-background-color);\n        width: calc(var(--base-unit) * 2.5);\n        height: calc(var(--base-unit) * 1.25);\n        top: calc(var(--base-unit) * 0.75);\n        margin-left: calc(var(--base-unit) * 0.75);\n        margin-right: auto;\n        border-radius: calc(var(--base-unit) * 2.5) calc(var(--base-unit) * 2.5)\n          0px 0px;\n      }\n      .gauge-c {\n        z-index: 2;\n        position: absolute;\n        background-color: var(--label-badge-blue);\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2);\n        top: calc(var(--base-unit) * 2);\n        margin-left: auto;\n        margin-right: auto;\n        border-radius: 0px 0px calc(var(--base-unit) * 2)\n          calc(var(--base-unit) * 2);\n        transform-origin: center top;\n      }\n      .init .gauge-c {\n        transition: all 1.3s ease-in-out;\n      }\n      .gauge-data {\n        z-index: 4;\n        color: var(--primary-text-color);\n        line-height: calc(var(--base-unit) * 0.3);\n        position: absolute;\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2.1);\n        top: calc(var(--base-unit) * 1.2);\n        margin-left: auto;\n        margin-right: auto;\n      }\n      .init .gauge-data {\n        transition: all 1s ease-out;\n      }\n      .gauge-data #percent {\n        font-size: calc(var(--base-unit) * 0.55);\n      }\n      .gauge-data #name {\n        padding-top: calc(var(--base-unit) * 0.15);\n        font-size: calc(var(--base-unit) * 0.3);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-gauge-card\": HuiGaugeCard;\n  }\n}\n","import deepClone from \"deep-clone-simple\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\n\nimport \"../cards/hui-alarm-panel-card\";\nimport \"../cards/hui-conditional-card\";\nimport \"../cards/hui-entities-card\";\nimport \"../cards/hui-entity-button-card\";\nimport \"../cards/hui-entity-filter-card\";\nimport {\n  createErrorCardElement,\n  createErrorCardConfig,\n  HuiErrorCard,\n} from \"../cards/hui-error-card\";\nimport \"../cards/hui-glance-card\";\nimport \"../cards/hui-history-graph-card\";\nimport \"../cards/hui-horizontal-stack-card\";\nimport \"../cards/hui-iframe-card\";\nimport \"../cards/hui-light-card\";\nimport \"../cards/hui-map-card\";\nimport \"../cards/hui-markdown-card\";\nimport \"../cards/hui-media-control-card\";\nimport \"../cards/hui-picture-card\";\nimport \"../cards/hui-picture-elements-card\";\nimport \"../cards/hui-picture-entity-card\";\nimport \"../cards/hui-picture-glance-card\";\nimport \"../cards/hui-plant-status-card\";\nimport \"../cards/hui-sensor-card\";\nimport \"../cards/hui-vertical-stack-card\";\nimport \"../cards/hui-shopping-list-card\";\nimport \"../cards/hui-thermostat-card\";\nimport \"../cards/hui-weather-forecast-card\";\nimport \"../cards/hui-gauge-card\";\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\n\nconst CARD_TYPES = new Set([\n  \"alarm-panel\",\n  \"conditional\",\n  \"entities\",\n  \"entity-button\",\n  \"entity-filter\",\n  \"error\",\n  \"gauge\",\n  \"glance\",\n  \"history-graph\",\n  \"horizontal-stack\",\n  \"iframe\",\n  \"light\",\n  \"map\",\n  \"markdown\",\n  \"media-control\",\n  \"picture\",\n  \"picture-elements\",\n  \"picture-entity\",\n  \"picture-glance\",\n  \"plant-status\",\n  \"sensor\",\n  \"shopping-list\",\n  \"thermostat\",\n  \"vertical-stack\",\n  \"weather-forecast\",\n]);\nconst CUSTOM_TYPE_PREFIX = \"custom:\";\nconst TIMEOUT = 2000;\n\nconst _createElement = (\n  tag: string,\n  config: LovelaceCardConfig\n): LovelaceCard | HuiErrorCard => {\n  const element = document.createElement(tag) as LovelaceCard;\n  try {\n    element.setConfig(deepClone(config));\n  } catch (err) {\n    // tslint:disable-next-line\n    console.error(tag, err);\n    return _createErrorElement(err.message, config);\n  }\n  return element;\n};\n\nconst _createErrorElement = (\n  error: string,\n  config: LovelaceCardConfig\n): HuiErrorCard => createErrorCardElement(createErrorCardConfig(error, config));\n\nexport const createCardElement = (\n  config: LovelaceCardConfig\n): LovelaceCard | HuiErrorCard => {\n  if (!config || typeof config !== \"object\" || !config.type) {\n    return _createErrorElement(\"No card type configured.\", config);\n  }\n\n  if (config.type.startsWith(CUSTOM_TYPE_PREFIX)) {\n    const tag = config.type.substr(CUSTOM_TYPE_PREFIX.length);\n\n    if (customElements.get(tag)) {\n      return _createElement(tag, config);\n    }\n    const element = _createErrorElement(\n      `Custom element doesn't exist: ${tag}.`,\n      config\n    );\n    element.style.display = \"None\";\n    const timer = window.setTimeout(() => {\n      element.style.display = \"\";\n    }, TIMEOUT);\n\n    customElements.whenDefined(tag).then(() => {\n      clearTimeout(timer);\n      fireEvent(element, \"ll-rebuild\");\n    });\n\n    return element;\n  }\n\n  if (!CARD_TYPES.has(config.type)) {\n    return _createErrorElement(\n      `Unknown card type encountered: ${config.type}.`,\n      config\n    );\n  }\n\n  return _createElement(`hui-${config.type}-card`, config);\n};\n","import { PolymerElement } from \"@polymer/polymer/polymer-element\";\nimport { IronResizableBehavior } from \"@polymer/iron-resizable-behavior/iron-resizable-behavior\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { Debouncer } from \"@polymer/polymer/lib/utils/debounce\";\nimport { timeOut } from \"@polymer/polymer/lib/utils/async\";\nimport { mixinBehaviors } from \"@polymer/polymer/lib/legacy/class\";\n\nimport formatTime from \"../../common/datetime/format_time\";\n// eslint-disable-next-line no-unused-vars\n/* global Chart moment Color */\n\nlet scriptsLoaded = null;\n\nclass HaChartBase extends mixinBehaviors(\n  [IronResizableBehavior],\n  PolymerElement\n) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n        }\n        .chartHeader {\n          padding: 6px 0 0 0;\n          width: 100%;\n          display: flex;\n          flex-direction: row;\n        }\n        .chartHeader > div {\n          vertical-align: top;\n          padding: 0 8px;\n        }\n        .chartHeader > div.chartTitle {\n          padding-top: 8px;\n          flex: 0 0 0;\n          max-width: 30%;\n        }\n        .chartHeader > div.chartLegend {\n          flex: 1 1;\n          min-width: 70%;\n        }\n        :root {\n          user-select: none;\n          -moz-user-select: none;\n          -webkit-user-select: none;\n          -ms-user-select: none;\n        }\n        .chartTooltip {\n          font-size: 90%;\n          opacity: 1;\n          position: absolute;\n          background: rgba(80, 80, 80, 0.9);\n          color: white;\n          border-radius: 3px;\n          pointer-events: none;\n          transform: translate(-50%, 12px);\n          z-index: 1000;\n          width: 200px;\n          transition: opacity 0.15s ease-in-out;\n        }\n        :host([rtl]) .chartTooltip {\n          direction: rtl;\n        }\n        .chartLegend ul,\n        .chartTooltip ul {\n          display: inline-block;\n          padding: 0 0px;\n          margin: 5px 0 0 0;\n          width: 100%;\n        }\n        .chartTooltip li {\n          display: block;\n          white-space: pre-line;\n        }\n        .chartTooltip .title {\n          text-align: center;\n          font-weight: 500;\n        }\n        .chartLegend li {\n          display: inline-block;\n          padding: 0 6px;\n          max-width: 49%;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          overflow: hidden;\n          box-sizing: border-box;\n        }\n        .chartLegend li:nth-child(odd):last-of-type {\n          /* Make last item take full width if it is odd-numbered. */\n          max-width: 100%;\n        }\n        .chartLegend li[data-hidden] {\n          text-decoration: line-through;\n        }\n        .chartLegend em,\n        .chartTooltip em {\n          border-radius: 5px;\n          display: inline-block;\n          height: 10px;\n          margin-right: 4px;\n          width: 10px;\n        }\n        :host([rtl]) .chartTooltip em {\n          margin-right: inherit;\n          margin-left: 4px;\n        }\n        paper-icon-button {\n          color: var(--secondary-text-color);\n        }\n      </style>\n      <template is=\"dom-if\" if=\"[[unit]]\">\n        <div class=\"chartHeader\">\n          <div class=\"chartTitle\">[[unit]]</div>\n          <div class=\"chartLegend\">\n            <ul>\n              <template is=\"dom-repeat\" items=\"[[metas]]\">\n                <li on-click=\"_legendClick\" data-hidden$=\"[[item.hidden]]\">\n                  <em style$=\"background-color:[[item.bgColor]]\"></em>\n                  [[item.label]]\n                </li>\n              </template>\n            </ul>\n          </div>\n        </div>\n      </template>\n      <div id=\"chartTarget\" style=\"height:40px; width:100%\">\n        <canvas id=\"chartCanvas\"></canvas>\n        <div\n          class$=\"chartTooltip [[tooltip.yAlign]]\"\n          style$=\"opacity:[[tooltip.opacity]]; top:[[tooltip.top]]; left:[[tooltip.left]]; padding:[[tooltip.yPadding]]px [[tooltip.xPadding]]px\"\n        >\n          <div class=\"title\">[[tooltip.title]]</div>\n          <div>\n            <ul>\n              <template is=\"dom-repeat\" items=\"[[tooltip.lines]]\">\n                <li>\n                  <em style$=\"background-color:[[item.bgColor]]\"></em\n                  >[[item.text]]\n                </li>\n              </template>\n            </ul>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  get chart() {\n    return this._chart;\n  }\n\n  static get properties() {\n    return {\n      data: Object,\n      identifier: String,\n      rendered: {\n        type: Boolean,\n        notify: true,\n        value: false,\n        readOnly: true,\n      },\n      metas: {\n        type: Array,\n        value: () => [],\n      },\n      tooltip: {\n        type: Object,\n        value: () => ({\n          opacity: \"0\",\n          left: \"0\",\n          top: \"0\",\n          xPadding: \"5\",\n          yPadding: \"3\",\n        }),\n      },\n      unit: Object,\n      rtl: {\n        type: Boolean,\n        reflectToAttribute: true,\n      },\n    };\n  }\n\n  static get observers() {\n    return [\"onPropsChange(data)\"];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._isAttached = true;\n    this.onPropsChange();\n    this._resizeListener = () => {\n      this._debouncer = Debouncer.debounce(\n        this._debouncer,\n        timeOut.after(10),\n        () => {\n          if (this._isAttached) {\n            this.resizeChart();\n          }\n        }\n      );\n    };\n\n    if (typeof ResizeObserver === \"function\") {\n      this.resizeObserver = new ResizeObserver((entries) => {\n        entries.forEach(() => {\n          this._resizeListener();\n        });\n      });\n      this.resizeObserver.observe(this.$.chartTarget);\n    } else {\n      this.addEventListener(\"iron-resize\", this._resizeListener);\n    }\n\n    if (scriptsLoaded === null) {\n      scriptsLoaded = import(/* webpackChunkName: \"load_chart\" */ \"../../resources/ha-chart-scripts.js\");\n    }\n    scriptsLoaded.then((ChartModule) => {\n      this.ChartClass = ChartModule.default;\n      this.onPropsChange();\n    });\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this._isAttached = false;\n    if (this.resizeObserver) {\n      this.resizeObserver.unobserve(this.$.chartTarget);\n    }\n\n    this.removeEventListener(\"iron-resize\", this._resizeListener);\n\n    if (this._resizeTimer !== undefined) {\n      clearInterval(this._resizeTimer);\n      this._resizeTimer = undefined;\n    }\n  }\n\n  onPropsChange() {\n    if (!this._isAttached || !this.ChartClass || !this.data) {\n      return;\n    }\n    this.drawChart();\n  }\n\n  _customTooltips(tooltip) {\n    // Hide if no tooltip\n    if (tooltip.opacity === 0) {\n      this.set([\"tooltip\", \"opacity\"], 0);\n      return;\n    }\n    // Set caret Position\n    if (tooltip.yAlign) {\n      this.set([\"tooltip\", \"yAlign\"], tooltip.yAlign);\n    } else {\n      this.set([\"tooltip\", \"yAlign\"], \"no-transform\");\n    }\n\n    const title = tooltip.title ? tooltip.title[0] || \"\" : \"\";\n    this.set([\"tooltip\", \"title\"], title);\n\n    const bodyLines = tooltip.body.map((n) => n.lines);\n\n    // Set Text\n    if (tooltip.body) {\n      this.set(\n        [\"tooltip\", \"lines\"],\n        bodyLines.map((body, i) => {\n          const colors = tooltip.labelColors[i];\n          return {\n            color: colors.borderColor,\n            bgColor: colors.backgroundColor,\n            text: body.join(\"\\n\"),\n          };\n        })\n      );\n    }\n    const parentWidth = this.$.chartTarget.clientWidth;\n    let positionX = tooltip.caretX;\n    const positionY = this._chart.canvas.offsetTop + tooltip.caretY;\n    if (tooltip.caretX + 100 > parentWidth) {\n      positionX = parentWidth - 100;\n    } else if (tooltip.caretX < 100) {\n      positionX = 100;\n    }\n    positionX += this._chart.canvas.offsetLeft;\n    // Display, position, and set styles for font\n    this.tooltip = Object.assign({}, this.tooltip, {\n      opacity: 1,\n      left: `${positionX}px`,\n      top: `${positionY}px`,\n    });\n  }\n\n  _legendClick(event) {\n    event = event || window.event;\n    event.stopPropagation();\n    let target = event.target || event.srcElement;\n    while (target.nodeName !== \"LI\") {\n      // user clicked child, find parent LI\n      target = target.parentElement;\n    }\n    const index = event.model.itemsIndex;\n\n    const meta = this._chart.getDatasetMeta(index);\n    meta.hidden =\n      meta.hidden === null ? !this._chart.data.datasets[index].hidden : null;\n    this.set(\n      [\"metas\", index, \"hidden\"],\n      this._chart.isDatasetVisible(index) ? null : \"hidden\"\n    );\n    this._chart.update();\n  }\n\n  _drawLegend() {\n    const chart = this._chart;\n    // New data for old graph. Keep metadata.\n    const preserveVisibility =\n      this._oldIdentifier && this.identifier === this._oldIdentifier;\n    this._oldIdentifier = this.identifier;\n    this.set(\n      \"metas\",\n      this._chart.data.datasets.map((x, i) => ({\n        label: x.label,\n        color: x.color,\n        bgColor: x.backgroundColor,\n        hidden:\n          preserveVisibility && i < this.metas.length\n            ? this.metas[i].hidden\n            : !chart.isDatasetVisible(i),\n      }))\n    );\n    let updateNeeded = false;\n    if (preserveVisibility) {\n      for (let i = 0; i < this.metas.length; i++) {\n        const meta = chart.getDatasetMeta(i);\n        if (!!meta.hidden !== !!this.metas[i].hidden) updateNeeded = true;\n        meta.hidden = this.metas[i].hidden ? true : null;\n      }\n    }\n    if (updateNeeded) {\n      chart.update();\n    }\n    this.unit = this.data.unit;\n  }\n\n  _formatTickValue(value, index, values) {\n    if (values.length === 0) {\n      return value;\n    }\n    const date = new Date(values[index].value);\n    return formatTime(date);\n  }\n\n  drawChart() {\n    const data = this.data.data;\n    const ctx = this.$.chartCanvas;\n\n    if ((!data.datasets || !data.datasets.length) && !this._chart) {\n      return;\n    }\n    if (this.data.type !== \"timeline\" && data.datasets.length > 0) {\n      const cnt = data.datasets.length;\n      const colors = this.constructor.getColorList(cnt);\n      for (let loopI = 0; loopI < cnt; loopI++) {\n        data.datasets[loopI].borderColor = colors[loopI].rgbString();\n        data.datasets[loopI].backgroundColor = colors[loopI]\n          .alpha(0.6)\n          .rgbaString();\n      }\n    }\n\n    if (this._chart) {\n      this._customTooltips({ opacity: 0 });\n      this._chart.data = data;\n      this._chart.update({ duration: 0 });\n      if (this.isTimeline) {\n        this._chart.options.scales.yAxes[0].gridLines.display = data.length > 1;\n      } else if (this.data.legend === true) {\n        this._drawLegend();\n      }\n      this.resizeChart();\n    } else {\n      if (!data.datasets) {\n        return;\n      }\n      this._customTooltips({ opacity: 0 });\n      const plugins = [{ afterRender: () => this._setRendered(true) }];\n      let options = {\n        responsive: true,\n        maintainAspectRatio: false,\n        animation: {\n          duration: 0,\n        },\n        hover: {\n          animationDuration: 0,\n        },\n        responsiveAnimationDuration: 0,\n        tooltips: {\n          enabled: false,\n          custom: this._customTooltips.bind(this),\n        },\n        legend: {\n          display: false,\n        },\n        line: {\n          spanGaps: true,\n        },\n        elements: {\n          font: \"12px 'Roboto', 'sans-serif'\",\n        },\n        ticks: {\n          fontFamily: \"'Roboto', 'sans-serif'\",\n        },\n      };\n      options = Chart.helpers.merge(options, this.data.options);\n      options.scales.xAxes[0].ticks.callback = this._formatTickValue;\n      if (this.data.type === \"timeline\") {\n        this.set(\"isTimeline\", true);\n        if (this.data.colors !== undefined) {\n          this._colorFunc = this.constructor.getColorGenerator(\n            this.data.colors.staticColors,\n            this.data.colors.staticColorIndex\n          );\n        }\n        if (this._colorFunc !== undefined) {\n          options.elements.colorFunction = this._colorFunc;\n        }\n        if (data.datasets.length === 1) {\n          if (options.scales.yAxes[0].ticks) {\n            options.scales.yAxes[0].ticks.display = false;\n          } else {\n            options.scales.yAxes[0].ticks = { display: false };\n          }\n          if (options.scales.yAxes[0].gridLines) {\n            options.scales.yAxes[0].gridLines.display = false;\n          } else {\n            options.scales.yAxes[0].gridLines = { display: false };\n          }\n        }\n        this.$.chartTarget.style.height = \"50px\";\n      } else {\n        this.$.chartTarget.style.height = \"160px\";\n      }\n      const chartData = {\n        type: this.data.type,\n        data: this.data.data,\n        options: options,\n        plugins: plugins,\n      };\n      // Async resize after dom update\n      this._chart = new this.ChartClass(ctx, chartData);\n      if (this.isTimeline !== true && this.data.legend === true) {\n        this._drawLegend();\n      }\n      this.resizeChart();\n    }\n  }\n\n  resizeChart() {\n    if (!this._chart) return;\n    // Chart not ready\n    if (this._resizeTimer === undefined) {\n      this._resizeTimer = setInterval(this.resizeChart.bind(this), 10);\n      return;\n    }\n\n    clearInterval(this._resizeTimer);\n    this._resizeTimer = undefined;\n\n    this._resizeChart();\n  }\n\n  _resizeChart() {\n    const chartTarget = this.$.chartTarget;\n\n    const options = this.data;\n    const data = options.data;\n\n    if (data.datasets.length === 0) {\n      return;\n    }\n\n    if (!this.isTimeline) {\n      this._chart.resize();\n      return;\n    }\n\n    // Recalculate chart height for Timeline chart\n    const areaTop = this._chart.chartArea.top;\n    const areaBot = this._chart.chartArea.bottom;\n    const height1 = this._chart.canvas.clientHeight;\n    if (areaBot > 0) {\n      this._axisHeight = height1 - areaBot + areaTop;\n    }\n\n    if (!this._axisHeight) {\n      chartTarget.style.height = \"50px\";\n      this._chart.resize();\n      this.resizeChart();\n      return;\n    }\n    if (this._axisHeight) {\n      const cnt = data.datasets.length;\n      const targetHeight = 30 * cnt + this._axisHeight + \"px\";\n      if (chartTarget.style.height !== targetHeight) {\n        chartTarget.style.height = targetHeight;\n      }\n      this._chart.resize();\n    }\n  }\n\n  // Get HSL distributed color list\n  static getColorList(count) {\n    let processL = false;\n    if (count > 10) {\n      processL = true;\n      count = Math.ceil(count / 2);\n    }\n    const h1 = 360 / count;\n    const result = [];\n    for (let loopI = 0; loopI < count; loopI++) {\n      result[loopI] = Color().hsl(h1 * loopI, 80, 38);\n      if (processL) {\n        result[loopI + count] = Color().hsl(h1 * loopI, 80, 62);\n      }\n    }\n    return result;\n  }\n\n  static getColorGenerator(staticColors, startIndex) {\n    // Known colors for static data,\n    // should add for very common state string manually.\n    // Palette modified from http://google.github.io/palette.js/ mpn65, Apache 2.0\n    const palette = [\n      \"ff0029\",\n      \"66a61e\",\n      \"377eb8\",\n      \"984ea3\",\n      \"00d2d5\",\n      \"ff7f00\",\n      \"af8d00\",\n      \"7f80cd\",\n      \"b3e900\",\n      \"c42e60\",\n      \"a65628\",\n      \"f781bf\",\n      \"8dd3c7\",\n      \"bebada\",\n      \"fb8072\",\n      \"80b1d3\",\n      \"fdb462\",\n      \"fccde5\",\n      \"bc80bd\",\n      \"ffed6f\",\n      \"c4eaff\",\n      \"cf8c00\",\n      \"1b9e77\",\n      \"d95f02\",\n      \"e7298a\",\n      \"e6ab02\",\n      \"a6761d\",\n      \"0097ff\",\n      \"00d067\",\n      \"f43600\",\n      \"4ba93b\",\n      \"5779bb\",\n      \"927acc\",\n      \"97ee3f\",\n      \"bf3947\",\n      \"9f5b00\",\n      \"f48758\",\n      \"8caed6\",\n      \"f2b94f\",\n      \"eff26e\",\n      \"e43872\",\n      \"d9b100\",\n      \"9d7a00\",\n      \"698cff\",\n      \"d9d9d9\",\n      \"00d27e\",\n      \"d06800\",\n      \"009f82\",\n      \"c49200\",\n      \"cbe8ff\",\n      \"fecddf\",\n      \"c27eb6\",\n      \"8cd2ce\",\n      \"c4b8d9\",\n      \"f883b0\",\n      \"a49100\",\n      \"f48800\",\n      \"27d0df\",\n      \"a04a9b\",\n    ];\n    function getColorIndex(idx) {\n      // Reuse the color if index too large.\n      return Color(\"#\" + palette[idx % palette.length]);\n    }\n    const colorDict = {};\n    let colorIndex = 0;\n    if (startIndex > 0) colorIndex = startIndex;\n    if (staticColors) {\n      Object.keys(staticColors).forEach((c) => {\n        const c1 = staticColors[c];\n        if (isFinite(c1)) {\n          colorDict[c.toLowerCase()] = getColorIndex(c1);\n        } else {\n          colorDict[c.toLowerCase()] = Color(staticColors[c]);\n        }\n      });\n    }\n    // Custom color assign\n    function getColor(__, data) {\n      let ret;\n      const name = data[3];\n      if (name === null) return Color().hsl(0, 40, 38);\n      if (name === undefined) return Color().hsl(120, 40, 38);\n      const name1 = name.toLowerCase();\n      if (ret === undefined) {\n        ret = colorDict[name1];\n      }\n      if (ret === undefined) {\n        ret = getColorIndex(colorIndex);\n        colorIndex++;\n        colorDict[name1] = ret;\n      }\n      return ret;\n    }\n    return getColor;\n  }\n}\ncustomElements.define(\"ha-chart-base\", HaChartBase);\n","import \"@polymer/polymer/lib/utils/debounce\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"./entity/ha-chart-base\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\nimport formatDateTime from \"../common/datetime/format_date_time\";\n\nclass StateHistoryChartLine extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          overflow: hidden;\n          height: 0;\n          transition: height 0.3s ease-in-out;\n        }\n      </style>\n      <ha-chart-base\n        id=\"chart\"\n        data=\"[[chartData]]\"\n        identifier=\"[[identifier]]\"\n        rendered=\"{{rendered}}\"\n      ></ha-chart-base>\n    `;\n  }\n\n  static get properties() {\n    return {\n      chartData: Object,\n      data: Object,\n      names: Object,\n      unit: String,\n      identifier: String,\n\n      isSingleDevice: {\n        type: Boolean,\n        value: false,\n      },\n\n      endTime: Object,\n      rendered: {\n        type: Boolean,\n        value: false,\n        observer: \"_onRenderedChanged\",\n      },\n    };\n  }\n\n  static get observers() {\n    return [\"dataChanged(data, endTime, isSingleDevice)\"];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._isAttached = true;\n    this.drawChart();\n  }\n\n  dataChanged() {\n    this.drawChart();\n  }\n\n  _onRenderedChanged(rendered) {\n    if (rendered) this.animateHeight();\n  }\n\n  animateHeight() {\n    requestAnimationFrame(() =>\n      requestAnimationFrame(() => {\n        this.style.height = this.$.chart.scrollHeight + \"px\";\n      })\n    );\n  }\n\n  drawChart() {\n    const unit = this.unit;\n    const deviceStates = this.data;\n    const datasets = [];\n    let endTime;\n\n    if (!this._isAttached) {\n      return;\n    }\n\n    if (deviceStates.length === 0) {\n      return;\n    }\n\n    function safeParseFloat(value) {\n      const parsed = parseFloat(value);\n      return isFinite(parsed) ? parsed : null;\n    }\n\n    endTime =\n      this.endTime ||\n      // Get the highest date from the last date of each device\n      new Date(\n        Math.max.apply(\n          null,\n          deviceStates.map(\n            (devSts) =>\n              new Date(devSts.states[devSts.states.length - 1].last_changed)\n          )\n        )\n      );\n    if (endTime > new Date()) {\n      endTime = new Date();\n    }\n\n    const names = this.names || {};\n    deviceStates.forEach((states) => {\n      const domain = states.domain;\n      const name = names[states.entity_id] || states.name;\n      // array containing [value1, value2, etc]\n      let prevValues;\n      const data = [];\n\n      function pushData(timestamp, datavalues) {\n        if (!datavalues) return;\n        if (timestamp > endTime) {\n          // Drop datapoints that are after the requested endTime. This could happen if\n          // endTime is \"now\" and client time is not in sync with server time.\n          return;\n        }\n        data.forEach((d, i) => {\n          d.data.push({ x: timestamp, y: datavalues[i] });\n        });\n        prevValues = datavalues;\n      }\n\n      function addColumn(nameY, step, fill) {\n        let dataFill = false;\n        let dataStep = false;\n        if (fill) {\n          dataFill = \"origin\";\n        }\n        if (step) {\n          dataStep = \"before\";\n        }\n        data.push({\n          label: nameY,\n          fill: dataFill,\n          steppedLine: dataStep,\n          pointRadius: 0,\n          data: [],\n          unitText: unit,\n        });\n      }\n\n      if (\n        domain === \"thermostat\" ||\n        domain === \"climate\" ||\n        domain === \"water_heater\"\n      ) {\n        // We differentiate between thermostats that have a target temperature\n        // range versus ones that have just a target temperature\n\n        // Using step chart by step-before so manually interpolation not needed.\n        const hasTargetRange = states.states.some(\n          (state) =>\n            state.attributes &&\n            state.attributes.target_temp_high !==\n              state.attributes.target_temp_low\n        );\n        const hasHeat = states.states.some((state) => state.state === \"heat\");\n        const hasCool = states.states.some((state) => state.state === \"cool\");\n\n        addColumn(name + \" current temperature\", true);\n        if (hasHeat) {\n          addColumn(name + \" heating\", true, true);\n          // The \"heating\" series uses steppedArea to shade the area below the current\n          // temperature when the thermostat is calling for heat.\n        }\n        if (hasCool) {\n          addColumn(name + \" cooling\", true, true);\n          // The \"cooling\" series uses steppedArea to shade the area below the current\n          // temperature when the thermostat is calling for heat.\n        }\n\n        if (hasTargetRange) {\n          addColumn(name + \" target temperature high\", true);\n          addColumn(name + \" target temperature low\", true);\n        } else {\n          addColumn(name + \" target temperature\", true);\n        }\n\n        states.states.forEach((state) => {\n          if (!state.attributes) return;\n          const curTemp = safeParseFloat(state.attributes.current_temperature);\n          const series = [curTemp];\n          if (hasHeat) {\n            series.push(state.state === \"heat\" ? curTemp : null);\n          }\n          if (hasCool) {\n            series.push(state.state === \"cool\" ? curTemp : null);\n          }\n          if (hasTargetRange) {\n            const targetHigh = safeParseFloat(\n              state.attributes.target_temp_high\n            );\n            const targetLow = safeParseFloat(state.attributes.target_temp_low);\n            series.push(targetHigh, targetLow);\n            pushData(new Date(state.last_changed), series);\n          } else {\n            const target = safeParseFloat(state.attributes.temperature);\n            series.push(target);\n            pushData(new Date(state.last_changed), series);\n          }\n        });\n      } else {\n        // Only disable interpolation for sensors\n        const isStep = domain === \"sensor\";\n        addColumn(name, isStep);\n\n        let lastValue = null;\n        let lastDate = null;\n        let lastNullDate = null;\n\n        // Process chart data.\n        // When state is `unknown`, calculate the value and break the line.\n        states.states.forEach((state) => {\n          const value = safeParseFloat(state.state);\n          const date = new Date(state.last_changed);\n          if (value !== null && lastNullDate !== null) {\n            const dateTime = date.getTime();\n            const lastNullDateTime = lastNullDate.getTime();\n            const lastDateTime = lastDate.getTime();\n            const tmpValue =\n              (value - lastValue) *\n                ((lastNullDateTime - lastDateTime) /\n                  (dateTime - lastDateTime)) +\n              lastValue;\n            pushData(lastNullDate, [tmpValue]);\n            pushData(new Date(lastNullDateTime + 1), [null]);\n            pushData(date, [value]);\n            lastDate = date;\n            lastValue = value;\n            lastNullDate = null;\n          } else if (value !== null && lastNullDate === null) {\n            pushData(date, [value]);\n            lastDate = date;\n            lastValue = value;\n          } else if (\n            value === null &&\n            lastNullDate === null &&\n            lastValue !== null\n          ) {\n            lastNullDate = date;\n          }\n        });\n      }\n\n      // Add an entry for final values\n      pushData(endTime, prevValues, false);\n\n      // Concat two arrays\n      Array.prototype.push.apply(datasets, data);\n    });\n\n    const formatTooltipTitle = (items, data) => {\n      const item = items[0];\n      const date = data.datasets[item.datasetIndex].data[item.index].x;\n\n      return formatDateTime(date, this.hass.language);\n    };\n\n    const chartOptions = {\n      type: \"line\",\n      unit: unit,\n      legend: !this.isSingleDevice,\n      options: {\n        scales: {\n          xAxes: [\n            {\n              type: \"time\",\n              ticks: {\n                major: {\n                  fontStyle: \"bold\",\n                },\n              },\n            },\n          ],\n          yAxes: [\n            {\n              ticks: {\n                maxTicksLimit: 7,\n              },\n            },\n          ],\n        },\n        tooltips: {\n          mode: \"neareach\",\n          callbacks: {\n            title: formatTooltipTitle,\n          },\n        },\n        hover: {\n          mode: \"neareach\",\n        },\n        layout: {\n          padding: {\n            top: 5,\n          },\n        },\n        elements: {\n          line: {\n            tension: 0.1,\n            pointRadius: 0,\n            borderWidth: 1.5,\n          },\n          point: {\n            hitRadius: 5,\n          },\n        },\n        plugins: {\n          filler: {\n            propagate: true,\n          },\n        },\n      },\n      data: {\n        labels: [],\n        datasets: datasets,\n      },\n    };\n    this.chartData = chartOptions;\n  }\n}\ncustomElements.define(\"state-history-chart-line\", StateHistoryChartLine);\n","import \"@polymer/polymer/lib/utils/debounce\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\nimport \"./entity/ha-chart-base\";\n\nimport formatDateTime from \"../common/datetime/format_date_time\";\nimport { computeRTL } from \"../common/util/compute_rtl\";\n\nclass StateHistoryChartTimeline extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          opacity: 0;\n          transition: opacity 0.3s ease-in-out;\n        }\n        :host([rendered]) {\n          opacity: 1;\n        }\n\n        ha-chart-base {\n          direction: ltr;\n        }\n      </style>\n      <ha-chart-base\n        data=\"[[chartData]]\"\n        rendered=\"{{rendered}}\"\n        rtl=\"{{rtl}}\"\n      ></ha-chart-base>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n      chartData: Object,\n      data: {\n        type: Object,\n        observer: \"dataChanged\",\n      },\n      names: Object,\n      noSingle: Boolean,\n      endTime: Date,\n      rendered: {\n        type: Boolean,\n        value: false,\n        reflectToAttribute: true,\n      },\n      rtl: {\n        reflectToAttribute: true,\n        computed: \"_computeRTL(hass)\",\n      },\n    };\n  }\n\n  static get observers() {\n    return [\"dataChanged(data, endTime, localize, language)\"];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._isAttached = true;\n    this.drawChart();\n  }\n\n  dataChanged() {\n    this.drawChart();\n  }\n\n  drawChart() {\n    const staticColors = {\n      on: 1,\n      off: 0,\n      unavailable: \"#a0a0a0\",\n      unknown: \"#606060\",\n      idle: 2,\n    };\n    let stateHistory = this.data;\n\n    if (!this._isAttached) {\n      return;\n    }\n\n    if (!stateHistory) {\n      stateHistory = [];\n    }\n\n    const startTime = new Date(\n      stateHistory.reduce(\n        (minTime, stateInfo) =>\n          Math.min(minTime, new Date(stateInfo.data[0].last_changed)),\n        new Date()\n      )\n    );\n\n    // end time is Math.max(startTime, last_event)\n    let endTime =\n      this.endTime ||\n      new Date(\n        stateHistory.reduce(\n          (maxTime, stateInfo) =>\n            Math.max(\n              maxTime,\n              new Date(stateInfo.data[stateInfo.data.length - 1].last_changed)\n            ),\n          startTime\n        )\n      );\n\n    if (endTime > new Date()) {\n      endTime = new Date();\n    }\n\n    const labels = [];\n    const datasets = [];\n    // stateHistory is a list of lists of sorted state objects\n    const names = this.names || {};\n    stateHistory.forEach((stateInfo) => {\n      let newLastChanged;\n      let prevState = null;\n      let locState = null;\n      let prevLastChanged = startTime;\n      const entityDisplay = names[stateInfo.entity_id] || stateInfo.name;\n\n      const dataRow = [];\n      stateInfo.data.forEach((state) => {\n        let newState = state.state;\n        const timeStamp = new Date(state.last_changed);\n        if (newState === undefined || newState === \"\") {\n          newState = null;\n        }\n        if (timeStamp > endTime) {\n          // Drop datapoints that are after the requested endTime. This could happen if\n          // endTime is 'now' and client time is not in sync with server time.\n          return;\n        }\n        if (prevState !== null && newState !== prevState) {\n          newLastChanged = new Date(state.last_changed);\n\n          dataRow.push([prevLastChanged, newLastChanged, locState, prevState]);\n\n          prevState = newState;\n          locState = state.state_localize;\n          prevLastChanged = newLastChanged;\n        } else if (prevState === null) {\n          prevState = newState;\n          locState = state.state_localize;\n          prevLastChanged = new Date(state.last_changed);\n        }\n      });\n\n      if (prevState !== null) {\n        dataRow.push([prevLastChanged, endTime, locState, prevState]);\n      }\n      datasets.push({ data: dataRow });\n      labels.push(entityDisplay);\n    });\n\n    const formatTooltipLabel = (item, data) => {\n      const values = data.datasets[item.datasetIndex].data[item.index];\n\n      const start = formatDateTime(values[0], this.hass.language);\n      const end = formatDateTime(values[1], this.hass.language);\n      const state = values[2];\n\n      return [state, start, end];\n    };\n\n    const chartOptions = {\n      type: \"timeline\",\n      options: {\n        tooltips: {\n          callbacks: {\n            label: formatTooltipLabel,\n          },\n        },\n        scales: {\n          xAxes: [\n            {\n              ticks: {\n                major: {\n                  fontStyle: \"bold\",\n                },\n              },\n            },\n          ],\n          yAxes: [\n            {\n              afterSetDimensions: (yaxe) => {\n                yaxe.maxWidth = yaxe.chart.width * 0.18;\n              },\n              position: this._computeRTL ? \"right\" : \"left\",\n            },\n          ],\n        },\n      },\n      data: {\n        labels: labels,\n        datasets: datasets,\n      },\n      colors: {\n        staticColors: staticColors,\n        staticColorIndex: 3,\n      },\n    };\n    this.chartData = chartOptions;\n  }\n\n  _computeRTL(hass) {\n    return computeRTL(hass);\n  }\n}\ncustomElements.define(\n  \"state-history-chart-timeline\",\n  StateHistoryChartTimeline\n);\n","import \"@polymer/paper-spinner/paper-spinner\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"./state-history-chart-line\";\nimport \"./state-history-chart-timeline\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\nclass StateHistoryCharts extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          /* height of single timeline chart = 58px */\n          min-height: 58px;\n        }\n        .info {\n          text-align: center;\n          line-height: 58px;\n          color: var(--secondary-text-color);\n        }\n      </style>\n      <template\n        is=\"dom-if\"\n        class=\"info\"\n        if=\"[[_computeIsLoading(isLoadingData)]]\"\n      >\n        <div class=\"info\">\n          [[localize('ui.components.history_charts.loading_history')]]\n        </div>\n      </template>\n\n      <template\n        is=\"dom-if\"\n        class=\"info\"\n        if=\"[[_computeIsEmpty(isLoadingData, historyData)]]\"\n      >\n        <div class=\"info\">\n          [[localize('ui.components.history_charts.no_history_found')]]\n        </div>\n      </template>\n\n      <template is=\"dom-if\" if=\"[[historyData.timeline.length]]\">\n        <state-history-chart-timeline\n          hass=\"[[hass]]\"\n          data=\"[[historyData.timeline]]\"\n          end-time=\"[[_computeEndTime(endTime, upToNow, historyData)]]\"\n          no-single=\"[[noSingle]]\"\n          names=\"[[names]]\"\n        ></state-history-chart-timeline>\n      </template>\n\n      <template is=\"dom-repeat\" items=\"[[historyData.line]]\">\n        <state-history-chart-line\n          hass=\"[[hass]]\"\n          unit=\"[[item.unit]]\"\n          data=\"[[item.data]]\"\n          identifier=\"[[item.identifier]]\"\n          is-single-device=\"[[_computeIsSingleLineChart(item.data, noSingle)]]\"\n          end-time=\"[[_computeEndTime(endTime, upToNow, historyData)]]\"\n          names=\"[[names]]\"\n        ></state-history-chart-line>\n      </template>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      historyData: {\n        type: Object,\n        value: null,\n      },\n      names: Object,\n\n      isLoadingData: Boolean,\n\n      endTime: {\n        type: Object,\n      },\n\n      upToNow: Boolean,\n      noSingle: Boolean,\n    };\n  }\n\n  _computeIsSingleLineChart(data, noSingle) {\n    return !noSingle && data && data.length === 1;\n  }\n\n  _computeIsEmpty(isLoadingData, historyData) {\n    const historyDataEmpty =\n      !historyData ||\n      !historyData.timeline ||\n      !historyData.line ||\n      (historyData.timeline.length === 0 && historyData.line.length === 0);\n    return !isLoadingData && historyDataEmpty;\n  }\n\n  _computeIsLoading(isLoading) {\n    return isLoading && !this.historyData;\n  }\n\n  _computeEndTime(endTime, upToNow) {\n    // We don't really care about the value of historyData, but if it change we want to update\n    // endTime.\n    return upToNow ? new Date() : endTime;\n  }\n}\ncustomElements.define(\"state-history-charts\", StateHistoryCharts);\n","import {\n  computeHistory,\n  fetchRecent,\n  HistoryResult,\n  TimelineEntity,\n  LineChartUnit,\n} from \"./history\";\nimport { HomeAssistant } from \"../types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { LocalizeFunc } from \"../common/translations/localize\";\n\ninterface CacheConfig {\n  refresh: number;\n  cacheKey: string;\n  hoursToShow: number;\n}\n\ninterface CachedResults {\n  prom: Promise<HistoryResult>;\n  startTime: Date;\n  endTime: Date;\n  language: string;\n  data: HistoryResult;\n}\n\n// This is a different interface, a different cache :(\ninterface RecentCacheResults {\n  created: number;\n  language: string;\n  data: Promise<HistoryResult>;\n}\n\nconst RECENT_THRESHOLD = 60000; // 1 minute\nconst RECENT_CACHE: { [cacheKey: string]: RecentCacheResults } = {};\nconst stateHistoryCache: { [cacheKey: string]: CachedResults } = {};\n\n// Cached type 1 unction. Without cache config.\nexport const getRecent = (\n  hass: HomeAssistant,\n  entityId: string,\n  startTime: Date,\n  endTime: Date,\n  localize: LocalizeFunc,\n  language: string\n) => {\n  const cacheKey = entityId;\n  const cache = RECENT_CACHE[cacheKey];\n\n  if (\n    cache &&\n    Date.now() - cache.created < RECENT_THRESHOLD &&\n    cache.language === language\n  ) {\n    return cache.data;\n  }\n\n  const prom = fetchRecent(hass, entityId, startTime, endTime).then(\n    (stateHistory) => computeHistory(hass, stateHistory, localize, language),\n    (err) => {\n      delete RECENT_CACHE[entityId];\n      throw err;\n    }\n  );\n\n  RECENT_CACHE[cacheKey] = {\n    created: Date.now(),\n    language,\n    data: prom,\n  };\n  return prom;\n};\n\n// Cache type 2 functionality\nfunction getEmptyCache(\n  language: string,\n  startTime: Date,\n  endTime: Date\n): CachedResults {\n  return {\n    prom: Promise.resolve({ line: [], timeline: [] }),\n    language,\n    startTime,\n    endTime,\n    data: { line: [], timeline: [] },\n  };\n}\n\nexport const getRecentWithCache = (\n  hass: HomeAssistant,\n  entityId: string,\n  cacheConfig: CacheConfig,\n  localize: LocalizeFunc,\n  language: string\n) => {\n  const cacheKey = cacheConfig.cacheKey;\n  const endTime = new Date();\n  const startTime = new Date(endTime);\n  startTime.setHours(startTime.getHours() - cacheConfig.hoursToShow);\n  let toFetchStartTime = startTime;\n  let appendingToCache = false;\n\n  let cache = stateHistoryCache[cacheKey];\n  if (\n    cache &&\n    toFetchStartTime >= cache.startTime &&\n    toFetchStartTime <= cache.endTime &&\n    cache.language === language\n  ) {\n    toFetchStartTime = cache.endTime;\n    appendingToCache = true;\n    // This pretty much never happens as endTime is usually set to now\n    if (endTime <= cache.endTime) {\n      return cache.prom;\n    }\n  } else {\n    cache = stateHistoryCache[cacheKey] = getEmptyCache(\n      language,\n      startTime,\n      endTime\n    );\n  }\n\n  const curCacheProm = cache.prom;\n\n  const genProm = async () => {\n    let fetchedHistory: HassEntity[][];\n\n    try {\n      const results = await Promise.all([\n        curCacheProm,\n        fetchRecent(\n          hass,\n          entityId,\n          toFetchStartTime,\n          endTime,\n          appendingToCache\n        ),\n      ]);\n      fetchedHistory = results[1];\n    } catch (err) {\n      delete stateHistoryCache[cacheKey];\n      throw err;\n    }\n    const stateHistory = computeHistory(\n      hass,\n      fetchedHistory,\n      localize,\n      language\n    );\n    if (appendingToCache) {\n      mergeLine(stateHistory.line, cache.data.line);\n      mergeTimeline(stateHistory.timeline, cache.data.timeline);\n      pruneStartTime(startTime, cache.data);\n    } else {\n      cache.data = stateHistory;\n    }\n    return cache.data;\n  };\n\n  cache.prom = genProm();\n  cache.startTime = startTime;\n  cache.endTime = endTime;\n  return cache.prom;\n};\n\nconst mergeLine = (\n  historyLines: LineChartUnit[],\n  cacheLines: LineChartUnit[]\n) => {\n  historyLines.forEach((line) => {\n    const unit = line.unit;\n    const oldLine = cacheLines.find((cacheLine) => cacheLine.unit === unit);\n    if (oldLine) {\n      line.data.forEach((entity) => {\n        const oldEntity = oldLine.data.find(\n          (cacheEntity) => entity.entity_id === cacheEntity.entity_id\n        );\n        if (oldEntity) {\n          oldEntity.states = oldEntity.states.concat(entity.states);\n        } else {\n          oldLine.data.push(entity);\n        }\n      });\n    } else {\n      cacheLines.push(line);\n    }\n  });\n};\n\nconst mergeTimeline = (\n  historyTimelines: TimelineEntity[],\n  cacheTimelines: TimelineEntity[]\n) => {\n  historyTimelines.forEach((timeline) => {\n    const oldTimeline = cacheTimelines.find(\n      (cacheTimeline) => cacheTimeline.entity_id === timeline.entity_id\n    );\n    if (oldTimeline) {\n      oldTimeline.data = oldTimeline.data.concat(timeline.data);\n    } else {\n      cacheTimelines.push(timeline);\n    }\n  });\n};\n\nconst pruneArray = (originalStartTime: Date, arr) => {\n  if (arr.length === 0) {\n    return arr;\n  }\n  const changedAfterStartTime = arr.findIndex(\n    (state) => new Date(state.last_changed) > originalStartTime\n  );\n  if (changedAfterStartTime === 0) {\n    // If all changes happened after originalStartTime then we are done.\n    return arr;\n  }\n\n  // If all changes happened at or before originalStartTime. Use last index.\n  const updateIndex =\n    changedAfterStartTime === -1 ? arr.length - 1 : changedAfterStartTime - 1;\n  arr[updateIndex].last_changed = originalStartTime;\n  return arr.slice(updateIndex);\n};\n\nconst pruneStartTime = (originalStartTime: Date, cacheData: HistoryResult) => {\n  cacheData.line.forEach((line) => {\n    line.data.forEach((entity) => {\n      entity.states = pruneArray(originalStartTime, entity.states);\n    });\n  });\n\n  cacheData.timeline.forEach((timeline) => {\n    timeline.data = pruneArray(originalStartTime, timeline.data);\n  });\n};\n","import { timeOut } from \"@polymer/polymer/lib/utils/async\";\nimport { Debouncer } from \"@polymer/polymer/lib/utils/debounce\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\nimport { computeHistory, fetchDate } from \"./history\";\nimport { getRecent, getRecentWithCache } from \"./cached-history\";\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaStateHistoryData extends LocalizeMixin(PolymerElement) {\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n        observer: \"hassChanged\",\n      },\n\n      filterType: String,\n\n      cacheConfig: Object,\n\n      startTime: Date,\n      endTime: Date,\n\n      entityId: String,\n\n      isLoading: {\n        type: Boolean,\n        value: true,\n        readOnly: true,\n        notify: true,\n      },\n\n      data: {\n        type: Object,\n        value: null,\n        readOnly: true,\n        notify: true,\n      },\n    };\n  }\n\n  static get observers() {\n    return [\n      \"filterChangedDebouncer(filterType, entityId, startTime, endTime, cacheConfig, localize)\",\n    ];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.filterChangedDebouncer(\n      this.filterType,\n      this.entityId,\n      this.startTime,\n      this.endTime,\n      this.cacheConfig,\n      this.localize\n    );\n  }\n\n  disconnectedCallback() {\n    if (this._refreshTimeoutId) {\n      window.clearInterval(this._refreshTimeoutId);\n      this._refreshTimeoutId = null;\n    }\n    super.disconnectedCallback();\n  }\n\n  hassChanged(newHass, oldHass) {\n    if (!oldHass && !this._madeFirstCall) {\n      this.filterChangedDebouncer(\n        this.filterType,\n        this.entityId,\n        this.startTime,\n        this.endTime,\n        this.cacheConfig,\n        this.localize\n      );\n    }\n  }\n\n  filterChangedDebouncer(...args) {\n    this._debounceFilterChanged = Debouncer.debounce(\n      this._debounceFilterChanged,\n      timeOut.after(0),\n      () => {\n        this.filterChanged(...args);\n      }\n    );\n  }\n\n  filterChanged(\n    filterType,\n    entityId,\n    startTime,\n    endTime,\n    cacheConfig,\n    localize\n  ) {\n    if (!this.hass) {\n      return;\n    }\n    if (cacheConfig && !cacheConfig.cacheKey) {\n      return;\n    }\n    if (!localize) {\n      return;\n    }\n    this._madeFirstCall = true;\n    const language = this.hass.language;\n    let data;\n\n    if (filterType === \"date\") {\n      if (!startTime || !endTime) return;\n\n      data = fetchDate(this.hass, startTime, endTime).then((dateHistory) =>\n        computeHistory(this.hass, dateHistory, localize, language)\n      );\n    } else if (filterType === \"recent-entity\") {\n      if (!entityId) return;\n      if (cacheConfig) {\n        data = this.getRecentWithCacheRefresh(\n          entityId,\n          cacheConfig,\n          localize,\n          language\n        );\n      } else {\n        data = getRecent(\n          this.hass,\n          entityId,\n          startTime,\n          endTime,\n          localize,\n          language\n        );\n      }\n    } else {\n      return;\n    }\n    this._setIsLoading(true);\n\n    data.then((stateHistory) => {\n      this._setData(stateHistory);\n      this._setIsLoading(false);\n    });\n  }\n\n  getRecentWithCacheRefresh(entityId, cacheConfig, localize, language) {\n    if (this._refreshTimeoutId) {\n      window.clearInterval(this._refreshTimeoutId);\n      this._refreshTimeoutId = null;\n    }\n    if (cacheConfig.refresh) {\n      this._refreshTimeoutId = window.setInterval(() => {\n        getRecentWithCache(\n          this.hass,\n          entityId,\n          cacheConfig,\n          localize,\n          language\n        ).then((stateHistory) => {\n          this._setData(Object.assign({}, stateHistory));\n        });\n      }, cacheConfig.refresh * 1000);\n    }\n    return getRecentWithCache(\n      this.hass,\n      entityId,\n      cacheConfig,\n      localize,\n      language\n    );\n  }\n}\ncustomElements.define(\"ha-state-history-data\", HaStateHistoryData);\n","import { HassEntity } from \"home-assistant-js-websocket\";\nimport durationToSeconds from \"../datetime/duration_to_seconds\";\n\nexport default function timerTimeRemaining(stateObj: HassEntity) {\n  let timeRemaining = durationToSeconds(stateObj.attributes.remaining);\n\n  if (stateObj.state === \"active\") {\n    const now = new Date().getTime();\n    const madeActive = new Date(stateObj.last_changed).getTime();\n    timeRemaining = Math.max(timeRemaining - (now - madeActive) / 1000, 0);\n  }\n\n  return timeRemaining;\n}\n","export default function durationToSeconds(duration: string): number {\n  const parts = duration.split(\":\").map(Number);\n  return parts[0] * 3600 + parts[1] * 60 + parts[2];\n}\n","import {\n  LitElement,\n  html,\n  PropertyValues,\n  TemplateResult,\n  css,\n  CSSResult,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { HomeAssistant } from \"../../types\";\n\nimport computeStateDomain from \"../../common/entity/compute_state_domain\";\nimport computeStateName from \"../../common/entity/compute_state_name\";\nimport domainIcon from \"../../common/entity/domain_icon\";\nimport stateIcon from \"../../common/entity/state_icon\";\nimport timerTimeRemaining from \"../../common/entity/timer_time_remaining\";\nimport secondsToDuration from \"../../common/datetime/seconds_to_duration\";\n\nimport \"../ha-label-badge\";\n\n@customElement(\"ha-state-label-badge\")\nexport class HaStateLabelBadge extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public state?: HassEntity;\n\n  @property() private _timerTimeRemaining?: number;\n\n  private _connected?: boolean;\n\n  private _updateRemaining?: number;\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._connected = true;\n    this.startInterval(this.state);\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._connected = false;\n    this.clearInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    const state = this.state;\n\n    if (!state) {\n      return html`\n        <ha-label-badge\n          class=\"warning\"\n          label=\"${this.hass!.localize(\"state_badge.default.error\")}\"\n          icon=\"hass:alert\"\n          description=\"${this.hass!.localize(\n            \"state_badge.default.entity_not_found\"\n          )}\"\n        ></ha-label-badge>\n      `;\n    }\n\n    const domain = computeStateDomain(state);\n\n    return html`\n      <ha-label-badge\n        class=\"${classMap({\n          [domain]: true,\n          \"has-unit_of_measurement\": \"unit_of_measurement\" in state.attributes,\n        })}\"\n        .value=\"${this._computeValue(domain, state)}\"\n        .icon=\"${this._computeIcon(domain, state)}\"\n        .image=\"${state.attributes.entity_picture}\"\n        .label=\"${this._computeLabel(domain, state, this._timerTimeRemaining)}\"\n        .description=\"${computeStateName(state)}\"\n      ></ha-label-badge>\n    `;\n  }\n\n  protected firstUpdated(changedProperties: PropertyValues): void {\n    super.firstUpdated(changedProperties);\n    this.addEventListener(\"click\", (ev) => {\n      ev.stopPropagation();\n      if (this.state) {\n        fireEvent(this, \"hass-more-info\", { entityId: this.state.entity_id });\n      }\n    });\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    if (this._connected && changedProperties.has(\"state\")) {\n      this.startInterval(this.state);\n    }\n  }\n\n  private _computeValue(domain: string, state: HassEntity) {\n    switch (domain) {\n      case \"binary_sensor\":\n      case \"device_tracker\":\n      case \"person\":\n      case \"updater\":\n      case \"sun\":\n      case \"alarm_control_panel\":\n      case \"timer\":\n        return null;\n      case \"sensor\":\n      default:\n        return state.state === \"unknown\"\n          ? \"-\"\n          : this.hass!.localize(`component.${domain}.state.${state.state}`) ||\n              state.state;\n    }\n  }\n\n  private _computeIcon(domain: string, state: HassEntity) {\n    if (state.state === \"unavailable\") {\n      return null;\n    }\n    switch (domain) {\n      case \"alarm_control_panel\":\n        if (state.state === \"pending\") {\n          return \"hass:clock-fast\";\n        }\n        if (state.state === \"armed_away\") {\n          return \"hass:nature\";\n        }\n        if (state.state === \"armed_home\") {\n          return \"hass:home-variant\";\n        }\n        if (state.state === \"armed_night\") {\n          return \"hass:weather-night\";\n        }\n        if (state.state === \"armed_custom_bypass\") {\n          return \"hass:shield-home\";\n        }\n        if (state.state === \"triggered\") {\n          return \"hass:alert-circle\";\n        }\n        // state == 'disarmed'\n        return domainIcon(domain, state.state);\n      case \"binary_sensor\":\n      case \"device_tracker\":\n      case \"updater\":\n      case \"person\":\n        return stateIcon(state);\n      case \"sun\":\n        return state.state === \"above_horizon\"\n          ? domainIcon(domain)\n          : \"hass:brightness-3\";\n      case \"timer\":\n        return state.state === \"active\" ? \"hass:timer\" : \"hass:timer-off\";\n      default:\n        return null;\n    }\n  }\n\n  private _computeLabel(domain, state, _timerTimeRemaining) {\n    if (\n      state.state === \"unavailable\" ||\n      [\"device_tracker\", \"alarm_control_panel\", \"person\"].includes(domain)\n    ) {\n      // Localize the state with a special state_badge namespace, which has variations of\n      // the state translations that are truncated to fit within the badge label. Translations\n      // are only added for device_tracker, alarm_control_panel and person.\n      return (\n        this.hass!.localize(`state_badge.${domain}.${state.state}`) ||\n        this.hass!.localize(`state_badge.default.${state.state}`) ||\n        state.state\n      );\n    }\n    if (domain === \"timer\") {\n      return secondsToDuration(_timerTimeRemaining);\n    }\n    return state.attributes.unit_of_measurement || null;\n  }\n\n  private clearInterval() {\n    if (this._updateRemaining) {\n      clearInterval(this._updateRemaining);\n      this._updateRemaining = undefined;\n    }\n  }\n\n  private startInterval(stateObj) {\n    this.clearInterval();\n    if (stateObj && computeStateDomain(stateObj) === \"timer\") {\n      this.calculateTimerRemaining(stateObj);\n\n      if (stateObj.state === \"active\") {\n        this._updateRemaining = window.setInterval(\n          () => this.calculateTimerRemaining(this.state),\n          1000\n        );\n      }\n    }\n  }\n\n  private calculateTimerRemaining(stateObj) {\n    this._timerTimeRemaining = timerTimeRemaining(stateObj);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n\n      ha-label-badge {\n        --ha-label-badge-color: var(--label-badge-red, #df4c1e);\n      }\n      ha-label-badge.has-unit_of_measurement {\n        --ha-label-badge-label-text-transform: none;\n      }\n\n      ha-label-badge.binary_sensor,\n      ha-label-badge.updater {\n        --ha-label-badge-color: var(--label-badge-blue, #039be5);\n      }\n\n      .red {\n        --ha-label-badge-color: var(--label-badge-red, #df4c1e);\n      }\n\n      .blue {\n        --ha-label-badge-color: var(--label-badge-blue, #039be5);\n      }\n\n      .green {\n        --ha-label-badge-color: var(--label-badge-green, #0da035);\n      }\n\n      .yellow {\n        --ha-label-badge-color: var(--label-badge-yellow, #f4b400);\n      }\n\n      .grey {\n        --ha-label-badge-color: var(--label-badge-grey, var(--paper-grey-500));\n      }\n\n      .warning {\n        --ha-label-badge-color: var(--label-badge-yellow, #fce588);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-state-label-badge\": HaStateLabelBadge;\n  }\n}\n","const validEntityId = /^(\\w+)\\.(\\w+)$/;\nexport default (entityId: string) => validEntityId.test(entityId);\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport LocalizeMixin from \"../mixins/localize-mixin\";\n\n/*\n * @appliesMixin LocalizeMixin\n */\nclass HaClimateState extends LocalizeMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          white-space: nowrap;\n        }\n\n        .target {\n          color: var(--primary-text-color);\n        }\n\n        .current {\n          color: var(--secondary-text-color);\n        }\n\n        .state-label {\n          font-weight: bold;\n          text-transform: capitalize;\n        }\n\n        .unit {\n          display: inline-block;\n          direction: ltr;\n        }\n      </style>\n\n      <div class=\"target\">\n        <template is=\"dom-if\" if=\"[[_hasKnownState(stateObj.state)]]\">\n          <span class=\"state-label\"> [[_localizeState(stateObj.state)]] </span>\n        </template>\n        <div class=\"unit\">[[computeTarget(hass, stateObj)]]</div>\n      </div>\n\n      <template is=\"dom-if\" if=\"[[currentStatus]]\">\n        <div class=\"current\">\n          [[localize('ui.card.climate.currently')]]:\n          <div class=\"unit\">[[currentStatus]]</div>\n        </div>\n      </template>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      stateObj: Object,\n      currentStatus: {\n        type: String,\n        computed: \"computeCurrentStatus(hass, stateObj)\",\n      },\n    };\n  }\n\n  computeCurrentStatus(hass, stateObj) {\n    if (!hass || !stateObj) return null;\n    if (stateObj.attributes.current_temperature != null) {\n      return `${stateObj.attributes.current_temperature} ${\n        hass.config.unit_system.temperature\n      }`;\n    }\n    if (stateObj.attributes.current_humidity != null) {\n      return `${stateObj.attributes.current_humidity} %`;\n    }\n    return null;\n  }\n\n  computeTarget(hass, stateObj) {\n    if (!hass || !stateObj) return null;\n    // We're using \"!= null\" on purpose so that we match both null and undefined.\n    if (\n      stateObj.attributes.target_temp_low != null &&\n      stateObj.attributes.target_temp_high != null\n    ) {\n      return `${stateObj.attributes.target_temp_low} - ${\n        stateObj.attributes.target_temp_high\n      } ${hass.config.unit_system.temperature}`;\n    }\n    if (stateObj.attributes.temperature != null) {\n      return `${stateObj.attributes.temperature} ${\n        hass.config.unit_system.temperature\n      }`;\n    }\n    if (\n      stateObj.attributes.target_humidity_low != null &&\n      stateObj.attributes.target_humidity_high != null\n    ) {\n      return `${stateObj.attributes.target_humidity_low} - ${\n        stateObj.attributes.target_humidity_high\n      } %`;\n    }\n    if (stateObj.attributes.humidity != null) {\n      return `${stateObj.attributes.humidity} %`;\n    }\n\n    return \"\";\n  }\n\n  _hasKnownState(state) {\n    return state !== \"unknown\";\n  }\n\n  _localizeState(state) {\n    return this.localize(`state.climate.${state}`) || state;\n  }\n}\ncustomElements.define(\"ha-climate-state\", HaClimateState);\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport CoverEntity from \"../util/cover-model\";\n\nclass HaCoverControls extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        .state {\n          white-space: nowrap;\n        }\n        [invisible] {\n          visibility: hidden !important;\n        }\n      </style>\n\n      <div class=\"state\">\n        <paper-icon-button\n          icon=\"hass:arrow-up\"\n          on-click=\"onOpenTap\"\n          invisible$=\"[[!entityObj.supportsOpen]]\"\n          disabled=\"[[computeOpenDisabled(stateObj, entityObj)]]\"\n        ></paper-icon-button>\n        <paper-icon-button\n          icon=\"hass:stop\"\n          on-click=\"onStopTap\"\n          invisible$=\"[[!entityObj.supportsStop]]\"\n        ></paper-icon-button>\n        <paper-icon-button\n          icon=\"hass:arrow-down\"\n          on-click=\"onCloseTap\"\n          invisible$=\"[[!entityObj.supportsClose]]\"\n          disabled=\"[[computeClosedDisabled(stateObj, entityObj)]]\"\n        ></paper-icon-button>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n      stateObj: {\n        type: Object,\n      },\n      entityObj: {\n        type: Object,\n        computed: \"computeEntityObj(hass, stateObj)\",\n      },\n    };\n  }\n\n  computeEntityObj(hass, stateObj) {\n    return new CoverEntity(hass, stateObj);\n  }\n\n  computeOpenDisabled(stateObj, entityObj) {\n    var assumedState = stateObj.attributes.assumed_state === true;\n    return (entityObj.isFullyOpen || entityObj.isOpening) && !assumedState;\n  }\n\n  computeClosedDisabled(stateObj, entityObj) {\n    var assumedState = stateObj.attributes.assumed_state === true;\n    return (entityObj.isFullyClosed || entityObj.isClosing) && !assumedState;\n  }\n\n  onOpenTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.openCover();\n  }\n\n  onCloseTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.closeCover();\n  }\n\n  onStopTap(ev) {\n    ev.stopPropagation();\n    this.entityObj.stopCover();\n  }\n}\n\ncustomElements.define(\"ha-cover-controls\", HaCoverControls);\n","/**\nAdapted from paper-time-input from\nhttps://github.com/ryanburns23/paper-time-input\nMIT Licensed. Copyright (c) 2017 Ryan Burns\n\n`<paper-time-input>` Polymer element to accept a time with paper-input & paper-dropdown-menu\nInspired by the time input in google forms\n\n### Styling\n\n`<paper-time-input>` provides the following custom properties and mixins for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-time-input-dropdown-ripple-color` | dropdown ripple color | `--primary-color`\n`--paper-time-input-cotnainer` | Mixin applied to the inputs | `{}`\n`--paper-time-dropdown-input-cotnainer` | Mixin applied to the dropdown input | `{}`\n*/\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-listbox/paper-listbox\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nexport class PaperTimeInput extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          @apply --paper-font-common-base;\n        }\n\n        paper-input {\n          width: 30px;\n          text-align: center;\n          --paper-input-container-input: {\n            /* Damn you firefox\n             * Needed to hide spin num in firefox\n             * http://stackoverflow.com/questions/3790935/can-i-hide-the-html5-number-input-s-spin-box\n             */\n            -moz-appearance: textfield;\n            @apply --paper-time-input-cotnainer;\n          }\n          --paper-input-container-input-webkit-spinner: {\n            -webkit-appearance: none;\n            margin: 0;\n            display: none;\n          }\n          --paper-input-container-shared-input-style_-_-webkit-appearance: textfield;\n        }\n\n        paper-dropdown-menu {\n          width: 55px;\n          padding: 0;\n          /* Force ripple to use the whole container */\n          --paper-dropdown-menu-ripple: {\n            color: var(\n              --paper-time-input-dropdown-ripple-color,\n              var(--primary-color)\n            );\n          }\n          --paper-input-container-input: {\n            @apply --paper-font-button;\n            text-align: center;\n            padding-left: 5px;\n            @apply --paper-time-dropdown-input-cotnainer;\n          }\n          --paper-input-container-underline: {\n            border-color: transparent;\n          }\n          --paper-input-container-underline-focus: {\n            border-color: transparent;\n          }\n        }\n\n        paper-item {\n          cursor: pointer;\n          text-align: center;\n          font-size: 14px;\n        }\n\n        paper-listbox {\n          padding: 0;\n        }\n\n        label {\n          @apply --paper-font-caption;\n        }\n\n        .time-input-wrap {\n          @apply --layout-horizontal;\n          @apply --layout-no-wrap;\n        }\n\n        [hidden] {\n          display: none !important;\n        }\n      </style>\n\n      <label hidden$=\"[[hideLabel]]\">[[label]]</label>\n      <div class=\"time-input-wrap\">\n        <!-- Hour Input -->\n        <paper-input\n          id=\"hour\"\n          type=\"number\"\n          value=\"{{hour}}\"\n          on-change=\"_shouldFormatHour\"\n          required=\"\"\n          auto-validate=\"[[autoValidate]]\"\n          prevent-invalid-input=\"\"\n          maxlength=\"2\"\n          max=\"[[_computeHourMax(format)]]\"\n          min=\"0\"\n          no-label-float=\"\"\n          disabled=\"[[disabled]]\"\n        >\n          <span suffix=\"\" slot=\"suffix\">:</span>\n        </paper-input>\n\n        <!-- Min Input -->\n        <paper-input\n          id=\"min\"\n          type=\"number\"\n          value=\"{{min}}\"\n          on-change=\"_formatMin\"\n          required=\"\"\n          auto-validate=\"[[autoValidate]]\"\n          prevent-invalid-input=\"\"\n          maxlength=\"2\"\n          max=\"59\"\n          min=\"0\"\n          no-label-float=\"\"\n          disabled=\"[[disabled]]\"\n        >\n        </paper-input>\n\n        <!-- Dropdown Menu -->\n        <paper-dropdown-menu\n          id=\"dropdown\"\n          required=\"\"\n          hidden$=\"[[_equal(format, 24)]]\"\n          no-label-float=\"\"\n          disabled=\"[[disabled]]\"\n        >\n          <paper-listbox\n            attr-for-selected=\"name\"\n            selected=\"{{amPm}}\"\n            slot=\"dropdown-content\"\n          >\n            <paper-item name=\"AM\">AM</paper-item>\n            <paper-item name=\"PM\">PM</paper-item>\n          </paper-listbox>\n        </paper-dropdown-menu>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      /**\n       * Label for the input\n       */\n      label: {\n        type: String,\n        value: \"Time\",\n      },\n      /**\n       * auto validate time inputs\n       */\n      autoValidate: {\n        type: Boolean,\n        value: true,\n      },\n      /**\n       * hides the label\n       */\n      hideLabel: {\n        type: Boolean,\n        value: false,\n      },\n      /**\n       * 12 or 24 hr format\n       */\n      format: {\n        type: Number,\n        value: 12,\n      },\n      /**\n       * disables the inputs\n       */\n      disabled: {\n        type: Boolean,\n        value: false,\n      },\n      /**\n       * hour\n       */\n      hour: {\n        type: String,\n        notify: true,\n      },\n      /**\n       * minute\n       */\n      min: {\n        type: String,\n        notify: true,\n      },\n      /**\n       * AM or PM\n       */\n      amPm: {\n        type: String,\n        notify: true,\n        value: \"AM\",\n      },\n      /**\n       * Formatted time string\n       */\n      value: {\n        type: String,\n        notify: true,\n        readOnly: true,\n        computed: \"_computeTime(min, hour, amPm)\",\n      },\n    };\n  }\n\n  /**\n   * Validate the inputs\n   * @return {boolean}\n   */\n  validate() {\n    var valid = true;\n    // Validate hour & min fields\n    if (!this.$.hour.validate() | !this.$.min.validate()) {\n      valid = false;\n    }\n    // Validate AM PM if 12 hour time\n    if (this.format === 12 && !this.$.dropdown.validate()) {\n      valid = false;\n    }\n    return valid;\n  }\n\n  /**\n   * Create time string\n   */\n  _computeTime(min, hour, amPm) {\n    if (hour && min) {\n      // No ampm on 24 hr time\n      if (this.format === 24) {\n        amPm = \"\";\n      }\n      return hour + \":\" + min + \" \" + amPm;\n    }\n    return undefined;\n  }\n\n  /**\n   * Format min\n   */\n  _formatMin() {\n    if (this.min.toString().length === 1) {\n      this.min = this.min < 10 ? \"0\" + this.min : this.min;\n    }\n  }\n\n  /**\n   * Hour needs a leading zero in 24hr format\n   */\n  _shouldFormatHour() {\n    if (this.format === 24 && this.hour.toString().length === 1) {\n      this.hour = this.hour < 10 ? \"0\" + this.hour : this.hour;\n    }\n  }\n\n  /**\n   * 24 hour format has a max hr of 23\n   */\n  _computeHourMax(format) {\n    if (format === 12) {\n      return format;\n    }\n    return 23;\n  }\n\n  _equal(n1, n2) {\n    return n1 === n2;\n  }\n}\n\ncustomElements.define(\"paper-time-input\", PaperTimeInput);\n","import \"@polymer/paper-slider\";\n\nconst PaperSliderClass = customElements.get(\"paper-slider\");\nlet subTemplate;\n\nclass HaSlider extends PaperSliderClass {\n  static get template() {\n    if (!subTemplate) {\n      subTemplate = PaperSliderClass.template.cloneNode(true);\n\n      const superStyle = subTemplate.content.querySelector(\"style\");\n\n      // append style to add mirroring of pin in RTL\n      superStyle.appendChild(\n        document.createTextNode(`\n          :host([dir=\"rtl\"]) #sliderContainer.pin.expand > .slider-knob > .slider-knob-inner::after {\n            -webkit-transform: scale(1) translate(0, -17px) scaleX(-1) !important;\n            transform: scale(1) translate(0, -17px) scaleX(-1) !important;\n            }\n        `)\n      );\n    }\n    return subTemplate;\n  }\n\n  _calcStep(value) {\n    if (!this.step) {\n      return parseFloat(value);\n    }\n\n    const numSteps = Math.round((value - this.min) / this.step);\n    const stepStr = this.step.toString();\n    const stepPointAt = stepStr.indexOf(\".\");\n    if (stepPointAt !== -1) {\n      /**\n       * For small values of this.step, if we calculate the step using\n       * For non-integer values of this.step, if we calculate the step using\n       * `Math.round(value / step) * step` we may hit a precision point issue\n       * eg. 0.1 * 0.2 =  0.020000000000000004\n       * http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\n       *\n       * as a work around we can round with the decimal precision of `step`\n       */\n      const precision = 10 ** (stepStr.length - stepPointAt - 1);\n      return (\n        Math.round((numSteps * this.step + this.min) * precision) / precision\n      );\n    }\n\n    return numSteps * this.step + this.min;\n  }\n}\ncustomElements.define(\"ha-slider\", HaSlider);\n","import { HomeAssistant } from \"../types\";\n\nexport const setInputSelectOption = (\n  hass: HomeAssistant,\n  entity: string,\n  option: string\n) =>\n  hass.callService(\"input_select\", \"select_option\", {\n    option,\n    entity_id: entity,\n  });\n","export const stopPropagation = (ev) => ev.stopPropagation();\n","import { Map } from \"leaflet\";\n\n// Sets up a Leaflet map on the provided DOM element\nexport type LeafletModuleType = typeof import(\"leaflet\");\n\nexport const setupLeafletMap = async (\n  mapElement: HTMLElement,\n  darkMode = false\n): Promise<[Map, LeafletModuleType]> => {\n  if (!mapElement.parentNode) {\n    throw new Error(\"Cannot setup Leaflet map on disconnected element\");\n  }\n  // tslint:disable-next-line\n  const Leaflet = (await import(\n    /* webpackChunkName: \"leaflet\" */ \"leaflet\"\n  )) as LeafletModuleType;\n  Leaflet.Icon.Default.imagePath = \"/static/images/leaflet/images/\";\n\n  const map = Leaflet.map(mapElement);\n  const style = document.createElement(\"link\");\n  style.setAttribute(\"href\", \"/static/images/leaflet/leaflet.css\");\n  style.setAttribute(\"rel\", \"stylesheet\");\n  mapElement.parentNode.appendChild(style);\n  map.setView([52.3731339, 4.8903147], 13);\n  Leaflet.tileLayer(\n    `https://{s}.basemaps.cartocdn.com/${\n      darkMode ? \"dark_all\" : \"light_all\"\n    }/{z}/{x}/{y}${Leaflet.Browser.retina ? \"@2x.png\" : \".png\"}`,\n    {\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: \"abcd\",\n      minZoom: 0,\n      maxZoom: 20,\n    }\n  ).addTo(map);\n\n  return [map, Leaflet];\n};\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { HomeAssistant } from \"../types\";\nimport computeStateName from \"../common/entity/compute_state_name\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport interface EntityRegistryEntry {\n  entity_id: string;\n  name: string;\n  platform: string;\n  config_entry_id?: string;\n  device_id?: string;\n  disabled_by?: string;\n}\n\nexport interface EntityRegistryEntryUpdateParams {\n  name: string | null;\n  new_entity_id: string;\n}\n\nexport const computeEntityRegistryName = (\n  hass: HomeAssistant,\n  entry: EntityRegistryEntry\n): string | null => {\n  if (entry.name) {\n    return entry.name;\n  }\n  const state = hass.states[entry.entity_id];\n  return state ? computeStateName(state) : null;\n};\n\nexport const updateEntityRegistryEntry = (\n  hass: HomeAssistant,\n  entityId: string,\n  updates: Partial<EntityRegistryEntryUpdateParams>\n): Promise<EntityRegistryEntry> =>\n  hass.callWS<EntityRegistryEntry>({\n    type: \"config/entity_registry/update\",\n    entity_id: entityId,\n    ...updates,\n  });\n\nexport const removeEntityRegistryEntry = (\n  hass: HomeAssistant,\n  entityId: string\n): Promise<void> =>\n  hass.callWS({\n    type: \"config/entity_registry/remove\",\n    entity_id: entityId,\n  });\n\nconst fetchEntityRegistry = (conn) =>\n  conn.sendMessagePromise({\n    type: \"config/entity_registry/list\",\n  });\n\nconst subscribeEntityRegistryUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchEntityRegistry(conn).then((entities) =>\n          store.setState(entities, true)\n        ),\n      500,\n      true\n    ),\n    \"entity_registry_updated\"\n  );\n\nexport const subscribeEntityRegistry = (\n  conn: Connection,\n  onChange: (entities: EntityRegistryEntry[]) => void\n) =>\n  createCollection<EntityRegistryEntry[]>(\n    \"_entityRegistry\",\n    fetchEntityRegistry,\n    subscribeEntityRegistryUpdates,\n    conn,\n    onChange\n  );\n","import {\n  html,\n  LitElement,\n  PropertyDeclarations,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport \"./ha-icon\";\n\nclass HaLabelBadge extends LitElement {\n  public value?: string;\n  public icon?: string;\n  public label?: string;\n  public description?: string;\n  public image?: string;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      value: {},\n      icon: {},\n      label: {},\n      description: {},\n      image: {},\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    return html`\n      <div class=\"badge-container\">\n        <div class=\"label-badge\" id=\"badge\">\n          <div\n            class=\"${classMap({\n              value: true,\n              big: Boolean(this.value && this.value.length > 4),\n            })}\"\n          >\n            ${this.icon && !this.value && !this.image\n              ? html`\n                  <ha-icon .icon=\"${this.icon}\"></ha-icon>\n                `\n              : \"\"}\n            ${this.value && !this.image\n              ? html`\n                  <span>${this.value}</span>\n                `\n              : \"\"}\n          </div>\n          ${this.label\n            ? html`\n                <div\n                  class=\"${classMap({\n                    label: true,\n                    big: this.label.length > 5,\n                  })}\"\n                >\n                  <span>${this.label}</span>\n                </div>\n              `\n            : \"\"}\n        </div>\n        ${this.description\n          ? html`\n              <div class=\"title\">${this.description}</div>\n            `\n          : \"\"}\n      </div>\n    `;\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      css`\n        .badge-container {\n          display: inline-block;\n          text-align: center;\n          vertical-align: top;\n        }\n        .label-badge {\n          position: relative;\n          display: block;\n          margin: 0 auto;\n          width: var(--ha-label-badge-size, 2.5em);\n          text-align: center;\n          height: var(--ha-label-badge-size, 2.5em);\n          line-height: var(--ha-label-badge-size, 2.5em);\n          font-size: var(--ha-label-badge-font-size, 1.5em);\n          border-radius: 50%;\n          border: 0.1em solid var(--ha-label-badge-color, var(--primary-color));\n          color: var(--label-badge-text-color, rgb(76, 76, 76));\n\n          white-space: nowrap;\n          background-color: var(--label-badge-background-color, white);\n          background-size: cover;\n          transition: border 0.3s ease-in-out;\n        }\n        .label-badge .value {\n          font-size: 90%;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        .label-badge .value.big {\n          font-size: 70%;\n        }\n        .label-badge .label {\n          position: absolute;\n          bottom: -1em;\n          /* Make the label as wide as container+border. (parent_borderwidth / font-size) */\n          left: -0.2em;\n          right: -0.2em;\n          line-height: 1em;\n          font-size: 0.5em;\n        }\n        .label-badge .label span {\n          box-sizing: border-box;\n          max-width: 100%;\n          display: inline-block;\n          background-color: var(--ha-label-badge-color, var(--primary-color));\n          color: var(--ha-label-badge-label-color, white);\n          border-radius: 1em;\n          padding: 9% 16% 8% 16%; /* mostly apitalized text, not much descenders => bit more top margin */\n          font-weight: 500;\n          overflow: hidden;\n          text-transform: uppercase;\n          text-overflow: ellipsis;\n          transition: background-color 0.3s ease-in-out;\n          text-transform: var(--ha-label-badge-label-text-transform, uppercase);\n        }\n        .label-badge .label.big span {\n          font-size: 90%;\n          padding: 10% 12% 7% 12%; /* push smaller text a bit down to center vertically */\n        }\n        .badge-container .title {\n          margin-top: 1em;\n          font-size: var(--ha-label-badge-title-font-size, 0.9em);\n          width: var(--ha-label-badge-title-width, 5em);\n          font-weight: var(--ha-label-badge-title-font-weight, 400);\n          overflow: hidden;\n          text-overflow: ellipsis;\n          line-height: normal;\n        }\n      `,\n    ];\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (changedProperties.has(\"image\")) {\n      this.shadowRoot!.getElementById(\"badge\")!.style.backgroundImage = this\n        .image\n        ? `url(${this.image})`\n        : \"\";\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-label-badge\": HaLabelBadge;\n  }\n}\n\ncustomElements.define(\"ha-label-badge\", HaLabelBadge);\n","import { HomeAssistant } from \"../types\";\n\nimport { timeCachePromiseFunc } from \"../common/util/time-cache-function-promise\";\n\nexport const SUPPORT_PAUSE = 1;\nexport const SUPPORT_NEXT_TRACK = 32;\nexport const SUPPORTS_PLAY = 16384;\nexport const OFF_STATES = [\"off\", \"idle\"];\n\nexport interface MediaPlayerThumbnail {\n  content_type: string;\n  content: string;\n}\n\nexport const fetchMediaPlayerThumbnailWithCache = (\n  hass: HomeAssistant,\n  entityId: string\n) =>\n  timeCachePromiseFunc(\n    \"_media_playerTmb\",\n    9000,\n    fetchMediaPlayerThumbnail,\n    hass,\n    entityId\n  );\n\nexport const fetchMediaPlayerThumbnail = (\n  hass: HomeAssistant,\n  entityId: string\n) => {\n  return hass.callWS<MediaPlayerThumbnail>({\n    type: \"media_player_thumbnail\",\n    entity_id: entityId,\n  });\n};\n","import { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { Lovelace } from \"../../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"show-edit-card\": EditCardDialogParams;\n  }\n}\n\nlet registeredDialog = false;\nconst dialogShowEvent = \"show-edit-card\";\nconst dialogTag = \"hui-dialog-edit-card\";\n\nexport interface EditCardDialogParams {\n  lovelace: Lovelace;\n  path: [number] | [number, number];\n}\n\nconst registerEditCardDialog = (element: HTMLElement): Event =>\n  fireEvent(element, \"register-dialog\", {\n    dialogShowEvent,\n    dialogTag,\n    dialogImport: () =>\n      import(/* webpackChunkName: \"hui-dialog-edit-card\" */ \"./hui-dialog-edit-card\"),\n  });\n\nexport const showEditCardDialog = (\n  element: HTMLElement,\n  editCardDialogParams: EditCardDialogParams\n): void => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    registerEditCardDialog(element);\n  }\n  fireEvent(element, dialogShowEvent, editCardDialogParams);\n};\n","export const afterNextRender = (cb: () => void): void => {\n  requestAnimationFrame(() => setTimeout(cb, 0));\n};\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport { PaperToggleButtonElement } from \"@polymer/paper-toggle-button/paper-toggle-button\";\n\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { turnOnOffEntities } from \"../common/entity/turn-on-off-entities\";\nimport { HomeAssistant } from \"../../../types\";\nimport { forwardHaptic } from \"../../../data/haptics\";\n\n@customElement(\"hui-entities-toggle\")\nclass HuiEntitiesToggle extends LitElement {\n  @property() public entities?: string[];\n\n  @property() protected hass?: HomeAssistant;\n\n  @property() private _toggleEntities?: string[];\n\n  public updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (changedProperties.has(\"entities\")) {\n      this._toggleEntities = this.entities!.filter(\n        (entityId) =>\n          entityId in this.hass!.states &&\n          DOMAINS_TOGGLE.has(entityId.split(\".\", 1)[0])\n      );\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._toggleEntities) {\n      return html``;\n    }\n\n    return html`\n      <paper-toggle-button\n        aria-label=\"Toggle entities.\"\n        ?checked=\"${this._toggleEntities!.some((entityId) => {\n          const stateObj = this.hass!.states[entityId];\n          return stateObj && stateObj.state === \"on\";\n        })}\"\n        @change=\"${this._callService}\"\n      ></paper-toggle-button>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        width: 38px;\n        display: block;\n      }\n      paper-toggle-button {\n        cursor: pointer;\n        --paper-toggle-button-label-spacing: 0;\n        padding: 13px 5px;\n        margin: -4px -5px;\n      }\n    `;\n  }\n\n  private _callService(ev: MouseEvent): void {\n    forwardHaptic(\"light\");\n    const turnOn = (ev.target as PaperToggleButtonElement).checked;\n    turnOnOffEntities(this.hass!, this._toggleEntities!, turnOn!);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entities-toggle\": HuiEntitiesToggle;\n  }\n}\n","import computeDomain from \"../../../../common/entity/compute_domain\";\nimport { STATES_OFF } from \"../../../../common/const\";\nimport { HomeAssistant } from \"../../../../types\";\n\nexport const turnOnOffEntities = (\n  hass: HomeAssistant,\n  entityIds: string[],\n  turnOn = true\n): void => {\n  const domainsToCall = {};\n  entityIds.forEach((entityId) => {\n    if (STATES_OFF.includes(hass.states[entityId].state) === turnOn) {\n      const stateDomain = computeDomain(entityId);\n      const serviceDomain = [\"cover\", \"lock\"].includes(stateDomain)\n        ? stateDomain\n        : \"homeassistant\";\n\n      if (!(serviceDomain in domainsToCall)) {\n        domainsToCall[serviceDomain] = [];\n      }\n      domainsToCall[serviceDomain].push(entityId);\n    }\n  });\n\n  Object.keys(domainsToCall).forEach((domain) => {\n    let service;\n    switch (domain) {\n      case \"lock\":\n        service = turnOn ? \"unlock\" : \"lock\";\n        break;\n      case \"cover\":\n        service = turnOn ? \"open_cover\" : \"close_cover\";\n        break;\n      default:\n        service = turnOn ? \"turn_on\" : \"turn_off\";\n    }\n\n    const entities = domainsToCall[domain];\n    hass.callService(domain, service, { entity_id: entities });\n  });\n};\n","import computeStateName from \"../../../common/entity/compute_state_name\";\nimport {\n  LitElement,\n  html,\n  css,\n  CSSResult,\n  PropertyValues,\n  property,\n  TemplateResult,\n} from \"lit-element\";\n\nimport \"../../../components/entity/state-badge\";\nimport \"../../../components/ha-relative-time\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { computeRTL } from \"../../../common/util/compute_rtl\";\nimport { EntitiesCardEntityConfig } from \"../cards/types\";\n\nclass HuiGenericEntityRow extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public config?: EntitiesCardEntityConfig;\n\n  @property() public showSecondary: boolean = true;\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this.config) {\n      return html``;\n    }\n    const stateObj = this.config.entity\n      ? this.hass.states[this.config.entity]\n      : undefined;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this.config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <state-badge\n        .stateObj=\"${stateObj}\"\n        .overrideIcon=\"${this.config.icon}\"\n      ></state-badge>\n      <div class=\"flex\">\n        <div class=\"info\">\n          ${this.config.name || computeStateName(stateObj)}\n          <div class=\"secondary\">\n            ${!this.showSecondary\n              ? html`\n                  <slot name=\"secondary\"></slot>\n                `\n              : this.config.secondary_info === \"entity-id\"\n              ? stateObj.entity_id\n              : this.config.secondary_info === \"last-changed\"\n              ? html`\n                  <ha-relative-time\n                    .hass=\"${this.hass}\"\n                    .datetime=\"${stateObj.last_changed}\"\n                  ></ha-relative-time>\n                `\n              : \"\"}\n          </div>\n        </div>\n\n        <slot></slot>\n      </div>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (changedProps.has(\"hass\")) {\n      this.toggleAttribute(\"rtl\", computeRTL(this.hass!));\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      .flex {\n        flex: 1;\n        margin-left: 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        min-width: 0;\n      }\n      .info {\n        flex: 1 0 60px;\n      }\n      .info,\n      .info > * {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .flex ::slotted(*) {\n        margin-left: 8px;\n        min-width: 0;\n      }\n      .flex ::slotted([slot=\"secondary\"]) {\n        margin-left: 0;\n      }\n      .secondary,\n      ha-relative-time {\n        display: block;\n        color: var(--secondary-text-color);\n      }\n      state-badge {\n        flex: 0 0 40px;\n      }\n      :host([rtl]) .flex {\n        margin-left: 0;\n        margin-right: 16px;\n      }\n      :host([rtl]) .flex ::slotted(*) {\n        margin-left: 0;\n        margin-right: 8px;\n      }\n    `;\n  }\n}\ncustomElements.define(\"hui-generic-entity-row\", HuiGenericEntityRow);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/ha-climate-state\";\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-climate-entity-row\")\nclass HuiClimateEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <ha-climate-state\n          .hass=\"${this.hass}\"\n          .stateObj=\"${stateObj}\"\n        ></ha-climate-state>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-climate-state {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-climate-entity-row\": HuiClimateEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/ha-cover-controls\";\nimport \"../../../components/ha-cover-tilt-controls\";\nimport \"../components/hui-warning\";\n\nimport { isTiltOnly } from \"../../../util/cover-model\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-cover-entity-row\")\nclass HuiCoverEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${isTiltOnly(stateObj)\n          ? html`\n              <ha-cover-tilt-controls\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-cover-tilt-controls>\n            `\n          : html`\n              <ha-cover-controls\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-cover-controls>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-cover-controls,\n      ha-cover-tilt-controls {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-cover-entity-row\": HuiCoverEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-group-entity-row\")\nclass HuiGroupEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${this._computeCanToggle(stateObj.attributes.entity_id)\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <div>\n                ${computeStateDisplay(\n                  this.hass!.localize,\n                  stateObj,\n                  this.hass.language\n                )}\n              </div>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  private _computeCanToggle(entityIds): boolean {\n    return entityIds.some((entityId) =>\n      DOMAINS_TOGGLE.has(entityId.split(\".\", 1)[0])\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-group-entity-row\": HuiGroupEntityRow;\n  }\n}\n","import {\n  html,\n  css,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n} from \"lit-element\";\n\nimport \"@polymer/paper-input/paper-input\";\n// tslint:disable-next-line:no-duplicate-imports\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\n\n@customElement(\"ha-date-input\")\nexport class HaDateInput extends LitElement {\n  @property() public year?: string;\n  @property() public month?: string;\n  @property() public day?: string;\n  @property({ type: Boolean }) public disabled = false;\n\n  static get styles() {\n    return css`\n      :host {\n        display: block;\n        font-family: var(--paper-font-common-base_-_font-family);\n        -webkit-font-smoothing: var(\n          --paper-font-common-base_-_-webkit-font-smoothing\n        );\n      }\n\n      paper-input {\n        width: 30px;\n        text-align: center;\n        --paper-input-container-shared-input-style_-_-webkit-appearance: textfield;\n        --paper-input-container-input_-_-moz-appearance: textfield;\n        --paper-input-container-shared-input-style_-_appearance: textfield;\n        --paper-input-container-input-webkit-spinner_-_-webkit-appearance: none;\n        --paper-input-container-input-webkit-spinner_-_margin: 0;\n        --paper-input-container-input-webkit-spinner_-_display: none;\n      }\n\n      paper-input#year {\n        width: 50px;\n      }\n\n      .date-input-wrap {\n        display: flex;\n        flex-direction: row;\n      }\n    `;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"date-input-wrap\">\n        <paper-input\n          id=\"year\"\n          type=\"number\"\n          .value=${this.year}\n          @change=${this._formatYear}\n          maxlength=\"4\"\n          max=\"9999\"\n          min=\"0\"\n          .disabled=${this.disabled}\n          no-label-float\n        >\n          <span suffix=\"\" slot=\"suffix\">-</span>\n        </paper-input>\n        <paper-input\n          id=\"month\"\n          type=\"number\"\n          .value=${this.month}\n          @change=${this._formatMonth}\n          maxlength=\"2\"\n          max=\"12\"\n          min=\"1\"\n          .disabled=${this.disabled}\n          no-label-float\n        >\n          <span suffix=\"\" slot=\"suffix\">-</span>\n        </paper-input>\n        <paper-input\n          id=\"day\"\n          type=\"number\"\n          .value=${this.day}\n          @change=${this._formatDay}\n          maxlength=\"2\"\n          max=\"31\"\n          min=\"1\"\n          .disabled=${this.disabled}\n          no-label-float\n        >\n        </paper-input>\n      </div>\n    `;\n  }\n\n  private _formatYear() {\n    const yearElement = this.shadowRoot!.getElementById(\n      \"year\"\n    ) as PaperInputElement;\n    this.year = yearElement.value!;\n  }\n\n  private _formatMonth() {\n    const monthElement = this.shadowRoot!.getElementById(\n      \"month\"\n    ) as PaperInputElement;\n    this.month = (\"0\" + monthElement.value!).slice(-2);\n  }\n\n  private _formatDay() {\n    const dayElement = this.shadowRoot!.getElementById(\n      \"day\"\n    ) as PaperInputElement;\n    this.day = (\"0\" + dayElement.value!).slice(-2);\n  }\n\n  get value() {\n    return `${this.year}-${this.month}-${this.day}`;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-date-input\": HaDateInput;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  PropertyValues,\n  customElement,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/paper-time-input.js\";\n// tslint:disable-next-line:no-duplicate-imports\nimport { PaperTimeInput } from \"../../../components/paper-time-input.js\";\nimport \"../../../components/ha-date-input\";\n// tslint:disable-next-line:no-duplicate-imports\nimport { HaDateInput } from \"../../../components/ha-date-input\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { setInputDateTimeValue } from \"../../../data/input_datetime\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-input-datetime-entity-row\")\nclass HuiInputDatetimeEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.attributes.has_date\n          ? html`\n              <ha-date-input\n                .year=${stateObj.attributes.year}\n                .month=${(\"0\" + stateObj.attributes.month).slice(-2)}\n                .day=${(\"0\" + stateObj.attributes.day).slice(-2)}\n                @change=${this._selectedValueChanged}\n                @click=${this._stopEventPropagation}\n              ></ha-date-input>\n              ${stateObj.attributes.has_time ? \",\" : \"\"}\n            `\n          : ``}\n        ${stateObj.attributes.has_time\n          ? html`\n              <paper-time-input\n                .hour=${stateObj.state === \"unknown\"\n                  ? \"\"\n                  : (\"0\" + stateObj.attributes.hour).slice(-2)}\n                .min=${stateObj.state === \"unknown\"\n                  ? \"\"\n                  : (\"0\" + stateObj.attributes.minute).slice(-2)}\n                .amPm=${false}\n                @change=${this._selectedValueChanged}\n                @click=${this._stopEventPropagation}\n                hide-label\n                format=\"24\"\n              ></paper-time-input>\n            `\n          : ``}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  private _stopEventPropagation(ev: Event): void {\n    ev.stopPropagation();\n  }\n\n  private get _timeInputEl(): PaperTimeInput {\n    return this.shadowRoot!.querySelector(\"paper-time-input\")!;\n  }\n\n  private get _dateInputEl(): HaDateInput {\n    return this.shadowRoot!.querySelector(\"ha-date-input\")!;\n  }\n\n  private _selectedValueChanged(ev): void {\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    const time =\n      this._timeInputEl !== null\n        ? this._timeInputEl.value.trim() + \":00\"\n        : undefined;\n\n    const date =\n      this._dateInputEl !== null ? this._dateInputEl.value : undefined;\n\n    if (time !== stateObj.state) {\n      setInputDateTimeValue(this.hass!, stateObj.entity_id, time, date);\n    }\n\n    ev.target.blur();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-datetime-entity-row\": HuiInputDatetimeEntityRow;\n  }\n}\n","import { HomeAssistant } from \"../types\";\n\nexport const setInputDateTimeValue = (\n  hass: HomeAssistant,\n  entityId: string,\n  time: string | undefined = undefined,\n  date: string | undefined = undefined\n) => {\n  const param = { entity_id: entityId, time, date };\n  hass.callService(entityId.split(\".\", 1)[0], \"set_datetime\", param);\n};\n","import { HomeAssistant } from \"../types\";\n\nexport const setValue = (hass: HomeAssistant, entity: string, value: string) =>\n  hass.callService(entity.split(\".\", 1)[0], \"set_value\", {\n    value,\n    entity_id: entity,\n  });\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/ha-slider\";\nimport \"../components/hui-warning\";\n\nimport { computeRTLDirection } from \"../../../common/util/compute_rtl\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { setValue } from \"../../../data/input_text\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-input-number-entity-row\")\nclass HuiInputNumberEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  private _loaded?: boolean;\n\n  private _updated?: boolean;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (this._updated && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected firstUpdated(): void {\n    this._updated = true;\n    if (this.isConnected && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>\n          ${stateObj.attributes.mode === \"slider\"\n            ? html`\n                <div class=\"flex\">\n                  <ha-slider\n                    .dir=\"${computeRTLDirection(this.hass!)}\"\n                    .step=\"${Number(stateObj.attributes.step)}\"\n                    .min=\"${Number(stateObj.attributes.min)}\"\n                    .max=\"${Number(stateObj.attributes.max)}\"\n                    .value=\"${Number(stateObj.state)}\"\n                    pin\n                    @change=\"${this._selectedValueChanged}\"\n                    ignore-bar-touch\n                    id=\"input\"\n                  ></ha-slider>\n                  <span class=\"state\">\n                    ${Number(stateObj.state)}\n                    ${stateObj.attributes.unit_of_measurement}\n                  </span>\n                </div>\n              `\n            : html`\n                <paper-input\n                  no-label-float\n                  auto-validate\n                  .pattern=\"[0-9]+([\\\\.][0-9]+)?\"\n                  .step=\"${Number(stateObj.attributes.step)}\"\n                  .min=\"${Number(stateObj.attributes.min)}\"\n                  .max=\"${Number(stateObj.attributes.max)}\"\n                  .value=\"${Number(stateObj.state)}\"\n                  type=\"number\"\n                  @change=\"${this._selectedValueChanged}\"\n                  id=\"input\"\n                ></paper-input>\n              `}\n        </div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .flex {\n        display: flex;\n        align-items: center;\n      }\n      .state {\n        min-width: 45px;\n        text-align: end;\n      }\n      paper-input {\n        text-align: end;\n      }\n    `;\n  }\n\n  private async _initialLoad(): Promise<void> {\n    this._loaded = true;\n    await this.updateComplete;\n    const element = this.shadowRoot!.querySelector(\".state\") as HTMLElement;\n\n    if (!element || !this.parentElement) {\n      return;\n    }\n\n    element.hidden = this.parentElement.clientWidth <= 350;\n  }\n\n  private get _inputElement(): { value: string } {\n    // linter recommended the following syntax\n    return (this.shadowRoot!.getElementById(\"input\") as unknown) as {\n      value: string;\n    };\n  }\n\n  private _selectedValueChanged(): void {\n    const element = this._inputElement;\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (element.value !== stateObj.state) {\n      setValue(this.hass!, stateObj.entity_id, element.value!);\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-number-entity-row\": HuiInputNumberEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-listbox/paper-listbox\";\n\nimport \"../../../components/ha-paper-dropdown-menu\";\nimport \"../../../components/entity/state-badge\";\nimport \"../components/hui-warning\";\n\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { HomeAssistant, InputSelectEntity } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { setInputSelectOption } from \"../../../data/input-select\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { forwardHaptic } from \"../../../data/haptics\";\nimport { stopPropagation } from \"../../../common/dom/stop_propagation\";\n\n@customElement(\"hui-input-select-entity-row\")\nclass HuiInputSelectEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as\n      | InputSelectEntity\n      | undefined;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <state-badge .stateObj=\"${stateObj}\"></state-badge>\n      <ha-paper-dropdown-menu\n        .label=${this._config.name || computeStateName(stateObj)}\n        .value=${stateObj.state}\n        @iron-select=${this._selectedChanged}\n        @click=${stopPropagation}\n      >\n        <paper-listbox slot=\"dropdown-content\">\n          ${stateObj.attributes.options.map(\n            (option) => html`\n              <paper-item>${option}</paper-item>\n            `\n          )}\n        </paper-listbox>\n      </ha-paper-dropdown-menu>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n\n    if (!this.hass || !this._config) {\n      return;\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as\n      | InputSelectEntity\n      | undefined;\n\n    if (!stateObj) {\n      return;\n    }\n\n    // Update selected after rendering the items or else it won't work in Firefox\n    this.shadowRoot!.querySelector(\n      \"paper-listbox\"\n    )!.selected = stateObj.attributes.options.indexOf(stateObj.state);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      ha-paper-dropdown-menu {\n        margin-left: 16px;\n        flex: 1;\n      }\n\n      paper-item {\n        cursor: pointer;\n        min-width: 200px;\n      }\n    `;\n  }\n\n  private _selectedChanged(ev): void {\n    const stateObj = this.hass!.states[this._config!.entity];\n    const option = ev.target.selectedItem.innerText.trim();\n    if (option === stateObj.state) {\n      return;\n    }\n\n    forwardHaptic(\"light\");\n\n    setInputSelectOption(this.hass!, stateObj.entity_id, option);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-select-entity-row\": HuiInputSelectEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { setValue } from \"../../../data/input_text\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-input-text-entity-row\")\nclass HuiInputTextEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <paper-input\n          no-label-float\n          .value=\"${stateObj.state}\"\n          .minlength=\"${stateObj.attributes.min}\"\n          .maxlength=\"${stateObj.attributes.max}\"\n          .autoValidate=\"${stateObj.attributes.pattern}\"\n          .pattern=\"${stateObj.attributes.pattern}\"\n          .type=\"${stateObj.attributes.mode}\"\n          @change=\"${this._selectedValueChanged}\"\n          placeholder=\"(empty value)\"\n        ></paper-input>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  private get _inputEl(): PaperInputElement {\n    return this.shadowRoot!.querySelector(\"paper-input\") as PaperInputElement;\n  }\n\n  private _selectedValueChanged(ev): void {\n    const element = this._inputEl;\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (element.value !== stateObj.state) {\n      setValue(this.hass!, stateObj.entity_id, element.value!);\n    }\n\n    ev.target.blur();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-text-entity-row\": HuiInputTextEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-lock-entity-row\")\nclass HuiLockEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <mwc-button @click=\"${this._callService}\">\n          ${stateObj.state === \"locked\"\n            ? this.hass!.localize(\"ui.card.lock.unlock\")\n            : this.hass!.localize(\"ui.card.lock.lock\")}\n        </mwc-button>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService(ev): void {\n    ev.stopPropagation();\n    const stateObj = this.hass!.states[this._config!.entity];\n    this.hass!.callService(\n      \"lock\",\n      stateObj.state === \"locked\" ? \"unlock\" : \"lock\",\n      { entity_id: stateObj.entity_id }\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-lock-entity-row\": HuiLockEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { supportsFeature } from \"../../../common/entity/supports-feature\";\nimport {\n  SUPPORTS_PLAY,\n  SUPPORT_NEXT_TRACK,\n  OFF_STATES,\n  SUPPORT_PAUSE,\n} from \"../../../data/media-player\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-media-player-entity-row\")\nclass HuiMediaPlayerEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row\n        .hass=\"${this.hass}\"\n        .config=\"${this._config}\"\n        .showSecondary=\"false\"\n      >\n        ${OFF_STATES.includes(stateObj.state)\n          ? html`\n              <div>\n                ${this.hass!.localize(`state.media_player.${stateObj.state}`) ||\n                  this.hass!.localize(`state.default.${stateObj.state}`) ||\n                  stateObj.state}\n              </div>\n            `\n          : html`\n              <div class=\"controls\">\n                ${stateObj.state !== \"playing\" &&\n                !supportsFeature(stateObj, SUPPORTS_PLAY)\n                  ? \"\"\n                  : html`\n                      <paper-icon-button\n                        icon=\"${this._computeControlIcon(stateObj)}\"\n                        @click=\"${this._playPause}\"\n                      ></paper-icon-button>\n                    `}\n                ${supportsFeature(stateObj, SUPPORT_NEXT_TRACK)\n                  ? html`\n                      <paper-icon-button\n                        icon=\"hass:skip-next\"\n                        @click=\"${this._nextTrack}\"\n                      ></paper-icon-button>\n                    `\n                  : \"\"}\n              </div>\n              <div slot=\"secondary\">${this._computeMediaTitle(stateObj)}</div>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .controls {\n        white-space: nowrap;\n      }\n    `;\n  }\n\n  private _computeControlIcon(stateObj: HassEntity): string {\n    if (stateObj.state !== \"playing\") {\n      return \"hass:play\";\n    }\n\n    // tslint:disable-next-line:no-bitwise\n    return supportsFeature(stateObj, SUPPORT_PAUSE)\n      ? \"hass:pause\"\n      : \"hass:stop\";\n  }\n\n  private _computeMediaTitle(stateObj: HassEntity): string {\n    let prefix;\n    let suffix;\n\n    switch (stateObj.attributes.media_content_type) {\n      case \"music\":\n        prefix = stateObj.attributes.media_artist;\n        suffix = stateObj.attributes.media_title;\n        break;\n      case \"tvshow\":\n        prefix = stateObj.attributes.media_series_title;\n        suffix = stateObj.attributes.media_title;\n        break;\n      default:\n        prefix =\n          stateObj.attributes.media_title ||\n          stateObj.attributes.app_name ||\n          stateObj.state;\n        suffix = \"\";\n    }\n\n    return prefix && suffix ? `${prefix}: ${suffix}` : prefix || suffix || \"\";\n  }\n\n  private _playPause(ev: MouseEvent): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"media_player\", \"media_play_pause\", {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _nextTrack(ev: MouseEvent): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"media_player\", \"media_next_track\", {\n      entity_id: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-media-player-entity-row\": HuiMediaPlayerEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResult,\n  css,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-scene-entity-row\")\nclass HuiSceneEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.attributes.can_cancel\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <mwc-button @click=\"${this._callService}\">\n                ${this.hass!.localize(\"ui.card.scene.activate\")}\n              </mwc-button>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService(ev): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"scene\", \"turn_on\", {\n      entity_id: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-scene-entity-row\": HuiSceneEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-script-entity-row\")\nclass HuiScriptEntityRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.attributes.can_cancel\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <mwc-button @click=\"${this._callService}\">\n                ${this.hass!.localize(\"ui.card.script.execute\")}\n              </mwc-button>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService(ev): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"script\", \"turn_on\", {\n      entity_id: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-script-entity-row\": HuiScriptEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport format_date from \"../../../common/datetime/format_date\";\nimport format_date_time from \"../../../common/datetime/format_date_time\";\nimport format_time from \"../../../common/datetime/format_time\";\nimport relativeTime from \"../../../common/datetime/relative_time\";\n\nconst FORMATS: { [key: string]: (ts: Date, lang: string) => string } = {\n  date: format_date,\n  datetime: format_date_time,\n  time: format_time,\n};\nconst INTERVAL_FORMAT = [\"relative\", \"total\"];\n\n@customElement(\"hui-timestamp-display\")\nclass HuiTimestampDisplay extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public ts?: Date;\n\n  @property() public format?:\n    | \"relative\"\n    | \"total\"\n    | \"date\"\n    | \"datetime\"\n    | \"time\";\n\n  @property() private _relative?: string;\n\n  private _connected?: boolean;\n\n  private _interval?: number;\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._connected = true;\n    this._startInterval();\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._connected = false;\n    this._clearInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.ts || !this.hass) {\n      return html``;\n    }\n\n    if (isNaN(this.ts.getTime())) {\n      return html`\n        Invalid date\n      `;\n    }\n\n    const format = this._format;\n\n    if (INTERVAL_FORMAT.includes(format)) {\n      return html`\n        ${this._relative}\n      `;\n    }\n    if (format in FORMATS) {\n      return html`\n        ${FORMATS[format](this.ts, this.hass.language)}\n      `;\n    }\n    return html`\n      Invalid format\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (!changedProperties.has(\"format\") || !this._connected) {\n      return;\n    }\n\n    if (INTERVAL_FORMAT.includes(\"relative\")) {\n      this._startInterval();\n    } else {\n      this._clearInterval();\n    }\n  }\n\n  private get _format(): string {\n    return this.format || \"relative\";\n  }\n\n  private _startInterval(): void {\n    this._clearInterval();\n    if (this._connected && INTERVAL_FORMAT.includes(this._format)) {\n      this._updateRelative();\n      this._interval = window.setInterval(() => this._updateRelative(), 1000);\n    }\n  }\n\n  private _clearInterval(): void {\n    if (this._interval) {\n      clearInterval(this._interval);\n      this._interval = undefined;\n    }\n  }\n\n  private _updateRelative(): void {\n    if (this.ts && this.hass!.localize) {\n      this._relative =\n        this._format === \"relative\"\n          ? relativeTime(this.ts, this.hass!.localize)\n          : (this._relative = relativeTime(new Date(), this.hass!.localize, {\n              compareTime: this.ts,\n              includeTense: false,\n            }));\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-timestamp-display\": HuiTimestampDisplay;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-timestamp-display\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\ninterface SensorEntityConfig extends EntityConfig {\n  format?: \"relative\" | \"date\" | \"time\" | \"datetime\";\n}\n\n@customElement(\"hui-sensor-entity-row\")\nclass HuiSensorEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: SensorEntityConfig;\n\n  public setConfig(config: SensorEntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>\n          ${stateObj.attributes.device_class === \"timestamp\"\n            ? html`\n                <hui-timestamp-display\n                  .hass=\"${this.hass}\"\n                  .ts=\"${new Date(stateObj.state)}\"\n                  .format=\"${this._config.format}\"\n                ></hui-timestamp-display>\n              `\n            : computeStateDisplay(\n                this.hass!.localize,\n                stateObj,\n                this.hass.language\n              )}\n        </div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      div {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-sensor-entity-row\": HuiSensorEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-text-entity-row\")\nclass HuiTextEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>\n          ${computeStateDisplay(\n            this.hass!.localize,\n            stateObj,\n            this.hass.language\n          )}\n        </div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      div {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-text-entity-row\": HuiTextEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  PropertyValues,\n  customElement,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport timerTimeRemaining from \"../../../common/entity/timer_time_remaining\";\nimport secondsToDuration from \"../../../common/datetime/seconds_to_duration\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityConfig } from \"./types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-timer-entity-row\")\nclass HuiTimerEntityRow extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  @property() private _timeRemaining?: number;\n\n  private _interval?: number;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._clearInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>${this._computeDisplay(stateObj)}</div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_timeRemaining\")) {\n      return true;\n    }\n\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n\n    if (changedProps.has(\"hass\")) {\n      const stateObj = this.hass!.states[this._config!.entity];\n      const oldHass = changedProps.get(\"hass\") as this[\"hass\"];\n      const oldStateObj = oldHass\n        ? oldHass.states[this._config!.entity]\n        : undefined;\n\n      if (oldStateObj !== stateObj) {\n        this._startInterval(stateObj);\n      } else if (!stateObj) {\n        this._clearInterval();\n      }\n    }\n  }\n\n  private _clearInterval(): void {\n    if (this._interval) {\n      window.clearInterval(this._interval);\n      this._interval = undefined;\n    }\n  }\n\n  private _startInterval(stateObj: HassEntity): void {\n    this._clearInterval();\n    this._calculateRemaining(stateObj);\n\n    if (stateObj.state === \"active\") {\n      this._interval = window.setInterval(\n        () => this._calculateRemaining(stateObj),\n        1000\n      );\n    }\n  }\n\n  private _calculateRemaining(stateObj: HassEntity): void {\n    this._timeRemaining = timerTimeRemaining(stateObj);\n  }\n\n  private _computeDisplay(stateObj: HassEntity): string | null {\n    if (!stateObj) {\n      return null;\n    }\n\n    if (stateObj.state === \"idle\" || this._timeRemaining === 0) {\n      return this.hass!.localize(\"state.timer.\" + stateObj.state);\n    }\n\n    let display = secondsToDuration(this._timeRemaining || 0);\n\n    if (stateObj.state === \"paused\") {\n      display += ` (${this.hass!.localize(\"state.timer.paused\")})`;\n    }\n\n    return display;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-timer-entity-row\": HuiTimerEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-toggle-entity-row\")\nclass HuiToggleEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.state === \"on\" || stateObj.state === \"off\"\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <div>\n                ${computeStateDisplay(\n                  this.hass!.localize,\n                  stateObj,\n                  this.hass!.language\n                )}\n              </div>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-toggle-entity-row\": HuiToggleEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport \"@material/mwc-button\";\n\nimport \"../../../components/ha-icon\";\n\nimport { callService } from \"../common/call-service\";\nimport { EntityRow, CallServiceConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-call-service-row\")\nclass HuiCallServiceRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: CallServiceConfig;\n\n  public setConfig(config: CallServiceConfig): void {\n    if (!config || !config.name || !config.service) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    this._config = { icon: \"hass:remote\", action_name: \"Run\", ...config };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-icon .icon=\"${this._config.icon}\"></ha-icon>\n      <div class=\"flex\">\n        <div>${this._config.name}</div>\n        <mwc-button @click=\"${this._callService}\"\n          >${this._config.action_name}</mwc-button\n        >\n      </div>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      ha-icon {\n        padding: 8px;\n        color: var(--paper-item-icon-color);\n      }\n      .flex {\n        flex: 1;\n        overflow: hidden;\n        margin-left: 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n      .flex div {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService() {\n    callService(this._config!, this.hass!);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-call-service-row\": HuiCallServiceRow;\n  }\n}\n","import { HomeAssistant } from \"../../../types\";\nimport { CallServiceConfig } from \"../entity-rows/types\";\n\nexport const callService = (\n  config: CallServiceConfig,\n  hass: HomeAssistant\n): void => {\n  const entityId = config.entity;\n  const [domain, service] = config.service.split(\".\", 2);\n  const serviceData = { entity_id: entityId, ...config.service_data };\n  hass.callService(domain, service, serviceData);\n};\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport { EntityRow, DividerConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-divider-row\")\nclass HuiDividerRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: DividerConfig;\n\n  public setConfig(config): void {\n    if (!config) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    this._config = {\n      style: {\n        height: \"1px\",\n        \"background-color\": \"var(--secondary-text-color)\",\n      },\n      ...config,\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    const el = document.createElement(\"div\");\n\n    Object.keys(this._config.style).forEach((prop) => {\n      el.style.setProperty(prop, this._config!.style[prop]);\n    });\n\n    return html`\n      ${el}\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-divider-row\": HuiDividerRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { EntityRow, SectionConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\nimport \"../../../components/ha-icon\";\n\n@customElement(\"hui-section-row\")\nclass HuiSectionRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: SectionConfig;\n\n  public setConfig(config: SectionConfig): void {\n    if (!config) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <div class=\"divider\"></div>\n      ${this._config.label\n        ? html`\n            <div class=\"label\">${this._config.label}</div>\n          `\n        : html``}\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .label {\n        color: var(--primary-color);\n        margin-left: 8px;\n        margin-bottom: 16px;\n        margin-top: 16px;\n      }\n      .divider {\n        height: 1px;\n        background-color: var(--secondary-text-color);\n        opacity: 0.25;\n        margin-left: -16px;\n        margin-right: -16px;\n        margin-top: 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-section-row\": HuiSectionRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { EntityRow, WeblinkConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\nimport \"../../../components/ha-icon\";\n\n@customElement(\"hui-weblink-row\")\nclass HuiWeblinkRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: WeblinkConfig;\n\n  public setConfig(config: WeblinkConfig): void {\n    if (!config || !config.url) {\n      throw new Error(\"Invalid Configuration: 'url' required\");\n    }\n\n    this._config = {\n      icon: \"hass:link\",\n      name: config.url,\n      ...config,\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <a href=\"${this._config.url}\" target=\"_blank\">\n        <ha-icon .icon=\"${this._config.icon}\"></ha-icon>\n        <div>${this._config.name}</div>\n      </a>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      a {\n        display: flex;\n        align-items: center;\n        color: var(--primary-color);\n      }\n      ha-icon {\n        padding: 8px;\n        color: var(--paper-item-icon-color);\n      }\n      div {\n        flex: 1;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        margin-left: 16px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-weblink-row\": HuiWeblinkRow;\n  }\n}\n","import deepClone from \"deep-clone-simple\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\n\nimport {\n  createErrorCardElement,\n  createErrorCardConfig,\n  HuiErrorCard,\n} from \"../cards/hui-error-card\";\nimport \"../entity-rows/hui-climate-entity-row\";\nimport \"../entity-rows/hui-cover-entity-row\";\nimport \"../entity-rows/hui-group-entity-row\";\nimport \"../entity-rows/hui-input-datetime-entity-row\";\nimport \"../entity-rows/hui-input-number-entity-row\";\nimport \"../entity-rows/hui-input-select-entity-row\";\nimport \"../entity-rows/hui-input-text-entity-row\";\nimport \"../entity-rows/hui-lock-entity-row\";\nimport \"../entity-rows/hui-media-player-entity-row\";\nimport \"../entity-rows/hui-scene-entity-row\";\nimport \"../entity-rows/hui-script-entity-row\";\nimport \"../entity-rows/hui-sensor-entity-row\";\nimport \"../entity-rows/hui-text-entity-row\";\nimport \"../entity-rows/hui-timer-entity-row\";\nimport \"../entity-rows/hui-toggle-entity-row\";\nimport \"../special-rows/hui-call-service-row\";\nimport \"../special-rows/hui-divider-row\";\nimport \"../special-rows/hui-section-row\";\nimport \"../special-rows/hui-weblink-row\";\nimport { EntityConfig, EntityRow } from \"../entity-rows/types\";\n\nconst CUSTOM_TYPE_PREFIX = \"custom:\";\nconst SPECIAL_TYPES = new Set([\n  \"call-service\",\n  \"divider\",\n  \"section\",\n  \"weblink\",\n]);\nconst DOMAIN_TO_ELEMENT_TYPE = {\n  alert: \"toggle\",\n  automation: \"toggle\",\n  climate: \"climate\",\n  cover: \"cover\",\n  fan: \"toggle\",\n  group: \"group\",\n  input_boolean: \"toggle\",\n  input_number: \"input-number\",\n  input_select: \"input-select\",\n  input_text: \"input-text\",\n  light: \"toggle\",\n  lock: \"lock\",\n  media_player: \"media-player\",\n  remote: \"toggle\",\n  scene: \"scene\",\n  script: \"script\",\n  sensor: \"sensor\",\n  timer: \"timer\",\n  switch: \"toggle\",\n  vacuum: \"toggle\",\n  // Temporary. Once climate is rewritten,\n  // water heater should get it's own row.\n  water_heater: \"climate\",\n  input_datetime: \"input-datetime\",\n};\nconst TIMEOUT = 2000;\n\nconst _createElement = (\n  tag: string,\n  config: EntityConfig\n): EntityRow | HuiErrorCard => {\n  const element = document.createElement(tag) as EntityRow;\n  try {\n    element.setConfig(deepClone(config));\n  } catch (err) {\n    // tslint:disable-next-line\n    console.error(tag, err);\n    return _createErrorElement(err.message, config);\n  }\n\n  return element;\n};\n\nconst _createErrorElement = (\n  error: string,\n  config: EntityConfig\n): HuiErrorCard => createErrorCardElement(createErrorCardConfig(error, config));\n\nconst _hideErrorElement = (element) => {\n  element.style.display = \"None\";\n  return window.setTimeout(() => {\n    element.style.display = \"\";\n  }, TIMEOUT);\n};\n\nexport const createRowElement = (\n  config: EntityConfig\n): EntityRow | HuiErrorCard => {\n  let tag;\n\n  if (\n    !config ||\n    typeof config !== \"object\" ||\n    (!config.entity && !config.type)\n  ) {\n    return _createErrorElement(\"Invalid config given.\", config);\n  }\n\n  const type = config.type || \"default\";\n  if (SPECIAL_TYPES.has(type)) {\n    return _createElement(`hui-${type}-row`, config);\n  }\n\n  if (type.startsWith(CUSTOM_TYPE_PREFIX)) {\n    tag = type.substr(CUSTOM_TYPE_PREFIX.length);\n\n    if (customElements.get(tag)) {\n      return _createElement(tag, config);\n    }\n    const element = _createErrorElement(\n      `Custom element doesn't exist: ${tag}.`,\n      config\n    );\n    const timer = _hideErrorElement(element);\n\n    customElements.whenDefined(tag).then(() => {\n      clearTimeout(timer);\n      fireEvent(element, \"ll-rebuild\");\n    });\n\n    return element;\n  }\n\n  const domain = config.entity.split(\".\", 1)[0];\n  tag = `hui-${DOMAIN_TO_ELEMENT_TYPE[domain] || \"text\"}-entity-row`;\n\n  return _createElement(tag, config);\n};\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-entities-toggle\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { DOMAINS_HIDE_MORE_INFO } from \"../../../common/const\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow } from \"../entity-rows/types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { createRowElement } from \"../common/create-row-element\";\nimport { EntitiesCardConfig, EntitiesCardEntityConfig } from \"./types\";\n\nimport computeDomain from \"../../../common/entity/compute_domain\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\n\n@customElement(\"hui-entities-card\")\nclass HuiEntitiesCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-entities-card-editor\" */ \"../editor/config-elements/hui-entities-card-editor\");\n    return document.createElement(\"hui-entities-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { entities: [] };\n  }\n\n  @property() protected _config?: EntitiesCardConfig;\n\n  protected _hass?: HomeAssistant;\n\n  protected _configEntities?: EntitiesCardEntityConfig[];\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n    this.shadowRoot!.querySelectorAll(\"#states > div > *\").forEach(\n      (element: unknown) => {\n        (element as EntityRow).hass = hass;\n      }\n    );\n    const entitiesToggle = this.shadowRoot!.querySelector(\n      \"hui-entities-toggle\"\n    );\n    if (entitiesToggle) {\n      (entitiesToggle as any).hass = hass;\n    }\n  }\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 0;\n    }\n    // +1 for the header\n    return (this._config.title ? 1 : 0) + this._config.entities.length;\n  }\n\n  public setConfig(config: EntitiesCardConfig): void {\n    const entities = processConfigEntities(config.entities);\n\n    this._config = { theme: \"default\", ...config };\n    this._configEntities = entities;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (this._hass && this._config) {\n      applyThemesOnElement(this, this._hass.themes, this._config.theme);\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this._hass) {\n      return html``;\n    }\n    const { show_header_toggle, title } = this._config;\n\n    return html`\n      <ha-card>\n        ${!title && !show_header_toggle\n          ? html``\n          : html`\n              <div class=\"card-header\">\n                <div class=\"name\">${title}</div>\n                ${show_header_toggle === false\n                  ? html``\n                  : html`\n                      <hui-entities-toggle\n                        .hass=\"${this._hass}\"\n                        .entities=\"${this._configEntities!.map(\n                          (conf) => conf.entity\n                        )}\"\n                      ></hui-entities-toggle>\n                    `}\n              </div>\n            `}\n        <div id=\"states\" class=\"card-content\">\n          ${this._configEntities!.map((entityConf) =>\n            this.renderEntity(entityConf)\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .card-header {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .card-header .name {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n\n      .card-header hui-entities-toggle {\n        margin: -4px 0;\n      }\n\n      #states > * {\n        margin: 8px 0;\n      }\n\n      #states > div > * {\n        overflow: hidden;\n      }\n\n      .state-card-dialog {\n        cursor: pointer;\n      }\n    `;\n  }\n\n  private renderEntity(entityConf: EntitiesCardEntityConfig): TemplateResult {\n    const element = createRowElement(entityConf);\n    if (this._hass) {\n      element.hass = this._hass;\n    }\n    if (\n      entityConf.entity &&\n      !DOMAINS_HIDE_MORE_INFO.includes(computeDomain(entityConf.entity))\n    ) {\n      element.classList.add(\"state-card-dialog\");\n      element.addEventListener(\"click\", () => this._handleClick(entityConf));\n    }\n\n    return html`\n      <div>${element}</div>\n    `;\n  }\n\n  private _handleClick(entityConf: EntitiesCardEntityConfig): void {\n    const entityId = entityConf.entity;\n    fireEvent(this, \"hass-more-info\", { entityId });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entities-card\": HuiEntitiesCard;\n  }\n}\n","/**\n@license\nCopyright (c) 2015 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n/*\nThis code is copied from app-header-layout.\n'fullbleed' support is removed as Home Assisstant doesn't use it.\ntransform: translate(0) is added.\n*/\n/*\n  FIXME(polymer-modulizer): the above comments were extracted\n  from HTML and may be out of place here. Review them and\n  then delete this comment!\n*/\nimport \"@polymer/app-layout/app-header-layout/app-header-layout\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport \"@polymer/polymer/polymer-element\";\n\nclass HaAppLayout extends customElements.get(\"app-header-layout\") {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          /**\n         * Force app-header-layout to have its own stacking context so that its parent can\n         * control the stacking of it relative to other elements (e.g. app-drawer-layout).\n         * This could be done using \\`isolation: isolate\\`, but that's not well supported\n         * across browsers.\n         */\n          position: relative;\n          z-index: 0;\n        }\n\n        #wrapper ::slotted([slot=\"header\"]) {\n          @apply --layout-fixed-top;\n          z-index: 1;\n        }\n\n        #wrapper.initializing ::slotted([slot=\"header\"]) {\n          position: relative;\n        }\n\n        :host([has-scrolling-region]) {\n          height: 100%;\n        }\n\n        :host([has-scrolling-region]) #wrapper ::slotted([slot=\"header\"]) {\n          position: absolute;\n        }\n\n        :host([has-scrolling-region])\n          #wrapper.initializing\n          ::slotted([slot=\"header\"]) {\n          position: relative;\n        }\n\n        :host([has-scrolling-region]) #wrapper #contentContainer {\n          @apply --layout-fit;\n          overflow-y: auto;\n          -webkit-overflow-scrolling: touch;\n        }\n\n        :host([has-scrolling-region]) #wrapper.initializing #contentContainer {\n          position: relative;\n        }\n\n        #contentContainer {\n          /* Create a stacking context here so that all children appear below the header. */\n          position: relative;\n          z-index: 0;\n          /* Using 'transform' will cause 'position: fixed' elements to behave like\n           'position: absolute' relative to this element. */\n          transform: translate(0);\n        }\n\n        @media print {\n          :host([has-scrolling-region]) #wrapper #contentContainer {\n            overflow-y: visible;\n          }\n        }\n      </style>\n\n      <div id=\"wrapper\" class=\"initializing\">\n        <slot id=\"headerSlot\" name=\"header\"></slot>\n\n        <div id=\"contentContainer\"><slot></slot></div>\n        <slot id=\"fab\" name=\"fab\"></slot>\n      </div>\n    `;\n  }\n}\ncustomElements.define(\"ha-app-layout\", HaAppLayout);\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport { EventsMixin } from \"../mixins/events-mixin\";\n\nimport isComponentLoaded from \"../common/config/is_component_loaded\";\nimport { fireEvent } from \"../common/dom/fire_event\";\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaStartVoiceButton extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <paper-icon-button\n        aria-label=\"Start conversation\"\n        icon=\"hass:microphone\"\n        hidden$=\"[[!canListen]]\"\n        on-click=\"handleListenClick\"\n      ></paper-icon-button>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n        value: null,\n      },\n\n      canListen: {\n        type: Boolean,\n        computed: \"computeCanListen(hass)\",\n        notify: true,\n      },\n    };\n  }\n\n  computeCanListen(hass) {\n    return (\n      \"webkitSpeechRecognition\" in window &&\n      isComponentLoaded(hass, \"conversation\")\n    );\n  }\n\n  handleListenClick() {\n    fireEvent(this, \"show-dialog\", {\n      dialogImport: () =>\n        import(\n          /* webpackChunkName: \"voice-command-dialog\" */ \"../dialogs/ha-voice-command-dialog\"\n        ),\n      dialogTag: \"ha-voice-command-dialog\",\n    });\n  }\n}\n\ncustomElements.define(\"ha-start-voice-button\", HaStartVoiceButton);\n","import { Constructor } from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { PaperIconButtonElement } from \"@polymer/paper-icon-button/paper-icon-button\";\n\nconst paperIconButtonClass = customElements.get(\n  \"paper-icon-button\"\n) as Constructor<PaperIconButtonElement>;\n\nexport class HaPaperIconButtonArrowNext extends paperIconButtonClass {\n  public connectedCallback() {\n    this.icon =\n      window.getComputedStyle(this).direction === \"ltr\"\n        ? \"hass:arrow-right\"\n        : \"hass:arrow-left\";\n\n    // calling super after setting icon to have it consistently show the icon (otherwise not always shown)\n    super.connectedCallback();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-icon-button-arrow-next\": HaPaperIconButtonArrowNext;\n  }\n}\n\ncustomElements.define(\n  \"ha-paper-icon-button-arrow-next\",\n  HaPaperIconButtonArrowNext\n);\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\n\nconst fetchNotifications = (conn) =>\n  conn.sendMessagePromise({\n    type: \"persistent_notification/get\",\n  });\n\nconst subscribeUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    () => fetchNotifications(conn).then((ntf) => store.setState(ntf, true)),\n    \"persistent_notifications_updated\"\n  );\n\nexport const subscribeNotifications = (\n  conn: Connection,\n  onChange: (notifications: Notification[]) => void\n) =>\n  createCollection<Notification[]>(\n    \"_ntf\",\n    fetchNotifications,\n    subscribeUpdates,\n    conn,\n    onChange\n  );\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../../components/ha-card\";\n\n@customElement(\"hui-notification-item-template\")\nexport class HuiNotificationItemTemplate extends LitElement {\n  protected render(): TemplateResult | void {\n    return html`\n      <ha-card>\n        <div class=\"header\"><slot name=\"header\"></slot></div>\n        <div class=\"contents\"><slot></slot></div>\n        <div class=\"actions\"><slot name=\"actions\"></slot></div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .contents {\n        padding: 16px;\n        -ms-user-select: text;\n        -webkit-user-select: text;\n        -moz-user-select: text;\n        user-select: text;\n      }\n\n      ha-card .header {\n        /* start paper-font-headline style */\n        font-family: \"Roboto\", \"Noto\", sans-serif;\n        -webkit-font-smoothing: antialiased; /* OS X subpixel AA bleed bug */\n        text-rendering: optimizeLegibility;\n        font-size: 24px;\n        font-weight: 400;\n        letter-spacing: -0.012em;\n        line-height: 32px;\n        /* end paper-font-headline style */\n\n        color: var(--primary-text-color);\n        padding: 16px 16px 0;\n      }\n\n      .actions {\n        border-top: 1px solid #e8e8e8;\n        padding: 5px 16px;\n      }\n\n      ::slotted(.primary) {\n        color: var(--primary-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-notification-item-template\": HuiNotificationItemTemplate;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport \"@material/mwc-button\";\n\nimport \"./hui-notification-item-template\";\n\nimport { HomeAssistant } from \"../../../../types\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { HassNotification } from \"./types\";\n\n@customElement(\"hui-configurator-notification-item\")\nexport class HuiConfiguratorNotificationItem extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public notification?: HassNotification;\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this.notification) {\n      return html``;\n    }\n\n    return html`\n      <hui-notification-item-template>\n        <span slot=\"header\">${this.hass.localize(\"domain.configurator\")}</span>\n\n        <div>\n          ${this.hass.localize(\n            \"ui.notification_drawer.click_to_configure\",\n            \"entity\",\n            this.notification.attributes.friendly_name\n          )}\n        </div>\n\n        <mwc-button slot=\"actions\" @click=\"${this._handleClick}\"\n          >${this.hass.localize(\n            `state.configurator.${this.notification.state}`\n          )}</mwc-button\n        >\n      </hui-notification-item-template>\n    `;\n  }\n\n  private _handleClick(): void {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this.notification!.entity_id,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-configurator-notification-item\": HuiConfiguratorNotificationItem;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport \"@material/mwc-button\";\nimport \"@polymer/paper-tooltip/paper-tooltip\";\n\nimport \"../../../../components/ha-relative-time\";\nimport \"../../../../components/ha-markdown\";\nimport \"./hui-notification-item-template\";\n\nimport { HomeAssistant } from \"../../../../types\";\nimport { HassNotification } from \"./types\";\n\n@customElement(\"hui-persistent-notification-item\")\nexport class HuiPersistentNotificationItem extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public notification?: HassNotification;\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this.notification) {\n      return html``;\n    }\n\n    return html`\n      <hui-notification-item-template>\n        <span slot=\"header\">${this._computeTitle(this.notification)}</span>\n\n        <ha-markdown content=\"${this.notification.message}\"></ha-markdown>\n\n        <div class=\"time\">\n          <span>\n            <ha-relative-time\n              .hass=\"${this.hass}\"\n              .datetime=\"${this.notification.created_at}\"\n            ></ha-relative-time>\n            <paper-tooltip\n              >${this._computeTooltip(\n                this.hass,\n                this.notification\n              )}</paper-tooltip\n            >\n          </span>\n        </div>\n\n        <mwc-button slot=\"actions\" @click=\"${this._handleDismiss}\"\n          >${this.hass.localize(\n            \"ui.card.persistent_notification.dismiss\"\n          )}</mwc-button\n        >\n      </hui-notification-item-template>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .time {\n        display: flex;\n        justify-content: flex-end;\n        margin-top: 6px;\n      }\n      ha-relative-time {\n        color: var(--secondary-text-color);\n      }\n      a {\n        color: var(--primary-color);\n      }\n    `;\n  }\n\n  private _handleDismiss(): void {\n    this.hass!.callService(\"persistent_notification\", \"dismiss\", {\n      notification_id: this.notification!.notification_id,\n    });\n  }\n\n  private _computeTitle(notification: HassNotification): string | undefined {\n    return notification.title || notification.notification_id;\n  }\n\n  private _computeTooltip(\n    hass: HomeAssistant,\n    notification: HassNotification\n  ): string | undefined {\n    if (!hass || !notification) {\n      return undefined;\n    }\n\n    const d = new Date(notification.created_at!);\n    return d.toLocaleDateString(hass.language, {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n      minute: \"numeric\",\n      hour: \"numeric\",\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-persistent-notification-item\": HuiPersistentNotificationItem;\n  }\n}\n","import {\n  LitElement,\n  property,\n  customElement,\n  PropertyValues,\n  TemplateResult,\n  html,\n} from \"lit-element\";\n\nimport \"./hui-configurator-notification-item\";\nimport \"./hui-persistent-notification-item\";\n\nimport { HomeAssistant } from \"../../../../types\";\nimport { HassNotification } from \"./types\";\n\n@customElement(\"hui-notification-item\")\nexport class HuiNotificationItem extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public notification?: HassNotification;\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (!this.hass || !this.notification || changedProps.has(\"notification\")) {\n      return true;\n    }\n\n    return false;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this.notification) {\n      return html``;\n    }\n\n    return this.notification.entity_id\n      ? html`\n          <hui-configurator-notification-item\n            .hass=\"${this.hass}\"\n            .notification=\"${this.notification}\"\n          ></hui-configurator-notification-item>\n        `\n      : html`\n          <hui-persistent-notification-item\n            .hass=\"${this.hass}\"\n            .notification=\"${this.notification}\"\n          ></hui-persistent-notification-item>\n        `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-notification-item\": HuiNotificationItem;\n  }\n}\n","import { Constructor } from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { PaperIconButtonElement } from \"@polymer/paper-icon-button/paper-icon-button\";\n\nconst paperIconButtonClass = customElements.get(\n  \"paper-icon-button\"\n) as Constructor<PaperIconButtonElement>;\n\nexport class HaPaperIconButtonNext extends paperIconButtonClass {\n  public connectedCallback() {\n    this.icon =\n      window.getComputedStyle(this).direction === \"ltr\"\n        ? \"hass:chevron-right\"\n        : \"hass:chevron-left\";\n\n    // calling super after setting icon to have it consistently show the icon (otherwise not always shown)\n    super.connectedCallback();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-icon-button-next\": HaPaperIconButtonNext;\n  }\n}\n\ncustomElements.define(\"ha-paper-icon-button-next\", HaPaperIconButtonNext);\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar\";\n\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"./hui-notification-item\";\nimport \"../../../../components/ha-paper-icon-button-next\";\n\nimport { EventsMixin } from \"../../../../mixins/events-mixin\";\nimport LocalizeMixin from \"../../../../mixins/localize-mixin\";\nimport { computeRTL } from \"../../../../common/util/compute_rtl\";\n\n/*\n * @appliesMixin EventsMixin\n * @appliesMixin LocalizeMixin\n */\nexport class HuiNotificationDrawer extends EventsMixin(\n  LocalizeMixin(PolymerElement)\n) {\n  static get template() {\n    return html`\n    <style include=\"paper-material-styles\">\n      :host {\n        bottom: 0;\n        left: 0;\n        position: absolute;\n        right: 0;\n        top: 0;\n      }\n\n      :host([hidden]) {\n        display: none;\n      }\n\n      .container {\n        align-items: stretch;\n        background: var(--sidebar-background-color, var(--primary-background-color));\n        bottom: 0;\n        box-shadow: var(--paper-material-elevation-1_-_box-shadow);\n        display: flex;\n        flex-direction: column;\n        overflow-y: hidden;\n        position: fixed;\n        top: 0;\n        transition: right .2s ease-in;\n        width: 500px;\n        z-index: 10;\n      }\n\n      :host([rtl]) .container {\n        transition: left .2s ease-in !important;\n      }\n\n      :host(:not(narrow)) .container {\n        right: -500px;\n      }\n\n      :host([rtl]:not(narrow)) .container {\n        left: -500px;\n      }\n\n      :host([narrow]) .container {\n        right: -100%;\n        width: 100%;\n      }\n\n      :host([rtl][narrow]) .container {\n        left: -100%;\n        width: 100%;\n      }\n\n      :host(.open) .container,\n      :host(.open[narrow]) .container {\n        right: 0;\n      }\n\n      :host([rtl].open) .container,\n      :host([rtl].open[narrow]) .container {\n        left: 0;\n      }\n\n      app-toolbar {\n        color: var(--primary-text-color);\n        border-bottom: 1px solid var(--divider-color);\n        background-color: var(--primary-background-color);\n        min-height: 64px;\n        width: calc(100% - 32px);\n        z-index: 11;\n      }\n\n      .overlay {\n        display: none;\n      }\n\n      :host(.open) .overlay {\n        bottom: 0;\n        display: block;\n        left: 0;\n        position: absolute;\n        right: 0;\n        top: 0;\n        z-index: 5;\n      }\n\n      .notifications {\n        overflow-y: auto;\n        padding-top: 16px;\n      }\n\n      .notification {\n        padding: 0 16px 16px;\n      }\n\n      .empty {\n        padding: 16px;\n        text-align: center;\n      }\n    </style>\n    <div class=\"overlay\" on-click=\"_closeDrawer\"></div>\n    <div class=\"container\">\n      <app-toolbar>\n        <div main-title>[[localize('ui.notification_drawer.title')]]</div>\n        <ha-paper-icon-button-next on-click=\"_closeDrawer\"></paper-icon-button>\n      </app-toolbar>\n      <div class=\"notifications\">\n        <template is=\"dom-if\" if=\"[[!_empty(notifications)]]\">\n          <dom-repeat items=\"[[notifications]]\">\n            <template>\n              <div class=\"notification\">\n                <hui-notification-item hass=\"[[hass]]\" notification=\"[[item]]\"></hui-notification-item>\n              </div>\n            </template>\n          </dom-repeat>\n        </template>\n        <template is=\"dom-if\" if=\"[[_empty(notifications)]]\">\n          <div class=\"empty\">[[localize('ui.notification_drawer.empty')]]<div>\n        </template>\n      </div>\n    </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      narrow: {\n        type: Boolean,\n        reflectToAttribute: true,\n      },\n      open: {\n        type: Boolean,\n        notify: true,\n        observer: \"_openChanged\",\n      },\n      hidden: {\n        type: Boolean,\n        value: true,\n        reflectToAttribute: true,\n      },\n      notifications: {\n        type: Array,\n        value: [],\n      },\n      rtl: {\n        type: Boolean,\n        reflectToAttribute: true,\n        computed: \"_computeRTL(hass)\",\n      },\n    };\n  }\n\n  _closeDrawer(ev) {\n    ev.stopPropagation();\n    this.open = false;\n  }\n\n  _empty(notifications) {\n    return notifications.length === 0;\n  }\n\n  _openChanged(open) {\n    clearTimeout(this._openTimer);\n    if (open) {\n      // Render closed then animate open\n      this.hidden = false;\n      this._openTimer = setTimeout(() => {\n        this.classList.add(\"open\");\n      }, 50);\n    } else {\n      // Animate closed then hide\n      this.classList.remove(\"open\");\n      this._openTimer = setTimeout(() => {\n        this.hidden = true;\n      }, 250);\n    }\n  }\n\n  _computeRTL(hass) {\n    return computeRTL(hass);\n  }\n}\ncustomElements.define(\"hui-notification-drawer\", HuiNotificationDrawer);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n} from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\n\ndeclare global {\n  // tslint:disable-next-line\n  interface HASSDomEvents {\n    \"opened-changed\": { value: boolean };\n  }\n}\n\nclass HuiNotificationsButton extends LitElement {\n  @property() public notifications?: string[];\n  @property() public opened?: boolean;\n\n  protected render(): TemplateResult | void {\n    return html`\n      <paper-icon-button\n        aria-label=\"Show Notifications\"\n        icon=\"hass:bell\"\n        @click=\"${this._clicked}\"\n      ></paper-icon-button>\n      ${this.notifications && this.notifications.length > 0\n        ? html`\n            <span class=\"indicator\">\n              <div>${this.notifications.length}</div>\n            </span>\n          `\n        : \"\"}\n    `;\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      css`\n        :host {\n          position: relative;\n        }\n\n        .indicator {\n          position: absolute;\n          top: 0px;\n          right: -3px;\n          width: 20px;\n          height: 20px;\n          border-radius: 50%;\n          background: var(--accent-color);\n          pointer-events: none;\n          z-index: 1;\n        }\n\n        .indicator > div {\n          right: 7px;\n          top: 3px;\n          position: absolute;\n          font-size: 0.55em;\n        }\n      `,\n    ];\n  }\n\n  private _clicked() {\n    this.opened = true;\n    fireEvent(this, \"opened-changed\", { value: this.opened });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-notifications-button\": HuiNotificationsButton;\n  }\n}\n\ncustomElements.define(\"hui-notifications-button\", HuiNotificationsButton);\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  property,\n  PropertyDeclarations,\n  TemplateResult,\n} from \"lit-element\";\n\nimport \"../../components/entity/ha-state-label-badge\";\n// This one is for types\n// tslint:disable-next-line\nimport { HaStateLabelBadge } from \"../../components/entity/ha-state-label-badge\";\n\nimport applyThemesOnElement from \"../../common/dom/apply_themes_on_element\";\n\nimport { LovelaceViewConfig, LovelaceCardConfig } from \"../../data/lovelace\";\nimport { HomeAssistant } from \"../../types\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport { Lovelace, LovelaceCard } from \"./types\";\nimport { createCardElement } from \"./common/create-card-element\";\nimport { computeCardSize } from \"./common/compute-card-size\";\nimport { showEditCardDialog } from \"./editor/card-editor/show-edit-card-dialog\";\nimport { HuiErrorCard } from \"./cards/hui-error-card\";\n\nimport { computeRTL } from \"../../common/util/compute_rtl\";\n\nlet editCodeLoaded = false;\n\n// Find column with < 5 entities, else column with lowest count\nconst getColumnIndex = (columnEntityCount: number[], size: number) => {\n  let minIndex = 0;\n  for (let i = 0; i < columnEntityCount.length; i++) {\n    if (columnEntityCount[i] < 5) {\n      minIndex = i;\n      break;\n    }\n    if (columnEntityCount[i] < columnEntityCount[minIndex]) {\n      minIndex = i;\n    }\n  }\n\n  columnEntityCount[minIndex] += size;\n\n  return minIndex;\n};\n\nexport class HUIView extends LitElement {\n  @property() public hass?: HomeAssistant;\n  \n  @property() public lovelace?: Lovelace;\n  \n  @property() public columns?: number;\n  \n  @property() public index?: number;\n  \n  private _cards: Array<LovelaceCard | HuiErrorCard>;\n  private _badges: Array<{ element: HaStateLabelBadge; entityId: string }>;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      hass: {},\n      lovelace: {},\n      columns: {},\n      index: {},\n      _cards: {},\n      _badges: {},\n    };\n  }\n\n  constructor() {\n    super();\n    this._cards = [];\n    this._badges = [];\n  }\n\n  // Public to make demo happy\n  public createCardElement(cardConfig: LovelaceCardConfig) {\n    const element = createCardElement(cardConfig) as LovelaceCard;\n    element.hass = this.hass;\n    element.addEventListener(\n      \"ll-rebuild\",\n      (ev) => {\n        // In edit mode let it go to hui-root and rebuild whole view.\n        if (!this.lovelace!.editMode) {\n          ev.stopPropagation();\n          this._rebuildCard(element, cardConfig);\n        }\n      },\n      { once: true }\n    );\n    return element;\n  }\n\n  protected render(): TemplateResult | void {\n    return html`\n      ${this.renderStyles()}\n      <div id=\"badges\"></div>\n      <div id=\"columns\"></div>\n      ${this.lovelace!.editMode\n        ? html`\n            <paper-fab\n              elevated=\"2\"\n              icon=\"hass:plus\"\n              title=\"${this.hass!.localize(\n                \"ui.panel.lovelace.editor.edit_card.add\"\n              )}\"\n              @click=\"${this._addCard}\"\n              class=\"${classMap({\n                rtl: computeRTL(this.hass!),\n              })}\"\n            ></paper-fab>\n          `\n        : \"\"}\n    `;\n  }\n\n  protected renderStyles(): TemplateResult {\n    return html`\n      <style>\n        :host {\n          display: block;\n          padding: 4px 4px 0;\n          transform: translateZ(0);\n          position: relative;\n          min-height: calc(100vh - 155px);\n        }\n\n        #badges {\n          margin: 8px 16px;\n          font-size: 85%;\n          text-align: center;\n        }\n\n        #columns {\n          display: flex;\n          flex-direction: row;\n          justify-content: center;\n        }\n\n        .column {\n          flex-basis: 0;\n          flex-grow: 1;\n          max-width: 500px;\n          overflow-x: hidden;\n        }\n\n        .column > * {\n          display: block;\n          margin: 4px 4px 8px;\n        }\n\n        paper-fab {\n          position: sticky;\n          float: right;\n          bottom: 16px;\n          right: 16px;\n          z-index: 1;\n        }\n\n        paper-fab.rtl {\n          float: left;\n          right: auto;\n          left: 16px;\n        }\n\n        @media (max-width: 500px) {\n          :host {\n            padding-left: 0;\n            padding-right: 0;\n          }\n\n          .column > * {\n            margin-left: 0;\n            margin-right: 0;\n          }\n        }\n\n        @media (max-width: 599px) {\n          .column {\n            max-width: 600px;\n          }\n        }\n      </style>\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    const lovelace = this.lovelace!;\n\n    if (lovelace.editMode && !editCodeLoaded) {\n      editCodeLoaded = true;\n      import(/* webpackChunkName: \"hui-view-editable\" */ \"./hui-view-editable\");\n    }\n\n    let editModeChanged = false;\n    let configChanged = false;\n\n    if (changedProperties.has(\"lovelace\")) {\n      const oldLovelace = changedProperties.get(\"lovelace\") as Lovelace;\n      editModeChanged =\n        !oldLovelace || lovelace.editMode !== oldLovelace.editMode;\n      configChanged = !oldLovelace || lovelace.config !== oldLovelace.config;\n    }\n\n    if (configChanged) {\n      this._createBadges(lovelace.config.views[this.index!]);\n    } else if (changedProperties.has(\"hass\")) {\n      this._badges.forEach((badge) => {\n        const { element, entityId } = badge;\n        element.hass = this.hass!;\n        element.state = this.hass!.states[entityId];\n      });\n    }\n\n    if (configChanged || editModeChanged || changedProperties.has(\"columns\")) {\n      this._createCards(lovelace.config.views[this.index!]);\n    } else if (changedProperties.has(\"hass\")) {\n      this._cards.forEach((element) => {\n        element.hass = this.hass;\n      });\n    }\n  }\n\n  private _addCard(): void {\n    showEditCardDialog(this, {\n      lovelace: this.lovelace!,\n      path: [this.index!],\n    });\n  }\n\n  private _createBadges(config: LovelaceViewConfig): void {\n    const root = this.shadowRoot!.getElementById(\"badges\")!;\n\n    while (root.lastChild) {\n      root.removeChild(root.lastChild);\n    }\n\n    if (!config || !config.badges || !Array.isArray(config.badges)) {\n      root.style.display = \"none\";\n      this._badges = [];\n      return;\n    }\n\n    const elements: HUIView[\"_badges\"] = [];\n    for (const entityId of config.badges) {\n      const element = document.createElement(\"ha-state-label-badge\");\n      element.hass = this.hass;\n      element.state = this.hass!.states[entityId];\n      elements.push({ element, entityId });\n      root.appendChild(element);\n    }\n    this._badges = elements;\n    root.style.display = elements.length > 0 ? \"block\" : \"none\";\n  }\n\n  private _createCards(config: LovelaceViewConfig): void {\n    const root = this.shadowRoot!.getElementById(\"columns\")!;\n\n    while (root.lastChild) {\n      root.removeChild(root.lastChild);\n    }\n\n    if (!config || !config.cards || !Array.isArray(config.cards)) {\n      this._cards = [];\n      return;\n    }\n\n    const elements: LovelaceCard[] = [];\n    const elementsToAppend: HTMLElement[] = [];\n    config.cards.forEach((cardConfig, cardIndex) => {\n      const element = this.createCardElement(cardConfig);\n      elements.push(element);\n\n      if (!this.lovelace!.editMode) {\n        elementsToAppend.push(element);\n        return;\n      }\n\n      const wrapper = document.createElement(\"hui-card-options\");\n      wrapper.hass = this.hass;\n      wrapper.lovelace = this.lovelace;\n      wrapper.path = [this.index!, cardIndex];\n      wrapper.appendChild(element);\n      elementsToAppend.push(wrapper);\n    });\n\n    let columns: HTMLElement[][] = [];\n    const columnEntityCount: number[] = [];\n    for (let i = 0; i < this.columns!; i++) {\n      columns.push([]);\n      columnEntityCount.push(0);\n    }\n\n    elements.forEach((el, index) => {\n      const cardSize = computeCardSize(el);\n      // Element to append might be the wrapped card when we're editing.\n      columns[getColumnIndex(columnEntityCount, cardSize)].push(\n        elementsToAppend[index]\n      );\n    });\n\n    // Remove empty columns\n    columns = columns.filter((val) => val.length > 0);\n\n    columns.forEach((column) => {\n      const columnEl = document.createElement(\"div\");\n      columnEl.classList.add(\"column\");\n      column.forEach((el) => columnEl.appendChild(el));\n      root.appendChild(columnEl);\n    });\n\n    this._cards = elements;\n\n    if (\"theme\" in config) {\n      applyThemesOnElement(root, this.hass!.themes, config.theme);\n    }\n  }\n\n  private _rebuildCard(\n    cardElToReplace: LovelaceCard,\n    config: LovelaceCardConfig\n  ): void {\n    const newCardEl = this.createCardElement(config);\n    cardElToReplace.parentElement!.replaceChild(newCardEl, cardElToReplace);\n    this._cards = this._cards!.map((curCardEl) =>\n      curCardEl === cardElToReplace ? newCardEl : curCardEl\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-view\": HUIView;\n  }\n}\n\ncustomElements.define(\"hui-view\", HUIView);\n","import { HASSDomEvent, fireEvent } from \"../../../../common/dom/fire_event\";\nimport { Lovelace } from \"../../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"reload-lovelace\": undefined;\n    \"show-edit-view\": EditViewDialogParams;\n  }\n  // for add event listener\n  interface HTMLElementEventMap {\n    \"reload-lovelace\": HASSDomEvent<undefined>;\n  }\n}\n\nlet registeredDialog = false;\nconst dialogShowEvent = \"show-edit-view\";\nconst dialogTag = \"hui-dialog-edit-view\";\n\nexport interface EditViewDialogParams {\n  lovelace: Lovelace;\n  viewIndex?: number;\n}\n\nconst registerEditViewDialog = (element: HTMLElement): Event =>\n  fireEvent(element, \"register-dialog\", {\n    dialogShowEvent,\n    dialogTag,\n    dialogImport: () =>\n      import(/* webpackChunkName: \"hui-dialog-edit-view\" */ \"./hui-dialog-edit-view\"),\n  });\n\nexport const showEditViewDialog = (\n  element: HTMLElement,\n  editViewDialogParams: EditViewDialogParams\n): void => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    registerEditViewDialog(element);\n  }\n  fireEvent(element, dialogShowEvent, editViewDialogParams);\n};\n","import { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { Lovelace } from \"../../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"show-edit-lovelace\": Lovelace;\n  }\n}\n\nlet registeredDialog = false;\nconst dialogShowEvent = \"show-edit-lovelace\";\nconst dialogTag = \"hui-dialog-edit-lovelace\";\n\nconst registerEditLovelaceDialog = (element: HTMLElement): Event =>\n  fireEvent(element, \"register-dialog\", {\n    dialogShowEvent,\n    dialogTag,\n    dialogImport: () =>\n      import(/* webpackChunkName: \"hui-dialog-edit-lovelace\" */ \"./hui-dialog-edit-lovelace\"),\n  });\n\nexport const showEditLovelaceDialog = (\n  element: HTMLElement,\n  lovelace: Lovelace\n): void => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    registerEditLovelaceDialog(element);\n  }\n  fireEvent(element, dialogShowEvent, lovelace);\n};\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n  property,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport \"@polymer/app-layout/app-header-layout/app-header-layout\";\nimport \"@polymer/app-layout/app-header/app-header\";\nimport \"@polymer/app-layout/app-scroll-effects/effects/waterfall\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar\";\nimport \"@polymer/app-route/app-route\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@material/mwc-button\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-listbox/paper-listbox\";\nimport \"@polymer/paper-menu-button/paper-menu-button\";\nimport \"@polymer/paper-tabs/paper-tab\";\nimport \"@polymer/paper-tabs/paper-tabs\";\nimport { HassEntities } from \"home-assistant-js-websocket\";\n\nimport scrollToTarget from \"../../common/dom/scroll-to-target\";\n\nimport \"../../layouts/ha-app-layout\";\nimport \"../../components/ha-start-voice-button\";\nimport \"../../components/ha-paper-icon-button-arrow-next\";\nimport \"../../components/ha-paper-icon-button-arrow-prev\";\nimport \"../../components/ha-icon\";\nimport { loadModule, loadCSS, loadJS } from \"../../common/dom/load_resource\";\nimport { subscribeNotifications } from \"../../data/ws-notifications\";\nimport { debounce } from \"../../common/util/debounce\";\nimport { HomeAssistant } from \"../../types\";\nimport { LovelaceConfig } from \"../../data/lovelace\";\nimport { navigate } from \"../../common/navigate\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { computeNotifications } from \"./common/compute-notifications\";\nimport { swapView } from \"./editor/config-util\";\n\nimport \"./components/notifications/hui-notification-drawer\";\nimport \"./components/notifications/hui-notifications-button\";\nimport \"./hui-view\";\n// Not a duplicate import, this one is for type\n// tslint:disable-next-line\nimport { HUIView } from \"./hui-view\";\nimport { createCardElement } from \"./common/create-card-element\";\nimport { showEditViewDialog } from \"./editor/view-editor/show-edit-view-dialog\";\nimport { showEditLovelaceDialog } from \"./editor/lovelace-editor/show-edit-lovelace-dialog\";\nimport { Lovelace } from \"./types\";\nimport { afterNextRender } from \"../../common/util/render-status\";\nimport { haStyle } from \"../../resources/styles\";\nimport { computeRTLDirection } from \"../../common/util/compute_rtl\";\n\n// CSS and JS should only be imported once. Modules and HTML are safe.\nconst CSS_CACHE = {};\nconst JS_CACHE = {};\n\nclass HUIRoot extends LitElement {\n  @property() public hass?: HomeAssistant;\n  @property() public lovelace?: Lovelace;\n  @property() public columns?: number;\n  @property() public narrow?: boolean;\n  @property() public route?: { path: string; prefix: string };\n  @property() private _routeData?: { view: string };\n  @property() private _curView?: number | \"hass-unused-entities\";\n  @property() private _notificationsOpen = false;\n  @property() private _persistentNotifications?: Notification[];\n  private _viewCache?: { [viewId: string]: HUIView };\n\n  private _debouncedConfigChanged: () => void;\n  private _unsubNotifications?: () => void;\n\n  constructor() {\n    super();\n    // The view can trigger a re-render when it knows that certain\n    // web components have been loaded.\n    this._debouncedConfigChanged = debounce(\n      () => this._selectView(this._curView, true),\n      100,\n      false\n    );\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._unsubNotifications = subscribeNotifications(\n      this.hass!.connection,\n      (notifications) => {\n        this._persistentNotifications = notifications;\n      }\n    );\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    if (this._unsubNotifications) {\n      this._unsubNotifications();\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    return html`\n    <app-route .route=\"${this.route}\" pattern=\"/:view\" data=\"${\n      this._routeData\n    }\" @data-changed=\"${this._routeDataChanged}\"></app-route>\n    <hui-notification-drawer\n      .hass=\"${this.hass}\"\n      .notifications=\"${this._notifications}\"\n      .open=\"${this._notificationsOpen}\"\n      @open-changed=\"${this._handleNotificationsOpenChanged}\"\n      .narrow=\"${this.narrow}\"\n    ></hui-notification-drawer>\n    <ha-app-layout id=\"layout\">\n      <app-header slot=\"header\" effects=\"waterfall\" class=\"${classMap({\n        \"edit-mode\": this._editMode,\n      })}\" fixed condenses>\n        ${\n          this._editMode\n            ? html`\n                <app-toolbar class=\"edit-mode\">\n                  <paper-icon-button\n                    icon=\"hass:close\"\n                    @click=\"${this._editModeDisable}\"\n                  ></paper-icon-button>\n                  <div main-title>\n                    ${this.config.title ||\n                      this.hass!.localize(\"ui.panel.lovelace.editor.header\")}\n                    <paper-icon-button\n                      icon=\"hass:pencil\"\n                      class=\"edit-icon\"\n                      @click=\"${this._editLovelace}\"\n                    ></paper-icon-button>\n                  </div>\n                  <paper-icon-button\n                    icon=\"hass:help-circle\"\n                    title=\"Help\"\n                    @click=\"${this._handleHelp}\"\n                  ></paper-icon-button>\n                  <paper-menu-button\n                    no-animations\n                    horizontal-align=\"right\"\n                    horizontal-offset=\"-5\"\n                  >\n                    <paper-icon-button\n                      aria-label=\"Open Lovelace menu\"\n                      icon=\"hass:dots-vertical\"\n                      slot=\"dropdown-trigger\"\n                    ></paper-icon-button>\n                    <paper-listbox\n                      @iron-select=\"${this._deselect}\"\n                      slot=\"dropdown-content\"\n                    >\n                      <paper-item @click=\"${this.lovelace!.enableFullEditMode}\"\n                        >${this.hass!.localize(\n                          \"ui.panel.lovelace.editor.menu.raw_editor\"\n                        )}</paper-item\n                      >\n                    </paper-listbox>\n                  </paper-menu-button>\n                </app-toolbar>\n              `\n            : /* IoB */ this._hideToolbar\n            ? \"\"\n            : html`\n                <app-toolbar>\n                  <!-- Disabled for IoB -->\n                  <!--ha-menu-button\n                    .hass=${this.hass}\n                    .narrow=${this.narrow}\n                  ></ha-menu-button-->\n                  <div main-title>${this.config.title || \"Home Assistant\"}</div>\n                  <hui-notifications-button\n                    .hass=\"${this.hass}\"\n                    .opened=\"${this._notificationsOpen}\"\n                    @opened-changed=\"${this._handleNotificationsOpenChanged}\"\n                    .notifications=\"${this._notifications}\"\n                  ></hui-notifications-button>\n                  <ha-start-voice-button\n                    .hass=\"${this.hass}\"\n                  ></ha-start-voice-button>\n                  <paper-menu-button\n                    no-animations\n                    horizontal-align=\"right\"\n                    horizontal-offset=\"-5\"\n                  >\n                    <paper-icon-button\n                      icon=\"hass:dots-vertical\"\n                      slot=\"dropdown-trigger\"\n                    ></paper-icon-button>\n                    <paper-listbox\n                      @iron-select=\"${this._deselect}\"\n                      slot=\"dropdown-content\"\n                    >\n                      ${this._yamlMode\n                        ? html`\n                            <paper-item @click=\"${this._handleRefresh}\"\n                              >${this.hass!.localize(\n                                \"ui.panel.lovelace.menu.refresh\"\n                              )}</paper-item\n                            >\n                          `\n                        : \"\"}\n                      ${__DEMO__ /* No unused entities available in the demo */\n                        ? \"\"\n                        : html`\n                            <paper-item @click=\"${this._handleUnusedEntities}\">\n                              ${this.hass!.localize(\n                                \"ui.panel.lovelace.menu.unused_entities\"\n                              )}\n                            </paper-item>\n                          `}\n                      <paper-item @click=\"${this._editModeEnable}\"\n                        >${this.hass!.localize(\n                          \"ui.panel.lovelace.menu.configure_ui\"\n                        )}</paper-item\n                      >\n                      <paper-item @click=\"${this._handleHelp}\"\n                        >${this.hass!.localize(\n                          \"ui.panel.lovelace.menu.help\"\n                        )}</paper-item\n                      >\n                    </paper-listbox>\n                  </paper-menu-button>\n                </app-toolbar>\n              `\n        }\n\n        ${\n          this.lovelace!.config.views.length > 1 || this._editMode\n            ? html`\n                <div sticky>\n                  <paper-tabs\n                    scrollable\n                    .selected=\"${this._curView}\"\n                    @iron-activate=\"${this._handleViewSelected}\"\n                    dir=\"${computeRTLDirection(this.hass!)}\"\n                  >\n                    ${this.lovelace!.config.views.map(\n                      (view) => html`\n                        <paper-tab aria-label=\"${view.title}\">\n                          ${this._editMode\n                            ? html`\n                                <ha-paper-icon-button-arrow-prev\n                                  title=\"Move view left\"\n                                  class=\"edit-icon view\"\n                                  @click=\"${this._moveViewLeft}\"\n                                  ?disabled=\"${this._curView === 0}\"\n                                ></ha-paper-icon-button-arrow-prev>\n                              `\n                            : \"\"}\n                          ${view.icon\n                            ? html`\n                                <ha-icon\n                                  title=\"${view.title}\"\n                                  .icon=\"${view.icon}\"\n                                ></ha-icon>\n                              `\n                            : view.title || \"Unnamed view\"}\n                          ${this._editMode\n                            ? html`\n                                <ha-icon\n                                  title=\"Edit view\"\n                                  class=\"edit-icon view\"\n                                  icon=\"hass:pencil\"\n                                  @click=\"${this._editView}\"\n                                ></ha-icon>\n                                <ha-paper-icon-button-arrow-next\n                                  title=\"Move view right\"\n                                  class=\"edit-icon view\"\n                                  @click=\"${this._moveViewRight}\"\n                                  ?disabled=\"${(this._curView! as number) +\n                                    1 ===\n                                    this.lovelace!.config.views.length}\"\n                                ></ha-paper-icon-button-arrow-next>\n                              `\n                            : \"\"}\n                        </paper-tab>\n                      `\n                    )}\n                    ${this._editMode\n                      ? html`\n                          <paper-icon-button\n                            id=\"add-view\"\n                            @click=\"${this._addView}\"\n                            title=\"${this.hass!.localize(\n                              \"ui.panel.lovelace.editor.edit_view.add\"\n                            )}\"\n                            icon=\"hass:plus\"\n                          ></paper-icon-button>\n                        `\n                      : \"\"}\n                  </paper-tabs>\n                </div>\n              `\n            : \"\"\n        }\n      </app-header>\n      <div id='view' class=\"${classMap({\n        \"tabs-hidden\": this.lovelace!.config.views.length < 2,\n      })}\" @ll-rebuild='${this._debouncedConfigChanged}'></div>\n    </app-header-layout>\n    `;\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      haStyle,\n      css`\n        :host {\n          -ms-user-select: none;\n          -webkit-user-select: none;\n          -moz-user-select: none;\n          --dark-color: #455a64;\n          --text-dark-color: #fff;\n        }\n\n        ha-app-layout {\n          min-height: 100%;\n        }\n        paper-menu-button {\n          padding: 0;\n        }\n        paper-tabs {\n          margin-left: 12px;\n          --paper-tabs-selection-bar-color: var(--text-primary-color, #fff);\n          text-transform: uppercase;\n        }\n        .edit-mode {\n          background-color: var(--dark-color, #455a64);\n          color: var(--text-dark-color);\n        }\n        .edit-mode div[main-title] {\n          pointer-events: auto;\n        }\n        paper-tab.iron-selected .edit-icon {\n          display: inline-flex;\n        }\n        .edit-icon {\n          color: var(--accent-color);\n          padding-left: 8px;\n        }\n        .edit-icon[disabled] {\n          color: var(--disabled-text-color);\n        }\n        .edit-icon.view {\n          display: none;\n        }\n        #add-view {\n          position: absolute;\n          height: 44px;\n        }\n        #add-view ha-icon {\n          background-color: var(--accent-color);\n          border-radius: 5px;\n          margin-top: 4px;\n        }\n        app-toolbar a {\n          color: var(--text-primary-color, white);\n        }\n        mwc-button.warning:not([disabled]) {\n          color: var(--google-red-500);\n        }\n        #view {\n          min-height: calc(100vh - 112px);\n          /**\n         * Since we only set min-height, if child nodes need percentage\n         * heights they must use absolute positioning so we need relative\n         * positioning here.\n         *\n         * https://www.w3.org/TR/CSS2/visudet.html#the-height-property\n         */\n          position: relative;\n        }\n        #view.tabs-hidden {\n          min-height: calc(100vh - 64px);\n        }\n        paper-item {\n          cursor: pointer;\n        }\n      `,\n    ];\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    const view = this._viewRoot;\n    const huiView = view.lastChild as HUIView;\n\n    if (changedProperties.has(\"columns\") && huiView) {\n      huiView.columns = this.columns;\n    }\n\n    if (changedProperties.has(\"hass\") && huiView) {\n      huiView.hass = this.hass;\n    }\n\n    let newSelectView;\n    let force = false;\n\n    if (changedProperties.has(\"route\")) {\n      const views = this.config && this.config.views;\n      if (\n        this.route!.path === \"\" &&\n        this.route!.prefix === \"/lovelace\" &&\n        views\n      ) {\n        navigate(this, `/lovelace/${views[0].path || 0}`, true);\n        newSelectView = 0;\n      } else if (this._routeData!.view === \"hass-unused-entities\") {\n        newSelectView = \"hass-unused-entities\";\n      } else if (this._routeData!.view) {\n        const selectedView = this._routeData!.view;\n        const selectedViewInt = parseInt(selectedView, 10);\n        let index = 0;\n        for (let i = 0; i < views.length; i++) {\n          if (views[i].path === selectedView || i === selectedViewInt) {\n            index = i;\n            break;\n          }\n        }\n        newSelectView = index;\n      }\n    }\n\n    if (changedProperties.has(\"lovelace\")) {\n      const oldLovelace = changedProperties.get(\"lovelace\") as\n        | Lovelace\n        | undefined;\n\n      if (!oldLovelace || oldLovelace.config !== this.lovelace!.config) {\n        this._loadResources(this.lovelace!.config.resources || []);\n        // On config change, recreate the current view from scratch.\n        force = true;\n        // Recalculate to see if we need to adjust content area for tab bar\n        fireEvent(this, \"iron-resize\");\n      }\n\n      if (!oldLovelace || oldLovelace.editMode !== this.lovelace!.editMode) {\n        // On edit mode change, recreate the current view from scratch\n        force = true;\n        // Recalculate to see if we need to adjust content area for tab bar\n        fireEvent(this, \"iron-resize\");\n      }\n    }\n\n    if (newSelectView !== undefined || force) {\n      if (force && newSelectView === undefined) {\n        newSelectView = this._curView;\n      }\n      // Will allow for ripples to start rendering\n      afterNextRender(() => this._selectView(newSelectView, force));\n    }\n  }\n\n  private get _notifications() {\n    return this._updateNotifications(\n      this.hass!.states,\n      this._persistentNotifications! || []\n    );\n  }\n\n  // IoB\n  private get _hideToolbar(): boolean {\n    return (\n      this.config.hideToolbar === true &&\n      window.location.search.indexOf(\"toolbar\") === -1\n    );\n  }\n\n  private get config(): LovelaceConfig {\n    return this.lovelace!.config;\n  }\n\n  private get _yamlMode(): boolean {\n    return this.lovelace!.mode === \"yaml\";\n  }\n\n  private get _editMode() {\n    return this.lovelace!.editMode;\n  }\n\n  private get _layout(): any {\n    return this.shadowRoot!.getElementById(\"layout\");\n  }\n\n  private get _viewRoot(): HTMLDivElement {\n    return this.shadowRoot!.getElementById(\"view\") as HTMLDivElement;\n  }\n\n  private _routeDataChanged(ev): void {\n    this._routeData = ev.detail.value;\n  }\n\n  private _handleNotificationsOpenChanged(ev): void {\n    this._notificationsOpen = ev.detail.value;\n  }\n\n  private _updateNotifications(\n    states: HassEntities,\n    persistent: unknown[]\n  ): unknown[] {\n    const configurator = computeNotifications(states);\n    return persistent.concat(configurator);\n  }\n\n  private _handleRefresh(): void {\n    fireEvent(this, \"config-refresh\");\n  }\n\n  private _handleUnusedEntities(): void {\n    navigate(this, `/lovelace/hass-unused-entities`);\n  }\n\n  private _deselect(ev): void {\n    ev.target.selected = null;\n  }\n\n  private _handleHelp(): void {\n    // window.open(\"https://www.home-assistant.io/lovelace/\", \"_blank\");\n    // IoB\n    window.open(\n      \"https://www.iobroker.net/#en/adapters/adapterref/iobroker.lovelace/README.md\",\n      \"_blank\"\n    );\n  }\n\n  private _editModeEnable(): void {\n    if (this._yamlMode) {\n      window.alert(\"The edit UI is not available when in YAML mode.\");\n      return;\n    }\n    this.lovelace!.setEditMode(true);\n    if (this.config.views.length < 2) {\n      fireEvent(this, \"iron-resize\");\n    }\n  }\n\n  private _editModeDisable(): void {\n    this.lovelace!.setEditMode(false);\n    if (this.config.views.length < 2) {\n      fireEvent(this, \"iron-resize\");\n    }\n  }\n\n  private _editLovelace() {\n    showEditLovelaceDialog(this, this.lovelace!);\n  }\n\n  private _editView() {\n    showEditViewDialog(this, {\n      lovelace: this.lovelace!,\n      viewIndex: this._curView as number,\n    });\n  }\n\n  private _moveViewLeft() {\n    const lovelace = this.lovelace!;\n    const oldIndex = this._curView as number;\n    const newIndex = (this._curView as number) - 1;\n    this._curView = newIndex;\n    lovelace.saveConfig(swapView(lovelace.config, oldIndex, newIndex));\n  }\n\n  private _moveViewRight() {\n    const lovelace = this.lovelace!;\n    const oldIndex = this._curView as number;\n    const newIndex = (this._curView as number) + 1;\n    this._curView = newIndex;\n    lovelace.saveConfig(swapView(lovelace.config, oldIndex, newIndex));\n  }\n\n  private _addView() {\n    showEditViewDialog(this, {\n      lovelace: this.lovelace!,\n    });\n  }\n\n  private _handleViewSelected(ev) {\n    const viewIndex = ev.detail.selected as number;\n\n    if (viewIndex !== this._curView) {\n      const path = this.config.views[viewIndex].path || viewIndex;\n      navigate(this, `/lovelace/${path}`);\n    }\n    scrollToTarget(this, this._layout.header.scrollTarget);\n  }\n\n  private _selectView(viewIndex: HUIRoot[\"_curView\"], force: boolean): void {\n    if (!force && this._curView === viewIndex) {\n      return;\n    }\n\n    viewIndex = viewIndex === undefined ? 0 : viewIndex;\n\n    this._curView = viewIndex;\n\n    if (force) {\n      this._viewCache = {};\n    }\n\n    // Recreate a new element to clear the applied themes.\n    const root = this._viewRoot;\n\n    if (root.lastChild) {\n      root.removeChild(root.lastChild);\n    }\n\n    if (viewIndex === \"hass-unused-entities\") {\n      const unusedEntities = document.createElement(\"hui-unused-entities\");\n      // Wait for promise to resolve so that the element has been upgraded.\n      import(\n        /* webpackChunkName: \"hui-unused-entities\" */ \"./hui-unused-entities\"\n      ).then(() => {\n        unusedEntities.setConfig(this.config);\n        unusedEntities.hass = this.hass!;\n      });\n      root.style.background = this.config.background || \"\";\n      root.append(unusedEntities);\n      return;\n    }\n\n    let view;\n    const viewConfig = this.config.views[viewIndex];\n\n    if (!viewConfig) {\n      this._editModeEnable();\n      return;\n    }\n\n    if (!force && this._viewCache![viewIndex]) {\n      view = this._viewCache![viewIndex];\n    } else {\n      if (viewConfig.panel && viewConfig.cards && viewConfig.cards.length > 0) {\n        view = createCardElement(viewConfig.cards[0]);\n        view.isPanel = true;\n      } else {\n        view = document.createElement(\"hui-view\");\n        view.lovelace = this.lovelace;\n        view.columns = this.columns;\n        view.index = viewIndex;\n      }\n      this._viewCache![viewIndex] = view;\n    }\n\n    view.hass = this.hass;\n    root.style.background =\n      viewConfig.background || this.config.background || \"\";\n    root.append(view);\n  }\n\n  private _loadResources(resources) {\n    resources.forEach((resource) => {\n      switch (resource.type) {\n        case \"css\":\n          if (resource.url in CSS_CACHE) {\n            break;\n          }\n          CSS_CACHE[resource.url] = loadCSS(resource.url);\n          break;\n\n        case \"js\":\n          if (resource.url in JS_CACHE) {\n            break;\n          }\n          JS_CACHE[resource.url] = loadJS(resource.url);\n          break;\n\n        case \"module\":\n          loadModule(resource.url);\n          break;\n\n        case \"html\":\n          import(\n            /* webpackChunkName: \"import-href-polyfill\" */ \"../../resources/html-import/import-href\"\n          ).then(({ importHref }) => importHref(resource.url));\n          break;\n\n        default:\n          // tslint:disable-next-line\n          console.warn(`Unknown resource type specified: ${resource.type}`);\n      }\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-root\": HUIRoot;\n  }\n}\n\ncustomElements.define(\"hui-root\", HUIRoot);\n","import { HassEntities, HassEntity } from \"home-assistant-js-websocket\";\n\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nexport const computeNotifications = (states: HassEntities): HassEntity[] => {\n  return Object.keys(states)\n    .filter((entityId) => computeDomain(entityId) === \"configurator\")\n    .map((entityId) => states[entityId]);\n};\n","/**\n * Scroll to a specific y coordinate.\n *\n * Copied from paper-scroll-header-panel.\n *\n * @method scroll\n * @param {number} top The coordinate to scroll to, along the y-axis.\n * @param {boolean} smooth true if the scroll position should be smoothly adjusted.\n */\nexport default function scrollToTarget(element, target) {\n  // the scroll event will trigger _updateScrollState directly,\n  // However, _updateScrollState relies on the previous `scrollTop` to update the states.\n  // Calling _updateScrollState will ensure that the states are synced correctly.\n  const top = 0;\n  const scroller = target;\n  const easingFn = function easeOutQuad(t, b, c, d) {\n    /* eslint-disable no-param-reassign, space-infix-ops, no-mixed-operators */\n    t /= d;\n    return -c * t * (t - 2) + b;\n    /* eslint-enable no-param-reassign, space-infix-ops, no-mixed-operators */\n  };\n  const animationId = Math.random();\n  const duration = 200;\n  const startTime = Date.now();\n  const currentScrollTop = scroller.scrollTop;\n  const deltaScrollTop = top - currentScrollTop;\n  element._currentAnimationId = animationId;\n  (function updateFrame() {\n    const now = Date.now();\n    const elapsedTime = now - startTime;\n    if (elapsedTime > duration) {\n      scroller.scrollTop = top;\n    } else if (element._currentAnimationId === animationId) {\n      scroller.scrollTop = easingFn(\n        elapsedTime,\n        currentScrollTop,\n        deltaScrollTop,\n        duration\n      );\n      requestAnimationFrame(updateFrame.bind(element));\n    }\n  }.call(element));\n}\n","import { fireEvent } from \"../../../common/dom/fire_event\";\nimport { Lovelace } from \"../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"show-save-config\": SaveDialogParams;\n  }\n}\n\nconst dialogShowEvent = \"show-save-config\";\nconst dialogTag = \"hui-dialog-save-config\";\n\nexport interface SaveDialogParams {\n  lovelace: Lovelace;\n}\n\nlet registeredDialog = false;\n\nexport const showSaveDialog = (\n  element: HTMLElement,\n  saveDialogParams: SaveDialogParams\n) => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    fireEvent(element, \"register-dialog\", {\n      dialogShowEvent,\n      dialogTag,\n      dialogImport: () =>\n        import(/* webpackChunkName: \"hui-dialog-save-config\" */ \"./hui-dialog-save-config\"),\n    });\n  }\n  fireEvent(element, dialogShowEvent, saveDialogParams);\n};\n","import { HomeAssistant, GroupEntity } from \"../../../types\";\nimport {\n  LovelaceConfig,\n  LovelaceCardConfig,\n  LovelaceViewConfig,\n} from \"../../../data/lovelace\";\nimport { HassEntity, HassEntities } from \"home-assistant-js-websocket\";\n\nimport extractViews from \"../../../common/entity/extract_views\";\nimport getViewEntities from \"../../../common/entity/get_view_entities\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport splitByGroups from \"../../../common/entity/split_by_groups\";\nimport computeObjectId from \"../../../common/entity/compute_object_id\";\nimport computeStateDomain from \"../../../common/entity/compute_state_domain\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nimport { EntityRowConfig, WeblinkConfig } from \"../entity-rows/types\";\nimport { LocalizeFunc } from \"../../../common/translations/localize\";\nimport { EntitiesCardConfig } from \"../cards/types\";\nimport {\n  subscribeAreaRegistry,\n  AreaRegistryEntry,\n} from \"../../../data/area_registry\";\nimport { subscribeOne } from \"../../../common/util/subscribe-one\";\nimport {\n  subscribeDeviceRegistry,\n  DeviceRegistryEntry,\n} from \"../../../data/device_registry\";\nimport {\n  subscribeEntityRegistry,\n  EntityRegistryEntry,\n} from \"../../../data/entity_registry\";\n\nconst DEFAULT_VIEW_ENTITY_ID = \"group.default_view\";\nconst DOMAINS_BADGES = [\n  \"binary_sensor\",\n  \"person\",\n  \"device_tracker\",\n  \"mailbox\",\n  \"sensor\",\n  \"sun\",\n  \"timer\",\n];\nconst HIDE_DOMAIN = new Set([\n  \"persistent_notification\",\n  \"configurator\",\n  \"geo_location\",\n]);\n\ninterface Registries {\n  areas: AreaRegistryEntry[];\n  devices: DeviceRegistryEntry[];\n  entities: EntityRegistryEntry[];\n}\n\nlet subscribedRegistries = false;\n\ninterface SplittedByAreas {\n  areasWithEntities: Array<[AreaRegistryEntry, HassEntity[]]>;\n  otherEntities: HassEntities;\n}\n\nconst splitByAreas = (\n  registries: Registries,\n  entities: HassEntities\n): SplittedByAreas => {\n  const allEntities = { ...entities };\n  const areasWithEntities: SplittedByAreas[\"areasWithEntities\"] = [];\n\n  for (const area of registries.areas) {\n    const areaEntities: HassEntity[] = [];\n    const areaDevices = new Set(\n      registries.devices\n        .filter((device) => device.area_id === area.area_id)\n        .map((device) => device.id)\n    );\n    for (const entity of registries.entities) {\n      if (\n        areaDevices.has(\n          // @ts-ignore\n          entity.device_id\n        ) &&\n        entity.entity_id in allEntities\n      ) {\n        areaEntities.push(allEntities[entity.entity_id]);\n        delete allEntities[entity.entity_id];\n      }\n    }\n    if (areaEntities.length > 0) {\n      areasWithEntities.push([area, areaEntities]);\n    }\n  }\n  return {\n    areasWithEntities,\n    otherEntities: allEntities,\n  };\n};\n\nconst computeCards = (\n  states: Array<[string, HassEntity]>,\n  entityCardOptions: Partial<EntitiesCardConfig>\n): LovelaceCardConfig[] => {\n  const cards: LovelaceCardConfig[] = [];\n\n  // For entity card\n  const entities: Array<string | EntityRowConfig> = [];\n\n  for (const [entityId, stateObj] of states) {\n    const domain = computeDomain(entityId);\n\n    if (domain === \"alarm_control_panel\") {\n      cards.push({\n        type: \"alarm-panel\",\n        entity: entityId,\n      });\n    } else if (domain === \"camera\") {\n      cards.push({\n        type: \"picture-entity\",\n        entity: entityId,\n      });\n    } else if (domain === \"climate\") {\n      cards.push({\n        type: \"thermostat\",\n        entity: entityId,\n      });\n    } else if (domain === \"history_graph\" && stateObj) {\n      cards.push({\n        type: \"history-graph\",\n        entities: stateObj.attributes.entity_id,\n        hours_to_show: stateObj.attributes.hours_to_show,\n        title: stateObj.attributes.friendly_name,\n        refresh_interval: stateObj.attributes.refresh,\n      });\n    } else if (domain === \"media_player\") {\n      cards.push({\n        type: \"media-control\",\n        entity: entityId,\n      });\n    } else if (domain === \"plant\") {\n      cards.push({\n        type: \"plant-status\",\n        entity: entityId,\n      });\n    } else if (domain === \"weather\") {\n      cards.push({\n        type: \"weather-forecast\",\n        entity: entityId,\n      });\n    } else if (domain === \"weblink\" && stateObj) {\n      const conf: WeblinkConfig = {\n        type: \"weblink\",\n        url: stateObj.state,\n        name: computeStateName(stateObj),\n      };\n      if (\"icon\" in stateObj.attributes) {\n        conf.icon = stateObj.attributes.icon;\n      }\n      entities.push(conf);\n    } else {\n      entities.push(entityId);\n    }\n  }\n\n  if (entities.length > 0) {\n    cards.unshift({\n      type: \"entities\",\n      entities,\n      ...entityCardOptions,\n    });\n  }\n\n  return cards;\n};\n\nconst computeDefaultViewStates = (hass: HomeAssistant): HassEntities => {\n  const states = {};\n  Object.keys(hass.states).forEach((entityId) => {\n    const stateObj = hass.states[entityId];\n    if (\n      !stateObj.attributes.hidden &&\n      !HIDE_DOMAIN.has(computeStateDomain(stateObj))\n    ) {\n      states[entityId] = hass.states[entityId];\n    }\n  });\n  return states;\n};\n\nconst generateDefaultViewConfig = (\n  hass: HomeAssistant,\n  registries: Registries\n): LovelaceViewConfig => {\n  const states = computeDefaultViewStates(hass);\n  const path = \"default_view\";\n  const title = \"Home\";\n  const icon = undefined;\n\n  // In the case of a default view, we want to use the group order attribute\n  const groupOrders = {};\n  Object.keys(states).forEach((entityId) => {\n    const stateObj = states[entityId];\n    if (stateObj.attributes.order) {\n      groupOrders[entityId] = stateObj.attributes.order;\n    }\n  });\n\n  const splittedByAreas = splitByAreas(registries, states);\n\n  const config = generateViewConfig(\n    hass.localize,\n    path,\n    title,\n    icon,\n    splittedByAreas.otherEntities,\n    groupOrders\n  );\n\n  const areaCards: LovelaceCardConfig[] = [];\n\n  splittedByAreas.areasWithEntities.forEach(([area, entities]) => {\n    areaCards.push(\n      ...computeCards(entities.map((entity) => [entity.entity_id, entity]), {\n        title: area.name,\n        show_header_toggle: true,\n      })\n    );\n  });\n\n  config.cards!.unshift(...areaCards);\n\n  return config;\n};\n\nconst generateViewConfig = (\n  localize: LocalizeFunc,\n  path: string,\n  title: string | undefined,\n  icon: string | undefined,\n  entities: HassEntities,\n  groupOrders: { [entityId: string]: number }\n): LovelaceViewConfig => {\n  const splitted = splitByGroups(entities);\n  splitted.groups.sort(\n    (gr1, gr2) => groupOrders[gr1.entity_id] - groupOrders[gr2.entity_id]\n  );\n\n  const badgeEntities: { [domain: string]: string[] } = {};\n  const ungroupedEntitites: { [domain: string]: string[] } = {};\n\n  // Organize ungrouped entities in badges/ungrouped things\n  Object.keys(splitted.ungrouped).forEach((entityId) => {\n    const state = splitted.ungrouped[entityId];\n    const domain = computeStateDomain(state);\n\n    const coll = DOMAINS_BADGES.includes(domain)\n      ? badgeEntities\n      : ungroupedEntitites;\n\n    if (!(domain in coll)) {\n      coll[domain] = [];\n    }\n\n    coll[domain].push(state.entity_id);\n  });\n\n  let badges: string[] = [];\n  DOMAINS_BADGES.forEach((domain) => {\n    if (domain in badgeEntities) {\n      badges = badges.concat(badgeEntities[domain]);\n    }\n  });\n\n  let cards: LovelaceCardConfig[] = [];\n\n  splitted.groups.forEach((groupEntity) => {\n    cards = cards.concat(\n      computeCards(\n        groupEntity.attributes.entity_id.map(\n          (entityId): [string, HassEntity] => [entityId, entities[entityId]]\n        ),\n        {\n          title: computeStateName(groupEntity),\n          show_header_toggle: groupEntity.attributes.control !== \"hidden\",\n        }\n      )\n    );\n  });\n\n  Object.keys(ungroupedEntitites)\n    .sort()\n    .forEach((domain) => {\n      cards = cards.concat(\n        computeCards(\n          ungroupedEntitites[domain].map(\n            (entityId): [string, HassEntity] => [entityId, entities[entityId]]\n          ),\n          {\n            title: localize(`domain.${domain}`),\n          }\n        )\n      );\n    });\n\n  const view: LovelaceViewConfig = {\n    path,\n    title,\n    badges,\n    cards,\n  };\n\n  if (icon) {\n    view.icon = icon;\n  }\n\n  return view;\n};\n\nexport const generateLovelaceConfig = async (\n  hass: HomeAssistant,\n  localize: LocalizeFunc\n): Promise<LovelaceConfig> => {\n  const viewEntities = extractViews(hass.states);\n\n  const views = viewEntities.map((viewEntity: GroupEntity) => {\n    const states = getViewEntities(hass.states, viewEntity);\n\n    // In the case of a normal view, we use group order as specified in view\n    const groupOrders = {};\n    Object.keys(states).forEach((entityId, idx) => {\n      groupOrders[entityId] = idx;\n    });\n\n    return generateViewConfig(\n      localize,\n      computeObjectId(viewEntity.entity_id),\n      computeStateName(viewEntity),\n      viewEntity.attributes.icon,\n      states,\n      groupOrders\n    );\n  });\n\n  let title = hass.config.location_name;\n\n  // User can override default view. If they didn't, we will add one\n  // that contains all entities.\n  if (\n    viewEntities.length === 0 ||\n    viewEntities[0].entity_id !== DEFAULT_VIEW_ENTITY_ID\n  ) {\n    // We want to keep the registry subscriptions alive after generating the UI\n    // so that we don't serve up stale data after changing areas.\n    if (!subscribedRegistries) {\n      subscribedRegistries = true;\n      subscribeAreaRegistry(hass.connection, () => undefined);\n      subscribeDeviceRegistry(hass.connection, () => undefined);\n      subscribeEntityRegistry(hass.connection, () => undefined);\n    }\n\n    const [areas, devices, entities] = await Promise.all([\n      subscribeOne(hass.connection, subscribeAreaRegistry),\n      subscribeOne(hass.connection, subscribeDeviceRegistry),\n      subscribeOne(hass.connection, subscribeEntityRegistry),\n    ]);\n    const registries = { areas, devices, entities };\n\n    views.unshift(generateDefaultViewConfig(hass, registries));\n\n    // Add map of geo locations to default view if loaded\n    if (hass.config.components.includes(\"geo_location\")) {\n      if (views[0] && views[0].cards) {\n        views[0].cards.push({\n          type: \"map\",\n          geo_location_sources: [\"all\"],\n        });\n      }\n    }\n\n    // Make sure we don't have Home as title and first tab.\n    if (views.length > 1 && title === \"Home\") {\n      title = \"Home Assistant\";\n    }\n  }\n\n  if (__DEMO__) {\n    views[0].cards!.unshift({\n      type: \"custom:ha-demo-card\",\n    });\n  }\n\n  // User has no entities\n  if (views.length === 1 && views[0].cards!.length === 0) {\n    import(/* webpackChunkName: \"hui-empty-state-card\" */ \"../cards/hui-empty-state-card\");\n    views[0].cards!.push({\n      type: \"custom:hui-empty-state-card\",\n    });\n  }\n\n  return {\n    title,\n    views,\n  };\n};\n","import computeDomain from \"./compute_domain\";\nimport { HassEntities } from \"home-assistant-js-websocket\";\nimport { GroupEntity } from \"../../types\";\n\n// Split a collection into a list of groups and a 'rest' list of ungrouped\n// entities.\n// Returns { groups: [], ungrouped: {} }\nexport default function splitByGroups(entities: HassEntities) {\n  const groups: GroupEntity[] = [];\n  const ungrouped: HassEntities = {};\n\n  Object.keys(entities).forEach((entityId) => {\n    const entity = entities[entityId];\n\n    if (computeDomain(entityId) === \"group\") {\n      groups.push(entity as GroupEntity);\n    } else {\n      ungrouped[entityId] = entity;\n    }\n  });\n\n  groups.forEach((group) =>\n    group.attributes.entity_id.forEach((entityId) => {\n      delete ungrouped[entityId];\n    })\n  );\n\n  return { groups, ungrouped };\n}\n","import { HassEntities } from \"home-assistant-js-websocket\";\nimport { DEFAULT_VIEW_ENTITY_ID } from \"../const\";\nimport { GroupEntity } from \"../../types\";\n\n// Return an ordered array of available views\nexport default function extractViews(entities: HassEntities): GroupEntity[] {\n  const views: GroupEntity[] = [];\n\n  Object.keys(entities).forEach((entityId) => {\n    const entity = entities[entityId];\n    if (entity.attributes.view) {\n      views.push(entity as GroupEntity);\n    }\n  });\n\n  views.sort((view1, view2) => {\n    if (view1.entity_id === DEFAULT_VIEW_ENTITY_ID) {\n      return -1;\n    }\n    if (view2.entity_id === DEFAULT_VIEW_ENTITY_ID) {\n      return 1;\n    }\n    return view1.attributes.order - view2.attributes.order;\n  });\n\n  return views;\n}\n","import { HassEntities } from \"home-assistant-js-websocket\";\nimport computeDomain from \"./compute_domain\";\nimport getGroupEntities from \"./get_group_entities\";\nimport { GroupEntity } from \"../../types\";\n\n// Return an object containing all entities that the view will show\n// including embedded groups.\nexport default function getViewEntities(\n  entities: HassEntities,\n  view: GroupEntity\n): HassEntities {\n  const viewEntities = {};\n\n  view.attributes.entity_id.forEach((entityId) => {\n    const entity = entities[entityId];\n\n    if (entity && !entity.attributes.hidden) {\n      viewEntities[entity.entity_id] = entity;\n\n      if (computeDomain(entity.entity_id) === \"group\") {\n        const groupEntities = getGroupEntities(entities, entity as GroupEntity);\n\n        Object.keys(groupEntities).forEach((grEntityId) => {\n          const grEntity = groupEntities[grEntityId];\n\n          if (!grEntity.attributes.hidden) {\n            viewEntities[grEntityId] = grEntity;\n          }\n        });\n      }\n    }\n  });\n\n  return viewEntities;\n}\n","import { HassEntities } from \"home-assistant-js-websocket\";\nimport { GroupEntity } from \"../../types\";\n\nexport default function getGroupEntities(\n  entities: HassEntities,\n  group: GroupEntity\n) {\n  const result = {};\n\n  group.attributes.entity_id.forEach((entityId) => {\n    const entity = entities[entityId];\n\n    if (entity) {\n      result[entity.entity_id] = entity;\n    }\n  });\n\n  return result;\n}\n","import \"@material/mwc-button\";\n\nimport {\n  fetchConfig,\n  LovelaceConfig,\n  saveConfig,\n  subscribeLovelaceUpdates,\n  WindowWithLovelaceProm,\n} from \"../../data/lovelace\";\nimport \"../../layouts/hass-loading-screen\";\nimport \"../../layouts/hass-error-screen\";\nimport \"./hui-root\";\nimport { HomeAssistant, PanelInfo, Route } from \"../../types\";\nimport { Lovelace } from \"./types\";\nimport {\n  LitElement,\n  html,\n  PropertyValues,\n  TemplateResult,\n  property,\n} from \"lit-element\";\nimport { showSaveDialog } from \"./editor/show-save-config-dialog\";\nimport { generateLovelaceConfig } from \"./common/generate-lovelace-config\";\nimport { showToast } from \"../../util/toast\";\n\ninterface LovelacePanelConfig {\n  mode: \"yaml\" | \"storage\";\n}\n\nlet editorLoaded = false;\n\nclass LovelacePanel extends LitElement {\n  @property() public panel?: PanelInfo<LovelacePanelConfig>;\n\n  @property() public hass?: HomeAssistant;\n\n  @property() public narrow?: boolean;\n\n  @property() public route?: Route;\n\n  @property() private _columns?: number;\n\n  @property()\n  private _state?: \"loading\" | \"loaded\" | \"error\" | \"yaml-editor\" = \"loading\";\n\n  @property() private _errorMsg?: string;\n\n  @property() private lovelace?: Lovelace;\n\n  private mqls?: MediaQueryList[];\n\n  private _saving: boolean = false;\n\n  constructor() {\n    super();\n    this._closeEditor = this._closeEditor.bind(this);\n  }\n\n  public render(): TemplateResult | void {\n    const state = this._state!;\n\n    if (state === \"loaded\") {\n      return html`\n        <hui-root\n          .hass=\"${this.hass}\"\n          .lovelace=\"${this.lovelace}\"\n          .route=\"${this.route}\"\n          .columns=\"${this._columns}\"\n          .narrow=${this.narrow}\n          @config-refresh=\"${this._forceFetchConfig}\"\n        ></hui-root>\n      `;\n    }\n\n    if (state === \"error\") {\n      return html`\n        <hass-error-screen title=\"Lovelace\" .error=\"${this._errorMsg}\">\n          <mwc-button on-click=\"_forceFetchConfig\"\n            >${this.hass!.localize(\n              \"ui.panel.lovelace.reload_lovelace\"\n            )}</mwc-button\n          >\n        </hass-error-screen>\n      `;\n    }\n\n    if (state === \"yaml-editor\") {\n      return html`\n        <hui-editor\n          .hass=\"${this.hass}\"\n          .lovelace=\"${this.lovelace}\"\n          .closeEditor=\"${this._closeEditor}\"\n        ></hui-editor>\n      `;\n    }\n\n    return html`\n      <hass-loading-screen\n        rootnav\n        .hass=${this.hass}\n        .narrow=${this.narrow}\n      ></hass-loading-screen>\n    `;\n  }\n\n  public updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    if (changedProps.has(\"narrow\")) {\n      this._updateColumns();\n      return;\n    }\n\n    if (!changedProps.has(\"hass\")) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as this[\"hass\"];\n\n    if (oldHass && this.hass!.dockedSidebar !== oldHass.dockedSidebar) {\n      this._updateColumns();\n    }\n  }\n\n  public firstUpdated() {\n    this._fetchConfig(false);\n    // we don't want to unsub as we want to stay informed of updates\n    subscribeLovelaceUpdates(this.hass!.connection, () =>\n      this._lovelaceChanged()\n    );\n    // reload lovelace on reconnect so we are sure we have the latest config\n    window.addEventListener(\"connection-status\", (ev) => {\n      if (ev.detail === \"connected\") {\n        this._fetchConfig(false);\n      }\n    });\n    this._updateColumns = this._updateColumns.bind(this);\n    this.mqls = [300, 600, 900, 1200].map((width) => {\n      const mql = matchMedia(`(min-width: ${width}px)`);\n      mql.addListener(this._updateColumns);\n      return mql;\n    });\n    this._updateColumns();\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (\n      this.lovelace &&\n      this.hass &&\n      this.lovelace.language !== this.hass.language\n    ) {\n      // language has been changed, rebuild UI\n      this._setLovelaceConfig(this.lovelace.config, this.lovelace.mode);\n    } else if (this.lovelace && this.lovelace.mode === \"generated\") {\n      // When lovelace is generated, we re-generate each time a user goes\n      // to the states panel to make sure new entities are shown.\n      this._state = \"loading\";\n      this._regenerateConfig();\n    }\n  }\n\n  private async _regenerateConfig() {\n    const conf = await generateLovelaceConfig(this.hass!, this.hass!.localize);\n    this._setLovelaceConfig(conf, \"generated\");\n    this._state = \"loaded\";\n  }\n\n  private _closeEditor() {\n    this._state = \"loaded\";\n  }\n\n  private _updateColumns() {\n    const matchColumns = this.mqls!.reduce(\n      (cols, mql) => cols + Number(mql.matches),\n      0\n    );\n    // Do -1 column if the menu is docked and open\n    this._columns = Math.max(\n      1,\n      matchColumns - Number(!this.narrow && this.hass!.dockedSidebar)\n    );\n  }\n\n  private _lovelaceChanged() {\n    if (this._saving) {\n      this._saving = false;\n    } else {\n      showToast(this, {\n        message: this.hass!.localize(\"ui.panel.lovelace.changed_toast.message\"),\n        action: {\n          action: () => this._fetchConfig(false),\n          text: this.hass!.localize(\"ui.panel.lovelace.changed_toast.refresh\"),\n        },\n        duration: 0,\n        dismissable: false,\n      });\n    }\n  }\n\n  private _forceFetchConfig() {\n    this._fetchConfig(true);\n  }\n\n  private async _fetchConfig(forceDiskRefresh) {\n    let conf: LovelaceConfig;\n    let confMode: Lovelace[\"mode\"] = this.panel!.config.mode;\n    let confProm: Promise<LovelaceConfig>;\n    const llWindow = window as WindowWithLovelaceProm;\n\n    // On first load, we speed up loading page by having LL promise ready\n    if (llWindow.llConfProm) {\n      confProm = llWindow.llConfProm;\n      llWindow.llConfProm = undefined;\n    } else {\n      confProm = fetchConfig(this.hass!.connection, forceDiskRefresh);\n    }\n\n    try {\n      conf = await confProm;\n    } catch (err) {\n      if (err.code !== \"config_not_found\") {\n        // tslint:disable-next-line\n        console.log(err);\n        this._state = \"error\";\n        this._errorMsg = err.message;\n        return;\n      }\n      conf = await generateLovelaceConfig(this.hass!, this.hass!.localize);\n      confMode = \"generated\";\n    }\n\n    this._state = \"loaded\";\n    this._setLovelaceConfig(conf, confMode);\n  }\n\n  private _setLovelaceConfig(config: LovelaceConfig, mode: Lovelace[\"mode\"]) {\n    this.lovelace = {\n      config,\n      mode,\n      editMode: this.lovelace ? this.lovelace.editMode : false,\n      language: this.hass!.language,\n      enableFullEditMode: () => {\n        if (!editorLoaded) {\n          editorLoaded = true;\n          import(/* webpackChunkName: \"lovelace-yaml-editor\" */ \"./hui-editor\");\n        }\n        this._state = \"yaml-editor\";\n      },\n      setEditMode: (editMode: boolean) => {\n        if (!editMode || this.lovelace!.mode !== \"generated\") {\n          this._updateLovelace({ editMode });\n          return;\n        }\n        showSaveDialog(this, {\n          lovelace: this.lovelace!,\n        });\n      },\n      saveConfig: async (newConfig: LovelaceConfig): Promise<void> => {\n        const { config: previousConfig, mode: previousMode } = this.lovelace!;\n        try {\n          // Optimistic update\n          this._updateLovelace({\n            config: newConfig,\n            mode: \"storage\",\n          });\n          this._saving = true;\n          await saveConfig(this.hass!, newConfig);\n        } catch (err) {\n          // tslint:disable-next-line\n          console.error(err);\n          // Rollback the optimistic update\n          this._updateLovelace({\n            config: previousConfig,\n            mode: previousMode,\n          });\n          throw err;\n        }\n      },\n    };\n  }\n\n  private _updateLovelace(props: Partial<Lovelace>) {\n    this.lovelace = {\n      ...this.lovelace!,\n      ...props,\n    };\n  }\n}\n\ncustomElements.define(\"ha-panel-lovelace\", LovelacePanel);\n","import { HomeAssistant } from \"../types\";\n\nexport interface AuthProvider {\n  name: string;\n  id: string;\n  type: string;\n}\n\nexport interface Credential {\n  type: string;\n}\n\nexport interface SignedPath {\n  path: string;\n}\n\nexport const hassUrl = `${location.protocol}//${location.host}`;\n\nexport const getSignedPath = (\n  hass: HomeAssistant,\n  path: string\n): Promise<SignedPath> => hass.callWS({ type: \"auth/sign_path\", path });\n\nexport const fetchAuthProviders = () =>\n  fetch(\"/auth/providers\", {\n    credentials: \"same-origin\",\n  });\n","// Load a resource and get a promise when loading done.\n// From: https://davidwalsh.name/javascript-loader\n\nconst _load = (\n  tag: \"link\" | \"script\" | \"img\",\n  url: string,\n  type?: \"module\"\n) => {\n  // This promise will be used by Promise.all to determine success or failure\n  return new Promise((resolve, reject) => {\n    const element = document.createElement(tag);\n    let attr = \"src\";\n    let parent = \"body\";\n\n    // Important success and error for the promise\n    element.onload = () => resolve(url);\n    element.onerror = () => reject(url);\n\n    // Need to set different attributes depending on tag type\n    switch (tag) {\n      case \"script\":\n        (element as HTMLScriptElement).async = true;\n        if (type) {\n          (element as HTMLScriptElement).type = type;\n        }\n        break;\n      case \"link\":\n        (element as HTMLLinkElement).type = \"text/css\";\n        (element as HTMLLinkElement).rel = \"stylesheet\";\n        attr = \"href\";\n        parent = \"head\";\n    }\n\n    // Inject into document to kick off loading\n    element[attr] = url;\n    document[parent].appendChild(element);\n  });\n};\n\nexport const loadCSS = (url: string) => _load(\"link\", url);\nexport const loadJS = (url: string) => _load(\"script\", url);\nexport const loadImg = (url: string) => _load(\"img\", url);\nexport const loadModule = (url: string) => _load(\"script\", url, \"module\");\n"],"sourceRoot":""}