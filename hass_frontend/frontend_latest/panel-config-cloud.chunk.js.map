{"version":3,"sources":["webpack:///./src/common/datetime/format_date_time.ts","webpack:///./src/common/entity/entity_filter.ts","webpack:///./src/components/buttons/ha-call-api-button.js","webpack:///./src/components/buttons/ha-progress-button.js","webpack:///./src/data/webhook.ts","webpack:///./src/panels/config/cloud/cloud-alexa-pref.ts","webpack:///./src/panels/config/cloud/cloud-exposed-entities.ts","webpack:///./src/panels/config/cloud/cloud-google-pref.ts","webpack:///./src/panels/config/cloud/cloud-remote-pref.ts","webpack:///./src/panels/config/cloud/cloud-webhooks.ts","webpack:///./src/panels/config/cloud/ha-config-cloud-account.js","webpack:///./src/panels/config/cloud/ha-config-cloud-login.js","webpack:///./src/panels/config/cloud/ha-config-cloud.ts","webpack:///./src/panels/config/cloud/show-cloud-webhook-manage-dialog.ts","webpack:///./src/panels/config/cloud/show-dialog-cloud-certificate.ts"],"names":["toLocaleStringSupportsOptions","Date","toLocaleString","e","name","dateObj","locales","year","month","day","hour","minute","fecha","format","isEmptyFilter","filter","include_domains","length","include_entities","exclude_domains","exclude_entities","generateFilter","includeDomains","includeEntities","excludeDomains","excludeEntities","includeDomainsSet","Set","includeEntitiesSet","excludeDomainsSet","excludeEntitiesSet","haveInclude","size","haveExclude","entityId","has","computeDomain","HaCallApiButton","LitElement","render","html","progress","_buttonTapped","disabled","constructor","method","data","properties","hass","Boolean","path","String","progressButton","renderRoot","querySelector","eventData","resp","callApi","actionSuccess","success","response","err","actionError","fireEvent","customElements","define","HaProgressButton","PolymerElement","template","type","Object","value","tempClass","className","classList","$","container","add","setTimeout","remove","ready","addEventListener","ev","buttonTapped","stopPropagation","computeDisabled","fetchWebhooks","callWS","CloudAlexaPref","cloudStatus","enabled","prefs","alexa_enabled","_toggleChanged","alexa_entities","alexa_domains","toggle","target","updateCloudPref","checked","styles","css","CloudExposedEntities","supportedDomains","_filterFunc","states","keys","forEach","stateObj","push","computeStateName","sort","renderStyle","repeat","stateInfo","entity_id","_handleMoreInfo","updated","changedProperties","get","filterFunc","domains","domain","split","currentTarget","CloudGooglePref","google_enabled","google_secure_devices_pin","_pinChanged","id","input","alert","message","CloudRemotePref","customElement","remote_connected","remote_domain","remote_certificate","_openCertInfo","showCloudCertificateDialog","certificateInfo","connectCloudRemote","disconnectCloudRemote","CloudWebhooks","_cloudHooks","_localHooks","_progress","connectedCallback","_fetchData","_renderBody","changedProps","cloudhooks","map","entry","toLowerCase","webhook_id","includes","_handleManageButton","_enableWebhook","_showDialog","webhookId","webhook","find","ent","cloudhook","showManageCloudhookDialog","disableHook","_disableWebhook","parentElement","updatedWebhook","createCloudhook","wid","deleteCloudhook","newHooks","config","components","registeredWebhookDialog","HaConfigCloudAccount","EventsMixin","LocalizeMixin","isWide","_subscription","_fetchSubscriptionInfo","dialogShowEvent","dialogTag","dialogImport","_computeRemoteConnected","connected","fetchCloudSubscriptionInfo","provider","cloud","fire","handleLogout","then","_formatSubscription","subInfo","description","human_description","plan_renewal_date","replace","formatDateTime","language","HaConfigCloudLogin","NavigateMixin","email","notify","_password","_requestInProgress","flashMessage","_error","observers","requestAnimationFrame","flashRipple","simulatedRipple","_inputChanged","invalid","password","_keyDown","keyCode","_handleLogin","preventDefault","focus","setProperties","errCode","body","code","navigate","props","_handleRegister","_handleForgotPassword","_dismissFlash","LOGGED_IN_URLS","NOT_LOGGED_IN_URLS","HaConfigCloud","property","defaultPage","showLoading","initialLoad","_cloudStatusLoaded","beforeRender","page","logged_in","undefined","routes","login","tag","register","load","account","Promise","resolve","_resolveCloudStatusLoaded","_flashMessage","detail","oldStatus","route","prefix","el","_loginEmail","_currentPage","narrow","HassRouterPage","element","webhookDialogParams","dialogParams"],"mappings":";;;;;;;;;;AAAA;AAAA;CAEA;;AACA,SAASA,6BAAT,GAAyC;AACvC,MAAI;AACF,QAAIC,IAAJ,GAAWC,cAAX,CAA0B,GAA1B;AACD,GAFD,CAEE,OAAOC,CAAP,EAAU;AACV,WAAOA,CAAC,CAACC,IAAF,KAAW,YAAlB;AACD;;AACD,SAAO,KAAP;AACD;;AAEeJ,4FAA6B,KACzC,CAACK,OAAD,EAAgBC,OAAhB,KACED,OAAO,CAACH,cAAR,CAAuBI,OAAvB,EAAgC;AAC9BC,MAAI,EAAE,SADwB;AAE9BC,OAAK,EAAE,MAFuB;AAG9BC,KAAG,EAAE,SAHyB;AAI9BC,MAAI,EAAE,SAJwB;AAK9BC,QAAM,EAAE;AALsB,CAAhC,CAFuC,GASxCN,OAAD,IAAmBO,6CAAK,CAACC,MAAN,CAAaR,OAAb,EAAsB,YAAtB,CATvB,E;;;;;;;;;;;;ACZA;AAAA;AAAA;AAAA;AAAA;AAWO,MAAMS,aAAa,GAAIC,MAAD,IAC3BA,MAAM,CAACC,eAAP,CAAuBC,MAAvB,GACEF,MAAM,CAACG,gBAAP,CAAwBD,MAD1B,GAEEF,MAAM,CAACI,eAAP,CAAuBF,MAFzB,GAGEF,MAAM,CAACK,gBAAP,CAAwBH,MAH1B,KAIA,CALK;AAOA,MAAMI,cAAc,GAAG,CAC5BC,cAD4B,EAE5BC,eAF4B,EAG5BC,cAH4B,EAI5BC,eAJ4B,KAKb;AACf,QAAMC,iBAAiB,GAAG,IAAIC,GAAJ,CAAQL,cAAR,CAA1B;AACA,QAAMM,kBAAkB,GAAG,IAAID,GAAJ,CAAQJ,eAAR,CAA3B;AACA,QAAMM,iBAAiB,GAAG,IAAIF,GAAJ,CAAQH,cAAR,CAA1B;AACA,QAAMM,kBAAkB,GAAG,IAAIH,GAAJ,CAAQF,eAAR,CAA3B;AAEA,QAAMM,WAAW,GAAGL,iBAAiB,CAACM,IAAlB,GAAyB,CAAzB,IAA8BJ,kBAAkB,CAACI,IAAnB,GAA0B,CAA5E;AACA,QAAMC,WAAW,GAAGJ,iBAAiB,CAACG,IAAlB,GAAyB,CAAzB,IAA8BF,kBAAkB,CAACE,IAAnB,GAA0B,CAA5E,CAPe,CASf;;AACA,MAAI,CAACD,WAAD,IAAgB,CAACE,WAArB,EAAkC;AAChC,WAAO,MAAM,IAAb;AACD,GAZc,CAcf;;;AACA,MAAIF,WAAW,IAAI,CAACE,WAApB,EAAiC;AAC/B,WAAQC,QAAD,IACLN,kBAAkB,CAACO,GAAnB,CAAuBD,QAAvB,KACAR,iBAAiB,CAACS,GAAlB,CAAsBC,+DAAa,CAACF,QAAD,CAAnC,CAFF;AAGD,GAnBc,CAqBf;;;AACA,MAAI,CAACH,WAAD,IAAgBE,WAApB,EAAiC;AAC/B,WAAQC,QAAD,IACL,CAACJ,kBAAkB,CAACK,GAAnB,CAAuBD,QAAvB,CAAD,IACA,CAACL,iBAAiB,CAACM,GAAlB,CAAsBC,+DAAa,CAACF,QAAD,CAAnC,CAFH;AAGD,GA1Bc,CA4Bf;AACA;AACA;AACA;AACA;AACA;;;AACA,MAAIR,iBAAiB,CAACM,IAAtB,EAA4B;AAC1B,WAAQE,QAAD,IACLR,iBAAiB,CAACS,GAAlB,CAAsBC,+DAAa,CAACF,QAAD,CAAnC,IACI,CAACJ,kBAAkB,CAACK,GAAnB,CAAuBD,QAAvB,CADL,GAEIN,kBAAkB,CAACO,GAAnB,CAAuBD,QAAvB,CAHN;AAID,GAvCc,CAyCf;AACA;AACA;;;AACA,MAAIL,iBAAiB,CAACG,IAAtB,EAA4B;AAC1B,WAAQE,QAAD,IACLL,iBAAiB,CAACM,GAAlB,CAAsBC,+DAAa,CAACF,QAAD,CAAnC,IACIN,kBAAkB,CAACO,GAAnB,CAAuBD,QAAvB,CADJ,GAEI,CAACJ,kBAAkB,CAACK,GAAnB,CAAuBD,QAAvB,CAHP;AAID,GAjDc,CAmDf;AACA;;;AACA,SAAQA,QAAD,IAAcN,kBAAkB,CAACO,GAAnB,CAAuBD,QAAvB,CAArB;AACD,CA3DM,C;;;;;;;;;;;;AClBP;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;;AAEA,MAAMG,eAAN,SAA8BC,sDAA9B,CAAyC;AACvCC,QAAM,GAAG;AACP,WAAOC,gDAAK;;qBAEK,KAAKC,QAAS;kBACjB,KAAKC,aAAc;qBAChB,KAAKC,QAAS;;;KAJ/B;AAQD;;AAEDC,aAAW,GAAG;AACZ;AACA,SAAKC,MAAL,GAAc,MAAd;AACA,SAAKC,IAAL,GAAY,EAAZ;AACA,SAAKH,QAAL,GAAgB,KAAhB;AACA,SAAKF,QAAL,GAAgB,KAAhB;AACD;;AAED,aAAWM,UAAX,GAAwB;AACtB,WAAO;AACLC,UAAI,EAAE,EADD;AAELP,cAAQ,EAAEQ,OAFL;AAGLC,UAAI,EAAEC,MAHD;AAILN,YAAM,EAAEM,MAJH;AAKLL,UAAI,EAAE,EALD;AAMLH,cAAQ,EAAEM;AANL,KAAP;AAQD;;AAED,MAAIG,cAAJ,GAAqB;AACnB,WAAO,KAAKC,UAAL,CAAgBC,aAAhB,CAA8B,oBAA9B,CAAP;AACD;;AAED,QAAMZ,aAAN,GAAsB;AACpB,SAAKD,QAAL,GAAgB,IAAhB;AACA,UAAMc,SAAS,GAAG;AAChBV,YAAM,EAAE,KAAKA,MADG;AAEhBK,UAAI,EAAE,KAAKA,IAFK;AAGhBJ,UAAI,EAAE,KAAKA;AAHK,KAAlB;;AAMA,QAAI;AACF,YAAMU,IAAI,GAAG,MAAM,KAAKR,IAAL,CAAUS,OAAV,CAAkB,KAAKZ,MAAvB,EAA+B,KAAKK,IAApC,EAA0C,KAAKJ,IAA/C,CAAnB;AACA,WAAKL,QAAL,GAAgB,KAAhB;AACA,WAAKW,cAAL,CAAoBM,aAApB;AACAH,eAAS,CAACI,OAAV,GAAoB,IAApB;AACAJ,eAAS,CAACK,QAAV,GAAqBJ,IAArB;AACD,KAND,CAME,OAAOK,GAAP,EAAY;AACZ,WAAKpB,QAAL,GAAgB,KAAhB;AACA,WAAKW,cAAL,CAAoBU,WAApB;AACAP,eAAS,CAACI,OAAV,GAAoB,KAApB;AACAJ,eAAS,CAACK,QAAV,GAAqBC,GAArB;AACD;;AAEDE,4EAAS,CAAC,IAAD,EAAO,iBAAP,EAA0BR,SAA1B,CAAT;AACD;;AAzDsC;;AA4DzCS,cAAc,CAACC,MAAf,CAAsB,oBAAtB,EAA4C5B,eAA5C,E;;;;;;;;;;;;ACjEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;;AAEA,MAAM6B,gBAAN,SAA+BC,+EAA/B,CAA8C;AAC5C,aAAWC,QAAX,GAAsB;AACpB,WAAO5B,wEAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAAZ;AA8CD;;AAED,aAAWO,UAAX,GAAwB;AACtB,WAAO;AACLC,UAAI,EAAE;AACJqB,YAAI,EAAEC;AADF,OADD;AAKL7B,cAAQ,EAAE;AACR4B,YAAI,EAAEpB,OADE;AAERsB,aAAK,EAAE;AAFC,OALL;AAUL5B,cAAQ,EAAE;AACR0B,YAAI,EAAEpB,OADE;AAERsB,aAAK,EAAE;AAFC;AAVL,KAAP;AAeD;;AAEDC,WAAS,CAACC,SAAD,EAAY;AACnB,QAAIC,SAAS,GAAG,KAAKC,CAAL,CAAOC,SAAP,CAAiBF,SAAjC;AACAA,aAAS,CAACG,GAAV,CAAcJ,SAAd;AACAK,cAAU,CAAC,MAAM;AACfJ,eAAS,CAACK,MAAV,CAAiBN,SAAjB;AACD,KAFS,EAEP,IAFO,CAAV;AAGD;;AAEDO,OAAK,GAAG;AACN,UAAMA,KAAN;AACA,SAAKC,gBAAL,CAAsB,OAAtB,EAAgCC,EAAD,IAAQ,KAAKC,YAAL,CAAkBD,EAAlB,CAAvC;AACD;;AAEDC,cAAY,CAACD,EAAD,EAAK;AACf,QAAI,KAAKzC,QAAT,EAAmByC,EAAE,CAACE,eAAH;AACpB;;AAED1B,eAAa,GAAG;AACd,SAAKc,SAAL,CAAe,SAAf;AACD;;AAEDV,aAAW,GAAG;AACZ,SAAKU,SAAL,CAAe,OAAf;AACD;;AAEDa,iBAAe,CAAC1C,QAAD,EAAWF,QAAX,EAAqB;AAClC,WAAOE,QAAQ,IAAIF,QAAnB;AACD;;AA/F2C;;AAkG9CuB,cAAc,CAACC,MAAf,CAAsB,oBAAtB,EAA4CC,gBAA5C,E;;;;;;;;;;;;AC/FA;AAAA;AAAO,MAAMoB,aAAa,GAAItC,IAAD,IAC3BA,IAAI,CAACuC,MAAL,CAAY;AACVlB,MAAI,EAAE;AADI,CAAZ,CADK,C;;;;;;;;;;;;;;;;;;;;;;;ACRP;AAQA;CAEA;;AAGA;AAEA;AAEA;AACA;AAEO,MAAMmB,cAAN,SAA6BlD,sDAA7B,CAAwC;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAI7C,aAAWS,UAAX,GAA8C;AAC5C,WAAO;AACLC,UAAI,EAAE,EADD;AAELyC,iBAAW,EAAE;AAFR,KAAP;AAID;;AAESlD,QAAV,GAA0C;AACxC,QAAI,CAAC,KAAKkD,WAAV,EAAuB;AACrB,aAAOjD,gDAAK,EAAZ;AACD;;AAED,UAAMkD,OAAO,GAAG,KAAKD,WAAL,CAAkBE,KAAlB,CAAwBC,aAAxC;AAEA,WAAOpD,gDAAK;;;sBAGMkD,OAAQ;qBACT,KAAKG,cAAe;;;;;;;;;;;;;;;;;;;;;;;YAuB7BH,OAAO,GACLlD,gDAAK;;;2BAGQ,KAAKQ,IAAK;6BACR,KAAKyC,WAAL,CAAkBK,cAAe;uCACvB,KAAKL,WAAL,CAAkBM,aAAc;;eANpD,GASL,EAAG;;;KApCb;AAwCD;;AAED,QAAcF,cAAd,CAA6BX,EAA7B,EAAiC;AAC/B,UAAMc,MAAM,GAAGd,EAAE,CAACe,MAAlB;;AACA,QAAI;AACF,YAAMC,mEAAe,CAAC,KAAKlD,IAAN,EAAa;AAAE4C,qBAAa,EAAEI,MAAM,CAACG;AAAxB,OAAb,CAArB;AACApC,8EAAS,CAAC,IAAD,EAAO,yBAAP,CAAT;AACD,KAHD,CAGE,OAAOF,GAAP,EAAY;AACZmC,YAAM,CAACG,OAAP,GAAiB,CAACH,MAAM,CAACG,OAAzB;AACD;AACF;;AAED,aAAWC,MAAX,GAA+B;AAC7B,WAAOC,+CAAI;;;;;;;;;;KAAX;AAWD;;AAlF4C;AA2F/CrC,cAAc,CAACC,MAAf,CAAsB,kBAAtB,EAA0CuB,cAA1C,E;;;;;;;;;;;;;;;;;;;;;;;AC/GA;AAOA;AACA;AAEA;AAEA;AAEA;AACA;AAMO,MAAMc,oBAAN,SAAmChE,sDAAnC,CAA8C;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAMnD,aAAWS,UAAX,GAA8C;AAC5C,WAAO;AACLC,UAAI,EAAE,EADD;AAELjC,YAAM,EAAE,EAFH;AAGLwF,sBAAgB,EAAE,EAHb;AAILC,iBAAW,EAAE;AAJR,KAAP;AAMD;;AAESjE,QAAV,GAA0C;AACxC,QAAI,CAAC,KAAKiE,WAAV,EAAuB;AACrB,aAAOhE,gDAAK,EAAZ;AACD;;AAED,UAAMiE,MAAuC,GAAG,EAAhD;AAEAnC,UAAM,CAACoC,IAAP,CAAY,KAAK1D,IAAL,CAAWyD,MAAvB,EAA+BE,OAA/B,CAAwCzE,QAAD,IAAc;AACnD,UAAI,KAAKsE,WAAL,CAAkBtE,QAAlB,CAAJ,EAAiC;AAC/B,cAAM0E,QAAQ,GAAG,KAAK5D,IAAL,CAAWyD,MAAX,CAAkBvE,QAAlB,CAAjB;AACAuE,cAAM,CAACI,IAAP,CAAY,CAACC,iFAAgB,CAACF,QAAD,CAAjB,EAA6BA,QAA7B,CAAZ;AACD;AACF,KALD;AAMAH,UAAM,CAACM,IAAP;AAEA,WAAOvE,gDAAK;QACR,KAAKwE,WAAL,EAAmB;QACnBC,yEAAM,CACNR,MADM,EAELS,SAAD,IAAeA,SAAS,CAAC,CAAD,CAAT,CAAaC,SAFtB,EAGLD,SAAD,IAAe1E,gDAAK;;;2BAGD0E,SAAS,CAAC,CAAD,CAAI;wBAChB,KAAKE,eAAgB;;+CAEEF,SAAS,CAAC,CAAD,CAAI;;SAT9C,CAYN;KAdJ;AAgBD;;AAESG,SAAV,CAAkBC,iBAAlB,EAAqD;AACnD,UAAMD,OAAN,CAAcC,iBAAd;;AACA,QACEA,iBAAiB,CAACnF,GAAlB,CAAsB,QAAtB,KACAmF,iBAAiB,CAACC,GAAlB,CAAsB,QAAtB,MAAoC,KAAKxG,MAF3C,EAGE;AACA,YAAMA,MAAM,GAAG,KAAKA,MAApB;AACA,YAAMyG,UAAU,GAAGnG,mFAAc,CAC/BN,MAAM,CAACC,eADwB,EAE/BD,MAAM,CAACG,gBAFwB,EAG/BH,MAAM,CAACI,eAHwB,EAI/BJ,MAAM,CAACK,gBAJwB,CAAjC;AAMA,YAAMqG,OAAO,GAAG,IAAI9F,GAAJ,CAAQ,KAAK4E,gBAAb,CAAhB;;AACA,WAAKC,WAAL,GAAoBtE,QAAD,IAAsB;AACvC,cAAMwF,MAAM,GAAGxF,QAAQ,CAACyF,KAAT,CAAe,GAAf,EAAoB,CAApB,CAAf;AACA,eAAOF,OAAO,CAACtF,GAAR,CAAYuF,MAAZ,KAAuBF,UAAU,CAACtF,QAAD,CAAxC;AACD,OAHD;AAID;AACF;;AAEOkF,iBAAR,CAAwBlC,EAAxB,EAAwC;AACtCnB,4EAAS,CAAC,IAAD,EAAO,gBAAP,EAAyB;AAChC7B,cAAQ,EAAGgD,EAAE,CAAC0C,aAAJ,CAA0BhB,QAA1B,CAAmCO;AADb,KAAzB,CAAT;AAGD;;AAEOH,aAAR,GAAsC;AACpC,WAAOxE,gDAAK;;;;;;;KAAZ;AAQD;;AApFkD;AA6FrDwB,cAAc,CAACC,MAAf,CAAsB,wBAAtB,EAAgDqC,oBAAhD,E;;;;;;;;;;;;;;;;;;;;;;;AClHA;AAQA;CAEA;;AAEA;AAEA;AAEA;AAEA;AAGO,MAAMuB,eAAN,SAA8BvF,sDAA9B,CAAyC;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAI9C,aAAWS,UAAX,GAA8C;AAC5C,WAAO;AACLC,UAAI,EAAE,EADD;AAELyC,iBAAW,EAAE;AAFR,KAAP;AAID;;AAESlD,QAAV,GAA0C;AACxC,QAAI,CAAC,KAAKkD,WAAV,EAAuB;AACrB,aAAOjD,gDAAK,EAAZ;AACD;;AAED,UAAM;AACJsF,oBADI;AAEJC;AAFI,QAGF,KAAKtC,WAAL,CAAiBE,KAHrB;AAKA,WAAOnD,gDAAK;;;;sBAIMsF,cAAe;qBAChB,KAAKjC,cAAe;;;;;;;;;;;;;;;;;;;;;;;;;;;;YA4B7BiC,cAAc,GACZtF,gDAAK;;;;;;;;;;6BAUUuF,yBAAyB,IAAI,EAAG;+BAC9B,KAAKC,WAAY;;;eAZtB,GAgBZ,EAAG;;;;qBAII,KAAKhF,IAAK;yBACN,CAAC8E,cAAe;;;;;;;;;;;KAtDrC;AAkED;;AAED,QAAcjC,cAAd,CAA6BX,EAA7B,EAAiC;AAC/B,UAAMc,MAAM,GAAGd,EAAE,CAACe,MAAlB;;AACA,QAAI;AACF,YAAMC,mEAAe,CAAC,KAAKlD,IAAN,EAAa;AAAE,SAACgD,MAAM,CAACiC,EAAR,GAAajC,MAAM,CAACG;AAAtB,OAAb,CAArB;AACApC,8EAAS,CAAC,IAAD,EAAO,yBAAP,CAAT;AACD,KAHD,CAGE,OAAOF,GAAP,EAAY;AACZmC,YAAM,CAACG,OAAP,GAAiB,CAACH,MAAM,CAACG,OAAzB;AACD;AACF;;AAED,QAAc6B,WAAd,CAA0B9C,EAA1B,EAA8B;AAC5B,UAAMgD,KAAK,GAAGhD,EAAE,CAACe,MAAjB;;AACA,QAAI;AACF,YAAMC,mEAAe,CAAC,KAAKlD,IAAN,EAAa;AAChC,SAACkF,KAAK,CAACD,EAAP,GAAYC,KAAK,CAAC3D,KAAN,IAAe;AADK,OAAb,CAArB;AAGAR,8EAAS,CAAC,IAAD,EAAO,yBAAP,CAAT;AACD,KALD,CAKE,OAAOF,GAAP,EAAY;AACZsE,WAAK,CAAE,wBAAuBtE,GAAG,CAACuE,OAAQ,EAArC,CAAL;AACAF,WAAK,CAAC3D,KAAN,GAAc,KAAKkB,WAAL,CAAkBE,KAAlB,CAAwBoC,yBAAtC;AACD;AACF;;AAED,aAAW3B,MAAX,GAA+B;AAC7B,WAAOC,+CAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAAX;AA8BD;;AA/I6C;AAwJhDrC,cAAc,CAACC,MAAf,CAAsB,mBAAtB,EAA2C4D,eAA3C,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7KA;AASA;AACA;CAEA;;AAGA;AAEA;AAEA;AAKA;AAGO,IAAMQ,eAAb,cADCC,iEAAa,CAAC,mBAAD,CACd;AADA,QACaD,eADb,qBACgD;AAAA;AAAA;;AAAA;AAAA;;AAAA;;AAAhD;AAAA,OAAaA,eAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAIE,sBAA8C;AAC5C,eAAO;AACLrF,cAAI,EAAE,EADD;AAELyC,qBAAW,EAAE;AAFR,SAAP;AAID;AATH;AAAA;AAAA;AAAA,aAWE,kBAA0C;AACxC,YAAI,CAAC,KAAKA,WAAV,EAAuB;AACrB,iBAAOjD,gDAAK,EAAZ;AACD;;AAED,cAAM;AACJ+F,0BADI;AAEJC,uBAFI;AAGJC;AAHI,YAIF,KAAKhD,WAJT;;AAMA,YAAI,CAACgD,kBAAL,EAAyB;AACvB,iBAAOjG,gDAAK;;;;;;OAAZ;AAOD;;AAED,eAAOA,gDAAK;;;sBAGM+F,gBAAiB;qBAClB,KAAK1C,cAAe;;;;;YAK7B0C,gBAAgB,GAAG,IAAH,GAAU,SAAU;6BACnBC,aAAc;sBACrBA,aAAc;;;;;;;YAOxBC,kBAAkB,GAChBjG,gDAAK;;qCAEkB,KAAKkG,aAAc;;;eAH1B,GAOhB,EAAG;;;KAzBb;AA6BD;AA7DH;AAAA;AAAA;AAAA,aA+DE,yBAAwB;AACtBC,yGAA0B,CAAC,IAAD,EAAO;AAC/BC,yBAAe,EAAE,KAAKnD,WAAL,CAAkBgD;AADJ,SAAP,CAA1B;AAGD;AAnEH;AAAA;AAAA;AAAA,aAqEE,8BAA6BvD,EAA7B,EAAiC;AAC/B,cAAMc,MAAM,GAAGd,EAAE,CAACe,MAAlB;;AAEA,YAAI;AACF,cAAID,MAAM,CAACG,OAAX,EAAoB;AAClB,kBAAM0C,sEAAkB,CAAC,KAAK7F,IAAN,CAAxB;AACD,WAFD,MAEO;AACL,kBAAM8F,yEAAqB,CAAC,KAAK9F,IAAN,CAA3B;AACD;;AACDe,kFAAS,CAAC,IAAD,EAAO,yBAAP,CAAT;AACD,SAPD,CAOE,OAAOF,GAAP,EAAY;AACZsE,eAAK,CAACtE,GAAG,CAACuE,OAAL,CAAL;AACApC,gBAAM,CAACG,OAAP,GAAiB,CAACH,MAAM,CAACG,OAAzB;AACD;AACF;AAnFH;AAAA;AAAA;AAAA;AAAA,aAqFE,kBAA+B;AAC7B,eAAOE,+CAAI;;;;;;;;;;;;;;;;;;;;;;KAAX;AAuBD;AA7GH;AAAA;AAAA,GAAqC/D,sDAArC,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3BA;AAMA;AACA;AACA;AACA;AACA;AAGA;AACA;AAMA;AAEO,MAAMyG,aAAN,SAA4BzG,sDAA5B,CAAuC;AAO5C,aAAWS,UAAX,GAA8C;AAC5C,WAAO;AACLC,UAAI,EAAE,EADD;AAELyC,iBAAW,EAAE,EAFR;AAGLuD,iBAAW,EAAE,EAHR;AAILC,iBAAW,EAAE,EAJR;AAKLC,eAAS,EAAE;AALN,KAAP;AAOD;;AAEDtG,aAAW,GAAG;AACZ;;AADY;;AAAA;;AAAA;;AAAA;;AAAA;;AAEZ,SAAKsG,SAAL,GAAiB,EAAjB;AACD;;AAEMC,mBAAP,GAA2B;AACzB,UAAMA,iBAAN;;AACA,SAAKC,UAAL;AACD;;AAES7G,QAAV,GAAmB;AACjB,WAAOC,gDAAK;QACR,KAAKwE,WAAL,EAAmB;;;;;;sBAML,KAAKqC,WAAL,EAAmB;;;;;;;;;KAPrC;AAiBD;;AAEShC,SAAV,CAAkBiC,YAAlB,EAAgD;AAC9C,UAAMjC,OAAN,CAAciC,YAAd;;AACA,QAAIA,YAAY,CAACnH,GAAb,CAAiB,aAAjB,KAAmC,KAAKsD,WAA5C,EAAyD;AACvD,WAAKuD,WAAL,GAAmB,KAAKvD,WAAL,CAAiBE,KAAjB,CAAuB4D,UAAvB,IAAqC,EAAxD;AACD;AACF;;AAEOF,aAAR,GAAsB;AACpB,QAAI,CAAC,KAAK5D,WAAN,IAAqB,CAAC,KAAKwD,WAA3B,IAA0C,CAAC,KAAKD,WAApD,EAAiE;AAC/D,aAAOxG,gDAAK;;OAAZ;AAGD;;AAED,QAAI,KAAKyG,WAAL,CAAiBhI,MAAjB,KAA4B,CAAhC,EAAmC;AACjC,aAAOuB,gDAAK;;;;;;OAAZ;AAOD;;AAED,WAAO,KAAKyG,WAAL,CAAiBO,GAAjB,CACJC,KAAD,IAAWjH,gDAAK;uCACiBiH,KAAM;;;gBAG7BA,KAAK,CAACrJ,IAAK;gBACXqJ,KAAK,CAAC/B,MAAN,KAAiB+B,KAAK,CAACrJ,IAAN,CAAWsJ,WAAX,EAAjB,GACE,EADF,GAEG,KAAID,KAAK,CAAC/B,MAAO,GAAG;;6BAEV+B,KAAK,CAACE,UAAW;;YAElC,KAAKT,SAAL,CAAeU,QAAf,CAAwBH,KAAK,CAACE,UAA9B,IACEnH,gDAAK;;;;eADP,GAME,KAAKwG,WAAL,CAAkBS,KAAK,CAACE,UAAxB,IACAnH,gDAAK;sCACmB,KAAKqH,mBAAoB;;;eAFjD,GAMArH,gDAAK;;4BAES,KAAKsH,cAAe;;eAEhC;;OA5BL,CAAP;AAgCD;;AAEOC,aAAR,CAAoBC,SAApB,EAAuC;AACrC,UAAMC,OAAO,GAAG,KAAKhB,WAAL,CAAkBiB,IAAlB,CACbC,GAAD,IAASA,GAAG,CAACR,UAAJ,KAAmBK,SADd,CAAhB;;AAGA,UAAMI,SAAS,GAAG,KAAKpB,WAAL,CAAkBgB,SAAlB,CAAlB;AACAK,uGAAyB,CAAC,IAAD,EAAO;AAC9BJ,aAD8B;AAE9BG,eAF8B;AAG9BE,iBAAW,EAAE,MAAM,KAAKC,eAAL,CAAqBP,SAArB;AAHW,KAAP,CAAzB;AAKD;;AAEOH,qBAAR,CAA4B3E,EAA5B,EAA4C;AAC1C,UAAMuE,KAAK,GAAIvE,EAAE,CAAC0C,aAAJ,CAA0B4C,aAA1B,CAAwCf,KAAtD;;AACA,SAAKM,WAAL,CAAiBN,KAAK,CAACE,UAAvB;AACD;;AAED,QAAcG,cAAd,CAA6B5E,EAA7B,EAA6C;AAC3C,UAAMuE,KAAK,GAAIvE,EAAE,CAAC0C,aAAJ,CAA0B4C,aAA1B,CAAwCf,KAAtD;AACA,SAAKP,SAAL,GAAiB,CAAC,GAAG,KAAKA,SAAT,EAAoBO,KAAK,CAACE,UAA1B,CAAjB;AACA,QAAIc,cAAJ;;AAEA,QAAI;AACFA,oBAAc,GAAG,MAAMC,mEAAe,CAAC,KAAK1H,IAAN,EAAayG,KAAK,CAACE,UAAnB,CAAtC;AACD,KAFD,CAEE,OAAO9F,GAAP,EAAY;AACZsE,WAAK,CAAEtE,GAAD,CAAsBuE,OAAvB,CAAL;AACA;AACD,KALD,SAKU;AACR,WAAKc,SAAL,GAAiB,KAAKA,SAAL,CAAenI,MAAf,CAAuB4J,GAAD,IAASA,GAAG,KAAKlB,KAAK,CAACE,UAA7C,CAAjB;AACD;;AAED,SAAKX,WAAL,qBACK,KAAKA,WADV;AAEE,OAACS,KAAK,CAACE,UAAP,GAAoBc;AAFtB,OAd2C,CAmB3C;;AACA,QAAI,KAAKvB,SAAL,CAAejI,MAAf,KAA0B,CAA9B,EAAiC;AAC/B,WAAK8I,WAAL,CAAiBN,KAAK,CAACE,UAAvB;AACD;AACF;;AAED,QAAcY,eAAd,CAA8BP,SAA9B,EAAiD;AAC/C,SAAKd,SAAL,GAAiB,CAAC,GAAG,KAAKA,SAAT,EAAoBc,SAApB,CAAjB;;AACA,QAAI;AACF,YAAMY,mEAAe,CAAC,KAAK5H,IAAN,EAAagH,SAAb,CAArB;AACD,KAFD,CAEE,OAAOnG,GAAP,EAAY;AACZsE,WAAK,CAAE,8BAA8BtE,GAAD,CAAsBuE,OAAQ,EAA7D,CAAL;AACA;AACD,KALD,SAKU;AACR,WAAKc,SAAL,GAAiB,KAAKA,SAAL,CAAenI,MAAf,CAAuB4J,GAAD,IAASA,GAAG,KAAKX,SAAvC,CAAjB;AACD,KAT8C,CAW/C;;;AACA,iBAAmD,KAAKhB,WAAxD;AAAA,UAAsC6B,QAAtC,wCAASb,SAAT;;AACA,SAAKhB,WAAL,GAAmB6B,QAAnB;AACD;;AAED,QAAczB,UAAd,GAA2B;AACzB,SAAKH,WAAL,GAAmB,KAAKjG,IAAL,CAAW8H,MAAX,CAAkBC,UAAlB,CAA6BnB,QAA7B,CAAsC,SAAtC,IACf,MAAMtE,mEAAa,CAAC,KAAKtC,IAAN,CADJ,GAEf,EAFJ;AAGD;;AAEOgE,aAAR,GAAsB;AACpB,WAAOxE,gDAAK;;;;;;;;;;;;;;;;;;;;;;;KAAZ;AAwBD;;AAlM2C;AA2M9CwB,cAAc,CAACC,MAAf,CAAsB,gBAAtB,EAAwC8E,aAAxC,E;;;;;;;;;;;;ACjOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,IAAIiC,uBAAuB,GAAG,KAA9B;AAEA;;;;;AAIA,MAAMC,oBAAN,SAAmCC,yEAAW,CAACC,uEAAa,CAAChH,+EAAD,CAAd,CAA9C,CAA8E;AAC5E,aAAWC,QAAX,GAAsB;AACpB,WAAO5B,wEAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAAZ;AAmHD;;AAED,aAAWO,UAAX,GAAwB;AACtB,WAAO;AACLC,UAAI,EAAEsB,MADD;AAEL8G,YAAM,EAAEnI,OAFH;AAGLwC,iBAAW,EAAEnB,MAHR;AAIL+G,mBAAa,EAAE;AACbhH,YAAI,EAAEC,MADO;AAEbC,aAAK,EAAE;AAFM;AAJV,KAAP;AASD;;AAEDS,OAAK,GAAG;AACN,UAAMA,KAAN;;AACA,SAAKsG,sBAAL;AACD;;AAEDnC,mBAAiB,GAAG;AAClB,UAAMA,iBAAN;;AAEA,QAAI,CAAC6B,uBAAL,EAA8B;AAC5BA,6BAAuB,GAAG,IAA1B;AACAjH,+EAAS,CAAC,IAAD,EAAO,iBAAP,EAA0B;AACjCwH,uBAAe,EAAE,sBADgB;AAEjCC,iBAAS,EAAE,6BAFsB;AAGjCC,oBAAY,EAAE,MACZ;AAJ+B,OAA1B,CAAT;AAMD;AACF;;AAEDC,yBAAuB,CAACC,SAAD,EAAY;AACjC,WAAOA,SAAS,GAAG,WAAH,GAAiB,eAAjC;AACD;;AAED,QAAML,sBAAN,GAA+B;AAC7B,SAAKD,aAAL,GAAqB,MAAMO,+EAA0B,CAAC,KAAK5I,IAAN,CAArD;;AACA,QACE,KAAKqI,aAAL,CAAmBQ,QAAnB,IACA,KAAKpG,WADL,IAEA,KAAKA,WAAL,CAAiBqG,KAAjB,KAA2B,WAH7B,EAIE;AACA,WAAKC,IAAL,CAAU,yBAAV;AACD;AACF;;AAEDC,cAAY,GAAG;AACb,SAAKhJ,IAAL,CACGS,OADH,CACW,MADX,EACmB,cADnB,EAEGwI,IAFH,CAEQ,MAAM,KAAKF,IAAL,CAAU,yBAAV,CAFd;AAGD;;AAEDG,qBAAmB,CAACC,OAAD,EAAU;AAC3B,QAAIA,OAAO,KAAK,IAAhB,EAAsB;AACpB,aAAO,wBAAP;AACD;;AAED,QAAIC,WAAW,GAAGD,OAAO,CAACE,iBAA1B;;AAEA,QAAIF,OAAO,CAACG,iBAAZ,EAA+B;AAC7BF,iBAAW,GAAGA,WAAW,CAACG,OAAZ,CACZ,aADY,EAEZC,kFAAc,CACZ,IAAIvM,IAAJ,CAASkM,OAAO,CAACG,iBAAR,GAA4B,IAArC,CADY,EAEZ,KAAKtJ,IAAL,CAAUyJ,QAFE,CAFF,CAAd;AAOD;;AAED,WAAOL,WAAP;AACD;;AA7L2E;;AAgM9EpI,cAAc,CAACC,MAAf,CAAsB,yBAAtB,EAAiDgH,oBAAjD,E;;;;;;;;;;;;AC7NA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;;;;AAIA,MAAMyB,kBAAN,SAAiCC,uEAAa,CAACzB,yEAAW,CAAC/G,+EAAD,CAAZ,CAA9C,CAA4E;AAC1E,aAAWC,QAAX,GAAsB;AACpB,WAAO5B,wEAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAAZ;AAsID;;AAED,aAAWO,UAAX,GAAwB;AACtB,WAAO;AACLC,UAAI,EAAEsB,MADD;AAEL8G,YAAM,EAAEnI,OAFH;AAGL2J,WAAK,EAAE;AACLvI,YAAI,EAAElB,MADD;AAEL0J,cAAM,EAAE;AAFH,OAHF;AAOLC,eAAS,EAAE;AACTzI,YAAI,EAAElB,MADG;AAEToB,aAAK,EAAE;AAFE,OAPN;AAWLwI,wBAAkB,EAAE;AAClB1I,YAAI,EAAEpB,OADY;AAElBsB,aAAK,EAAE;AAFW,OAXf;AAeLyI,kBAAY,EAAE;AACZ3I,YAAI,EAAElB,MADM;AAEZ0J,cAAM,EAAE;AAFI,OAfT;AAmBLI,YAAM,EAAE9J;AAnBH,KAAP;AAqBD;;AAED,aAAW+J,SAAX,GAAuB;AACrB,WAAO,CAAC,iCAAD,CAAP;AACD;;AAED/D,mBAAiB,GAAG;AAClB,UAAMA,iBAAN;;AACA,QAAI,KAAK6D,YAAT,EAAuB;AACrB;AACAG,2BAAqB,CAAC,MACpBA,qBAAqB,CAAC,MAAM,KAAKxI,CAAL,CAAOyI,WAAP,CAAmBC,eAAnB,EAAP,CADF,CAArB;AAGD;AACF;;AAEDC,eAAa,GAAG;AACd,SAAK3I,CAAL,CAAOiI,KAAP,CAAaW,OAAb,GAAuB,KAAvB;AACA,SAAK5I,CAAL,CAAO6I,QAAP,CAAgBD,OAAhB,GAA0B,KAA1B;AACA,SAAKN,MAAL,GAAc,KAAd;AACD;;AAEDQ,UAAQ,CAACvI,EAAD,EAAK;AACX;AACA,QAAIA,EAAE,CAACwI,OAAH,KAAe,EAAnB,EAAuB;AACrB,WAAKC,YAAL;;AACAzI,QAAE,CAAC0I,cAAH;AACD;AACF;;AAEDD,cAAY,GAAG;AACb,QAAIJ,OAAO,GAAG,KAAd;;AAEA,QAAI,CAAC,KAAKX,KAAN,IAAe,CAAC,KAAKA,KAAL,CAAWhD,QAAX,CAAoB,GAApB,CAApB,EAA8C;AAC5C,WAAKjF,CAAL,CAAOiI,KAAP,CAAaW,OAAb,GAAuB,IAAvB;AACA,WAAK5I,CAAL,CAAOiI,KAAP,CAAaiB,KAAb;AACAN,aAAO,GAAG,IAAV;AACD;;AAED,QAAI,KAAKT,SAAL,CAAe7L,MAAf,GAAwB,CAA5B,EAA+B;AAC7B,WAAK0D,CAAL,CAAO6I,QAAP,CAAgBD,OAAhB,GAA0B,IAA1B;;AAEA,UAAI,CAACA,OAAL,EAAc;AACZA,eAAO,GAAG,IAAV;AACA,aAAK5I,CAAL,CAAO6I,QAAP,CAAgBK,KAAhB;AACD;AACF;;AAED,QAAIN,OAAJ,EAAa;AAEb,SAAKR,kBAAL,GAA0B,IAA1B;AAEA,SAAK/J,IAAL,CACGS,OADH,CACW,MADX,EACmB,aADnB,EACkC;AAC9BmJ,WAAK,EAAE,KAAKA,KADkB;AAE9BY,cAAQ,EAAE,KAAKV;AAFe,KADlC,EAKGb,IALH,CAMI,MAAM;AACJ,WAAKF,IAAL,CAAU,yBAAV;AACA,WAAK+B,aAAL,CAAmB;AACjBlB,aAAK,EAAE,EADU;AAEjBE,iBAAS,EAAE;AAFM,OAAnB;AAID,KAZL,EAaKjJ,GAAD,IAAS;AACP;AACA,WAAKiJ,SAAL,GAAiB,EAAjB;AAEA,YAAMiB,OAAO,GAAGlK,GAAG,IAAIA,GAAG,CAACmK,IAAX,IAAmBnK,GAAG,CAACmK,IAAJ,CAASC,IAA5C;;AACA,UAAIF,OAAO,KAAK,wBAAhB,EAA0C;AACxC5F,aAAK,CAAC,qDAAD,CAAL;AACA,aAAK+F,QAAL,CAAc,+BAAd;AACA;AACD;;AAED,YAAMC,KAAK,GAAG;AACZpB,0BAAkB,EAAE,KADR;AAEZE,cAAM,EACJpJ,GAAG,IAAIA,GAAG,CAACmK,IAAX,IAAmBnK,GAAG,CAACmK,IAAJ,CAAS5F,OAA5B,GACIvE,GAAG,CAACmK,IAAJ,CAAS5F,OADb,GAEI;AALM,OAAd;;AAQA,UAAI2F,OAAO,KAAK,kBAAhB,EAAoC;AAClCI,aAAK,CAAClB,MAAN,GAAe,mDAAf;AACD;;AAED,WAAKa,aAAL,CAAmBK,KAAnB;AACA,WAAKxJ,CAAL,CAAOiI,KAAP,CAAaiB,KAAb;AACD,KAtCL;AAwCD;;AAEDO,iBAAe,GAAG;AAChB,SAAKpB,YAAL,GAAoB,EAApB;AACA,SAAKkB,QAAL,CAAc,wBAAd;AACD;;AAEDG,uBAAqB,GAAG;AACtB,SAAKrB,YAAL,GAAoB,EAApB;AACA,SAAKkB,QAAL,CAAc,+BAAd;AACD;;AAEDI,eAAa,GAAG;AACd;AACAxJ,cAAU,CAAC,MAAM;AACf,WAAKkI,YAAL,GAAoB,EAApB;AACD,KAFS,EAEP,GAFO,CAAV;AAGD;;AA7QyE;;AAgR5EhJ,cAAc,CAACC,MAAf,CAAsB,uBAAtB,EAA+CyI,kBAA/C,E;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtSA;AACA;AACA;AAIA;AAEA;AAKA,MAAM6B,cAAc,GAAG,CAAC,SAAD,EAAY,kBAAZ,CAAvB;AACA,MAAMC,kBAAkB,GAAG,CAAC,OAAD,EAAU,UAAV,EAAsB,iBAAtB,CAA3B;;IAGMC,a,cADLnG,iEAAa,CAAC,iBAAD,C;AAAd,QACMmG,aADN,yBAC2C;AAAA;AAAA;;AAAA;AAAA;;AAAA;;;OAArCA,a;;;mBACHC,4DAAQ,E;;;;;mBACRA,4DAAQ,E;;;;;mBACRA,4DAAQ,E;;;;;mBACRA,4DAAQ,E;;;;;mBACRA,4DAAQ,E;;;;;;;;eAEgC;AACvCC,qBAAW,EAAE,OAD0B;AAEvCC,qBAAW,EAAE,IAF0B;AAGvCC,qBAAW,EAAE,MAAM,KAAKC,kBAHe;AAIvC;AACAC,sBAAY,EAAGC,IAAD,IAAkB;AAC9B,gBAAI,KAAKvJ,WAAL,CAAiBwJ,SAArB,EAAgC;AAC9B,kBAAI,CAACV,cAAc,CAAC3E,QAAf,CAAwBoF,IAAxB,CAAL,EAAoC;AAClC,uBAAO,SAAP;AACD;AACF,aAJD,MAIO;AACL,kBAAI,CAACR,kBAAkB,CAAC5E,QAAnB,CAA4BoF,IAA5B,CAAL,EAAwC;AACtC,uBAAO,OAAP;AACD;AACF;;AACD,mBAAOE,SAAP;AACD,WAhBsC;AAiBvCC,gBAAM,EAAE;AACNC,iBAAK,EAAE;AACLC,iBAAG,EAAE;AADA,aADD;AAINC,oBAAQ,EAAE;AACRD,iBAAG,EAAE,0BADG;AAERE,kBAAI,EAAE,MAAM;AAFJ,aAJJ;AAQN,+BAAmB;AACjBF,iBAAG,EAAE,iCADY;AAEjBE,kBAAI,EAAE,MAAM;AAFK,aARb;AAYNC,mBAAO,EAAE;AACPH,iBAAG,EAAE;AADE,aAZH;AAeN,gCAAoB;AAClBA,iBAAG,EAAE,kCADa;AAElBE,kBAAI,EAAE,MAAM;AAFM;AAfd;AAjB+B,S;;;;;mBAuCxCb,4DAAQ,E;;;;eAA2B,E;;;;;mBACnCA,4DAAQ,E;;;;eAAyB,E;;;;;;;;;;;;eAEL,IAAIe,OAAJ,CAAaC,OAAD,IAAa;AACpD,eAAKC,yBAAL,GAAiCD,OAAjC;AACD,SAF4B,C;;;;;;aAI7B,sBAAuBpG,YAAvB,EAAqC;AACnC,6BAtDEmF,aAsDF,8CAAmBnF,YAAnB;;AACA,aAAKrE,gBAAL,CAAsB,YAAtB,EAAqCC,EAAD,IAAQ;AAC1C,eAAK0K,aAAL,GAAsB1K,EAAD,CAAY2K,MAAZ,CAAmB7C,YAAxC;AACAkB,2EAAQ,CAAC,IAAD,EAAO,qBAAP,CAAR;AACD,SAHD;AAID;;;;aAED,iBAAkB5E,YAAlB,EAAgC;AAC9B,6BA9DEmF,aA8DF,yCAAcnF,YAAd;;AAEA,YAAIA,YAAY,CAACnH,GAAb,CAAiB,aAAjB,CAAJ,EAAqC;AACnC,gBAAM2N,SAAS,GAAGxG,YAAY,CAAC/B,GAAb,CAAiB,aAAjB,CAAlB;;AAGA,cAAIuI,SAAS,KAAKZ,SAAlB,EAA6B;AAC3B,iBAAKS,yBAAL;AACD,WAFD,MAEO,IAAIG,SAAS,CAACb,SAAV,KAAwB,KAAKxJ,WAAL,CAAiBwJ,SAA7C,EAAwD;AAC7Df,6EAAQ,CAAC,IAAD,EAAO,KAAK6B,KAAL,CAAWC,MAAlB,EAA0B,IAA1B,CAAR;AACD;AACF;AACF;;;;aAED,uBAAwBX,GAAxB,EAAqC;AACnC,cAAMY,EAAE,wBA7ENxB,aA6EM,+CAAuBY,GAAvB,CAAR;;AACAY,UAAE,CAAChL,gBAAH,CAAoB,eAApB,EAAsCC,EAAD,IAAQ;AAC3C,eAAKgL,WAAL,GAAoBhL,EAAD,CAAoC2K,MAApC,CAA2CtL,KAA9D;AACD,SAFD;AAGA0L,UAAE,CAAChL,gBAAH,CAAoB,uBAApB,EAA8CC,EAAD,IAAQ;AACnD,eAAK0K,aAAL,GAAsB1K,EAAD,CAAoC2K,MAApC,CAA2CtL,KAAhE;AACD,SAFD;AAGA,eAAO0L,EAAP;AACD;;;;aAED,sBAAuBA,EAAvB,EAA2B;AACzB;AACA;AACA,YACE,KAAKxK,WAAL,IACA,CAAC,KAAKA,WAAL,CAAiBwJ,SADlB,IAEAV,cAAc,CAAC3E,QAAf,CAAwB,KAAKuG,YAA7B,CAHF,EAIE;AACA;AACD;;AAED,YAAI,mBAAmBF,EAAvB,EAA2B;AACzB;AACCA,YAAD,CAAuBnC,aAAvB,CAAqC;AACnC9K,gBAAI,EAAE,KAAKA,IADwB;AAEnC4J,iBAAK,EAAE,KAAKsD,WAFuB;AAGnC9E,kBAAM,EAAE,KAAKA,MAHsB;AAInC3F,uBAAW,EAAE,KAAKA,WAJiB;AAKnCuH,wBAAY,EAAE,KAAK4C;AALgB,WAArC;AAOD,SATD,MASO;AACLK,YAAE,CAACjN,IAAH,GAAU,KAAKA,IAAf;AACAiN,YAAE,CAACrD,KAAH,GAAW,KAAKsD,WAAhB;AACAD,YAAE,CAAC7E,MAAH,GAAY,KAAKA,MAAjB;AACA6E,YAAE,CAACG,MAAH,GAAY,KAAKA,MAAjB;AACAH,YAAE,CAACxK,WAAH,GAAiB,KAAKA,WAAtB;AACAwK,YAAE,CAACjD,YAAH,GAAkB,KAAK4C,aAAvB;AACD;AACF;;;GAnHyBS,wE;;;;;;;;;;;;ACjB5B;AAAA;AAAA;AAAA;AAUO,MAAMhG,yBAAyB,GAAG,CACvCiG,OADuC,EAEvCC,mBAFuC,KAG9B;AACTxM,0EAAS,CAACuM,OAAD,EAAU,aAAV,EAAyB;AAChC9E,aAAS,EAAE,6BADqB;AAEhCC,gBAAY,EAAE,MACZ,okBAH8B;AAIhC+E,gBAAY,EAAED;AAJkB,GAAzB,CAAT;AAMD,CAVM,C;;;;;;;;;;;;ACVP;AAAA;AAAA;AAAA;AAOO,MAAM5H,0BAA0B,GAAG,CACxC2H,OADwC,EAExCC,mBAFwC,KAG/B;AACTxM,0EAAS,CAACuM,OAAD,EAAU,aAAV,EAAyB;AAChC9E,aAAS,EAAE,0BADqB;AAEhCC,gBAAY,EAAE,MACZ,0fAH8B;AAIhC+E,gBAAY,EAAED;AAJkB,GAAzB,CAAT;AAMD,CAVM,C","file":"panel-config-cloud.chunk.js","sourcesContent":["import fecha from \"fecha\";\n\n// Check for support of native locale string options\nfunction toLocaleStringSupportsOptions() {\n  try {\n    new Date().toLocaleString(\"i\");\n  } catch (e) {\n    return e.name === \"RangeError\";\n  }\n  return false;\n}\n\nexport default (toLocaleStringSupportsOptions()\n  ? (dateObj: Date, locales: string) =>\n      dateObj.toLocaleString(locales, {\n        year: \"numeric\",\n        month: \"long\",\n        day: \"numeric\",\n        hour: \"numeric\",\n        minute: \"2-digit\",\n      })\n  : (dateObj: Date) => fecha.format(dateObj, \"haDateTime\"));\n","import computeDomain from \"./compute_domain\";\n\nexport type FilterFunc = (entityId: string) => boolean;\n\nexport interface EntityFilter {\n  include_domains: string[];\n  include_entities: string[];\n  exclude_domains: string[];\n  exclude_entities: string[];\n}\n\nexport const isEmptyFilter = (filter: EntityFilter) =>\n  filter.include_domains.length +\n    filter.include_entities.length +\n    filter.exclude_domains.length +\n    filter.exclude_entities.length ===\n  0;\n\nexport const generateFilter = (\n  includeDomains?: string[],\n  includeEntities?: string[],\n  excludeDomains?: string[],\n  excludeEntities?: string[]\n): FilterFunc => {\n  const includeDomainsSet = new Set(includeDomains);\n  const includeEntitiesSet = new Set(includeEntities);\n  const excludeDomainsSet = new Set(excludeDomains);\n  const excludeEntitiesSet = new Set(excludeEntities);\n\n  const haveInclude = includeDomainsSet.size > 0 || includeEntitiesSet.size > 0;\n  const haveExclude = excludeDomainsSet.size > 0 || excludeEntitiesSet.size > 0;\n\n  // Case 1 - no includes or excludes - pass all entities\n  if (!haveInclude && !haveExclude) {\n    return () => true;\n  }\n\n  // Case 2 - includes, no excludes - only include specified entities\n  if (haveInclude && !haveExclude) {\n    return (entityId) =>\n      includeEntitiesSet.has(entityId) ||\n      includeDomainsSet.has(computeDomain(entityId));\n  }\n\n  // Case 3 - excludes, no includes - only exclude specified entities\n  if (!haveInclude && haveExclude) {\n    return (entityId) =>\n      !excludeEntitiesSet.has(entityId) &&\n      !excludeDomainsSet.has(computeDomain(entityId));\n  }\n\n  // Case 4 - both includes and excludes specified\n  // Case 4a - include domain specified\n  //  - if domain is included, pass if entity not excluded\n  //  - if domain is not included, pass if entity is included\n  // note: if both include and exclude domains specified,\n  //   the exclude domains are ignored\n  if (includeDomainsSet.size) {\n    return (entityId) =>\n      includeDomainsSet.has(computeDomain(entityId))\n        ? !excludeEntitiesSet.has(entityId)\n        : includeEntitiesSet.has(entityId);\n  }\n\n  // Case 4b - exclude domain specified\n  //  - if domain is excluded, pass if entity is included\n  //  - if domain is not excluded, pass if entity not excluded\n  if (excludeDomainsSet.size) {\n    return (entityId) =>\n      excludeDomainsSet.has(computeDomain(entityId))\n        ? includeEntitiesSet.has(entityId)\n        : !excludeEntitiesSet.has(entityId);\n  }\n\n  // Case 4c - neither include or exclude domain specified\n  //  - Only pass if entity is included.  Ignore entity excludes.\n  return (entityId) => includeEntitiesSet.has(entityId);\n};\n","import { LitElement, html } from \"lit-element\";\n\nimport \"./ha-progress-button\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\n\nclass HaCallApiButton extends LitElement {\n  render() {\n    return html`\n      <ha-progress-button\n        .progress=\"${this.progress}\"\n        @click=\"${this._buttonTapped}\"\n        ?disabled=\"${this.disabled}\"\n        ><slot></slot\n      ></ha-progress-button>\n    `;\n  }\n\n  constructor() {\n    super();\n    this.method = \"POST\";\n    this.data = {};\n    this.disabled = false;\n    this.progress = false;\n  }\n\n  static get properties() {\n    return {\n      hass: {},\n      progress: Boolean,\n      path: String,\n      method: String,\n      data: {},\n      disabled: Boolean,\n    };\n  }\n\n  get progressButton() {\n    return this.renderRoot.querySelector(\"ha-progress-button\");\n  }\n\n  async _buttonTapped() {\n    this.progress = true;\n    const eventData = {\n      method: this.method,\n      path: this.path,\n      data: this.data,\n    };\n\n    try {\n      const resp = await this.hass.callApi(this.method, this.path, this.data);\n      this.progress = false;\n      this.progressButton.actionSuccess();\n      eventData.success = true;\n      eventData.response = resp;\n    } catch (err) {\n      this.progress = false;\n      this.progressButton.actionError();\n      eventData.success = false;\n      eventData.response = err;\n    }\n\n    fireEvent(this, \"hass-api-called\", eventData);\n  }\n}\n\ncustomElements.define(\"ha-call-api-button\", HaCallApiButton);\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-spinner/paper-spinner\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nclass HaProgressButton extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        .container {\n          position: relative;\n          display: inline-block;\n        }\n\n        mwc-button {\n          transition: all 1s;\n        }\n\n        .success mwc-button {\n          --mdc-theme-primary: white;\n          background-color: var(--google-green-500);\n          transition: none;\n        }\n\n        .error mwc-button {\n          --mdc-theme-primary: white;\n          background-color: var(--google-red-500);\n          transition: none;\n        }\n\n        .progress {\n          @apply --layout;\n          @apply --layout-center-center;\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n        }\n      </style>\n      <div class=\"container\" id=\"container\">\n        <mwc-button\n          id=\"button\"\n          disabled=\"[[computeDisabled(disabled, progress)]]\"\n          on-click=\"buttonTapped\"\n        >\n          <slot></slot>\n        </mwc-button>\n        <template is=\"dom-if\" if=\"[[progress]]\">\n          <div class=\"progress\"><paper-spinner active=\"\"></paper-spinner></div>\n        </template>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      progress: {\n        type: Boolean,\n        value: false,\n      },\n\n      disabled: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  tempClass(className) {\n    var classList = this.$.container.classList;\n    classList.add(className);\n    setTimeout(() => {\n      classList.remove(className);\n    }, 1000);\n  }\n\n  ready() {\n    super.ready();\n    this.addEventListener(\"click\", (ev) => this.buttonTapped(ev));\n  }\n\n  buttonTapped(ev) {\n    if (this.progress) ev.stopPropagation();\n  }\n\n  actionSuccess() {\n    this.tempClass(\"success\");\n  }\n\n  actionError() {\n    this.tempClass(\"error\");\n  }\n\n  computeDisabled(disabled, progress) {\n    return disabled || progress;\n  }\n}\n\ncustomElements.define(\"ha-progress-button\", HaProgressButton);\n","import { HomeAssistant } from \"../types\";\n\nexport interface Webhook {\n  webhook_id: string;\n  domain: string;\n  name: string;\n}\n\nexport const fetchWebhooks = (hass: HomeAssistant): Promise<Webhook[]> =>\n  hass.callWS({\n    type: \"webhook/list\",\n  });\n","import {\n  html,\n  LitElement,\n  PropertyDeclarations,\n  TemplateResult,\n  CSSResult,\n  css,\n} from \"lit-element\";\nimport \"@material/mwc-button\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button\";\n// tslint:disable-next-line\nimport { PaperToggleButtonElement } from \"@polymer/paper-toggle-button/paper-toggle-button\";\n\nimport \"../../../components/ha-card\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { HomeAssistant } from \"../../../types\";\nimport \"./cloud-exposed-entities\";\nimport { CloudStatusLoggedIn, updateCloudPref } from \"../../../data/cloud\";\n\nexport class CloudAlexaPref extends LitElement {\n  public hass?: HomeAssistant;\n  public cloudStatus?: CloudStatusLoggedIn;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      hass: {},\n      cloudStatus: {},\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.cloudStatus) {\n      return html``;\n    }\n\n    const enabled = this.cloudStatus!.prefs.alexa_enabled;\n\n    return html`\n      <ha-card header=\"Alexa\">\n        <paper-toggle-button\n          .checked=\"${enabled}\"\n          @change=\"${this._toggleChanged}\"\n        ></paper-toggle-button>\n        <div class=\"card-content\">\n          With the Alexa integration for Home Assistant Cloud you'll be able to\n          control all your Home Assistant devices via any Alexa-enabled device.\n          <ul>\n            <li>\n              To activate, search in the Alexa app for the Home Assistant Smart\n              Home skill.\n            </li>\n            <li>\n              <a\n                href=\"https://www.nabucasa.com/config/amazon_alexa/\"\n                target=\"_blank\"\n              >\n                Config documentation\n              </a>\n            </li>\n          </ul>\n          <em\n            >This integration requires an Alexa-enabled device like the Amazon\n            Echo.</em\n          >\n          ${enabled\n            ? html`\n                <p>Exposed entities:</p>\n                <cloud-exposed-entities\n                  .hass=\"${this.hass}\"\n                  .filter=\"${this.cloudStatus!.alexa_entities}\"\n                  .supportedDomains=\"${this.cloudStatus!.alexa_domains}\"\n                ></cloud-exposed-entities>\n              `\n            : \"\"}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  private async _toggleChanged(ev) {\n    const toggle = ev.target as PaperToggleButtonElement;\n    try {\n      await updateCloudPref(this.hass!, { alexa_enabled: toggle.checked! });\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err) {\n      toggle.checked = !toggle.checked;\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      a {\n        color: var(--primary-color);\n      }\n      ha-card > paper-toggle-button {\n        margin: -4px 0;\n        position: absolute;\n        right: 8px;\n        top: 32px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-alexa-pref\": CloudAlexaPref;\n  }\n}\n\ncustomElements.define(\"cloud-alexa-pref\", CloudAlexaPref);\n","import {\n  html,\n  LitElement,\n  PropertyDeclarations,\n  PropertyValues,\n  TemplateResult,\n} from \"lit-element\";\nimport { repeat } from \"lit-html/directives/repeat\";\nimport \"@polymer/paper-tooltip/paper-tooltip\";\nimport { HassEntityBase } from \"home-assistant-js-websocket\";\nimport \"../../../components/entity/ha-state-icon\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { HomeAssistant } from \"../../../types\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport {\n  FilterFunc,\n  generateFilter,\n  EntityFilter,\n} from \"../../../common/entity/entity_filter\";\n\nexport class CloudExposedEntities extends LitElement {\n  public hass?: HomeAssistant;\n  public filter?: EntityFilter;\n  public supportedDomains?: string[];\n  private _filterFunc?: FilterFunc;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      hass: {},\n      filter: {},\n      supportedDomains: {},\n      _filterFunc: {},\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._filterFunc) {\n      return html``;\n    }\n\n    const states: Array<[string, HassEntityBase]> = [];\n\n    Object.keys(this.hass!.states).forEach((entityId) => {\n      if (this._filterFunc!(entityId)) {\n        const stateObj = this.hass!.states[entityId];\n        states.push([computeStateName(stateObj), stateObj]);\n      }\n    });\n    states.sort();\n\n    return html`\n      ${this.renderStyle()}\n      ${repeat(\n        states!,\n        (stateInfo) => stateInfo[1].entity_id,\n        (stateInfo) => html`\n          <span>\n            <ha-state-icon\n              .stateObj=\"${stateInfo[1]}\"\n              @click=\"${this._handleMoreInfo}\"\n            ></ha-state-icon>\n            <paper-tooltip position=\"bottom\">${stateInfo[0]}</paper-tooltip>\n          </span>\n        `\n      )}\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues) {\n    super.updated(changedProperties);\n    if (\n      changedProperties.has(\"filter\") &&\n      changedProperties.get(\"filter\") !== this.filter\n    ) {\n      const filter = this.filter!;\n      const filterFunc = generateFilter(\n        filter.include_domains,\n        filter.include_entities,\n        filter.exclude_domains,\n        filter.exclude_entities\n      );\n      const domains = new Set(this.supportedDomains);\n      this._filterFunc = (entityId: string) => {\n        const domain = entityId.split(\".\")[0];\n        return domains.has(domain) && filterFunc(entityId);\n      };\n    }\n  }\n\n  private _handleMoreInfo(ev: MouseEvent) {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: (ev.currentTarget as any).stateObj.entity_id,\n    });\n  }\n\n  private renderStyle(): TemplateResult {\n    return html`\n      <style>\n        ha-state-icon {\n          color: var(--primary-text-color);\n          cursor: pointer;\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-exposed-entities\": CloudExposedEntities;\n  }\n}\n\ncustomElements.define(\"cloud-exposed-entities\", CloudExposedEntities);\n","import {\n  html,\n  LitElement,\n  PropertyDeclarations,\n  TemplateResult,\n  CSSResult,\n  css,\n} from \"lit-element\";\nimport \"@material/mwc-button\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button\";\n// tslint:disable-next-line\nimport { PaperToggleButtonElement } from \"@polymer/paper-toggle-button/paper-toggle-button\";\nimport \"../../../components/buttons/ha-call-api-button\";\n\nimport \"../../../components/ha-card\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { HomeAssistant } from \"../../../types\";\nimport { CloudStatusLoggedIn, updateCloudPref } from \"../../../data/cloud\";\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\n\nexport class CloudGooglePref extends LitElement {\n  public hass?: HomeAssistant;\n  public cloudStatus?: CloudStatusLoggedIn;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      hass: {},\n      cloudStatus: {},\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.cloudStatus) {\n      return html``;\n    }\n\n    const {\n      google_enabled,\n      google_secure_devices_pin,\n    } = this.cloudStatus.prefs;\n\n    return html`\n      <ha-card header=\"Google Assistant\">\n        <paper-toggle-button\n          id=\"google_enabled\"\n          .checked=\"${google_enabled}\"\n          @change=\"${this._toggleChanged}\"\n        ></paper-toggle-button>\n        <div class=\"card-content\">\n          With the Google Assistant integration for Home Assistant Cloud you'll\n          be able to control all your Home Assistant devices via any Google\n          Assistant-enabled device.\n          <ul>\n            <li>\n              <a\n                href=\"https://assistant.google.com/services/a/uid/00000091fd5fb875?hl=en-US\"\n                target=\"_blank\"\n              >\n                Activate the Home Assistant skill for Google Assistant\n              </a>\n            </li>\n            <li>\n              <a\n                href=\"https://www.nabucasa.com/config/google_assistant/\"\n                target=\"_blank\"\n              >\n                Config documentation\n              </a>\n            </li>\n          </ul>\n          <em\n            >This integration requires a Google Assistant-enabled device like\n            the Google Home or Android phone.</em\n          >\n          ${google_enabled\n            ? html`\n                <div class=\"secure_devices\">\n                  Please enter a pin to interact with security devices. Security\n                  devices are doors, garage doors and locks. You will be asked\n                  to say/enter this pin when interacting with such devices via\n                  Google Assistant.\n                  <paper-input\n                    label=\"Secure Devices Pin\"\n                    id=\"google_secure_devices_pin\"\n                    placeholder=\"Secure devices disabled\"\n                    .value=${google_secure_devices_pin || \"\"}\n                    @change=\"${this._pinChanged}\"\n                  ></paper-input>\n                </div>\n              `\n            : \"\"}\n        </div>\n        <div class=\"card-actions\">\n          <ha-call-api-button\n            .hass=\"${this.hass}\"\n            .disabled=\"${!google_enabled}\"\n            path=\"cloud/google_actions/sync\"\n          >\n            Sync entities to Google\n          </ha-call-api-button>\n          <div class=\"spacer\"></div>\n          <a href=\"/config/cloud/google-assistant\">\n            <mwc-button>Manage Entities</mwc-button>\n          </a>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  private async _toggleChanged(ev) {\n    const toggle = ev.target as PaperToggleButtonElement;\n    try {\n      await updateCloudPref(this.hass!, { [toggle.id]: toggle.checked! });\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err) {\n      toggle.checked = !toggle.checked;\n    }\n  }\n\n  private async _pinChanged(ev) {\n    const input = ev.target as PaperInputElement;\n    try {\n      await updateCloudPref(this.hass!, {\n        [input.id]: input.value || null,\n      });\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err) {\n      alert(`Unable to store pin: ${err.message}`);\n      input.value = this.cloudStatus!.prefs.google_secure_devices_pin;\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      a {\n        color: var(--primary-color);\n      }\n      ha-card > paper-toggle-button {\n        margin: -4px 0;\n        position: absolute;\n        right: 8px;\n        top: 32px;\n      }\n      ha-call-api-button {\n        color: var(--primary-color);\n        font-weight: 500;\n      }\n      .secure_devices {\n        padding-top: 16px;\n      }\n      paper-input {\n        width: 200px;\n      }\n      .card-actions {\n        display: flex;\n      }\n      .card-actions a {\n        text-decoration: none;\n      }\n      .spacer {\n        flex-grow: 1;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-google-pref\": CloudGooglePref;\n  }\n}\n\ncustomElements.define(\"cloud-google-pref\", CloudGooglePref);\n","import {\n  html,\n  LitElement,\n  PropertyDeclarations,\n  TemplateResult,\n  customElement,\n  CSSResult,\n  css,\n} from \"lit-element\";\nimport \"@material/mwc-button\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button\";\nimport \"@polymer/paper-item/paper-item-body\";\n// tslint:disable-next-line\nimport { PaperToggleButtonElement } from \"@polymer/paper-toggle-button/paper-toggle-button\";\n\nimport \"../../../components/ha-card\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { HomeAssistant } from \"../../../types\";\nimport {\n  connectCloudRemote,\n  disconnectCloudRemote,\n  CloudStatusLoggedIn,\n} from \"../../../data/cloud\";\nimport { showCloudCertificateDialog } from \"./show-dialog-cloud-certificate\";\n\n@customElement(\"cloud-remote-pref\")\nexport class CloudRemotePref extends LitElement {\n  public hass?: HomeAssistant;\n  public cloudStatus?: CloudStatusLoggedIn;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      hass: {},\n      cloudStatus: {},\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.cloudStatus) {\n      return html``;\n    }\n\n    const {\n      remote_connected,\n      remote_domain,\n      remote_certificate,\n    } = this.cloudStatus;\n\n    if (!remote_certificate) {\n      return html`\n        <ha-card header=\"Remote Control\">\n          <div class=\"preparing\">\n            Remote access is being prepared. We will notify you when it's ready.\n          </div>\n        </ha-card>\n      `;\n    }\n\n    return html`\n      <ha-card header=\"Remote Control\">\n        <paper-toggle-button\n          .checked=\"${remote_connected}\"\n          @change=\"${this._toggleChanged}\"\n        ></paper-toggle-button>\n        <div class=\"card-content\">\n          Home Assistant Cloud provides a secure remote connection to your\n          instance while away from home. Your instance\n          ${remote_connected ? \"is\" : \"will be\"} available at\n          <a href=\"https://${remote_domain}\" target=\"_blank\">\n            https://${remote_domain}</a\n          >.\n        </div>\n        <div class=\"card-actions\">\n          <a href=\"https://www.nabucasa.com/config/remote/\" target=\"_blank\">\n            <mwc-button>Learn how it works</mwc-button>\n          </a>\n          ${remote_certificate\n            ? html`\n                <div class=\"spacer\"></div>\n                <mwc-button @click=${this._openCertInfo}>\n                  Certificate Info\n                </mwc-button>\n              `\n            : \"\"}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  private _openCertInfo() {\n    showCloudCertificateDialog(this, {\n      certificateInfo: this.cloudStatus!.remote_certificate!,\n    });\n  }\n\n  private async _toggleChanged(ev) {\n    const toggle = ev.target as PaperToggleButtonElement;\n\n    try {\n      if (toggle.checked) {\n        await connectCloudRemote(this.hass!);\n      } else {\n        await disconnectCloudRemote(this.hass!);\n      }\n      fireEvent(this, \"ha-refresh-cloud-status\");\n    } catch (err) {\n      alert(err.message);\n      toggle.checked = !toggle.checked;\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .preparing {\n        padding: 0 16px 16px;\n      }\n      a {\n        color: var(--primary-color);\n      }\n      ha-card > paper-toggle-button {\n        margin: -4px 0;\n        position: absolute;\n        right: 8px;\n        top: 32px;\n      }\n      .card-actions {\n        display: flex;\n      }\n      .card-actions a {\n        text-decoration: none;\n      }\n      .spacer {\n        flex-grow: 1;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-remote-pref\": CloudRemotePref;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyDeclarations,\n  PropertyValues,\n} from \"lit-element\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-item/paper-item-body\";\nimport \"@polymer/paper-spinner/paper-spinner\";\nimport \"../../../components/ha-card\";\n\nimport { HomeAssistant, WebhookError } from \"../../../types\";\nimport { Webhook, fetchWebhooks } from \"../../../data/webhook\";\nimport {\n  createCloudhook,\n  deleteCloudhook,\n  CloudWebhook,\n  CloudStatusLoggedIn,\n} from \"../../../data/cloud\";\nimport { showManageCloudhookDialog } from \"./show-cloud-webhook-manage-dialog\";\n\nexport class CloudWebhooks extends LitElement {\n  public hass?: HomeAssistant;\n  public cloudStatus?: CloudStatusLoggedIn;\n  private _cloudHooks?: { [webhookId: string]: CloudWebhook };\n  private _localHooks?: Webhook[];\n  private _progress: string[];\n\n  static get properties(): PropertyDeclarations {\n    return {\n      hass: {},\n      cloudStatus: {},\n      _cloudHooks: {},\n      _localHooks: {},\n      _progress: {},\n    };\n  }\n\n  constructor() {\n    super();\n    this._progress = [];\n  }\n\n  public connectedCallback() {\n    super.connectedCallback();\n    this._fetchData();\n  }\n\n  protected render() {\n    return html`\n      ${this.renderStyle()}\n      <ha-card header=\"Webhooks\">\n        <div class=\"card-content\">\n          Anything that is configured to be triggered by a webhook can be given\n          a publicly accessible URL to allow you to send data back to Home\n          Assistant from anywhere, without exposing your instance to the\n          internet. ${this._renderBody()}\n\n          <div class=\"footer\">\n            <a href=\"https://www.nabucasa.com/config/webhooks\" target=\"_blank\">\n              Learn more about creating webhook-powered automations.\n            </a>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n    if (changedProps.has(\"cloudStatus\") && this.cloudStatus) {\n      this._cloudHooks = this.cloudStatus.prefs.cloudhooks || {};\n    }\n  }\n\n  private _renderBody() {\n    if (!this.cloudStatus || !this._localHooks || !this._cloudHooks) {\n      return html`\n        <div class=\"body-text\">Loading…</div>\n      `;\n    }\n\n    if (this._localHooks.length === 0) {\n      return html`\n        <div class=\"body-text\">\n          Looks like you have no webhooks yet. Get started by configuring a\n          <a href=\"/config/integrations\">webhook-based integration</a> or by\n          creating a <a href=\"/config/automation/new\">webhook automation</a>.\n        </div>\n      `;\n    }\n\n    return this._localHooks.map(\n      (entry) => html`\n        <div class=\"webhook\" .entry=\"${entry}\">\n          <paper-item-body two-line>\n            <div>\n              ${entry.name}\n              ${entry.domain === entry.name.toLowerCase()\n                ? \"\"\n                : ` (${entry.domain})`}\n            </div>\n            <div secondary>${entry.webhook_id}</div>\n          </paper-item-body>\n          ${this._progress.includes(entry.webhook_id)\n            ? html`\n                <div class=\"progress\">\n                  <paper-spinner active></paper-spinner>\n                </div>\n              `\n            : this._cloudHooks![entry.webhook_id]\n            ? html`\n                <mwc-button @click=\"${this._handleManageButton}\">\n                  Manage\n                </mwc-button>\n              `\n            : html`\n                <paper-toggle-button\n                  @click=\"${this._enableWebhook}\"\n                ></paper-toggle-button>\n              `}\n        </div>\n      `\n    );\n  }\n\n  private _showDialog(webhookId: string) {\n    const webhook = this._localHooks!.find(\n      (ent) => ent.webhook_id === webhookId\n    )!;\n    const cloudhook = this._cloudHooks![webhookId];\n    showManageCloudhookDialog(this, {\n      webhook,\n      cloudhook,\n      disableHook: () => this._disableWebhook(webhookId),\n    });\n  }\n\n  private _handleManageButton(ev: MouseEvent) {\n    const entry = (ev.currentTarget as any).parentElement.entry as Webhook;\n    this._showDialog(entry.webhook_id);\n  }\n\n  private async _enableWebhook(ev: MouseEvent) {\n    const entry = (ev.currentTarget as any).parentElement.entry;\n    this._progress = [...this._progress, entry.webhook_id];\n    let updatedWebhook;\n\n    try {\n      updatedWebhook = await createCloudhook(this.hass!, entry.webhook_id);\n    } catch (err) {\n      alert((err as WebhookError).message);\n      return;\n    } finally {\n      this._progress = this._progress.filter((wid) => wid !== entry.webhook_id);\n    }\n\n    this._cloudHooks = {\n      ...this._cloudHooks,\n      [entry.webhook_id]: updatedWebhook,\n    };\n\n    // Only open dialog if we're not also enabling others, otherwise it's confusing\n    if (this._progress.length === 0) {\n      this._showDialog(entry.webhook_id);\n    }\n  }\n\n  private async _disableWebhook(webhookId: string) {\n    this._progress = [...this._progress, webhookId];\n    try {\n      await deleteCloudhook(this.hass!, webhookId!);\n    } catch (err) {\n      alert(`Failed to disable webhook: ${(err as WebhookError).message}`);\n      return;\n    } finally {\n      this._progress = this._progress.filter((wid) => wid !== webhookId);\n    }\n\n    // Remove cloud related parts from entry.\n    const { [webhookId]: disabledHook, ...newHooks } = this._cloudHooks!;\n    this._cloudHooks = newHooks;\n  }\n\n  private async _fetchData() {\n    this._localHooks = this.hass!.config.components.includes(\"webhook\")\n      ? await fetchWebhooks(this.hass!)\n      : [];\n  }\n\n  private renderStyle() {\n    return html`\n      <style>\n        .body-text {\n          padding: 8px 0;\n        }\n        .webhook {\n          display: flex;\n          padding: 4px 0;\n        }\n        .progress {\n          margin-right: 16px;\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n        }\n        .footer {\n          padding-top: 16px;\n        }\n        .body-text a,\n        .footer a {\n          color: var(--primary-color);\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"cloud-webhooks\": CloudWebhooks;\n  }\n}\n\ncustomElements.define(\"cloud-webhooks\", CloudWebhooks);\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-item/paper-item-body\";\nimport \"@polymer/paper-toggle-button/paper-toggle-button\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/buttons/ha-call-api-button\";\nimport \"../../../layouts/hass-subpage\";\nimport \"../../../resources/ha-style\";\n\nimport \"../ha-config-section\";\nimport \"./cloud-webhooks\";\n\nimport formatDateTime from \"../../../common/datetime/format_date_time\";\nimport { EventsMixin } from \"../../../mixins/events-mixin\";\nimport LocalizeMixin from \"../../../mixins/localize-mixin\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { fetchCloudSubscriptionInfo } from \"../../../data/cloud\";\nimport \"./cloud-alexa-pref\";\nimport \"./cloud-google-pref\";\nimport \"./cloud-remote-pref\";\n\nlet registeredWebhookDialog = false;\n\n/*\n * @appliesMixin EventsMixin\n * @appliesMixin LocalizeMixin\n */\nclass HaConfigCloudAccount extends EventsMixin(LocalizeMixin(PolymerElement)) {\n  static get template() {\n    return html`\n      <style include=\"iron-flex ha-style\">\n        [slot=\"introduction\"] {\n          margin: -1em 0;\n        }\n        [slot=\"introduction\"] a {\n          color: var(--primary-color);\n        }\n        .content {\n          padding-bottom: 24px;\n          direction: ltr;\n        }\n        .account-row {\n          display: flex;\n          padding: 0 16px;\n        }\n        mwc-button {\n          align-self: center;\n        }\n        .soon {\n          font-style: italic;\n          margin-top: 24px;\n          text-align: center;\n        }\n        .nowrap {\n          white-space: nowrap;\n        }\n        .wrap {\n          white-space: normal;\n        }\n        .status {\n          text-transform: capitalize;\n          padding: 16px;\n        }\n        a {\n          color: var(--primary-color);\n        }\n      </style>\n      <hass-subpage header=\"Home Assistant Cloud\">\n        <div class=\"content\">\n          <ha-config-section is-wide=\"[[isWide]]\">\n            <span slot=\"header\">Home Assistant Cloud</span>\n            <div slot=\"introduction\">\n              <p>\n                Thank you for being part of Home Assistant Cloud. It's because\n                of people like you that we are able to make a great home\n                automation experience for everyone. Thank you!\n              </p>\n            </div>\n\n            <ha-card header=\"Nabu Casa Account\">\n              <div class=\"account-row\">\n                <paper-item-body two-line=\"\">\n                  [[cloudStatus.email]]\n                  <div secondary class=\"wrap\">\n                    [[_formatSubscription(_subscription)]]\n                  </div>\n                </paper-item-body>\n              </div>\n\n              <div class=\"account-row\">\n                <paper-item-body> Cloud connection status </paper-item-body>\n                <div class=\"status\">[[cloudStatus.cloud]]</div>\n              </div>\n\n              <div class=\"card-actions\">\n                <a href=\"https://account.nabucasa.com\" target=\"_blank\"\n                  ><mwc-button>Manage Account</mwc-button></a\n                >\n                <mwc-button style=\"float: right\" on-click=\"handleLogout\"\n                  >Sign out</mwc-button\n                >\n              </div>\n            </ha-card>\n          </ha-config-section>\n\n          <ha-config-section is-wide=\"[[isWide]]\">\n            <span slot=\"header\">Integrations</span>\n            <div slot=\"introduction\">\n              <p>\n                Integrations for Home Assistant Cloud allow you to connect with\n                services in the cloud without having to expose your Home\n                Assistant instance publicly on the internet.\n              </p>\n              <p>\n                Check the website for\n                <a href=\"https://www.nabucasa.com\" target=\"_blank\"\n                  >all available features</a\n                >.\n              </p>\n            </div>\n\n            <cloud-remote-pref\n              hass=\"[[hass]]\"\n              cloud-status=\"[[cloudStatus]]\"\n            ></cloud-remote-pref>\n\n            <cloud-alexa-pref\n              hass=\"[[hass]]\"\n              cloud-status=\"[[cloudStatus]]\"\n            ></cloud-alexa-pref>\n\n            <cloud-google-pref\n              hass=\"[[hass]]\"\n              cloud-status=\"[[cloudStatus]]\"\n            ></cloud-google-pref>\n\n            <cloud-webhooks\n              hass=\"[[hass]]\"\n              cloud-status=\"[[cloudStatus]]\"\n            ></cloud-webhooks>\n          </ha-config-section>\n        </div>\n      </hass-subpage>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      isWide: Boolean,\n      cloudStatus: Object,\n      _subscription: {\n        type: Object,\n        value: null,\n      },\n    };\n  }\n\n  ready() {\n    super.ready();\n    this._fetchSubscriptionInfo();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    if (!registeredWebhookDialog) {\n      registeredWebhookDialog = true;\n      fireEvent(this, \"register-dialog\", {\n        dialogShowEvent: \"manage-cloud-webhook\",\n        dialogTag: \"cloud-webhook-manage-dialog\",\n        dialogImport: () =>\n          import(/* webpackChunkName: \"cloud-webhook-manage-dialog\" */ \"./cloud-webhook-manage-dialog\"),\n      });\n    }\n  }\n\n  _computeRemoteConnected(connected) {\n    return connected ? \"Connected\" : \"Not Connected\";\n  }\n\n  async _fetchSubscriptionInfo() {\n    this._subscription = await fetchCloudSubscriptionInfo(this.hass);\n    if (\n      this._subscription.provider &&\n      this.cloudStatus &&\n      this.cloudStatus.cloud !== \"connected\"\n    ) {\n      this.fire(\"ha-refresh-cloud-status\");\n    }\n  }\n\n  handleLogout() {\n    this.hass\n      .callApi(\"post\", \"cloud/logout\")\n      .then(() => this.fire(\"ha-refresh-cloud-status\"));\n  }\n\n  _formatSubscription(subInfo) {\n    if (subInfo === null) {\n      return \"Fetching subscription…\";\n    }\n\n    let description = subInfo.human_description;\n\n    if (subInfo.plan_renewal_date) {\n      description = description.replace(\n        \"{periodEnd}\",\n        formatDateTime(\n          new Date(subInfo.plan_renewal_date * 1000),\n          this.hass.language\n        )\n      );\n    }\n\n    return description;\n  }\n}\n\ncustomElements.define(\"ha-config-cloud-account\", HaConfigCloudAccount);\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-item/paper-item-body\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-ripple/paper-ripple\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/buttons/ha-progress-button\";\nimport \"../../../layouts/hass-subpage\";\nimport \"../../../resources/ha-style\";\n\nimport \"../ha-config-section\";\nimport { EventsMixin } from \"../../../mixins/events-mixin\";\nimport NavigateMixin from \"../../../mixins/navigate-mixin\";\nimport \"../../../components/ha-icon-next\";\n/*\n * @appliesMixin NavigateMixin\n * @appliesMixin EventsMixin\n */\nclass HaConfigCloudLogin extends NavigateMixin(EventsMixin(PolymerElement)) {\n  static get template() {\n    return html`\n      <style include=\"iron-flex ha-style\">\n        .content {\n          padding-bottom: 24px;\n          direction: ltr;\n        }\n        [slot=\"introduction\"] {\n          margin: -1em 0;\n        }\n        [slot=\"introduction\"] a {\n          color: var(--primary-color);\n        }\n        paper-item {\n          cursor: pointer;\n        }\n        ha-card {\n          overflow: hidden;\n        }\n        ha-card .card-header {\n          margin-bottom: -8px;\n        }\n        h1 {\n          @apply --paper-font-headline;\n          margin: 0;\n        }\n        .error {\n          color: var(--google-red-500);\n        }\n        .card-actions {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n        [hidden] {\n          display: none;\n        }\n        .flash-msg {\n          padding-right: 44px;\n        }\n        .flash-msg paper-icon-button {\n          position: absolute;\n          top: 8px;\n          right: 8px;\n          color: var(--secondary-text-color);\n        }\n      </style>\n      <hass-subpage header=\"Cloud Login\">\n        <div class=\"content\">\n          <ha-config-section is-wide=\"[[isWide]]\">\n            <span slot=\"header\">Home Assistant Cloud</span>\n            <div slot=\"introduction\">\n              <p>\n                Home Assistant Cloud provides you with a secure remote\n                connection to your instance while away from home. It also allows\n                you to connect with cloud-only services: Amazon Alexa and Google\n                Assistant.\n              </p>\n              <p>\n                This service is run by our partner\n                <a href=\"https://www.nabucasa.com\" target=\"_blank\"\n                  >Nabu&nbsp;Casa,&nbsp;Inc</a\n                >, a company founded by the founders of Home Assistant and\n                Hass.io.\n              </p>\n              <p>\n                Home Assistant Cloud is a subscription service with a free one\n                month trial. No payment information necessary.\n              </p>\n              <p>\n                <a href=\"https://www.nabucasa.com\" target=\"_blank\"\n                  >Learn more about Home Assistant Cloud</a\n                >\n              </p>\n            </div>\n\n            <ha-card hidden$=\"[[!flashMessage]]\">\n              <div class=\"card-content flash-msg\">\n                [[flashMessage]]\n                <paper-icon-button icon=\"hass:close\" on-click=\"_dismissFlash\"\n                  >Dismiss</paper-icon-button\n                >\n                <paper-ripple id=\"flashRipple\" noink=\"\"></paper-ripple>\n              </div>\n            </ha-card>\n\n            <ha-card header=\"Sign in\">\n              <div class=\"card-content\">\n                <div class=\"error\" hidden$=\"[[!_error]]\">[[_error]]</div>\n                <paper-input\n                  label=\"Email\"\n                  id=\"email\"\n                  type=\"email\"\n                  value=\"{{email}}\"\n                  on-keydown=\"_keyDown\"\n                  error-message=\"Invalid email\"\n                ></paper-input>\n                <paper-input\n                  id=\"password\"\n                  label=\"Password\"\n                  value=\"{{_password}}\"\n                  type=\"password\"\n                  on-keydown=\"_keyDown\"\n                  error-message=\"Passwords are at least 8 characters\"\n                ></paper-input>\n              </div>\n              <div class=\"card-actions\">\n                <ha-progress-button\n                  on-click=\"_handleLogin\"\n                  progress=\"[[_requestInProgress]]\"\n                  >Sign in</ha-progress-button\n                >\n                <button\n                  class=\"link\"\n                  hidden=\"[[_requestInProgress]]\"\n                  on-click=\"_handleForgotPassword\"\n                >\n                  forgot password?\n                </button>\n              </div>\n            </ha-card>\n\n            <ha-card>\n              <paper-item on-click=\"_handleRegister\">\n                <paper-item-body two-line=\"\">\n                  Start your free 1 month trial\n                  <div secondary=\"\">No payment information necessary</div>\n                </paper-item-body>\n                <ha-icon-next></ha-icon-next>\n              </paper-item>\n            </ha-card>\n          </ha-config-section>\n        </div>\n      </hass-subpage>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      isWide: Boolean,\n      email: {\n        type: String,\n        notify: true,\n      },\n      _password: {\n        type: String,\n        value: \"\",\n      },\n      _requestInProgress: {\n        type: Boolean,\n        value: false,\n      },\n      flashMessage: {\n        type: String,\n        notify: true,\n      },\n      _error: String,\n    };\n  }\n\n  static get observers() {\n    return [\"_inputChanged(email, _password)\"];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    if (this.flashMessage) {\n      // Wait for DOM to be drawn\n      requestAnimationFrame(() =>\n        requestAnimationFrame(() => this.$.flashRipple.simulatedRipple())\n      );\n    }\n  }\n\n  _inputChanged() {\n    this.$.email.invalid = false;\n    this.$.password.invalid = false;\n    this._error = false;\n  }\n\n  _keyDown(ev) {\n    // validate on enter\n    if (ev.keyCode === 13) {\n      this._handleLogin();\n      ev.preventDefault();\n    }\n  }\n\n  _handleLogin() {\n    let invalid = false;\n\n    if (!this.email || !this.email.includes(\"@\")) {\n      this.$.email.invalid = true;\n      this.$.email.focus();\n      invalid = true;\n    }\n\n    if (this._password.length < 8) {\n      this.$.password.invalid = true;\n\n      if (!invalid) {\n        invalid = true;\n        this.$.password.focus();\n      }\n    }\n\n    if (invalid) return;\n\n    this._requestInProgress = true;\n\n    this.hass\n      .callApi(\"post\", \"cloud/login\", {\n        email: this.email,\n        password: this._password,\n      })\n      .then(\n        () => {\n          this.fire(\"ha-refresh-cloud-status\");\n          this.setProperties({\n            email: \"\",\n            _password: \"\",\n          });\n        },\n        (err) => {\n          // Do this before setProperties because changing it clears errors.\n          this._password = \"\";\n\n          const errCode = err && err.body && err.body.code;\n          if (errCode === \"PasswordChangeRequired\") {\n            alert(\"You need to change your password before logging in.\");\n            this.navigate(\"/config/cloud/forgot-password\");\n            return;\n          }\n\n          const props = {\n            _requestInProgress: false,\n            _error:\n              err && err.body && err.body.message\n                ? err.body.message\n                : \"Unknown error\",\n          };\n\n          if (errCode === \"UserNotConfirmed\") {\n            props._error = \"You need to confirm your email before logging in.\";\n          }\n\n          this.setProperties(props);\n          this.$.email.focus();\n        }\n      );\n  }\n\n  _handleRegister() {\n    this.flashMessage = \"\";\n    this.navigate(\"/config/cloud/register\");\n  }\n\n  _handleForgotPassword() {\n    this.flashMessage = \"\";\n    this.navigate(\"/config/cloud/forgot-password\");\n  }\n\n  _dismissFlash() {\n    // give some time to let the ripple finish.\n    setTimeout(() => {\n      this.flashMessage = \"\";\n    }, 200);\n  }\n}\n\ncustomElements.define(\"ha-config-cloud-login\", HaConfigCloudLogin);\n","import \"./ha-config-cloud-account\";\nimport \"./ha-config-cloud-login\";\nimport {\n  HassRouterPage,\n  RouterOptions,\n} from \"../../../layouts/hass-router-page\";\nimport { property, customElement } from \"lit-element\";\nimport { HomeAssistant, Route } from \"../../../types\";\nimport { navigate } from \"../../../common/navigate\";\nimport { CloudStatus } from \"../../../data/cloud\";\nimport { PolymerChangedEvent } from \"../../../polymer-types\";\nimport { PolymerElement } from \"@polymer/polymer\";\n\nconst LOGGED_IN_URLS = [\"account\", \"google-assistant\"];\nconst NOT_LOGGED_IN_URLS = [\"login\", \"register\", \"forgot-password\"];\n\n@customElement(\"ha-config-cloud\")\nclass HaConfigCloud extends HassRouterPage {\n  @property() public hass!: HomeAssistant;\n  @property() public isWide!: boolean;\n  @property() public narrow!: boolean;\n  @property() public route!: Route;\n  @property() public cloudStatus!: CloudStatus;\n\n  protected routerOptions: RouterOptions = {\n    defaultPage: \"login\",\n    showLoading: true,\n    initialLoad: () => this._cloudStatusLoaded,\n    // Guard the different pages based on if we're logged in.\n    beforeRender: (page: string) => {\n      if (this.cloudStatus.logged_in) {\n        if (!LOGGED_IN_URLS.includes(page)) {\n          return \"account\";\n        }\n      } else {\n        if (!NOT_LOGGED_IN_URLS.includes(page)) {\n          return \"login\";\n        }\n      }\n      return undefined;\n    },\n    routes: {\n      login: {\n        tag: \"ha-config-cloud-login\",\n      },\n      register: {\n        tag: \"ha-config-cloud-register\",\n        load: () => import(\"./ha-config-cloud-register\"),\n      },\n      \"forgot-password\": {\n        tag: \"ha-config-cloud-forgot-password\",\n        load: () => import(\"./ha-config-cloud-forgot-password\"),\n      },\n      account: {\n        tag: \"ha-config-cloud-account\",\n      },\n      \"google-assistant\": {\n        tag: \"ha-config-cloud-google-assistant\",\n        load: () => import(\"./ha-config-cloud-google-assistant\"),\n      },\n    },\n  };\n\n  @property() private _flashMessage = \"\";\n  @property() private _loginEmail = \"\";\n  private _resolveCloudStatusLoaded!: () => void;\n  private _cloudStatusLoaded = new Promise((resolve) => {\n    this._resolveCloudStatusLoaded = resolve;\n  });\n\n  protected firstUpdated(changedProps) {\n    super.firstUpdated(changedProps);\n    this.addEventListener(\"cloud-done\", (ev) => {\n      this._flashMessage = (ev as any).detail.flashMessage;\n      navigate(this, \"/config/cloud/login\");\n    });\n  }\n\n  protected updated(changedProps) {\n    super.updated(changedProps);\n\n    if (changedProps.has(\"cloudStatus\")) {\n      const oldStatus = changedProps.get(\"cloudStatus\") as\n        | CloudStatus\n        | undefined;\n      if (oldStatus === undefined) {\n        this._resolveCloudStatusLoaded();\n      } else if (oldStatus.logged_in !== this.cloudStatus.logged_in) {\n        navigate(this, this.route.prefix, true);\n      }\n    }\n  }\n\n  protected createElement(tag: string) {\n    const el = super.createElement(tag);\n    el.addEventListener(\"email-changed\", (ev) => {\n      this._loginEmail = (ev as PolymerChangedEvent<string>).detail.value;\n    });\n    el.addEventListener(\"flash-message-changed\", (ev) => {\n      this._flashMessage = (ev as PolymerChangedEvent<string>).detail.value;\n    });\n    return el;\n  }\n\n  protected updatePageEl(el) {\n    // We are not going to update if the current page if we are not logged in\n    // and the current page requires being logged in. Happens when we log out.\n    if (\n      this.cloudStatus &&\n      !this.cloudStatus.logged_in &&\n      LOGGED_IN_URLS.includes(this._currentPage)\n    ) {\n      return;\n    }\n\n    if (\"setProperties\" in el) {\n      // As long as we have Polymer pages\n      (el as PolymerElement).setProperties({\n        hass: this.hass,\n        email: this._loginEmail,\n        isWide: this.isWide,\n        cloudStatus: this.cloudStatus,\n        flashMessage: this._flashMessage,\n      });\n    } else {\n      el.hass = this.hass;\n      el.email = this._loginEmail;\n      el.isWide = this.isWide;\n      el.narrow = this.narrow;\n      el.cloudStatus = this.cloudStatus;\n      el.flashMessage = this._flashMessage;\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-config-cloud\": HaConfigCloud;\n  }\n}\n","import { fireEvent } from \"../../../common/dom/fire_event\";\nimport { Webhook } from \"../../../data/webhook\";\nimport { CloudWebhook } from \"../../../data/cloud\";\n\nexport interface WebhookDialogParams {\n  webhook: Webhook;\n  cloudhook: CloudWebhook;\n  disableHook: () => void;\n}\n\nexport const showManageCloudhookDialog = (\n  element: HTMLElement,\n  webhookDialogParams: WebhookDialogParams\n): void => {\n  fireEvent(element, \"show-dialog\", {\n    dialogTag: \"cloud-webhook-manage-dialog\",\n    dialogImport: () =>\n      import(/* webpackChunkName: \"cloud-webhook-manage-dialog\" */ \"./cloud-webhook-manage-dialog\"),\n    dialogParams: webhookDialogParams,\n  });\n};\n","import { fireEvent } from \"../../../common/dom/fire_event\";\nimport { CertificateInformation } from \"../../../data/cloud\";\n\nexport interface CloudCertificateParams {\n  certificateInfo: CertificateInformation;\n}\n\nexport const showCloudCertificateDialog = (\n  element: HTMLElement,\n  webhookDialogParams: CloudCertificateParams\n): void => {\n  fireEvent(element, \"show-dialog\", {\n    dialogTag: \"dialog-cloud-certificate\",\n    dialogImport: () =>\n      import(/* webpackChunkName: \"dialog-cloud-certificate\" */ \"./dialog-cloud-certificate\"),\n    dialogParams: webhookDialogParams,\n  });\n};\n"],"sourceRoot":""}