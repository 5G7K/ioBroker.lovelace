{"version":3,"sources":["webpack:///./src/common/dom/load_resource.ts","webpack:///./src/common/dom/scroll-to-target.ts","webpack:///./src/common/dom/setup-leaflet-map.ts","webpack:///./src/common/entity/valid_entity_id.ts","webpack:///./src/common/string/compare.ts","webpack:///./src/common/util/debounce.ts","webpack:///./src/common/util/parse-aspect-ratio.ts","webpack:///./src/common/util/render-status.ts","webpack:///./src/common/util/subscribe-one.ts","webpack:///./src/components/buttons/ha-call-service-button.js","webpack:///./src/components/buttons/ha-progress-button.js","webpack:///./src/components/ha-date-input.ts","webpack:///./src/components/ha-paper-dropdown-menu.ts","webpack:///./src/components/ha-paper-icon-button-arrow-next.ts","webpack:///./src/components/ha-paper-icon-button-next.ts","webpack:///./src/components/paper-time-input.js","webpack:///./src/data/alarm_control_panel.ts","webpack:///./src/data/area_registry.ts","webpack:///./src/data/device_registry.ts","webpack:///./src/data/entity.ts","webpack:///./src/data/entity_registry.ts","webpack:///./src/data/input_datetime.ts","webpack:///./src/data/input_text.ts","webpack:///./src/data/lovelace.ts","webpack:///./src/data/shopping-list.ts","webpack:///./src/data/ws-notifications.ts","webpack:///./src/panels/lovelace/cards/hui-alarm-panel-card.ts","webpack:///./src/panels/lovelace/cards/hui-conditional-card.ts","webpack:///./src/panels/lovelace/cards/hui-entities-card.ts","webpack:///./src/panels/lovelace/cards/hui-entity-button-card.ts","webpack:///./src/panels/lovelace/cards/hui-entity-filter-card.ts","webpack:///./src/panels/lovelace/cards/hui-error-card.ts","webpack:///./src/panels/lovelace/cards/hui-gauge-card.ts","webpack:///./src/panels/lovelace/cards/hui-glance-card.ts","webpack:///./src/panels/lovelace/cards/hui-history-graph-card.js","webpack:///./src/panels/lovelace/cards/hui-horizontal-stack-card.ts","webpack:///./src/panels/lovelace/cards/hui-iframe-card.ts","webpack:///./src/panels/lovelace/cards/hui-legacy-wrapper-card.js","webpack:///./src/panels/lovelace/cards/hui-light-card.ts","webpack:///./src/panels/lovelace/cards/hui-map-card.ts","webpack:///./src/panels/lovelace/cards/hui-markdown-card.ts","webpack:///./src/panels/lovelace/cards/hui-media-control-card.js","webpack:///./src/panels/lovelace/cards/hui-picture-card.ts","webpack:///./src/panels/lovelace/cards/hui-picture-elements-card.ts","webpack:///./src/panels/lovelace/cards/hui-picture-entity-card.ts","webpack:///./src/panels/lovelace/cards/hui-picture-glance-card.ts","webpack:///./src/panels/lovelace/cards/hui-plant-status-card.ts","webpack:///./src/panels/lovelace/cards/hui-sensor-card.ts","webpack:///./src/panels/lovelace/cards/hui-shopping-list-card.ts","webpack:///./src/panels/lovelace/cards/hui-stack-card.ts","webpack:///./src/panels/lovelace/cards/hui-thermostat-card.ts","webpack:///./src/panels/lovelace/cards/hui-vertical-stack-card.ts","webpack:///./src/panels/lovelace/cards/hui-weather-forecast-card.js","webpack:///./src/panels/lovelace/cards/picture-elements/create-styled-hui-element.ts","webpack:///./src/panels/lovelace/common/call-service.ts","webpack:///./src/panels/lovelace/common/compute-card-size.ts","webpack:///./src/panels/lovelace/common/compute-notifications.ts","webpack:///./src/panels/lovelace/common/compute-tooltip.ts","webpack:///./src/panels/lovelace/common/create-card-element.ts","webpack:///./src/panels/lovelace/common/create-hui-element.ts","webpack:///./src/panels/lovelace/common/create-row-element.ts","webpack:///./src/panels/lovelace/common/directives/long-press-directive.ts","webpack:///./src/panels/lovelace/common/entity/toggle-entity.ts","webpack:///./src/panels/lovelace/common/entity/turn-on-off-entities.ts","webpack:///./src/panels/lovelace/common/entity/turn-on-off-entity.ts","webpack:///./src/panels/lovelace/common/generate-lovelace-config.ts","webpack:///./src/panels/lovelace/common/handle-click.ts","webpack:///./src/panels/lovelace/common/has-changed.ts","webpack:///./src/panels/lovelace/common/process-config-entities.ts","webpack:///./src/panels/lovelace/common/validate-condition.ts","webpack:///./src/panels/lovelace/components/hui-entities-toggle.ts","webpack:///./src/panels/lovelace/components/hui-generic-entity-row.ts","webpack:///./src/panels/lovelace/components/hui-image.ts","webpack:///./src/panels/lovelace/components/hui-timestamp-display.ts","webpack:///./src/panels/lovelace/components/hui-warning-element.ts","webpack:///./src/panels/lovelace/components/hui-warning.ts","webpack:///./src/panels/lovelace/components/notifications/hui-configurator-notification-item.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notification-drawer.js","webpack:///./src/panels/lovelace/components/notifications/hui-notification-item-template.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notification-item.ts","webpack:///./src/panels/lovelace/components/notifications/hui-notifications-button.ts","webpack:///./src/panels/lovelace/components/notifications/hui-persistent-notification-item.ts","webpack:///./src/panels/lovelace/editor/card-editor/show-edit-card-dialog.ts","webpack:///./src/panels/lovelace/editor/config-util.ts","webpack:///./src/panels/lovelace/editor/lovelace-editor/show-edit-lovelace-dialog.ts","webpack:///./src/panels/lovelace/editor/show-save-config-dialog.ts","webpack:///./src/panels/lovelace/editor/view-editor/show-edit-view-dialog.ts","webpack:///./src/panels/lovelace/elements/hui-conditional-element.ts","webpack:///./src/panels/lovelace/elements/hui-icon-element.ts","webpack:///./src/panels/lovelace/elements/hui-image-element.ts","webpack:///./src/panels/lovelace/elements/hui-service-button-element.ts","webpack:///./src/panels/lovelace/elements/hui-state-badge-element.ts","webpack:///./src/panels/lovelace/elements/hui-state-icon-element.ts","webpack:///./src/panels/lovelace/elements/hui-state-label-element.ts","webpack:///./src/panels/lovelace/entity-rows/hui-climate-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-cover-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-group-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-datetime-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-number-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-select-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-input-text-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-lock-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-media-player-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-scene-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-script-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-sensor-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-text-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-timer-entity-row.ts","webpack:///./src/panels/lovelace/entity-rows/hui-toggle-entity-row.ts","webpack:///./src/panels/lovelace/ha-panel-lovelace.ts","webpack:///./src/panels/lovelace/hui-root.ts","webpack:///./src/panels/lovelace/hui-view.ts","webpack:///./src/panels/lovelace/special-rows/hui-call-service-row.ts","webpack:///./src/panels/lovelace/special-rows/hui-divider-row.ts","webpack:///./src/panels/lovelace/special-rows/hui-section-row.ts","webpack:///./src/panels/lovelace/special-rows/hui-weblink-row.ts","webpack:///./src/panels/map/ha-entity-marker.js","webpack:///./src/resources/jquery.roundslider.ondemand.ts"],"names":["_load","tag","url","type","Promise","resolve","reject","element","document","createElement","attr","parent","onload","onerror","async","rel","appendChild","loadCSS","loadJS","loadImg","loadModule","scrollToTarget","target","top","scroller","easingFn","easeOutQuad","t","b","c","d","animationId","Math","random","duration","startTime","Date","now","currentScrollTop","scrollTop","deltaScrollTop","_currentAnimationId","updateFrame","elapsedTime","requestAnimationFrame","bind","call","setupLeafletMap","mapElement","parentNode","Error","Leaflet","Icon","Default","imagePath","map","style","setAttribute","setView","tileLayer","Browser","retina","attribution","subdomains","minZoom","maxZoom","addTo","validEntityId","entityId","test","compare","a","caseInsensitiveCompare","toLowerCase","debounce","func","wait","immediate","timeout","args","context","later","apply","callNow","clearTimeout","setTimeout","parseOrThrow","num","parsed","parseFloat","isNaN","parseAspectRatio","input","endsWith","w","h","substr","length","arr","replace","split","err","afterNextRender","cb","subscribeOne","conn","subscribe","unsub","items","HaCallServiceButton","EventsMixin","PolymerElement","template","html","properties","hass","Object","progress","Boolean","value","domain","String","service","serviceData","buttonTapped","el","eventData","callService","then","$","actionSuccess","success","actionError","fire","customElements","define","HaProgressButton","disabled","tempClass","className","classList","container","add","remove","ready","addEventListener","ev","stopPropagation","computeDisabled","HaDateInput","customElement","property","css","year","_formatYear","month","_formatMonth","day","_formatDay","yearElement","shadowRoot","getElementById","monthElement","slice","dayElement","LitElement","paperDropdownClass","get","HaPaperDropdownClass","window","getComputedStyle","direction","textAlign","paperIconButtonClass","HaPaperIconButtonArrowNext","connectedCallback","icon","HaPaperIconButtonNext","PaperTimeInput","label","autoValidate","hideLabel","format","Number","hour","notify","min","amPm","readOnly","computed","validate","valid","dropdown","_computeTime","undefined","_formatMin","toString","_shouldFormatHour","_computeHourMax","_equal","n1","n2","FORMAT_TEXT","FORMAT_NUMBER","callAlarmAction","entity","action","code","entity_id","createAreaRegistryEntry","values","callWS","updateAreaRegistryEntry","areaId","updates","area_id","deleteAreaRegistryEntry","fetchAreaRegistry","sendMessagePromise","areas","sort","ent1","ent2","name","subscribeAreaRegistryUpdates","store","subscribeEvents","setState","subscribeAreaRegistry","onChange","createCollection","updateDeviceRegistryEntry","deviceId","device_id","fetchDeviceRegistry","subscribeDeviceRegistryUpdates","devices","subscribeDeviceRegistry","UNAVAILABLE","ENTITY_COMPONENT_DOMAINS","computeEntityRegistryName","entry","state","states","computeStateName","updateEntityRegistryEntry","removeEntityRegistryEntry","fetchEntityRegistry","subscribeEntityRegistryUpdates","entities","subscribeEntityRegistry","setInputDateTimeValue","time","date","param","setValue","fetchConfig","force","saveConfig","config","subscribeLovelaceUpdates","fetchItems","updateItem","itemId","item","item_id","clearItems","addItem","fetchNotifications","subscribeUpdates","ntf","subscribeNotifications","ICONS","armed_away","armed_custom_bypass","armed_home","armed_night","disarmed","pending","triggered","BUTTONS","HuiAlarmPanelCard","_config","stateObj","attributes","code_format","defaults","_code","changedProps","has","oldHass","localize","_label","classMap","_stateIconLabel","_handleActionClick","_handlePadClick","stateLabel","pop","e","val","currentTarget","HuiConditionalCard","HTMLElement","setConfig","card","conditions","Array","isArray","validateConditionalConfig","_card","parentElement","removeChild","createCardElement","update","_hass","getCardSize","computeCardSize","visible","checkConditionsMet","setProperty","HuiEntitiesCard","querySelectorAll","forEach","entitiesToggle","querySelector","title","processConfigEntities","theme","_configEntities","changedProperties","applyThemesOnElement","themes","show_header_toggle","conf","entityConf","renderEntity","createRowElement","DOMAINS_HIDE_MORE_INFO","includes","computeDomain","_handleClick","fireEvent","HuiEntityButtonCard","tap_action","hold_action","show_icon","show_name","isValidEntityId","DOMAINS_TOGGLE","_handleTap","_handleHold","longPress","computeStateDomain","stateIcon","styleMap","filter","_computeBrightness","color","_computeColor","height","icon_height","brightness","hs_color","hue","sat","handleClick","EntityFilterCard","_element","state_filter","_baseCardConfig","lastChild","entitiesList","show_empty","display","_cardElement","tagName","isPanel","createErrorCardElement","createErrorCardConfig","error","origConfig","HuiErrorCard","_toStr","JSON","stringify","severityMap","red","green","yellow","normal","HuiGaugeCard","max","_setBaseUnit","_baseUnit","transform","_translateTurn","_computeSeverity","unit","unit_of_measurement","hasConfigOrEntityChanged","_updated","isConnected","baseUnit","_computeBaseUnit","numberValue","sections","severity","sectionsArray","keys","sortable","maxTurnValue","clientWidth","HuiGlanceCard","ceil","columns","requestUpdate","show_state","computeStateDisplay","language","HuiHistoryGraphCard","_names","_entities","_stateHistory","_stateHistoryLoading","_cacheConfig","push","setProperties","cacheKey","join","hoursToShow","hours_to_show","refresh","refresh_interval","HuiHorizontalStackCard","HuiStackCard","totalSize","_cards","elementSize","renderStyle","HuiIframeCard","aspect_ratio","aspectRatio","LegacyWrapperCard","constructor","_tag","toUpperCase","_domain","_ensureElement","lightConfig","radius","step","circleShape","startAngle","width","sliderType","lineCap","handleSize","showTooltip","animation","HuiLightCard","_handleMoreInfo","loaded","loadRoundslider","_roundSliderStyle","roundSliderStyle","_jQuery","jQuery","roundSlider","change","_setBrightness","drag","_dragEvent","start","_showBrightness","stop","_hideBrightness","innerHTML","round","attrs","_brightnessTimout","brightness_pct","toggleEntity","HuiMapCard","reflect","_leafletMap","invalidateSize","geo_location_sources","ratio","ar","toFixed","floor","_connected","hasUpdated","loadMap","_attachObserver","_resizeObserver","unobserve","_mapEl","removeEventListener","_debouncedResizeListener","_fitMap","root","paddingBottom","_drawEntities","zoom","default_zoom","_mapItems","LatLng","latitude","longitude","bounds","latLngBounds","getLatLng","fitBounds","pad","getZoom","setZoom","marker","mapItems","allEntities","concat","includesAll","source","passive","entity_picture","entityPicture","gps_accuracy","gpsAccuracy","divIcon","iconSize","interactive","circle","entityName","part","addLayer","ResizeObserver","observe","HuiMarkdownCard","content","HuiMediaControlCard","getConfigElement","getStubConfig","HuiPictureCard","image","clickable","HuiPictureElementsCard","camera_image","state_image","elements","camera_view","elementConfig","createStyledHuiElement","HuiPictureEntityCard","footer","STATES_OFF","Set","HuiPictureGlanceCard","_entitiesDialog","_entitiesToggle","force_dialog","dialog","_openDialog","_callService","SENSORS","moisture","temperature","conductivity","battery","HuiPlantStatusCard","computeAttributes","computeIcon","problem","indexOf","unit_of_measurement_dict","key","batLvl","sensors","midPoint","_Ax","_Ay","_Bx","_By","_Zx","_Zy","getPath","coords","next","Z","X","Y","path","last","coord","calcPoints","history","hours","detail","margin","yRatio","xRatio","isFinite","getCoords","i","offset","depth","subItem","index","average","reduce","sum","x","y","coordinates","getTime","res","point","age","last_changed","abs","HuiSensorCard","cardConfig","graph","_history","svg","_date","minute","_getHistory","endTime","setHours","getHours","stateHistory","fetchRecent","HuiShoppingListCard","_uncheckedItems","_checkedItems","_fetchData","_unsubEvents","connection","_addItem","_addKeyPress","repeat","id","complete","_completeItem","_saveEdit","_clearItems","checkedItems","uncheckedItems","checked","catch","blur","newItem","_newItem","focus","keyCode","cards","_createCardElement","render","_rebuildCard","once","cardElToReplace","newCardEl","replaceChild","curCardEl","thermostatConfig","modeIcons","auto","manual","heat","cool","off","fan_only","eco","dry","idle","HuiThermostatCard","_loaded","_initialLoad","mode","operation_mode","large","_broadCard","small","current_temperature","unit_system","operation_list","modeItem","_renderIcon","sliderValue","uiValue","_genSliderValue","_updateSetTemp","target_temp_step","UNIT_F","updateComplete","_sliderType","target_temp_low","target_temp_high","min_temp","max_temp","_setTemperature","_stepSize","formatTemp","handle","currentMode","_handleModeClick","temps","spaceStepSize","stepSize","HuiVerticalStackCard","HuiWeatherForecastCard","createHuiElement","prop","service_data","computeNotifications","computeTooltip","stateName","tooltip","tapTooltip","computeActionTooltip","holdTooltip","newline","isHold","navigation_path","CARD_TYPES","CUSTOM_TYPE_PREFIX","TIMEOUT","_createElement","deepClone","console","_createErrorElement","message","startsWith","timer","whenDefined","ELEMENT_TYPES","_hideErrorElement","SPECIAL_TYPES","DOMAIN_TO_ELEMENT_TYPE","alert","automation","climate","cover","fan","group","input_boolean","input_number","input_select","input_text","light","lock","media_player","remote","scene","script","sensor","switch","vacuum","water_heater","input_datetime","isTouch","navigator","maxTouchPoints","msMaxTouchPoints","LongPress","holdTime","ripple","held","cooldownStart","cooldownEnd","assign","borderRadius","position","pointerEvents","stopAnimation","event","preventDefault","cancelBubble","returnValue","clickStart","touches","pageX","pageY","startAnimation","clickEnd","dispatchEvent","Event","left","holdDown","simulatedRipple","getLongPress","body","longpress","longPressBind","directive","committer","turnOn","turnOnOffEntity","turnOnOffEntities","entityIds","domainsToCall","stateDomain","serviceDomain","DEFAULT_VIEW_ENTITY_ID","DOMAINS_BADGES","HIDE_DOMAIN","subscribedRegistries","splitByAreas","registries","areasWithEntities","area","areaEntities","areaDevices","device","otherEntities","computeCards","entityCardOptions","friendly_name","unshift","computeDefaultViewStates","hidden","generateDefaultViewConfig","groupOrders","order","splittedByAreas","generateViewConfig","areaCards","splitted","splitByGroups","groups","gr1","gr2","badgeEntities","ungroupedEntitites","ungrouped","coll","badges","groupEntity","control","view","generateLovelaceConfig","viewEntities","extractViews","views","viewEntity","getViewEntities","idx","computeObjectId","location_name","all","components","__DEMO__","node","hold","actionConfig","navigate","every","state_not","HuiEntitiesToggle","_toggleEntities","some","forwardHaptic","HuiGenericEntityRow","showSecondary","secondary_info","toggleAttribute","computeRTL","UPDATE_INTERVAL","DEFAULT_FILTER","HuiImage","query","_attached","cameraImage","cameraView","_startUpdateCameraInterval","_stopUpdateCameraInterval","imageSrc","cameraObj","imageFallback","stateImage","_cameraImageSrc","stateFilter","isOff","_onImageError","_onImageLoad","_loadError","_lastImageHeight","_updateCameraImageSrc","_cameraUpdater","setInterval","clearInterval","_image","offsetHeight","cameraState","fetchThumbnailUrlWithCache","FORMATS","format_date","datetime","format_date_time","format_time","INTERVAL_FORMAT","HuiTimestampDisplay","_startInterval","_clearInterval","ts","_format","_relative","_updateRelative","_interval","relativeTime","compareTime","includeTense","HuiWarningElement","HuiWarning","HuiConfiguratorNotificationItem","notification","HuiNotificationDrawer","LocalizeMixin","narrow","reflectToAttribute","open","observer","notifications","rtl","_closeDrawer","_empty","_openChanged","_openTimer","_computeRTL","HuiNotificationItemTemplate","HuiNotificationItem","HuiNotificationsButton","_clicked","opened","HuiPersistentNotificationItem","_computeTitle","created_at","_computeTooltip","_handleDismiss","notification_id","toLocaleDateString","registeredDialog","dialogShowEvent","dialogTag","registerEditCardDialog","dialogImport","showEditCardDialog","editCardDialogParams","addCard","viewIndex","viewConf","replaceCard","cardIndex","origConf","ind","deleteCard","_origConf","swapCard","path1","path2","card1","card2","origView1","newView1","origCard","origView2","newView2","origView","moveCard","fromPath","toPath","fromView","toView","addView","viewConfig","replaceView","swapView","view1","view2","deleteView","_origView","registerEditLovelaceDialog","showEditLovelaceDialog","lovelace","showSaveDialog","saveDialogParams","registerEditViewDialog","showEditViewDialog","editViewDialogParams","HuiConditionalElement","_elements","updateElements","HuiIconElement","HuiImageElement","toggle","HuiServiceButtonElement","_service","HuiStateBadgeElement","HuiStateIconElement","HuiStateLabelElement","prefix","suffix","HuiClimateEntityRow","HuiCoverEntityRow","isTiltOnly","HuiGroupEntityRow","_computeCanToggle","HuiInputDatetimeEntityRow","has_date","_selectedValueChanged","_stopEventPropagation","has_time","_timeInputEl","trim","_dateInputEl","HuiInputNumberEntityRow","computeRTLDirection","_inputElement","HuiInputSelectEntityRow","_selectedChanged","options","option","selected","selectedItem","innerText","setInputSelectOption","HuiInputTextEntityRow","pattern","_inputEl","HuiLockEntityRow","HuiMediaPlayerEntityRow","OFF_STATES","supportsFeature","SUPPORTS_PLAY","_computeControlIcon","_playPause","SUPPORT_NEXT_TRACK","_nextTrack","_computeMediaTitle","SUPPORT_PAUSE","media_content_type","media_artist","media_title","media_series_title","app_name","HuiSceneEntityRow","can_cancel","HuiScriptEntityRow","HuiSensorEntityRow","device_class","HuiTextEntityRow","HuiTimerEntityRow","_computeDisplay","oldStateObj","_calculateRemaining","_timeRemaining","timerTimeRemaining","secondsToDuration","HuiToggleEntityRow","editorLoaded","LovelacePanel","_closeEditor","_state","route","_columns","_forceFetchConfig","_errorMsg","_updateColumns","dockedSidebar","_fetchConfig","_lovelaceChanged","mqls","mql","matchMedia","addListener","_setLovelaceConfig","_regenerateConfig","matchColumns","cols","matches","_saving","showToast","text","dismissable","forceDiskRefresh","confMode","panel","log","editMode","enableFullEditMode","setEditMode","_updateLovelace","newConfig","previousConfig","previousMode","props","CSS_CACHE","JS_CACHE","loadedUnusedEntities","HUIRoot","_debouncedConfigChanged","_selectView","_curView","_unsubNotifications","_persistentNotifications","_routeData","_routeDataChanged","_notifications","_notificationsOpen","_handleNotificationsOpenChanged","_editMode","_editModeDisable","_editLovelace","_handleHelp","_deselect","_yamlMode","_handleRefresh","_handleUnusedEntities","_editModeEnable","_handleViewSelected","_moveViewLeft","_editView","_moveViewRight","_addView","haStyle","_viewRoot","huiView","newSelectView","selectedView","selectedViewInt","parseInt","oldLovelace","_loadResources","resources","_updateNotifications","persistent","configurator","oldIndex","newIndex","_layout","header","scrollTarget","_viewCache","unusedEntities","background","resource","importHref","warn","editCodeLoaded","getColumnIndex","columnEntityCount","size","minIndex","HUIView","_badges","renderStyles","_addCard","editModeChanged","configChanged","_createBadges","badge","_createCards","elementsToAppend","wrapper","cardSize","column","columnEl","HuiCallServiceRow","action_name","HuiDividerRow","HuiSectionRow","HuiWeblinkRow","HaEntityMarker","badgeTap"],"mappings":"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","file":"panel-lovelace.chunk.js","sourcesContent":["// Load a resource and get a promise when loading done.\n// From: https://davidwalsh.name/javascript-loader\n\nconst _load = (\n  tag: \"link\" | \"script\" | \"img\",\n  url: string,\n  type?: \"module\"\n) => {\n  // This promise will be used by Promise.all to determine success or failure\n  return new Promise((resolve, reject) => {\n    const element = document.createElement(tag);\n    let attr = \"src\";\n    let parent = \"body\";\n\n    // Important success and error for the promise\n    element.onload = () => resolve(url);\n    element.onerror = () => reject(url);\n\n    // Need to set different attributes depending on tag type\n    switch (tag) {\n      case \"script\":\n        (element as HTMLScriptElement).async = true;\n        if (type) {\n          (element as HTMLScriptElement).type = type;\n        }\n        break;\n      case \"link\":\n        (element as HTMLLinkElement).type = \"text/css\";\n        (element as HTMLLinkElement).rel = \"stylesheet\";\n        attr = \"href\";\n        parent = \"head\";\n    }\n\n    // Inject into document to kick off loading\n    element[attr] = url;\n    document[parent].appendChild(element);\n  });\n};\n\nexport const loadCSS = (url: string) => _load(\"link\", url);\nexport const loadJS = (url: string) => _load(\"script\", url);\nexport const loadImg = (url: string) => _load(\"img\", url);\nexport const loadModule = (url: string) => _load(\"script\", url, \"module\");\n","/**\n * Scroll to a specific y coordinate.\n *\n * Copied from paper-scroll-header-panel.\n *\n * @method scroll\n * @param {number} top The coordinate to scroll to, along the y-axis.\n * @param {boolean} smooth true if the scroll position should be smoothly adjusted.\n */\nexport default function scrollToTarget(element, target) {\n  // the scroll event will trigger _updateScrollState directly,\n  // However, _updateScrollState relies on the previous `scrollTop` to update the states.\n  // Calling _updateScrollState will ensure that the states are synced correctly.\n  const top = 0;\n  const scroller = target;\n  const easingFn = function easeOutQuad(t, b, c, d) {\n    /* eslint-disable no-param-reassign, space-infix-ops, no-mixed-operators */\n    t /= d;\n    return -c * t * (t - 2) + b;\n    /* eslint-enable no-param-reassign, space-infix-ops, no-mixed-operators */\n  };\n  const animationId = Math.random();\n  const duration = 200;\n  const startTime = Date.now();\n  const currentScrollTop = scroller.scrollTop;\n  const deltaScrollTop = top - currentScrollTop;\n  element._currentAnimationId = animationId;\n  (function updateFrame() {\n    const now = Date.now();\n    const elapsedTime = now - startTime;\n    if (elapsedTime > duration) {\n      scroller.scrollTop = top;\n    } else if (element._currentAnimationId === animationId) {\n      scroller.scrollTop = easingFn(\n        elapsedTime,\n        currentScrollTop,\n        deltaScrollTop,\n        duration\n      );\n      requestAnimationFrame(updateFrame.bind(element));\n    }\n  }.call(element));\n}\n","import { Map } from \"leaflet\";\n\n// Sets up a Leaflet map on the provided DOM element\nexport type LeafletModuleType = typeof import(\"leaflet\");\n\nexport const setupLeafletMap = async (\n  mapElement: HTMLElement\n): Promise<[Map, LeafletModuleType]> => {\n  if (!mapElement.parentNode) {\n    throw new Error(\"Cannot setup Leaflet map on disconnected element\");\n  }\n  // tslint:disable-next-line\n  const Leaflet = (await import(/* webpackChunkName: \"leaflet\" */ \"leaflet\")) as LeafletModuleType;\n  Leaflet.Icon.Default.imagePath = \"/static/images/leaflet/images/\";\n\n  const map = Leaflet.map(mapElement);\n  const style = document.createElement(\"link\");\n  style.setAttribute(\"href\", \"/static/images/leaflet/leaflet.css\");\n  style.setAttribute(\"rel\", \"stylesheet\");\n  mapElement.parentNode.appendChild(style);\n  map.setView([52.3731339, 4.8903147], 13);\n  Leaflet.tileLayer(\n    `https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}${\n      Leaflet.Browser.retina ? \"@2x.png\" : \".png\"\n    }`,\n    {\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>, &copy; <a href=\"https://carto.com/attributions\">CARTO</a>',\n      subdomains: \"abcd\",\n      minZoom: 0,\n      maxZoom: 20,\n    }\n  ).addTo(map);\n\n  return [map, Leaflet];\n};\n","const validEntityId = /^(\\w+)\\.(\\w+)$/;\nexport default (entityId: string) => validEntityId.test(entityId);\n","export const compare = (a: string, b: string) => {\n  if (a < b) {\n    return -1;\n  }\n  if (a > b) {\n    return 1;\n  }\n\n  return 0;\n};\n\nexport const caseInsensitiveCompare = (a: string, b: string) =>\n  compare(a.toLowerCase(), b.toLowerCase());\n","// From: https://davidwalsh.name/javascript-debounce-function\n\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// tslint:disable-next-line: ban-types\nexport const debounce = <T extends Function>(\n  func: T,\n  wait,\n  immediate = false\n): T => {\n  let timeout;\n  // @ts-ignore\n  return function(...args) {\n    // tslint:disable:no-this-assignment\n    // @ts-ignore\n    const context = this;\n    const later = () => {\n      timeout = null;\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n};\n","// Handle 16x9, 16:9, 1.78x1, 1.78:1, 1.78\n// Ignore everything else\nconst parseOrThrow = (num) => {\n  const parsed = parseFloat(num);\n  if (isNaN(parsed)) {\n    throw new Error(`${num} is not a number`);\n  }\n  return parsed;\n};\n\nexport default function parseAspectRatio(input: string) {\n  if (!input) {\n    return null;\n  }\n  try {\n    if (input.endsWith(\"%\")) {\n      return { w: 100, h: parseOrThrow(input.substr(0, input.length - 1)) };\n    }\n\n    const arr = input.replace(\":\", \"x\").split(\"x\");\n    if (arr.length === 0) {\n      return null;\n    }\n\n    return arr.length === 1\n      ? { w: parseOrThrow(arr[0]), h: 1 }\n      : { w: parseOrThrow(arr[0]), h: parseOrThrow(arr[1]) };\n  } catch (err) {\n    // Ignore the error\n  }\n  return null;\n}\n","export const afterNextRender = (cb: () => void): void => {\n  requestAnimationFrame(() => setTimeout(cb, 0));\n};\n","import { UnsubscribeFunc, Connection } from \"home-assistant-js-websocket\";\n\nexport const subscribeOne = async <T>(\n  conn: Connection,\n  subscribe: (conn: Connection, onChange: (items: T) => void) => UnsubscribeFunc\n) =>\n  new Promise<T>((resolve) => {\n    const unsub = subscribe(conn, (items) => {\n      unsub();\n      resolve(items);\n    });\n  });\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"./ha-progress-button\";\nimport { EventsMixin } from \"../../mixins/events-mixin\";\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaCallServiceButton extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <ha-progress-button\n        id=\"progress\"\n        progress=\"[[progress]]\"\n        on-click=\"buttonTapped\"\n        ><slot></slot\n      ></ha-progress-button>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      progress: {\n        type: Boolean,\n        value: false,\n      },\n\n      domain: {\n        type: String,\n      },\n\n      service: {\n        type: String,\n      },\n\n      serviceData: {\n        type: Object,\n        value: {},\n      },\n    };\n  }\n\n  buttonTapped() {\n    this.progress = true;\n    var el = this;\n    var eventData = {\n      domain: this.domain,\n      service: this.service,\n      serviceData: this.serviceData,\n    };\n\n    this.hass\n      .callService(this.domain, this.service, this.serviceData)\n      .then(\n        function() {\n          el.progress = false;\n          el.$.progress.actionSuccess();\n          eventData.success = true;\n        },\n        function() {\n          el.progress = false;\n          el.$.progress.actionError();\n          eventData.success = false;\n        }\n      )\n      .then(function() {\n        el.fire(\"hass-service-called\", eventData);\n      });\n  }\n}\n\ncustomElements.define(\"ha-call-service-button\", HaCallServiceButton);\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-spinner/paper-spinner\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nclass HaProgressButton extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        .container {\n          position: relative;\n          display: inline-block;\n        }\n\n        mwc-button {\n          transition: all 1s;\n        }\n\n        .success mwc-button {\n          --mdc-theme-primary: white;\n          background-color: var(--google-green-500);\n          transition: none;\n        }\n\n        .error mwc-button {\n          --mdc-theme-primary: white;\n          background-color: var(--google-red-500);\n          transition: none;\n        }\n\n        .progress {\n          @apply --layout;\n          @apply --layout-center-center;\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n        }\n      </style>\n      <div class=\"container\" id=\"container\">\n        <mwc-button\n          id=\"button\"\n          disabled=\"[[computeDisabled(disabled, progress)]]\"\n          on-click=\"buttonTapped\"\n        >\n          <slot></slot>\n        </mwc-button>\n        <template is=\"dom-if\" if=\"[[progress]]\">\n          <div class=\"progress\"><paper-spinner active=\"\"></paper-spinner></div>\n        </template>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      progress: {\n        type: Boolean,\n        value: false,\n      },\n\n      disabled: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  tempClass(className) {\n    var classList = this.$.container.classList;\n    classList.add(className);\n    setTimeout(() => {\n      classList.remove(className);\n    }, 1000);\n  }\n\n  ready() {\n    super.ready();\n    this.addEventListener(\"click\", (ev) => this.buttonTapped(ev));\n  }\n\n  buttonTapped(ev) {\n    if (this.progress) ev.stopPropagation();\n  }\n\n  actionSuccess() {\n    this.tempClass(\"success\");\n  }\n\n  actionError() {\n    this.tempClass(\"error\");\n  }\n\n  computeDisabled(disabled, progress) {\n    return disabled || progress;\n  }\n}\n\ncustomElements.define(\"ha-progress-button\", HaProgressButton);\n","import {\n  html,\n  css,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n} from \"lit-element\";\n\nimport \"@polymer/paper-input/paper-input\";\n// tslint:disable-next-line:no-duplicate-imports\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\n\n@customElement(\"ha-date-input\")\nexport class HaDateInput extends LitElement {\n  @property() public year?: string;\n  @property() public month?: string;\n  @property() public day?: string;\n  @property({ type: Boolean }) public disabled = false;\n\n  static get styles() {\n    return css`\n      :host {\n        display: block;\n        font-family: var(--paper-font-common-base_-_font-family);\n        -webkit-font-smoothing: var(\n          --paper-font-common-base_-_-webkit-font-smoothing\n        );\n      }\n\n      paper-input {\n        width: 30px;\n        text-align: center;\n        --paper-input-container-shared-input-style_-_-webkit-appearance: textfield;\n        --paper-input-container-input_-_-moz-appearance: textfield;\n        --paper-input-container-shared-input-style_-_appearance: textfield;\n        --paper-input-container-input-webkit-spinner_-_-webkit-appearance: none;\n        --paper-input-container-input-webkit-spinner_-_margin: 0;\n        --paper-input-container-input-webkit-spinner_-_display: none;\n      }\n\n      paper-input#year {\n        width: 50px;\n      }\n\n      .date-input-wrap {\n        display: flex;\n        flex-direction: row;\n      }\n    `;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      <div class=\"date-input-wrap\">\n        <paper-input\n          id=\"year\"\n          type=\"number\"\n          .value=${this.year}\n          @change=${this._formatYear}\n          maxlength=\"4\"\n          max=\"9999\"\n          min=\"0\"\n          .disabled=${this.disabled}\n          no-label-float\n        >\n          <span suffix=\"\" slot=\"suffix\">-</span>\n        </paper-input>\n        <paper-input\n          id=\"month\"\n          type=\"number\"\n          .value=${this.month}\n          @change=${this._formatMonth}\n          maxlength=\"2\"\n          max=\"12\"\n          min=\"1\"\n          .disabled=${this.disabled}\n          no-label-float\n        >\n          <span suffix=\"\" slot=\"suffix\">-</span>\n        </paper-input>\n        <paper-input\n          id=\"day\"\n          type=\"number\"\n          .value=${this.day}\n          @change=${this._formatDay}\n          maxlength=\"2\"\n          max=\"31\"\n          min=\"1\"\n          .disabled=${this.disabled}\n          no-label-float\n        >\n        </paper-input>\n      </div>\n    `;\n  }\n\n  private _formatYear() {\n    const yearElement = this.shadowRoot!.getElementById(\n      \"year\"\n    ) as PaperInputElement;\n    this.year = yearElement.value!;\n  }\n\n  private _formatMonth() {\n    const monthElement = this.shadowRoot!.getElementById(\n      \"month\"\n    ) as PaperInputElement;\n    this.month = (\"0\" + monthElement.value!).slice(-2);\n  }\n\n  private _formatDay() {\n    const dayElement = this.shadowRoot!.getElementById(\n      \"day\"\n    ) as PaperInputElement;\n    this.day = (\"0\" + dayElement.value!).slice(-2);\n  }\n\n  get value() {\n    return `${this.year}-${this.month}-${this.day}`;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-date-input\": HaDateInput;\n  }\n}\n","import \"@polymer/paper-dropdown-menu/paper-dropdown-menu\";\nimport { Constructor } from \"lit-element\";\nimport { PolymerElement } from \"@polymer/polymer\";\n\nconst paperDropdownClass = customElements.get(\n  \"paper-dropdown-menu\"\n) as Constructor<PolymerElement>;\n\n// patches paper drop down to properly support RTL - https://github.com/PolymerElements/paper-dropdown-menu/issues/183\nexport class HaPaperDropdownClass extends paperDropdownClass {\n  public ready() {\n    super.ready();\n    // wait to check for direction since otherwise direction is wrong even though top level is RTL\n    setTimeout(() => {\n      if (window.getComputedStyle(this).direction === \"rtl\") {\n        this.style.textAlign = \"right\";\n      }\n    }, 100);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-dropdown-menu\": HaPaperDropdownClass;\n  }\n}\n\ncustomElements.define(\"ha-paper-dropdown-menu\", HaPaperDropdownClass);\n","import { Constructor } from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { PaperIconButtonElement } from \"@polymer/paper-icon-button/paper-icon-button\";\n\nconst paperIconButtonClass = customElements.get(\n  \"paper-icon-button\"\n) as Constructor<PaperIconButtonElement>;\n\nexport class HaPaperIconButtonArrowNext extends paperIconButtonClass {\n  public connectedCallback() {\n    this.icon =\n      window.getComputedStyle(this).direction === \"ltr\"\n        ? \"hass:arrow-right\"\n        : \"hass:arrow-left\";\n\n    // calling super after setting icon to have it consistently show the icon (otherwise not always shown)\n    super.connectedCallback();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-icon-button-arrow-next\": HaPaperIconButtonArrowNext;\n  }\n}\n\ncustomElements.define(\n  \"ha-paper-icon-button-arrow-next\",\n  HaPaperIconButtonArrowNext\n);\n","import { Constructor } from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { PaperIconButtonElement } from \"@polymer/paper-icon-button/paper-icon-button\";\n\nconst paperIconButtonClass = customElements.get(\n  \"paper-icon-button\"\n) as Constructor<PaperIconButtonElement>;\n\nexport class HaPaperIconButtonNext extends paperIconButtonClass {\n  public connectedCallback() {\n    this.icon =\n      window.getComputedStyle(this).direction === \"ltr\"\n        ? \"hass:chevron-right\"\n        : \"hass:chevron-left\";\n\n    // calling super after setting icon to have it consistently show the icon (otherwise not always shown)\n    super.connectedCallback();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-icon-button-next\": HaPaperIconButtonNext;\n  }\n}\n\ncustomElements.define(\"ha-paper-icon-button-next\", HaPaperIconButtonNext);\n","/**\nAdapted from paper-time-input from\nhttps://github.com/ryanburns23/paper-time-input\nMIT Licensed. Copyright (c) 2017 Ryan Burns\n\n`<paper-time-input>` Polymer element to accept a time with paper-input & paper-dropdown-menu\nInspired by the time input in google forms\n\n### Styling\n\n`<paper-time-input>` provides the following custom properties and mixins for styling:\n\nCustom property | Description | Default\n----------------|-------------|----------\n`--paper-time-input-dropdown-ripple-color` | dropdown ripple color | `--primary-color`\n`--paper-time-input-cotnainer` | Mixin applied to the inputs | `{}`\n`--paper-time-dropdown-input-cotnainer` | Mixin applied to the dropdown input | `{}`\n*/\nimport \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-listbox/paper-listbox\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-dropdown-menu/paper-dropdown-menu\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nexport class PaperTimeInput extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        :host {\n          display: block;\n          @apply --paper-font-common-base;\n        }\n\n        paper-input {\n          width: 30px;\n          text-align: center;\n          --paper-input-container-input: {\n            /* Damn you firefox\n             * Needed to hide spin num in firefox\n             * http://stackoverflow.com/questions/3790935/can-i-hide-the-html5-number-input-s-spin-box\n             */\n            -moz-appearance: textfield;\n            @apply --paper-time-input-cotnainer;\n          }\n          --paper-input-container-input-webkit-spinner: {\n            -webkit-appearance: none;\n            margin: 0;\n            display: none;\n          }\n          --paper-input-container-shared-input-style_-_-webkit-appearance: textfield;\n        }\n\n        paper-dropdown-menu {\n          width: 55px;\n          padding: 0;\n          /* Force ripple to use the whole container */\n          --paper-dropdown-menu-ripple: {\n            color: var(\n              --paper-time-input-dropdown-ripple-color,\n              var(--primary-color)\n            );\n          }\n          --paper-input-container-input: {\n            @apply --paper-font-button;\n            text-align: center;\n            padding-left: 5px;\n            @apply --paper-time-dropdown-input-cotnainer;\n          }\n          --paper-input-container-underline: {\n            border-color: transparent;\n          }\n          --paper-input-container-underline-focus: {\n            border-color: transparent;\n          }\n        }\n\n        paper-item {\n          cursor: pointer;\n          text-align: center;\n          font-size: 14px;\n        }\n\n        paper-listbox {\n          padding: 0;\n        }\n\n        label {\n          @apply --paper-font-caption;\n        }\n\n        .time-input-wrap {\n          @apply --layout-horizontal;\n          @apply --layout-no-wrap;\n        }\n\n        [hidden] {\n          display: none !important;\n        }\n      </style>\n\n      <label hidden$=\"[[hideLabel]]\">[[label]]</label>\n      <div class=\"time-input-wrap\">\n        <!-- Hour Input -->\n        <paper-input\n          id=\"hour\"\n          type=\"number\"\n          value=\"{{hour}}\"\n          on-change=\"_shouldFormatHour\"\n          required=\"\"\n          auto-validate=\"[[autoValidate]]\"\n          prevent-invalid-input=\"\"\n          maxlength=\"2\"\n          max=\"[[_computeHourMax(format)]]\"\n          min=\"0\"\n          no-label-float=\"\"\n          disabled=\"[[disabled]]\"\n        >\n          <span suffix=\"\" slot=\"suffix\">:</span>\n        </paper-input>\n\n        <!-- Min Input -->\n        <paper-input\n          id=\"min\"\n          type=\"number\"\n          value=\"{{min}}\"\n          on-change=\"_formatMin\"\n          required=\"\"\n          auto-validate=\"[[autoValidate]]\"\n          prevent-invalid-input=\"\"\n          maxlength=\"2\"\n          max=\"59\"\n          min=\"0\"\n          no-label-float=\"\"\n          disabled=\"[[disabled]]\"\n        >\n        </paper-input>\n\n        <!-- Dropdown Menu -->\n        <paper-dropdown-menu\n          id=\"dropdown\"\n          required=\"\"\n          hidden$=\"[[_equal(format, 24)]]\"\n          no-label-float=\"\"\n          disabled=\"[[disabled]]\"\n        >\n          <paper-listbox\n            attr-for-selected=\"name\"\n            selected=\"{{amPm}}\"\n            slot=\"dropdown-content\"\n          >\n            <paper-item name=\"AM\">AM</paper-item>\n            <paper-item name=\"PM\">PM</paper-item>\n          </paper-listbox>\n        </paper-dropdown-menu>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      /**\n       * Label for the input\n       */\n      label: {\n        type: String,\n        value: \"Time\",\n      },\n      /**\n       * auto validate time inputs\n       */\n      autoValidate: {\n        type: Boolean,\n        value: true,\n      },\n      /**\n       * hides the label\n       */\n      hideLabel: {\n        type: Boolean,\n        value: false,\n      },\n      /**\n       * 12 or 24 hr format\n       */\n      format: {\n        type: Number,\n        value: 12,\n      },\n      /**\n       * disables the inputs\n       */\n      disabled: {\n        type: Boolean,\n        value: false,\n      },\n      /**\n       * hour\n       */\n      hour: {\n        type: String,\n        notify: true,\n      },\n      /**\n       * minute\n       */\n      min: {\n        type: String,\n        notify: true,\n      },\n      /**\n       * AM or PM\n       */\n      amPm: {\n        type: String,\n        notify: true,\n        value: \"AM\",\n      },\n      /**\n       * Formatted time string\n       */\n      value: {\n        type: String,\n        notify: true,\n        readOnly: true,\n        computed: \"_computeTime(min, hour, amPm)\",\n      },\n    };\n  }\n\n  /**\n   * Validate the inputs\n   * @return {boolean}\n   */\n  validate() {\n    var valid = true;\n    // Validate hour & min fields\n    if (!this.$.hour.validate() | !this.$.min.validate()) {\n      valid = false;\n    }\n    // Validate AM PM if 12 hour time\n    if (this.format === 12 && !this.$.dropdown.validate()) {\n      valid = false;\n    }\n    return valid;\n  }\n\n  /**\n   * Create time string\n   */\n  _computeTime(min, hour, amPm) {\n    if (hour && min) {\n      // No ampm on 24 hr time\n      if (this.format === 24) {\n        amPm = \"\";\n      }\n      return hour + \":\" + min + \" \" + amPm;\n    }\n    return undefined;\n  }\n\n  /**\n   * Format min\n   */\n  _formatMin() {\n    if (this.min.toString().length === 1) {\n      this.min = this.min < 10 ? \"0\" + this.min : this.min;\n    }\n  }\n\n  /**\n   * Hour needs a leading zero in 24hr format\n   */\n  _shouldFormatHour() {\n    if (this.format === 24 && this.hour.toString().length === 1) {\n      this.hour = this.hour < 10 ? \"0\" + this.hour : this.hour;\n    }\n  }\n\n  /**\n   * 24 hour format has a max hr of 23\n   */\n  _computeHourMax(format) {\n    if (format === 12) {\n      return format;\n    }\n    return 23;\n  }\n\n  _equal(n1, n2) {\n    return n1 === n2;\n  }\n}\n\ncustomElements.define(\"paper-time-input\", PaperTimeInput);\n","import { HomeAssistant } from \"../types\";\n\nexport const FORMAT_TEXT = \"text\";\nexport const FORMAT_NUMBER = \"number\";\n\nexport const callAlarmAction = (\n  hass: HomeAssistant,\n  entity: string,\n  action:\n    | \"arm_away\"\n    | \"arm_home\"\n    | \"arm_night\"\n    | \"arm_custom_bypass\"\n    | \"disarm\",\n  code: string\n) => {\n  hass!.callService(\"alarm_control_panel\", \"alarm_\" + action, {\n    entity_id: entity,\n    code,\n  });\n};\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { HomeAssistant } from \"../types\";\nimport { compare } from \"../common/string/compare\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport interface AreaRegistryEntry {\n  area_id: string;\n  name: string;\n}\n\nexport interface AreaRegistryEntryMutableParams {\n  name: string;\n}\n\nexport const createAreaRegistryEntry = (\n  hass: HomeAssistant,\n  values: AreaRegistryEntryMutableParams\n) =>\n  hass.callWS<AreaRegistryEntry>({\n    type: \"config/area_registry/create\",\n    ...values,\n  });\n\nexport const updateAreaRegistryEntry = (\n  hass: HomeAssistant,\n  areaId: string,\n  updates: Partial<AreaRegistryEntryMutableParams>\n) =>\n  hass.callWS<AreaRegistryEntry>({\n    type: \"config/area_registry/update\",\n    area_id: areaId,\n    ...updates,\n  });\n\nexport const deleteAreaRegistryEntry = (hass: HomeAssistant, areaId: string) =>\n  hass.callWS({\n    type: \"config/area_registry/delete\",\n    area_id: areaId,\n  });\n\nconst fetchAreaRegistry = (conn) =>\n  conn\n    .sendMessagePromise({\n      type: \"config/area_registry/list\",\n    })\n    .then((areas) => areas.sort((ent1, ent2) => compare(ent1.name, ent2.name)));\n\nconst subscribeAreaRegistryUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchAreaRegistry(conn).then((areas) => store.setState(areas, true)),\n      500,\n      true\n    ),\n    \"area_registry_updated\"\n  );\n\nexport const subscribeAreaRegistry = (\n  conn: Connection,\n  onChange: (areas: AreaRegistryEntry[]) => void\n) =>\n  createCollection<AreaRegistryEntry[]>(\n    \"_areaRegistry\",\n    fetchAreaRegistry,\n    subscribeAreaRegistryUpdates,\n    conn,\n    onChange\n  );\n","import { HomeAssistant } from \"../types\";\nimport { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport interface DeviceRegistryEntry {\n  id: string;\n  config_entries: string[];\n  connections: Array<[string, string]>;\n  manufacturer: string;\n  model?: string;\n  name?: string;\n  sw_version?: string;\n  hub_device_id?: string;\n  area_id?: string;\n  name_by_user?: string;\n}\n\nexport interface DeviceRegistryEntryMutableParams {\n  area_id?: string | null;\n  name_by_user?: string | null;\n}\n\nexport const updateDeviceRegistryEntry = (\n  hass: HomeAssistant,\n  deviceId: string,\n  updates: Partial<DeviceRegistryEntryMutableParams>\n) =>\n  hass.callWS<DeviceRegistryEntry>({\n    type: \"config/device_registry/update\",\n    device_id: deviceId,\n    ...updates,\n  });\n\nconst fetchDeviceRegistry = (conn) =>\n  conn.sendMessagePromise({\n    type: \"config/device_registry/list\",\n  });\n\nconst subscribeDeviceRegistryUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchDeviceRegistry(conn).then((devices) =>\n          store.setState(devices, true)\n        ),\n      500,\n      true\n    ),\n    \"device_registry_updated\"\n  );\n\nexport const subscribeDeviceRegistry = (\n  conn: Connection,\n  onChange: (devices: DeviceRegistryEntry[]) => void\n) =>\n  createCollection<DeviceRegistryEntry[]>(\n    \"_dr\",\n    fetchDeviceRegistry,\n    subscribeDeviceRegistryUpdates,\n    conn,\n    onChange\n  );\n","export const UNAVAILABLE = \"unavailable\";\n\nexport const ENTITY_COMPONENT_DOMAINS = [\n  \"air_quality\",\n  \"alarm_control_panel\",\n  \"automation\",\n  \"binary_sensor\",\n  \"calendar\",\n  \"counter\",\n  \"cover\",\n  \"dominos\",\n  \"fan\",\n  \"geo_location\",\n  \"group\",\n  \"history_graph\",\n  \"image_processing\",\n  \"input_boolean\",\n  \"input_datetime\",\n  \"input_number\",\n  \"input_select\",\n  \"input_text\",\n  \"light\",\n  \"lock\",\n  \"mailbox\",\n  \"media_player\",\n  \"person\",\n  \"plant\",\n  \"remember_the_milk\",\n  \"remote\",\n  \"scene\",\n  \"script\",\n  \"sensor\",\n  \"switch\",\n  \"timer\",\n  \"utility_meter\",\n  \"vacuum\",\n  \"weather\",\n  \"wink\",\n  \"zha\",\n  \"zwave\",\n];\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { HomeAssistant } from \"../types\";\nimport computeStateName from \"../common/entity/compute_state_name\";\nimport { debounce } from \"../common/util/debounce\";\n\nexport interface EntityRegistryEntry {\n  entity_id: string;\n  name: string;\n  platform: string;\n  config_entry_id?: string;\n  device_id?: string;\n  disabled_by?: string;\n}\n\nexport interface EntityRegistryEntryUpdateParams {\n  name: string | null;\n  new_entity_id: string;\n}\n\nexport const computeEntityRegistryName = (\n  hass: HomeAssistant,\n  entry: EntityRegistryEntry\n): string | null => {\n  if (entry.name) {\n    return entry.name;\n  }\n  const state = hass.states[entry.entity_id];\n  return state ? computeStateName(state) : null;\n};\n\nexport const updateEntityRegistryEntry = (\n  hass: HomeAssistant,\n  entityId: string,\n  updates: Partial<EntityRegistryEntryUpdateParams>\n): Promise<EntityRegistryEntry> =>\n  hass.callWS<EntityRegistryEntry>({\n    type: \"config/entity_registry/update\",\n    entity_id: entityId,\n    ...updates,\n  });\n\nexport const removeEntityRegistryEntry = (\n  hass: HomeAssistant,\n  entityId: string\n): Promise<void> =>\n  hass.callWS({\n    type: \"config/entity_registry/remove\",\n    entity_id: entityId,\n  });\n\nconst fetchEntityRegistry = (conn) =>\n  conn.sendMessagePromise({\n    type: \"config/entity_registry/list\",\n  });\n\nconst subscribeEntityRegistryUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchEntityRegistry(conn).then((entities) =>\n          store.setState(entities, true)\n        ),\n      500,\n      true\n    ),\n    \"entity_registry_updated\"\n  );\n\nexport const subscribeEntityRegistry = (\n  conn: Connection,\n  onChange: (entities: EntityRegistryEntry[]) => void\n) =>\n  createCollection<EntityRegistryEntry[]>(\n    \"_entityRegistry\",\n    fetchEntityRegistry,\n    subscribeEntityRegistryUpdates,\n    conn,\n    onChange\n  );\n","import { HomeAssistant } from \"../types\";\n\nexport const setInputDateTimeValue = (\n  hass: HomeAssistant,\n  entityId: string,\n  time: string | undefined = undefined,\n  date: string | undefined = undefined\n) => {\n  const param = { entity_id: entityId, time, date };\n  hass.callService(entityId.split(\".\", 1)[0], \"set_datetime\", param);\n};\n","import { HomeAssistant } from \"../types\";\n\nexport const setValue = (hass: HomeAssistant, entity: string, value: string) =>\n  hass.callService(entity.split(\".\", 1)[0], \"set_value\", {\n    value,\n    entity_id: entity,\n  });\n","import { HomeAssistant } from \"../types\";\nimport { Connection } from \"home-assistant-js-websocket\";\n\nexport interface LovelaceConfig {\n  title?: string;\n  views: LovelaceViewConfig[];\n  background?: string;\n  resources?: Array<{ type: \"css\" | \"js\" | \"module\" | \"html\"; url: string }>;\n}\n\nexport interface LovelaceViewConfig {\n  index?: number;\n  title?: string;\n  badges?: string[];\n  cards?: LovelaceCardConfig[];\n  path?: string;\n  icon?: string;\n  theme?: string;\n  panel?: boolean;\n  background?: string;\n}\n\nexport interface LovelaceCardConfig {\n  index?: number;\n  view_index?: number;\n  type: string;\n  [key: string]: any;\n}\n\nexport interface ToggleActionConfig {\n  action: \"toggle\";\n}\n\nexport interface CallServiceActionConfig {\n  action: \"call-service\";\n  service: string;\n  service_data?: {\n    entity_id?: string | [string];\n    [key: string]: any;\n  };\n}\n\nexport interface NavigateActionConfig {\n  action: \"navigate\";\n  navigation_path: string;\n}\n\nexport interface MoreInfoActionConfig {\n  action: \"more-info\";\n}\n\nexport interface NoActionConfig {\n  action: \"none\";\n}\n\nexport type ActionConfig =\n  | ToggleActionConfig\n  | CallServiceActionConfig\n  | NavigateActionConfig\n  | MoreInfoActionConfig\n  | NoActionConfig;\n\nexport const fetchConfig = (\n  hass: HomeAssistant,\n  force: boolean\n): Promise<LovelaceConfig> =>\n  hass.callWS({\n    type: \"lovelace/config\",\n    force,\n  });\n\nexport const saveConfig = (\n  hass: HomeAssistant,\n  config: LovelaceConfig\n): Promise<void> =>\n  hass.callWS({\n    type: \"lovelace/config/save\",\n    config,\n  });\n\nexport const subscribeLovelaceUpdates = (\n  conn: Connection,\n  onChange: () => void\n) => conn.subscribeEvents(onChange, \"lovelace_updated\");\n","import { HomeAssistant } from \"../types\";\n\nexport interface ShoppingListItem {\n  id: number;\n  name: string;\n  complete: boolean;\n}\n\nexport const fetchItems = (hass: HomeAssistant): Promise<ShoppingListItem[]> =>\n  hass.callWS({\n    type: \"shopping_list/items\",\n  });\n\nexport const updateItem = (\n  hass: HomeAssistant,\n  itemId: number,\n  item: {\n    name?: string;\n    complete?: boolean;\n  }\n): Promise<ShoppingListItem> =>\n  hass.callWS({\n    type: \"shopping_list/items/update\",\n    item_id: itemId,\n    ...item,\n  });\n\nexport const clearItems = (hass: HomeAssistant): Promise<void> =>\n  hass.callWS({\n    type: \"shopping_list/items/clear\",\n  });\n\nexport const addItem = (\n  hass: HomeAssistant,\n  name: string\n): Promise<ShoppingListItem> =>\n  hass.callWS({\n    type: \"shopping_list/items/add\",\n    name,\n  });\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\n\nconst fetchNotifications = (conn) =>\n  conn.sendMessagePromise({\n    type: \"persistent_notification/get\",\n  });\n\nconst subscribeUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    () => fetchNotifications(conn).then((ntf) => store.setState(ntf, true)),\n    \"persistent_notifications_updated\"\n  );\n\nexport const subscribeNotifications = (\n  conn: Connection,\n  onChange: (notifications: Notification[]) => void\n) =>\n  createCollection<Notification[]>(\n    \"_ntf\",\n    fetchNotifications,\n    subscribeUpdates,\n    conn,\n    onChange\n  );\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n  property,\n  customElement,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-label-badge\";\nimport \"../components/hui-warning\";\n\nimport { LovelaceCard } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport {\n  callAlarmAction,\n  FORMAT_NUMBER,\n} from \"../../../data/alarm_control_panel\";\nimport { AlarmPanelCardConfig } from \"./types\";\n\nconst ICONS = {\n  armed_away: \"hass:shield-lock\",\n  armed_custom_bypass: \"hass:security\",\n  armed_home: \"hass:shield-home\",\n  armed_night: \"hass:shield-home\",\n  disarmed: \"hass:shield-check\",\n  pending: \"hass:shield-outline\",\n  triggered: \"hass:bell-ring\",\n};\n\nconst BUTTONS = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"\", \"0\", \"clear\"];\n\n@customElement(\"hui-alarm-panel-card\")\nclass HuiAlarmPanelCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement() {\n    await import(/* webpackChunkName: \"hui-alarm-panel-card-editor\" */ \"../editor/config-elements/hui-alarm-panel-card-editor\");\n    return document.createElement(\"hui-alarm-panel-card-editor\");\n  }\n\n  public static getStubConfig() {\n    return { states: [\"arm_home\", \"arm_away\"] };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: AlarmPanelCardConfig;\n\n  @property() private _code?: string;\n\n  public getCardSize(): number {\n    if (!this._config || !this.hass) {\n      return 0;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    return !stateObj || stateObj.attributes.code_format !== FORMAT_NUMBER\n      ? 3\n      : 8;\n  }\n\n  public setConfig(config: AlarmPanelCardConfig): void {\n    if (\n      !config ||\n      !config.entity ||\n      config.entity.split(\".\")[0] !== \"alarm_control_panel\"\n    ) {\n      throw new Error(\"Invalid card configuration\");\n    }\n\n    const defaults = {\n      states: [\"arm_away\", \"arm_home\"],\n    };\n\n    this._config = { ...defaults, ...config };\n    this._code = \"\";\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\") || changedProps.has(\"_code\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (oldHass) {\n      return (\n        oldHass.states[this._config!.entity] !==\n        this.hass!.states[this._config!.entity]\n      );\n    }\n    return true;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.name || this._label(stateObj.state)}\">\n        <ha-label-badge\n          class=\"${classMap({ [stateObj.state]: true })}\"\n          .icon=\"${ICONS[stateObj.state] || \"hass:shield-outline\"}\"\n          .label=\"${this._stateIconLabel(stateObj.state)}\"\n        ></ha-label-badge>\n        <div id=\"armActions\" class=\"actions\">\n          ${(stateObj.state === \"disarmed\"\n            ? this._config.states!\n            : [\"disarm\"]\n          ).map((state) => {\n            return html`\n              <mwc-button\n                .action=\"${state}\"\n                @click=\"${this._handleActionClick}\"\n                outlined\n              >\n                ${this._label(state)}\n              </mwc-button>\n            `;\n          })}\n        </div>\n        ${!stateObj.attributes.code_format\n          ? html``\n          : html`\n              <paper-input\n                label=\"Alarm Code\"\n                type=\"password\"\n                .value=\"${this._code}\"\n              ></paper-input>\n            `}\n        ${stateObj.attributes.code_format !== FORMAT_NUMBER\n          ? html``\n          : html`\n              <div id=\"keypad\">\n                ${BUTTONS.map((value) => {\n                  return value === \"\"\n                    ? html`\n                        <mwc-button disabled></mwc-button>\n                      `\n                    : html`\n                        <mwc-button\n                          .value=\"${value}\"\n                          @click=\"${this._handlePadClick}\"\n                          dense\n                        >\n                          ${value === \"clear\"\n                            ? this._label(\"clear_code\")\n                            : value}\n                        </mwc-button>\n                      `;\n                })}\n              </div>\n            `}\n      </ha-card>\n    `;\n  }\n\n  private _stateIconLabel(state: string): string {\n    const stateLabel = state.split(\"_\").pop();\n    return stateLabel === \"disarmed\" ||\n      stateLabel === \"triggered\" ||\n      !stateLabel\n      ? \"\"\n      : stateLabel;\n  }\n\n  private _label(state: string): string {\n    return (\n      this.hass!.localize(`state.alarm_control_panel.${state}`) ||\n      this.hass!.localize(`ui.card.alarm_control_panel.${state}`)\n    );\n  }\n\n  private _handlePadClick(e: MouseEvent): void {\n    const val = (e.currentTarget! as any).value;\n    this._code = val === \"clear\" ? \"\" : this._code + val;\n  }\n\n  private _handleActionClick(e: MouseEvent): void {\n    callAlarmAction(\n      this.hass!,\n      this._config!.entity,\n      (e.currentTarget! as any).action,\n      this._code!\n    );\n    this._code = \"\";\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        padding-bottom: 16px;\n        position: relative;\n        --alarm-color-disarmed: var(--label-badge-green);\n        --alarm-color-pending: var(--label-badge-yellow);\n        --alarm-color-triggered: var(--label-badge-red);\n        --alarm-color-armed: var(--label-badge-red);\n        --alarm-color-autoarm: rgba(0, 153, 255, 0.1);\n        --alarm-state-color: var(--alarm-color-armed);\n        --base-unit: 15px;\n        font-size: calc(var(--base-unit));\n      }\n\n      ha-label-badge {\n        --ha-label-badge-color: var(--alarm-state-color);\n        --label-badge-text-color: var(--alarm-state-color);\n        --label-badge-background-color: var(--paper-card-background-color);\n        color: var(--alarm-state-color);\n        position: absolute;\n        right: 12px;\n        top: 12px;\n      }\n\n      .disarmed {\n        --alarm-state-color: var(--alarm-color-disarmed);\n      }\n\n      .triggered {\n        --alarm-state-color: var(--alarm-color-triggered);\n        animation: pulse 1s infinite;\n      }\n\n      .arming {\n        --alarm-state-color: var(--alarm-color-pending);\n        animation: pulse 1s infinite;\n      }\n\n      .pending {\n        --alarm-state-color: var(--alarm-color-pending);\n        animation: pulse 1s infinite;\n      }\n\n      @keyframes pulse {\n        0% {\n          --ha-label-badge-color: var(--alarm-state-color);\n        }\n        100% {\n          --ha-label-badge-color: rgba(255, 153, 0, 0.3);\n        }\n      }\n\n      paper-input {\n        margin: 0 auto 8px;\n        max-width: 150px;\n        font-size: calc(var(--base-unit));\n        text-align: center;\n      }\n\n      .state {\n        margin-left: 16px;\n        font-size: calc(var(--base-unit) * 0.9);\n        position: relative;\n        bottom: 16px;\n        color: var(--alarm-state-color);\n        animation: none;\n      }\n\n      #keypad {\n        display: flex;\n        justify-content: center;\n        flex-wrap: wrap;\n        margin: auto;\n        width: 300px;\n      }\n\n      #keypad mwc-button {\n        margin-bottom: 5%;\n        width: 30%;\n        padding: calc(var(--base-unit));\n        font-size: calc(var(--base-unit) * 1.1);\n        box-sizing: border-box;\n      }\n\n      .actions {\n        margin: 0 8px;\n        padding-top: 20px;\n        display: flex;\n        flex-wrap: wrap;\n        justify-content: center;\n        font-size: calc(var(--base-unit) * 1);\n      }\n\n      .actions mwc-button {\n        min-width: calc(var(--base-unit) * 9);\n        margin: 0 4px 4px;\n      }\n\n      mwc-button#disarm {\n        color: var(--google-red-500);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-alarm-panel-card\": HuiAlarmPanelCard;\n  }\n}\n","import { createCardElement } from \"../common/create-card-element\";\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport {\n  checkConditionsMet,\n  validateConditionalConfig,\n} from \"../../lovelace/common/validate-condition\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard } from \"../types\";\nimport { ConditionalCardConfig } from \"./types\";\n\nclass HuiConditionalCard extends HTMLElement implements LovelaceCard {\n  private _hass?: HomeAssistant;\n  private _config?: ConditionalCardConfig;\n  private _card?: LovelaceCard;\n\n  public setConfig(config) {\n    if (\n      !config.card ||\n      !config.conditions ||\n      !Array.isArray(config.conditions) ||\n      !validateConditionalConfig(config.conditions)\n    ) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    if (this._card && this._card.parentElement) {\n      this.removeChild(this._card);\n    }\n\n    this._config = config;\n    this._card = createCardElement(config.card);\n\n    this.update();\n  }\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n\n    this.update();\n  }\n\n  public getCardSize() {\n    return computeCardSize(this._card!);\n  }\n\n  private update() {\n    if (!this._card || !this._hass) {\n      return;\n    }\n\n    const visible =\n      this._config && checkConditionsMet(this._config.conditions, this._hass);\n\n    if (visible) {\n      this._card.hass = this._hass;\n      if (!this._card.parentElement) {\n        this.appendChild(this._card);\n      }\n    } else if (this._card.parentElement) {\n      this.removeChild(this._card);\n    }\n    // This will hide the complete card so it won't get styled by parent\n    this.style.setProperty(\"display\", visible ? \"\" : \"none\");\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-conditional-card\": HuiConditionalCard;\n  }\n}\n\ncustomElements.define(\"hui-conditional-card\", HuiConditionalCard);\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-entities-toggle\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { DOMAINS_HIDE_MORE_INFO } from \"../../../common/const\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow } from \"../entity-rows/types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { createRowElement } from \"../common/create-row-element\";\nimport { EntitiesCardConfig, EntitiesCardEntityConfig } from \"./types\";\n\nimport computeDomain from \"../../../common/entity/compute_domain\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\n\n@customElement(\"hui-entities-card\")\nclass HuiEntitiesCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-entities-card-editor\" */ \"../editor/config-elements/hui-entities-card-editor\");\n    return document.createElement(\"hui-entities-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { entities: [] };\n  }\n\n  @property() protected _config?: EntitiesCardConfig;\n\n  protected _hass?: HomeAssistant;\n\n  protected _configEntities?: EntitiesCardEntityConfig[];\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n    this.shadowRoot!.querySelectorAll(\"#states > div > *\").forEach(\n      (element: unknown) => {\n        (element as EntityRow).hass = hass;\n      }\n    );\n    const entitiesToggle = this.shadowRoot!.querySelector(\n      \"hui-entities-toggle\"\n    );\n    if (entitiesToggle) {\n      (entitiesToggle as any).hass = hass;\n    }\n  }\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 0;\n    }\n    // +1 for the header\n    return (this._config.title ? 1 : 0) + this._config.entities.length;\n  }\n\n  public setConfig(config: EntitiesCardConfig): void {\n    const entities = processConfigEntities(config.entities);\n\n    this._config = { theme: \"default\", ...config };\n    this._configEntities = entities;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (this._hass && this._config) {\n      applyThemesOnElement(this, this._hass.themes, this._config.theme);\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this._hass) {\n      return html``;\n    }\n    const { show_header_toggle, title } = this._config;\n\n    return html`\n      <ha-card>\n        ${!title && !show_header_toggle\n          ? html``\n          : html`\n              <div class=\"card-header\">\n                <div class=\"name\">${title}</div>\n                ${show_header_toggle === false\n                  ? html``\n                  : html`\n                      <hui-entities-toggle\n                        .hass=\"${this._hass}\"\n                        .entities=\"${this._configEntities!.map(\n                          (conf) => conf.entity\n                        )}\"\n                      ></hui-entities-toggle>\n                    `}\n              </div>\n            `}\n        <div id=\"states\" class=\"card-content\">\n          ${this._configEntities!.map((entityConf) =>\n            this.renderEntity(entityConf)\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .card-header {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .card-header .name {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n\n      .card-header hui-entities-toggle {\n        margin: -4px 0;\n      }\n\n      #states > * {\n        margin: 8px 0;\n      }\n\n      #states > div > * {\n        overflow: hidden;\n      }\n\n      .state-card-dialog {\n        cursor: pointer;\n      }\n    `;\n  }\n\n  private renderEntity(entityConf: EntitiesCardEntityConfig): TemplateResult {\n    const element = createRowElement(entityConf);\n    if (this._hass) {\n      element.hass = this._hass;\n    }\n    if (\n      entityConf.entity &&\n      !DOMAINS_HIDE_MORE_INFO.includes(computeDomain(entityConf.entity))\n    ) {\n      element.classList.add(\"state-card-dialog\");\n      element.addEventListener(\"click\", () => this._handleClick(entityConf));\n    }\n\n    return html`\n      <div>${element}</div>\n    `;\n  }\n\n  private _handleClick(entityConf: EntitiesCardEntityConfig): void {\n    const entityId = entityConf.entity;\n    fireEvent(this, \"hass-more-info\", { entityId });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entities-card\": HuiEntitiesCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n  customElement,\n  property,\n} from \"lit-element\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport \"@material/mwc-ripple\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-warning\";\n\nimport isValidEntityId from \"../../../common/entity/valid_entity_id\";\nimport stateIcon from \"../../../common/entity/state_icon\";\nimport computeStateDomain from \"../../../common/entity/compute_state_domain\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nimport { HomeAssistant, LightEntity } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { handleClick } from \"../common/handle-click\";\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { EntityButtonCardConfig } from \"./types\";\n\n@customElement(\"hui-entity-button-card\")\nclass HuiEntityButtonCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-entity-button-card-editor\" */ \"../editor/config-elements/hui-entity-button-card-editor\");\n    return document.createElement(\"hui-entity-button-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {\n      tap_action: { action: \"toggle\" },\n      hold_action: { action: \"more-info\" },\n      show_icon: true,\n      show_name: true,\n    };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityButtonCardConfig;\n\n  public getCardSize(): number {\n    return 2;\n  }\n\n  public setConfig(config: EntityButtonCardConfig): void {\n    if (!isValidEntityId(config.entity)) {\n      throw new Error(\"Invalid Entity\");\n    }\n\n    this._config = {\n      theme: \"default\",\n      hold_action: { action: \"more-info\" },\n      show_icon: true,\n      show_name: true,\n      ...config,\n    };\n\n    if (DOMAINS_TOGGLE.has(computeDomain(config.entity))) {\n      this._config = {\n        tap_action: {\n          action: \"toggle\",\n        },\n        ...this._config,\n      };\n    } else {\n      this._config = {\n        tap_action: {\n          action: \"more-info\",\n        },\n        ...this._config,\n      };\n    }\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (oldHass) {\n      return (\n        oldHass.states[this._config!.entity] !==\n        this.hass!.states[this._config!.entity]\n      );\n    }\n    return true;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      >\n        ${this._config.show_icon\n          ? html`\n              <ha-icon\n                data-domain=\"${computeStateDomain(stateObj)}\"\n                data-state=\"${stateObj.state}\"\n                .icon=\"${this._config.icon || stateIcon(stateObj)}\"\n                style=\"${styleMap({\n                  filter: this._computeBrightness(stateObj),\n                  color: this._computeColor(stateObj),\n                  height: this._config.icon_height\n                    ? this._config.icon_height\n                    : \"auto\",\n                })}\"\n              ></ha-icon>\n            `\n          : \"\"}\n        ${this._config.show_name\n          ? html`\n              <span>\n                ${this._config.name || computeStateName(stateObj)}\n              </span>\n            `\n          : \"\"}\n        <mwc-ripple></mwc-ripple>\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        cursor: pointer;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        text-align: center;\n        padding: 4% 0;\n        font-size: 1.2rem;\n      }\n\n      ha-icon {\n        width: 40%;\n        height: auto;\n        color: var(--paper-item-icon-color, #44739e);\n      }\n\n      ha-icon[data-domain=\"light\"][data-state=\"on\"],\n      ha-icon[data-domain=\"switch\"][data-state=\"on\"],\n      ha-icon[data-domain=\"binary_sensor\"][data-state=\"on\"],\n      ha-icon[data-domain=\"fan\"][data-state=\"on\"],\n      ha-icon[data-domain=\"sun\"][data-state=\"above_horizon\"] {\n        color: var(--paper-item-icon-active-color, #fdd835);\n      }\n\n      ha-icon[data-state=\"unavailable\"] {\n        color: var(--state-icon-unavailable-color);\n      }\n    `;\n  }\n\n  private _computeBrightness(stateObj: HassEntity | LightEntity): string {\n    if (!stateObj.attributes.brightness) {\n      return \"\";\n    }\n    const brightness = stateObj.attributes.brightness;\n    return `brightness(${(brightness + 245) / 5}%)`;\n  }\n\n  private _computeColor(stateObj: HassEntity | LightEntity): string {\n    if (!stateObj.attributes.hs_color) {\n      return \"\";\n    }\n    const [hue, sat] = stateObj.attributes.hs_color;\n    if (sat <= 10) {\n      return \"\";\n    }\n    return `hsl(${hue}, 100%, ${100 - sat / 2}%)`;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entity-button-card\": HuiEntityButtonCard;\n  }\n}\n","import { createCardElement } from \"../common/create-card-element\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\nimport { EntityConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityFilterCardConfig } from \"./types\";\n\nclass EntityFilterCard extends HTMLElement implements LovelaceCard {\n  public isPanel?: boolean;\n  private _element?: LovelaceCard;\n  private _config?: EntityFilterCardConfig;\n  private _configEntities?: EntityConfig[];\n  private _baseCardConfig?: LovelaceCardConfig;\n\n  public getCardSize(): number {\n    return this._element ? this._element.getCardSize() : 1;\n  }\n\n  public setConfig(config: EntityFilterCardConfig): void {\n    if (!config.state_filter || !Array.isArray(config.state_filter)) {\n      throw new Error(\"Incorrect filter config.\");\n    }\n\n    this._config = config;\n    this._configEntities = undefined;\n    this._baseCardConfig = {\n      type: \"entities\",\n      entities: [],\n      ...this._config.card,\n    };\n\n    if (this.lastChild) {\n      this.removeChild(this.lastChild);\n      this._element = undefined;\n    }\n  }\n\n  set hass(hass: HomeAssistant) {\n    if (!hass || !this._config) {\n      return;\n    }\n\n    if (!this._configEntities) {\n      this._configEntities = processConfigEntities(this._config.entities);\n    }\n\n    const entitiesList = this._configEntities.filter((entityConf) => {\n      const stateObj = hass.states[entityConf.entity];\n      return stateObj && this._config!.state_filter.includes(stateObj.state);\n    });\n\n    if (entitiesList.length === 0 && this._config.show_empty === false) {\n      this.style.display = \"none\";\n      return;\n    }\n\n    const element = this._cardElement();\n\n    if (!element) {\n      return;\n    }\n\n    if (element.tagName !== \"HUI-ERROR-CARD\") {\n      element.setConfig({ ...this._baseCardConfig!, entities: entitiesList });\n      element.isPanel = this.isPanel;\n      element.hass = hass;\n    }\n\n    // Attach element if it has never been attached.\n    if (!this.lastChild) {\n      this.appendChild(element);\n    }\n\n    this.style.display = \"block\";\n  }\n\n  private _cardElement(): LovelaceCard | undefined {\n    if (!this._element && this._config) {\n      const element = createCardElement(this._baseCardConfig!);\n      this._element = element;\n    }\n\n    return this._element;\n  }\n}\ncustomElements.define(\"hui-entity-filter-card\", EntityFilterCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\nimport { HomeAssistant } from \"../../../types\";\nimport { ErrorCardConfig } from \"./types\";\n\nexport const createErrorCardElement = (config) => {\n  const el = document.createElement(\"hui-error-card\");\n  el.setConfig(config);\n  return el;\n};\n\nexport const createErrorCardConfig = (error, origConfig) => ({\n  type: \"error\",\n  error,\n  origConfig,\n});\n\n@customElement(\"hui-error-card\")\nexport class HuiErrorCard extends LitElement implements LovelaceCard {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: ErrorCardConfig;\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: ErrorCardConfig): void {\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      ${this._config.error}\n      <pre>${this._toStr(this._config.origConfig)}</pre>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        background-color: #ef5350;\n        color: white;\n        padding: 8px;\n        font-weight: 500;\n      }\n    `;\n  }\n\n  private _toStr(config: LovelaceCardConfig): string {\n    return JSON.stringify(config, null, 2);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-error-card\": HuiErrorCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport { styleMap } from \"lit-html/directives/style-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-warning\";\n\nimport isValidEntityId from \"../../../common/entity/valid_entity_id\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { GaugeCardConfig } from \"./types\";\n\nexport const severityMap = {\n  red: \"var(--label-badge-red)\",\n  green: \"var(--label-badge-green)\",\n  yellow: \"var(--label-badge-yellow)\",\n  normal: \"var(--label-badge-blue)\",\n};\n\n@customElement(\"hui-gauge-card\")\nclass HuiGaugeCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-gauge-card-editor\" */ \"../editor/config-elements/hui-gauge-card-editor\");\n    return document.createElement(\"hui-gauge-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _baseUnit = \"50px\";\n  @property() private _config?: GaugeCardConfig;\n\n  private _updated?: boolean;\n\n  public getCardSize(): number {\n    return 2;\n  }\n\n  public setConfig(config: GaugeCardConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid card configuration\");\n    }\n    if (!isValidEntityId(config.entity)) {\n      throw new Error(\"Invalid Entity\");\n    }\n    this._config = { min: 0, max: 100, theme: \"default\", ...config };\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._setBaseUnit();\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    const state = Number(stateObj.state);\n\n    if (isNaN(state)) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_non_numeric\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card\n        @click=\"${this._handleClick}\"\n        style=${styleMap({\n          \"--base-unit\": this._baseUnit,\n        })}\n      >\n        <div class=\"container\">\n          <div class=\"gauge-a\"></div>\n          <div class=\"gauge-b\"></div>\n          <div\n            class=\"gauge-c\"\n            style=${styleMap({\n              transform: `rotate(${this._translateTurn(state)}turn)`,\n              \"background-color\": this._computeSeverity(state),\n            })}\n          ></div>\n          <div class=\"gauge-data\">\n            <div id=\"percent\">\n              ${stateObj.state}\n              ${this._config.unit ||\n                stateObj.attributes.unit_of_measurement ||\n                \"\"}\n            </div>\n            <div id=\"name\">\n              ${this._config.name || computeStateName(stateObj)}\n            </div>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected firstUpdated(): void {\n    this._updated = true;\n    this._setBaseUnit();\n    this.classList.add(\"init\");\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  private _setBaseUnit(): void {\n    if (!this.isConnected || !this._updated) {\n      return;\n    }\n    const baseUnit = this._computeBaseUnit();\n    if (baseUnit !== \"0px\") {\n      this._baseUnit = baseUnit;\n    }\n  }\n\n  private _computeSeverity(numberValue: number): string {\n    const sections = this._config!.severity;\n\n    if (!sections) {\n      return severityMap.normal;\n    }\n\n    const sectionsArray = Object.keys(sections);\n    const sortable = sectionsArray.map((severity) => [\n      severity,\n      sections[severity],\n    ]);\n\n    for (const severity of sortable) {\n      if (severityMap[severity[0]] == null || isNaN(severity[1])) {\n        return severityMap.normal;\n      }\n    }\n    sortable.sort((a, b) => a[1] - b[1]);\n\n    if (numberValue >= sortable[0][1] && numberValue < sortable[1][1]) {\n      return severityMap[sortable[0][0]];\n    }\n    if (numberValue >= sortable[1][1] && numberValue < sortable[2][1]) {\n      return severityMap[sortable[1][0]];\n    }\n    if (numberValue >= sortable[2][1]) {\n      return severityMap[sortable[2][0]];\n    }\n    return severityMap.normal;\n  }\n\n  private _translateTurn(value: number): number {\n    const { min, max } = this._config!;\n    const maxTurnValue = Math.min(Math.max(value, min!), max!);\n    return (5 * (maxTurnValue - min!)) / (max! - min!) / 10;\n  }\n\n  private _computeBaseUnit(): string {\n    return this.clientWidth < 200 ? this.clientWidth / 5 + \"px\" : \"50px\";\n  }\n\n  private _handleClick(): void {\n    fireEvent(this, \"hass-more-info\", { entityId: this._config!.entity });\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        height: calc(var(--base-unit) * 3);\n        position: relative;\n        cursor: pointer;\n      }\n      .container {\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2);\n        position: absolute;\n        top: calc(var(--base-unit) * 1.5);\n        left: 50%;\n        overflow: hidden;\n        text-align: center;\n        transform: translate(-50%, -50%);\n      }\n      .gauge-a {\n        z-index: 1;\n        position: absolute;\n        background-color: var(--primary-background-color);\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2);\n        top: 0%;\n        border-radius: calc(var(--base-unit) * 2.5) calc(var(--base-unit) * 2.5)\n          0px 0px;\n      }\n      .gauge-b {\n        z-index: 3;\n        position: absolute;\n        background-color: var(--paper-card-background-color);\n        width: calc(var(--base-unit) * 2.5);\n        height: calc(var(--base-unit) * 1.25);\n        top: calc(var(--base-unit) * 0.75);\n        margin-left: calc(var(--base-unit) * 0.75);\n        margin-right: auto;\n        border-radius: calc(var(--base-unit) * 2.5) calc(var(--base-unit) * 2.5)\n          0px 0px;\n      }\n      .gauge-c {\n        z-index: 2;\n        position: absolute;\n        background-color: var(--label-badge-blue);\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2);\n        top: calc(var(--base-unit) * 2);\n        margin-left: auto;\n        margin-right: auto;\n        border-radius: 0px 0px calc(var(--base-unit) * 2)\n          calc(var(--base-unit) * 2);\n        transform-origin: center top;\n      }\n      .init .gauge-c {\n        transition: all 1.3s ease-in-out;\n      }\n      .gauge-data {\n        z-index: 4;\n        color: var(--primary-text-color);\n        line-height: calc(var(--base-unit) * 0.3);\n        position: absolute;\n        width: calc(var(--base-unit) * 4);\n        height: calc(var(--base-unit) * 2.1);\n        top: calc(var(--base-unit) * 1.2);\n        margin-left: auto;\n        margin-right: auto;\n      }\n      .init .gauge-data {\n        transition: all 1s ease-out;\n      }\n      .gauge-data #percent {\n        font-size: calc(var(--base-unit) * 0.55);\n      }\n      .gauge-data #name {\n        padding-top: calc(var(--base-unit) * 0.15);\n        font-size: calc(var(--base-unit) * 0.3);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-gauge-card\": HuiGaugeCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\n\nimport \"../../../components/entity/state-badge\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning-element\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { handleClick } from \"../common/handle-click\";\nimport { GlanceCardConfig, ConfigEntity } from \"./types\";\n\n@customElement(\"hui-glance-card\")\nexport class HuiGlanceCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-glance-card-editor\" */ \"../editor/config-elements/hui-glance-card-editor\");\n    return document.createElement(\"hui-glance-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { entities: [] };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: GlanceCardConfig;\n\n  private _configEntities?: ConfigEntity[];\n\n  public getCardSize(): number {\n    return (\n      (this._config!.title ? 1 : 0) +\n      Math.ceil(this._configEntities!.length / 5)\n    );\n  }\n\n  public setConfig(config: GlanceCardConfig): void {\n    this._config = { theme: \"default\", ...config };\n    const entities = processConfigEntities<ConfigEntity>(config.entities);\n\n    for (const entity of entities) {\n      if (\n        (entity.tap_action &&\n          entity.tap_action.action === \"call-service\" &&\n          !entity.tap_action.service) ||\n        (entity.hold_action &&\n          entity.hold_action.action === \"call-service\" &&\n          !entity.hold_action.service)\n      ) {\n        throw new Error(\n          'Missing required property \"service\" when tap_action or hold_action is call-service'\n        );\n      }\n    }\n\n    const columns = config.columns || Math.min(config.entities.length, 5);\n    this.style.setProperty(\"--glance-column-width\", `${100 / columns}%`);\n\n    this._configEntities = entities;\n\n    if (this.hass) {\n      this.requestUpdate();\n    }\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (oldHass && this._configEntities) {\n      for (const entity of this._configEntities) {\n        if (\n          oldHass.states[entity.entity] !== this.hass!.states[entity.entity]\n        ) {\n          return true;\n        }\n      }\n      return false;\n    }\n    return true;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n    const { title } = this._config;\n\n    return html`\n      <ha-card .header=\"${title}\">\n        <div class=\"${classMap({ entities: true, \"no-header\": !title })}\">\n          ${this._configEntities!.map((entityConf) =>\n            this.renderEntity(entityConf)\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProperties.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .entities {\n        display: flex;\n        padding: 0 16px 4px;\n        flex-wrap: wrap;\n      }\n      .entities.no-header {\n        padding-top: 16px;\n      }\n      .entity {\n        box-sizing: border-box;\n        padding: 0 4px;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        cursor: pointer;\n        margin-bottom: 12px;\n        width: var(--glance-column-width, 20%);\n      }\n      .entity div {\n        width: 100%;\n        text-align: center;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .name {\n        min-height: var(--paper-font-body1_-_line-height, 20px);\n      }\n      state-badge {\n        margin: 8px 0;\n      }\n    `;\n  }\n\n  private renderEntity(entityConf): TemplateResult {\n    const stateObj = this.hass!.states[entityConf.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass!.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            entityConf.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <div\n        class=\"entity\"\n        .entityConf=\"${entityConf}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      >\n        ${this._config!.show_name !== false\n          ? html`\n              <div class=\"name\">\n                ${\"name\" in entityConf\n                  ? entityConf.name\n                  : computeStateName(stateObj)}\n              </div>\n            `\n          : \"\"}\n        ${this._config!.show_icon !== false\n          ? html`\n              <state-badge\n                .stateObj=\"${stateObj}\"\n                .overrideIcon=\"${entityConf.icon}\"\n              ></state-badge>\n            `\n          : \"\"}\n        ${this._config!.show_state !== false\n          ? html`\n              <div>\n                ${computeStateDisplay(\n                  this.hass!.localize,\n                  stateObj,\n                  this.hass!.language\n                )}\n              </div>\n            `\n          : \"\"}\n      </div>\n    `;\n  }\n\n  private _handleTap(ev: MouseEvent): void {\n    const config = (ev.currentTarget as any).entityConf as ConfigEntity;\n    handleClick(this, this.hass!, config, false);\n  }\n\n  private _handleHold(ev: MouseEvent): void {\n    const config = (ev.currentTarget as any).entityConf as ConfigEntity;\n    handleClick(this, this.hass!, config, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-glance-card\": HuiGlanceCard;\n  }\n}\n","import { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/state-history-charts\";\nimport \"../../../data/ha-state-history-data\";\n\nimport { processConfigEntities } from \"../common/process-config-entities\";\n\nclass HuiHistoryGraphCard extends PolymerElement {\n  static get template() {\n    return html`\n      <style>\n        .content {\n          padding: 16px;\n        }\n        [header] .content {\n          padding-top: 0;\n        }\n      </style>\n\n      <ha-card header$=\"[[_config.title]]\">\n        <div class=\"content\">\n          <ha-state-history-data\n            hass=\"[[hass]]\"\n            filter-type=\"recent-entity\"\n            entity-id=\"[[_entities]]\"\n            data=\"{{_stateHistory}}\"\n            is-loading=\"{{_stateHistoryLoading}}\"\n            cache-config=\"[[_cacheConfig]]\"\n          ></ha-state-history-data>\n          <state-history-charts\n            hass=\"[[hass]]\"\n            history-data=\"[[_stateHistory]]\"\n            is-loading-data=\"[[_stateHistoryLoading]]\"\n            names=\"[[_names]]\"\n            up-to-now\n            no-single\n          ></state-history-charts>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      _config: Object,\n      _names: Object,\n      _entities: Array,\n\n      _stateHistory: Object,\n      _stateHistoryLoading: Boolean,\n      _cacheConfig: Object,\n    };\n  }\n\n  getCardSize() {\n    return 4;\n  }\n\n  setConfig(config) {\n    const entities = processConfigEntities(config.entities);\n\n    this._config = config;\n\n    const _entities = [];\n    const _names = {};\n    for (const entity of entities) {\n      _entities.push(entity.entity);\n      if (entity.name) {\n        _names[entity.entity] = entity.name;\n      }\n    }\n\n    this.setProperties({\n      _cacheConfig: {\n        cacheKey: _entities.sort().join(),\n        hoursToShow: config.hours_to_show || 24,\n        refresh: config.refresh_interval || 0,\n      },\n      _entities,\n      _names,\n    });\n  }\n}\n\ncustomElements.define(\"hui-history-graph-card\", HuiHistoryGraphCard);\n","import { html, TemplateResult } from \"lit-element\";\n\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport { HuiStackCard } from \"./hui-stack-card\";\n\nclass HuiHorizontalStackCard extends HuiStackCard {\n  public getCardSize(): number {\n    let totalSize = 0;\n\n    if (this._cards) {\n      for (const element of this._cards) {\n        const elementSize = computeCardSize(element);\n        totalSize = elementSize > totalSize ? elementSize : totalSize;\n      }\n    }\n\n    return totalSize;\n  }\n\n  protected renderStyle(): TemplateResult {\n    return html`\n      <style>\n        #root {\n          display: flex;\n        }\n        #root > * {\n          flex: 1 1 0;\n          margin: 0 4px;\n          min-width: 0;\n        }\n        #root > *:first-child {\n          margin-left: 0;\n        }\n        #root > *:last-child {\n          margin-right: 0;\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-horitzontal-stack-card\": HuiHorizontalStackCard;\n  }\n}\n\ncustomElements.define(\"hui-horizontal-stack-card\", HuiHorizontalStackCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../components/ha-card\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport { IframeCardConfig } from \"./types\";\n\n@customElement(\"hui-iframe-card\")\nexport class HuiIframeCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-iframe-card-editor\" */ \"../editor/config-elements/hui-iframe-card-editor\");\n    return document.createElement(\"hui-iframe-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return { url: \"https://www.home-assistant.io\", aspect_ratio: \"50%\" };\n  }\n\n  @property() protected _config?: IframeCardConfig;\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 3;\n    }\n    const aspectRatio = this._config.aspect_ratio\n      ? Number(this._config.aspect_ratio.replace(\"%\", \"\"))\n      : 50;\n    return 1 + aspectRatio / 25;\n  }\n\n  public setConfig(config: IframeCardConfig): void {\n    if (!config.url) {\n      throw new Error(\"URL required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    const aspectRatio = this._config.aspect_ratio || \"50%\";\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <div\n          id=\"root\"\n          style=\"${styleMap({\n            \"padding-top\": aspectRatio,\n          })}\"\n        >\n          <iframe src=\"${this._config.url}\"></iframe>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        overflow: hidden;\n      }\n\n      #root {\n        width: 100%;\n        position: relative;\n      }\n\n      iframe {\n        position: absolute;\n        border: none;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-iframe-card\": HuiIframeCard;\n  }\n}\n","import { createErrorCardConfig } from \"./hui-error-card\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nexport default class LegacyWrapperCard extends HTMLElement {\n  constructor(tag, domain) {\n    super();\n    this._tag = tag.toUpperCase();\n    this._domain = domain;\n    this._element = null;\n  }\n\n  getCardSize() {\n    return 3;\n  }\n\n  setConfig(config) {\n    if (!config.entity) {\n      throw new Error(\"No entity specified\");\n    }\n\n    if (computeDomain(config.entity) !== this._domain) {\n      throw new Error(\n        `Specified entity needs to be of domain ${this._domain}.`\n      );\n    }\n\n    this._config = config;\n  }\n\n  set hass(hass) {\n    const entityId = this._config.entity;\n\n    if (entityId in hass.states) {\n      this._ensureElement(this._tag);\n      this.lastChild.hass = hass;\n      this.lastChild.stateObj = hass.states[entityId];\n      this.lastChild.config = this._config;\n    } else {\n      this._ensureElement(\"HUI-ERROR-CARD\");\n      this.lastChild.setConfig(\n        createErrorCardConfig(\n          `No state available for ${entityId}`,\n          this._config\n        )\n      );\n    }\n  }\n\n  _ensureElement(tag) {\n    if (this.lastChild && this.lastChild.tagName === tag) return;\n\n    if (this.lastChild) {\n      this.removeChild(this.lastChild);\n    }\n\n    this.appendChild(document.createElement(tag));\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n\nimport stateIcon from \"../../../common/entity/state_icon\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport { HomeAssistant, LightEntity } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { loadRoundslider } from \"../../../resources/jquery.roundslider.ondemand\";\nimport { toggleEntity } from \"../common/entity/toggle-entity\";\nimport { LightCardConfig } from \"./types\";\n\nconst lightConfig = {\n  radius: 80,\n  step: 1,\n  circleShape: \"pie\",\n  startAngle: 315,\n  width: 5,\n  min: 1,\n  max: 100,\n  sliderType: \"min-range\",\n  lineCap: \"round\",\n  handleSize: \"+12\",\n  showTooltip: false,\n  animation: false,\n};\n\n@customElement(\"hui-light-card\")\nexport class HuiLightCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-light-card-editor\" */ \"../editor/config-elements/hui-light-card-editor\");\n    return document.createElement(\"hui-light-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: LightCardConfig;\n\n  @property() private _roundSliderStyle?: TemplateResult;\n\n  @property() private _jQuery?: any;\n\n  private _brightnessTimout?: number;\n\n  public getCardSize(): number {\n    return 2;\n  }\n\n  public setConfig(config: LightCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"light\") {\n      throw new Error(\"Specify an entity from within the light domain.\");\n    }\n\n    this._config = { theme: \"default\", ...config };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config!.entity] as LightEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      ${this.renderStyle()}\n      <ha-card>\n        <paper-icon-button\n          icon=\"hass:dots-vertical\"\n          class=\"more-info\"\n          @click=\"${this._handleMoreInfo}\"\n        ></paper-icon-button>\n        <div id=\"light\"></div>\n        <div id=\"tooltip\">\n          <div class=\"icon-state\">\n            <ha-icon\n              class=\"light-icon\"\n              data-state=\"${stateObj.state}\"\n              .icon=\"${stateIcon(stateObj)}\"\n              style=\"${styleMap({\n                filter: this._computeBrightness(stateObj),\n                color: this._computeColor(stateObj),\n              })}\"\n              @click=\"${this._handleTap}\"\n            ></ha-icon>\n            <div class=\"brightness\" @ha-click=\"${this._handleTap}\"></div>\n            <div class=\"name\">\n              ${this._config.name || computeStateName(stateObj)}\n            </div>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected async firstUpdated(): Promise<void> {\n    const loaded = await loadRoundslider();\n\n    this._roundSliderStyle = loaded.roundSliderStyle;\n    this._jQuery = loaded.jQuery;\n\n    const stateObj = this.hass!.states[this._config!.entity] as LightEntity;\n\n    if (!stateObj) {\n      // Card will require refresh to work again\n      return;\n    }\n\n    const brightness = stateObj.attributes.brightness || 0;\n\n    this._jQuery(\"#light\", this.shadowRoot).roundSlider({\n      ...lightConfig,\n      change: (value) => this._setBrightness(value),\n      drag: (value) => this._dragEvent(value),\n      start: () => this._showBrightness(),\n      stop: () => this._hideBrightness(),\n    });\n    this.shadowRoot!.querySelector(\".brightness\")!.innerHTML =\n      (Math.round((brightness / 254) * 100) || 0) + \"%\";\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass || !this._jQuery) {\n      return;\n    }\n\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (!stateObj) {\n      return;\n    }\n\n    const attrs = stateObj.attributes;\n\n    this._jQuery(\"#light\", this.shadowRoot).roundSlider({\n      value: Math.round((attrs.brightness / 254) * 100) || 0,\n    });\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  private renderStyle(): TemplateResult {\n    return html`\n      ${this._roundSliderStyle}\n      <style>\n        :host {\n          display: block;\n        }\n\n        ha-card {\n          position: relative;\n          overflow: hidden;\n          --brightness-font-color: white;\n          --brightness-font-text-shadow: -1px -1px 0 #000, 1px -1px 0 #000,\n            -1px 1px 0 #000, 1px 1px 0 #000;\n          --name-font-size: 1.2rem;\n          --brightness-font-size: 1.2rem;\n          --rail-border-color: transparent;\n        }\n\n        #tooltip {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 100%;\n          text-align: center;\n          z-index: 15;\n        }\n\n        .icon-state {\n          display: block;\n          margin: auto;\n          width: 100%;\n          height: 100%;\n          transform: translate(0, 25%);\n        }\n\n        #light {\n          margin: 0 auto;\n          padding-top: 16px;\n          padding-bottom: 16px;\n        }\n\n        #light .rs-bar.rs-transition.rs-first,\n        .rs-bar.rs-transition.rs-second {\n          z-index: 20 !important;\n        }\n\n        #light .rs-range-color {\n          background-color: var(--primary-color);\n        }\n\n        #light .rs-path-color {\n          background-color: var(--disabled-text-color);\n        }\n\n        #light .rs-handle {\n          background-color: var(--paper-card-background-color, white);\n          padding: 7px;\n          border: 2px solid var(--disabled-text-color);\n        }\n\n        #light .rs-handle.rs-focus {\n          border-color: var(--primary-color);\n        }\n\n        #light .rs-handle:after {\n          border-color: var(--primary-color);\n          background-color: var(--primary-color);\n        }\n\n        #light .rs-border {\n          border-color: var(--rail-border-color);\n        }\n\n        #light .rs-inner.rs-bg-color.rs-border,\n        #light .rs-overlay.rs-transition.rs-bg-color {\n          background-color: var(--paper-card-background-color, white);\n        }\n\n        .light-icon {\n          margin: auto;\n          width: 76px;\n          height: 76px;\n          color: var(--paper-item-icon-color, #44739e);\n          cursor: pointer;\n        }\n\n        .light-icon[data-state=\"on\"] {\n          color: var(--paper-item-icon-active-color, #fdd835);\n        }\n\n        .light-icon[data-state=\"unavailable\"] {\n          color: var(--state-icon-unavailable-color);\n        }\n\n        .name {\n          padding-top: 40px;\n          font-size: var(--name-font-size);\n        }\n\n        .brightness {\n          font-size: var(--brightness-font-size);\n          position: absolute;\n          margin: 0 auto;\n          left: 50%;\n          top: 10%;\n          transform: translate(-50%);\n          opacity: 0;\n          transition: opacity 0.5s ease-in-out;\n          -moz-transition: opacity 0.5s ease-in-out;\n          -webkit-transition: opacity 0.5s ease-in-out;\n          cursor: pointer;\n          color: var(--brightness-font-color);\n          text-shadow: var(--brightness-font-text-shadow);\n          pointer-events: none;\n        }\n\n        .show_brightness {\n          opacity: 1;\n        }\n\n        .more-info {\n          position: absolute;\n          cursor: pointer;\n          top: 0;\n          right: 0;\n          z-index: 25;\n          color: var(--secondary-text-color);\n        }\n      </style>\n    `;\n  }\n\n  private _dragEvent(e: any): void {\n    this.shadowRoot!.querySelector(\".brightness\")!.innerHTML = e.value + \"%\";\n  }\n\n  private _showBrightness(): void {\n    clearTimeout(this._brightnessTimout);\n    this.shadowRoot!.querySelector(\".brightness\")!.classList.add(\n      \"show_brightness\"\n    );\n  }\n\n  private _hideBrightness(): void {\n    this._brightnessTimout = window.setTimeout(() => {\n      this.shadowRoot!.querySelector(\".brightness\")!.classList.remove(\n        \"show_brightness\"\n      );\n    }, 500);\n  }\n\n  private _setBrightness(e: any): void {\n    this.hass!.callService(\"light\", \"turn_on\", {\n      entity_id: this._config!.entity,\n      brightness_pct: e.value,\n    });\n  }\n\n  private _computeBrightness(stateObj: LightEntity): string {\n    if (!stateObj.attributes.brightness) {\n      return \"\";\n    }\n    const brightness = stateObj.attributes.brightness;\n    return `brightness(${(brightness + 245) / 5}%)`;\n  }\n\n  private _computeColor(stateObj: LightEntity): string {\n    if (!stateObj.attributes.hs_color) {\n      return \"\";\n    }\n    const [hue, sat] = stateObj.attributes.hs_color;\n    if (sat <= 10) {\n      return \"\";\n    }\n    return `hsl(${hue}, 100%, ${100 - sat / 2}%)`;\n  }\n\n  private _handleTap() {\n    toggleEntity(this.hass!, this._config!.entity!);\n  }\n\n  private _handleMoreInfo() {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-light-card\": HuiLightCard;\n  }\n}\n","import \"@polymer/paper-icon-button/paper-icon-button\";\nimport { Layer, Marker, Circle, Map } from \"leaflet\";\nimport {\n  LitElement,\n  TemplateResult,\n  css,\n  html,\n  property,\n  PropertyValues,\n  CSSResult,\n  customElement,\n} from \"lit-element\";\n\nimport \"../../map/ha-entity-marker\";\n\nimport {\n  setupLeafletMap,\n  LeafletModuleType,\n} from \"../../../common/dom/setup-leaflet-map\";\nimport computeStateDomain from \"../../../common/entity/compute_state_domain\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport { debounce } from \"../../../common/util/debounce\";\nimport parseAspectRatio from \"../../../common/util/parse-aspect-ratio\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard } from \"../types\";\nimport { EntityConfig } from \"../entity-rows/types\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { MapCardConfig } from \"./types\";\n\n@customElement(\"hui-map-card\")\nclass HuiMapCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement() {\n    await import(/* webpackChunkName: \"hui-map-card-editor\" */ \"../editor/config-elements/hui-map-card-editor\");\n    return document.createElement(\"hui-map-card-editor\");\n  }\n\n  public static getStubConfig() {\n    return { entities: [] };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property({ type: Boolean, reflect: true })\n  public isPanel = false;\n\n  @property()\n  private _config?: MapCardConfig;\n  private _configEntities?: EntityConfig[];\n  // tslint:disable-next-line\n  private Leaflet?: LeafletModuleType;\n  private _leafletMap?: Map;\n  // @ts-ignore\n  private _resizeObserver?: ResizeObserver;\n  private _debouncedResizeListener = debounce(\n    () => {\n      if (!this._leafletMap) {\n        return;\n      }\n      this._leafletMap.invalidateSize();\n    },\n    100,\n    false\n  );\n  private _mapItems: Array<Marker | Circle> = [];\n  private _connected = false;\n\n  public setConfig(config: MapCardConfig): void {\n    if (!config) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    if (!config.entities && !config.geo_location_sources) {\n      throw new Error(\n        \"Either entities or geo_location_sources must be defined\"\n      );\n    }\n    if (config.entities && !Array.isArray(config.entities)) {\n      throw new Error(\"Entities need to be an array\");\n    }\n    if (\n      config.geo_location_sources &&\n      !Array.isArray(config.geo_location_sources)\n    ) {\n      throw new Error(\"Geo_location_sources needs to be an array\");\n    }\n\n    this._config = config;\n    this._configEntities = config.entities\n      ? processConfigEntities(config.entities)\n      : [];\n  }\n\n  public getCardSize(): number {\n    if (!this._config) {\n      return 3;\n    }\n    const ratio = parseAspectRatio(this._config.aspect_ratio);\n    const ar =\n      ratio && ratio.w > 0 && ratio.h > 0\n        ? `${((100 * ratio.h) / ratio.w).toFixed(2)}`\n        : \"100\";\n    return 1 + Math.floor(Number(ar) / 25) || 3;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._connected = true;\n    if (this.hasUpdated) {\n      this.loadMap();\n      this._attachObserver();\n    }\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._connected = false;\n\n    if (this._leafletMap) {\n      this._leafletMap.remove();\n      this._leafletMap = undefined;\n      this.Leaflet = undefined;\n    }\n\n    if (this._resizeObserver) {\n      this._resizeObserver.unobserve(this._mapEl);\n    } else {\n      window.removeEventListener(\"resize\", this._debouncedResizeListener);\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n    return html`\n      <ha-card id=\"card\" .header=${this._config.title}>\n        <div id=\"root\">\n          <div id=\"map\"></div>\n          <paper-icon-button\n            @click=${this._fitMap}\n            icon=\"hass:image-filter-center-focus\"\n            title=\"Reset focus\"\n          ></paper-icon-button>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues): void {\n    super.firstUpdated(changedProps);\n    this.loadMap();\n    const root = this.shadowRoot!.getElementById(\"root\");\n\n    if (!this._config || this.isPanel || !root) {\n      return;\n    }\n\n    if (this._connected) {\n      this._attachObserver();\n    }\n\n    const ratio = parseAspectRatio(this._config.aspect_ratio);\n\n    root.style.paddingBottom =\n      ratio && ratio.w > 0 && ratio.h > 0\n        ? `${((100 * ratio.h) / ratio.w).toFixed(2)}%`\n        : (root.style.paddingBottom = \"100%\");\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    if (changedProps.has(\"hass\")) {\n      this._drawEntities();\n    }\n  }\n\n  private get _mapEl(): HTMLDivElement {\n    return this.shadowRoot!.getElementById(\"map\") as HTMLDivElement;\n  }\n\n  private async loadMap(): Promise<void> {\n    [this._leafletMap, this.Leaflet] = await setupLeafletMap(this._mapEl);\n    this._drawEntities();\n    this._leafletMap.invalidateSize();\n    this._fitMap();\n  }\n\n  private _fitMap(): void {\n    if (!this._leafletMap || !this.Leaflet || !this._config || !this.hass) {\n      return;\n    }\n    const zoom = this._config.default_zoom;\n    if (this._mapItems.length === 0) {\n      this._leafletMap.setView(\n        new this.Leaflet.LatLng(\n          this.hass.config.latitude,\n          this.hass.config.longitude\n        ),\n        zoom || 14\n      );\n      return;\n    }\n\n    const bounds = this.Leaflet.latLngBounds(\n      this._mapItems ? this._mapItems.map((item) => item.getLatLng()) : []\n    );\n    this._leafletMap.fitBounds(bounds.pad(0.5));\n\n    if (zoom && this._leafletMap.getZoom() > zoom) {\n      this._leafletMap.setZoom(zoom);\n    }\n  }\n\n  private _drawEntities(): void {\n    const hass = this.hass;\n    const map = this._leafletMap;\n    const config = this._config;\n    const Leaflet = this.Leaflet;\n    if (!hass || !map || !config || !Leaflet) {\n      return;\n    }\n\n    if (this._mapItems) {\n      this._mapItems.forEach((marker) => marker.remove());\n    }\n    const mapItems: Layer[] = (this._mapItems = []);\n\n    const allEntities = this._configEntities!.concat();\n\n    // Calculate visible geo location sources\n    if (config.geo_location_sources) {\n      const includesAll = config.geo_location_sources.includes(\"all\");\n      for (const entityId of Object.keys(hass.states)) {\n        const stateObj = hass.states[entityId];\n        if (\n          computeDomain(entityId) === \"geo_location\" &&\n          (includesAll ||\n            config.geo_location_sources.includes(stateObj.attributes.source))\n        ) {\n          allEntities.push({ entity: entityId });\n        }\n      }\n    }\n\n    for (const entity of allEntities) {\n      const entityId = entity.entity;\n      const stateObj = hass.states[entityId];\n      if (!stateObj) {\n        continue;\n      }\n      const title = computeStateName(stateObj);\n      const {\n        latitude,\n        longitude,\n        passive,\n        icon,\n        radius,\n        entity_picture: entityPicture,\n        gps_accuracy: gpsAccuracy,\n      } = stateObj.attributes;\n\n      if (!(latitude && longitude)) {\n        continue;\n      }\n\n      if (computeStateDomain(stateObj) === \"zone\") {\n        // DRAW ZONE\n        if (passive) {\n          continue;\n        }\n\n        // create marker with the icon\n        mapItems.push(\n          Leaflet.marker([latitude, longitude], {\n            icon: Leaflet.divIcon({\n              html: icon ? `<ha-icon icon=\"${icon}\"></ha-icon>` : title,\n              iconSize: [24, 24],\n              className: \"\",\n            }),\n            interactive: false,\n            title,\n          })\n        );\n\n        // create circle around it\n        mapItems.push(\n          Leaflet.circle([latitude, longitude], {\n            interactive: false,\n            color: \"#FF9800\",\n            radius,\n          })\n        );\n\n        continue;\n      }\n\n      // DRAW ENTITY\n      // create icon\n      const entityName = title\n        .split(\" \")\n        .map((part) => part[0])\n        .join(\"\")\n        .substr(0, 3);\n\n      // create market with the icon\n      mapItems.push(\n        Leaflet.marker([latitude, longitude], {\n          icon: Leaflet.divIcon({\n            // Leaflet clones this element before adding it to the map. This messes up\n            // our Polymer object and we can't pass data through. Thus we hack like this.\n            html: `\n              <ha-entity-marker\n                entity-id=\"${entityId}\"\n                entity-name=\"${entityName}\"\n                entity-picture=\"${entityPicture || \"\"}\"\n              ></ha-entity-marker>\n            `,\n            iconSize: [48, 48],\n            className: \"\",\n          }),\n          title: computeStateName(stateObj),\n        })\n      );\n\n      // create circle around if entity has accuracy\n      if (gpsAccuracy) {\n        mapItems.push(\n          Leaflet.circle([latitude, longitude], {\n            interactive: false,\n            color: \"#0288D1\",\n            radius: gpsAccuracy,\n          })\n        );\n      }\n    }\n\n    this._mapItems.forEach((marker) => map.addLayer(marker));\n  }\n\n  private _attachObserver(): void {\n    // Observe changes to map size and invalidate to prevent broken rendering\n    // Uses ResizeObserver in Chrome, otherwise window resize event\n\n    // @ts-ignore\n    if (typeof ResizeObserver === \"function\") {\n      // @ts-ignore\n      this._resizeObserver = new ResizeObserver(() =>\n        this._debouncedResizeListener()\n      );\n      this._resizeObserver.observe(this._mapEl);\n    } else {\n      window.addEventListener(\"resize\", this._debouncedResizeListener);\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host([ispanel]) ha-card {\n        left: 0;\n        top: 0;\n        width: 100%;\n        /**\n       * In panel mode we want a full height map. Since parent #view\n       * only sets min-height, we need absolute positioning here\n       */\n        height: 100%;\n        position: absolute;\n      }\n\n      ha-card {\n        overflow: hidden;\n      }\n\n      #map {\n        z-index: 0;\n        border: none;\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n      }\n\n      paper-icon-button {\n        position: absolute;\n        top: 75px;\n        left: 7px;\n      }\n\n      #root {\n        position: relative;\n      }\n\n      :host([ispanel]) #root {\n        height: 100%;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-map-card\": HuiMapCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-markdown\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { MarkdownCardConfig } from \"./types\";\n\n@customElement(\"hui-markdown-card\")\nexport class HuiMarkdownCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-markdown-card-editor\" */ \"../editor/config-elements/hui-markdown-card-editor\");\n    return document.createElement(\"hui-markdown-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { content: \" \" };\n  }\n\n  @property() private _config?: MarkdownCardConfig;\n\n  public getCardSize(): number {\n    return this._config!.content.split(\"\\n\").length;\n  }\n\n  public setConfig(config: MarkdownCardConfig): void {\n    if (!config.content) {\n      throw new Error(\"Invalid Configuration: Content Required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <ha-markdown\n          class=\"markdown ${classMap({\n            \"no-header\": !this._config.title,\n          })}\"\n          .content=\"${this._config.content}\"\n        ></ha-markdown>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        /* start paper-font-body1 style */\n        font-family: \"Roboto\", \"Noto\", sans-serif;\n        -webkit-font-smoothing: antialiased; /* OS X subpixel AA bleed bug */\n        font-size: 14px;\n        font-weight: 400;\n        line-height: 20px;\n        /* end paper-font-body1 style */\n      }\n      ha-markdown {\n        display: block;\n        padding: 0 16px 16px;\n        -ms-user-select: initial;\n        -webkit-user-select: initial;\n        -moz-user-select: initial;\n      }\n      .markdown.no-header {\n        padding-top: 16px;\n      }\n      ha-markdown > *:first-child {\n        margin-top: 0;\n      }\n      ha-markdown > *:last-child {\n        margin-bottom: 0;\n      }\n      ha-markdown a {\n        color: var(--primary-color);\n      }\n      ha-markdown img {\n        max-width: 100%;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-markdown-card\": HuiMarkdownCard;\n  }\n}\n","import \"../../../cards/ha-media_player-card\";\n\nimport LegacyWrapperCard from \"./hui-legacy-wrapper-card\";\n\nclass HuiMediaControlCard extends LegacyWrapperCard {\n  static async getConfigElement() {\n    await import(/* webpackChunkName: \"hui-media-control-card-editor\" */ \"../editor/config-elements/hui-media-control-card-editor\");\n    return document.createElement(\"hui-media-control-card-editor\");\n  }\n\n  static getStubConfig() {\n    return {};\n  }\n\n  constructor() {\n    super(\"ha-media_player-card\", \"media_player\");\n  }\n}\n\ncustomElements.define(\"hui-media-control-card\", HuiMediaControlCard);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../components/ha-card\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { PictureCardConfig } from \"./types\";\n\n@customElement(\"hui-picture-card\")\nexport class HuiPictureCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-picture-card-editor\" */ \"../editor/config-elements/hui-picture-card-editor\");\n    return document.createElement(\"hui-picture-card-editor\");\n  }\n  public static getStubConfig(): object {\n    return {\n      image:\n        \"https://www.home-assistant.io/images/merchandise/shirt-frontpage.png\",\n      tap_action: { action: \"none\" },\n      hold_action: { action: \"none\" },\n    };\n  }\n\n  public hass?: HomeAssistant;\n\n  @property() protected _config?: PictureCardConfig;\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PictureCardConfig): void {\n    if (!config || !config.image) {\n      throw new Error(\"Invalid Configuration: 'image' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-card\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n        class=\"${classMap({\n          clickable: Boolean(\n            this._config.tap_action || this._config.hold_action\n          ),\n        })}\"\n      >\n        <img src=\"${this._config.image}\" />\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        overflow: hidden;\n      }\n\n      ha-card.clickable {\n        cursor: pointer;\n      }\n\n      img {\n        display: block;\n        width: 100%;\n      }\n    `;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-card\": HuiPictureCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { createStyledHuiElement } from \"./picture-elements/create-styled-hui-element\";\nimport { LovelaceCard } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceElementConfig, LovelaceElement } from \"../elements/types\";\nimport { PictureElementsCardConfig } from \"./types\";\n\n@customElement(\"hui-picture-elements-card\")\nclass HuiPictureElementsCard extends LitElement implements LovelaceCard {\n  @property() private _config?: PictureElementsCardConfig;\n\n  private _hass?: HomeAssistant;\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n    for (const el of this.shadowRoot!.querySelectorAll(\"#root > *\")) {\n      const element = el as LovelaceElement;\n      element.hass = this._hass;\n    }\n  }\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: PictureElementsCardConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid Configuration\");\n    } else if (\n      !(config.image || config.camera_image || config.state_image) ||\n      (config.state_image && !config.entity)\n    ) {\n      throw new Error(\"Invalid Configuration: image required\");\n    } else if (!Array.isArray(config.elements)) {\n      throw new Error(\"Invalid Configuration: elements required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <div id=\"root\">\n          <hui-image\n            .hass=\"${this._hass}\"\n            .image=\"${this._config.image}\"\n            .stateImage=\"${this._config.state_image}\"\n            .cameraImage=\"${this._config.camera_image}\"\n            .cameraView=\"${this._config.camera_view}\"\n            .entity=\"${this._config.entity}\"\n            .aspectRatio=\"${this._config.aspect_ratio}\"\n          ></hui-image>\n          ${this._config.elements.map(\n            (elementConfig: LovelaceElementConfig) => {\n              const element = createStyledHuiElement(elementConfig);\n              element.hass = this._hass;\n\n              return element;\n            }\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      #root {\n        position: relative;\n      }\n\n      .element {\n        position: absolute;\n        transform: translate(-50%, -50%);\n      }\n\n      ha-card {\n        overflow: hidden;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-elements-card\": HuiPictureElementsCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport \"../../../components/ha-card\";\nimport \"../components/hui-image\";\nimport \"../components/hui-warning\";\n\nimport computeDomain from \"../../../common/entity/compute_domain\";\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard } from \"../types\";\nimport { handleClick } from \"../common/handle-click\";\nimport { UNAVAILABLE } from \"../../../data/entity\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { PictureEntityCardConfig } from \"./types\";\n\n@customElement(\"hui-picture-entity-card\")\nclass HuiPictureEntityCard extends LitElement implements LovelaceCard {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: PictureEntityCardConfig;\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PictureEntityCardConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    if (\n      computeDomain(config.entity) !== \"camera\" &&\n      (!config.image && !config.state_image && !config.camera_image)\n    ) {\n      throw new Error(\"No image source configured.\");\n    }\n\n    this._config = { show_name: true, show_state: true, ...config };\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    const name = this._config.name || computeStateName(stateObj);\n    const state = computeStateDisplay(\n      this.hass!.localize,\n      stateObj,\n      this.hass.language\n    );\n\n    let footer: TemplateResult | string = \"\";\n    if (this._config.show_name && this._config.show_state) {\n      footer = html`\n        <div class=\"footer both\">\n          <div>${name}</div>\n          <div>${state}</div>\n        </div>\n      `;\n    } else if (this._config.show_name) {\n      footer = html`\n        <div class=\"footer\">${name}</div>\n      `;\n    } else if (this._config.show_state) {\n      footer = html`\n        <div class=\"footer state\">${state}</div>\n      `;\n    }\n\n    return html`\n      <ha-card>\n        <hui-image\n          .hass=\"${this.hass}\"\n          .image=\"${this._config.image}\"\n          .stateImage=\"${this._config.state_image}\"\n          .cameraImage=\"${computeDomain(this._config.entity) === \"camera\"\n            ? this._config.entity\n            : this._config.camera_image}\"\n          .cameraView=\"${this._config.camera_view}\"\n          .entity=\"${this._config.entity}\"\n          .aspectRatio=\"${this._config.aspect_ratio}\"\n          @ha-click=\"${this._handleTap}\"\n          @ha-hold=\"${this._handleHold}\"\n          .longPress=\"${longPress()}\"\n          class=\"${classMap({\n            clickable: stateObj.state !== UNAVAILABLE,\n          })}\"\n        ></hui-image>\n        ${footer}\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        min-height: 75px;\n        overflow: hidden;\n        position: relative;\n      }\n\n      hui-image.clickable {\n        cursor: pointer;\n      }\n\n      .footer {\n        /* start paper-font-common-nowrap style */\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        /* end paper-font-common-nowrap style */\n\n        position: absolute;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: rgba(0, 0, 0, 0.3);\n        padding: 16px;\n        font-size: 16px;\n        line-height: 16px;\n        color: white;\n      }\n\n      .both {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .state {\n        text-align: right;\n      }\n    `;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-entity-card\": HuiPictureEntityCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\nimport stateIcon from \"../../../common/entity/state_icon\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-image\";\nimport \"../components/hui-warning-element\";\n\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { LovelaceCard } from \"../types\";\nimport { EntityConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { processConfigEntities } from \"../common/process-config-entities\";\nimport { handleClick } from \"../common/handle-click\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { toggleEntity } from \"../common/entity/toggle-entity\";\nimport { PictureGlanceCardConfig } from \"./types\";\n\nconst STATES_OFF = new Set([\"closed\", \"locked\", \"not_home\", \"off\"]);\n\n@customElement(\"hui-picture-glance-card\")\nclass HuiPictureGlanceCard extends LitElement implements LovelaceCard {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: PictureGlanceCardConfig;\n\n  private _entitiesDialog?: EntityConfig[];\n\n  private _entitiesToggle?: EntityConfig[];\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PictureGlanceCardConfig): void {\n    if (\n      !config ||\n      !config.entities ||\n      !Array.isArray(config.entities) ||\n      !(config.image || config.camera_image || config.state_image) ||\n      (config.state_image && !config.entity)\n    ) {\n      throw new Error(\"Invalid card configuration\");\n    }\n\n    const entities = processConfigEntities(config.entities);\n    this._entitiesDialog = [];\n    this._entitiesToggle = [];\n\n    entities.forEach((item) => {\n      if (\n        config.force_dialog ||\n        !DOMAINS_TOGGLE.has(computeDomain(item.entity))\n      ) {\n        this._entitiesDialog!.push(item);\n      } else {\n        this._entitiesToggle!.push(item);\n      }\n    });\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_config\")) {\n      return true;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass) {\n      return true;\n    }\n\n    if (this._entitiesDialog) {\n      for (const entity of this._entitiesDialog) {\n        if (\n          oldHass.states[entity.entity] !== this.hass!.states[entity.entity]\n        ) {\n          return true;\n        }\n      }\n    }\n\n    if (this._entitiesToggle) {\n      for (const entity of this._entitiesToggle) {\n        if (\n          oldHass.states[entity.entity] !== this.hass!.states[entity.entity]\n        ) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-card>\n        <hui-image\n          class=\"${classMap({\n            clickable: Boolean(\n              this._config.tap_action ||\n                this._config.hold_action ||\n                this._config.camera_image\n            ),\n          })}\"\n          @ha-click=\"${this._handleTap}\"\n          @ha-hold=\"${this._handleHold}\"\n          .longPress=\"${longPress()}\"\n          .hass=\"${this.hass}\"\n          .image=\"${this._config.image}\"\n          .stateImage=\"${this._config.state_image}\"\n          .cameraImage=\"${this._config.camera_image}\"\n          .cameraView=\"${this._config.camera_view}\"\n          .entity=\"${this._config.entity}\"\n          .aspectRatio=\"${this._config.aspect_ratio}\"\n        ></hui-image>\n        <div class=\"box\">\n          ${this._config.title\n            ? html`\n                <div class=\"title\">${this._config.title}</div>\n              `\n            : \"\"}\n          <div>\n            ${this._entitiesDialog!.map((entityConf) =>\n              this.renderEntity(entityConf, true)\n            )}\n          </div>\n          <div>\n            ${this._entitiesToggle!.map((entityConf) =>\n              this.renderEntity(entityConf, false)\n            )}\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  private renderEntity(\n    entityConf: EntityConfig,\n    dialog: boolean\n  ): TemplateResult {\n    const stateObj = this.hass!.states[entityConf.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass!.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            entityConf.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <ha-icon\n        .entity=\"${stateObj.entity_id}\"\n        @click=\"${dialog ? this._openDialog : this._callService}\"\n        class=\"${classMap({\n          \"state-on\": !STATES_OFF.has(stateObj.state),\n        })}\"\n        .icon=\"${entityConf.icon || stateIcon(stateObj)}\"\n        title=\"${`\n            ${computeStateName(stateObj)} : ${computeStateDisplay(\n          this.hass!.localize,\n          stateObj,\n          this.hass!.language\n        )}\n          `}\"\n      ></ha-icon>\n    `;\n  }\n\n  private _handleTap() {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold() {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n\n  private _openDialog(ev: MouseEvent): void {\n    fireEvent(this, \"hass-more-info\", { entityId: (ev.target as any).entity });\n  }\n\n  private _callService(ev: MouseEvent): void {\n    toggleEntity(this.hass!, (ev.target as any).entity);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-card {\n        position: relative;\n        min-height: 48px;\n        overflow: hidden;\n      }\n\n      hui-image.clickable {\n        cursor: pointer;\n      }\n\n      .box {\n        /* start paper-font-common-nowrap style */\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        /* end paper-font-common-nowrap style */\n\n        position: absolute;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: rgba(0, 0, 0, 0.3);\n        padding: 4px 8px;\n        font-size: 16px;\n        line-height: 40px;\n        color: white;\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .box .title {\n        font-weight: 500;\n        margin-left: 8px;\n      }\n\n      ha-icon {\n        cursor: pointer;\n        padding: 8px;\n        color: #a9a9a9;\n      }\n\n      ha-icon.state-on {\n        color: white;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-glance-card\": HuiPictureGlanceCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\n\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { LovelaceCardEditor, LovelaceCard } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { PlantStatusCardConfig, PlantAttributeTarget } from \"./types\";\n\nconst SENSORS = {\n  moisture: \"hass:water\",\n  temperature: \"hass:thermometer\",\n  brightness: \"hass:white-balance-sunny\",\n  conductivity: \"hass:emoticon-poop\",\n  battery: \"hass:battery\",\n};\n\n@customElement(\"hui-plant-status-card\")\nclass HuiPlantStatusCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-plant-status-card-editor\" */ \"../editor/config-elements/hui-plant-status-card-editor\");\n    return document.createElement(\"hui-plant-status-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: PlantStatusCardConfig;\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  public setConfig(config: PlantStatusCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"plant\") {\n      throw new Error(\"Specify an entity from within the plant domain.\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config!.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <ha-card\n        class=\"${stateObj.attributes.entity_picture ? \"has-plant-image\" : \"\"}\"\n      >\n        <div\n          class=\"banner\"\n          style=\"background-image:url(${stateObj.attributes.entity_picture})\"\n        >\n          <div class=\"header\">\n            ${this._config.name || computeStateName(stateObj)}\n          </div>\n        </div>\n        <div class=\"content\">\n          ${this.computeAttributes(stateObj).map(\n            (item) => html`\n              <div\n                class=\"attributes\"\n                @click=\"${this._handleMoreInfo}\"\n                .value=\"${item}\"\n              >\n                <div>\n                  <ha-icon\n                    icon=\"${this.computeIcon(\n                      item,\n                      stateObj.attributes.battery\n                    )}\"\n                  ></ha-icon>\n                </div>\n                <div\n                  class=\"${stateObj.attributes.problem.indexOf(item) === -1\n                    ? \"\"\n                    : \"problem\"}\"\n                >\n                  ${stateObj.attributes[item]}\n                </div>\n                <div class=\"uom\">\n                  ${stateObj.attributes.unit_of_measurement_dict[item] || \"\"}\n                </div>\n              </div>\n            `\n          )}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .banner {\n        display: flex;\n        align-items: flex-end;\n        background-repeat: no-repeat;\n        background-size: cover;\n        background-position: center;\n        padding-top: 12px;\n      }\n\n      .has-plant-image .banner {\n        padding-top: 30%;\n      }\n\n      .header {\n        /* start paper-font-headline style */\n        font-family: \"Roboto\", \"Noto\", sans-serif;\n        -webkit-font-smoothing: antialiased; /* OS X subpixel AA bleed bug */\n        text-rendering: optimizeLegibility;\n        font-size: 24px;\n        font-weight: 400;\n        letter-spacing: -0.012em;\n        /* end paper-font-headline style */\n\n        line-height: 40px;\n        padding: 8px 16px;\n      }\n\n      .has-plant-image .header {\n        font-size: 16px;\n        font-weight: 500;\n        line-height: 16px;\n        padding: 16px;\n        color: white;\n        width: 100%;\n        background: rgba(0, 0, 0, var(--dark-secondary-opacity));\n      }\n\n      .content {\n        display: flex;\n        justify-content: space-between;\n        padding: 16px 32px 24px 32px;\n      }\n\n      .has-plant-image .content {\n        padding-bottom: 16px;\n      }\n\n      ha-icon {\n        color: var(--paper-item-icon-color);\n        margin-bottom: 8px;\n      }\n\n      .attributes {\n        cursor: pointer;\n      }\n\n      .attributes div {\n        text-align: center;\n      }\n\n      .problem {\n        color: var(--google-red-500);\n        font-weight: bold;\n      }\n\n      .uom {\n        color: var(--secondary-text-color);\n      }\n    `;\n  }\n\n  private computeAttributes(stateObj: HassEntity): string[] {\n    return Object.keys(SENSORS).filter((key) => key in stateObj.attributes);\n  }\n\n  private computeIcon(attr: string, batLvl: number): string {\n    const icon = SENSORS[attr];\n    if (attr === \"battery\") {\n      if (batLvl <= 5) {\n        return `${icon}-alert`;\n      }\n      if (batLvl < 95) {\n        return `${icon}-${Math.round(batLvl / 10 - 0.01) * 10}`;\n      }\n    }\n    return icon;\n  }\n\n  private _handleMoreInfo(ev: Event): void {\n    const target = ev.currentTarget! as PlantAttributeTarget;\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (target.value) {\n      fireEvent(this, \"hass-more-info\", {\n        entityId: stateObj.attributes.sensors[target.value],\n      });\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-plant-status-card\": HuiPlantStatusCard;\n  }\n}\n","import {\n  html,\n  svg,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport \"@polymer/paper-spinner/paper-spinner\";\n\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport stateIcon from \"../../../common/entity/state_icon\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { fetchRecent } from \"../../../data/history\";\nimport { SensorCardConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\nconst midPoint = (\n  _Ax: number,\n  _Ay: number,\n  _Bx: number,\n  _By: number\n): number[] => {\n  const _Zx = (_Ax - _Bx) / 2 + _Bx;\n  const _Zy = (_Ay - _By) / 2 + _By;\n  return [_Zx, _Zy];\n};\n\nconst getPath = (coords: number[][]): string => {\n  let next;\n  let Z;\n  const X = 0;\n  const Y = 1;\n  let path = \"\";\n  let last = coords.filter(Boolean)[0];\n\n  path += `M ${last[X]},${last[Y]}`;\n\n  for (const coord of coords) {\n    next = coord;\n    Z = midPoint(last[X], last[Y], next[X], next[Y]);\n    path += ` ${Z[X]},${Z[Y]}`;\n    path += ` Q${next[X]},${next[Y]}`;\n    last = next;\n  }\n\n  path += ` ${next[X]},${next[Y]}`;\n  return path;\n};\n\nconst calcPoints = (\n  history: any,\n  hours: number,\n  width: number,\n  detail: number,\n  min: number,\n  max: number\n): number[][] => {\n  const coords = [] as number[][];\n  const margin = 5;\n  const height = 80;\n  width -= 10;\n  let yRatio = (max - min) / height;\n  yRatio = yRatio !== 0 ? yRatio : height;\n  let xRatio = width / (hours - (detail === 1 ? 1 : 0));\n  xRatio = isFinite(xRatio) ? xRatio : width;\n  const getCoords = (item, i, offset = 0, depth = 1) => {\n    if (depth > 1) {\n      return item.forEach((subItem, index) =>\n        getCoords(subItem, i, index, depth - 1)\n      );\n    }\n    const average =\n      item.reduce((sum, entry) => sum + parseFloat(entry.state), 0) /\n      item.length;\n\n    const x = xRatio * (i + offset / 6) + margin;\n    const y = height - (average - min) / yRatio + margin * 2;\n    return coords.push([x, y]);\n  };\n\n  history.forEach((item, i) => getCoords(item, i, 0, detail));\n  if (coords.length === 1) {\n    coords[1] = [width + margin, coords[0][1]];\n  }\n\n  coords.push([width + margin, coords[coords.length - 1][1]]);\n  return coords;\n};\n\nconst coordinates = (\n  history: any,\n  hours: number,\n  width: number,\n  detail: number\n): number[][] => {\n  history.forEach((item) => (item.state = Number(item.state)));\n  history = history.filter((item) => !Number.isNaN(item.state));\n\n  const min = Math.min.apply(Math, history.map((item) => item.state));\n  const max = Math.max.apply(Math, history.map((item) => item.state));\n  const now = new Date().getTime();\n\n  const reduce = (res, item, point) => {\n    const age = now - new Date(item.last_changed).getTime();\n\n    let key = Math.abs(age / (1000 * 3600) - hours);\n    if (point) {\n      key = (key - Math.floor(key)) * 60;\n      key = Number((Math.round(key / 10) * 10).toString()[0]);\n    } else {\n      key = Math.floor(key);\n    }\n    if (!res[key]) {\n      res[key] = [];\n    }\n    res[key].push(item);\n    return res;\n  };\n\n  history = history.reduce((res, item) => reduce(res, item, false), []);\n  if (detail > 1) {\n    history = history.map((entry) =>\n      entry.reduce((res, item) => reduce(res, item, true), [])\n    );\n  }\n  return calcPoints(history, hours, width, detail, min, max);\n};\n\n@customElement(\"hui-sensor-card\")\nclass HuiSensorCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-sensor-card-editor\" */ \"../editor/config-elements/hui-sensor-card-editor\");\n    return document.createElement(\"hui-sensor-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: SensorCardConfig;\n\n  @property() private _history?: any;\n\n  private _date?: Date;\n\n  public setConfig(config: SensorCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"sensor\") {\n      throw new Error(\"Specify an entity from within the sensor domain.\");\n    }\n\n    const cardConfig = {\n      detail: 1,\n      theme: \"default\",\n      hours_to_show: 24,\n      ...config,\n    };\n\n    cardConfig.hours_to_show = Number(cardConfig.hours_to_show);\n    cardConfig.detail =\n      cardConfig.detail === 1 || cardConfig.detail === 2\n        ? cardConfig.detail\n        : 1;\n\n    this._config = cardConfig;\n  }\n\n  public getCardSize(): number {\n    return 3;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    let graph;\n\n    if (stateObj && this._config.graph === \"line\") {\n      if (!stateObj.attributes.unit_of_measurement) {\n        return html`\n          <hui-warning\n            >Entity: ${this._config.entity} - Has no Unit of Measurement and\n            therefore can not display a line graph.</hui-warning\n          >\n        `;\n      } else if (!this._history) {\n        graph = svg`\n          <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 500 100\"></svg>\n        `;\n      } else {\n        graph = svg`\n          <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 500 100\">\n            <path\n              d=\"${this._history}\"\n              fill=\"none\"\n              stroke=\"var(--accent-color)\"\n              stroke-width=\"5\"\n              stroke-linecap=\"round\"\n              stroke-linejoin=\"round\"\n            />\n          </svg>\n        `;\n      }\n    } else {\n      graph = \"\";\n    }\n    return html`\n      <ha-card @click=\"${this._handleClick}\">\n        <div class=\"flex\">\n          <div class=\"icon\">\n            <ha-icon\n              .icon=\"${this._config.icon || stateIcon(stateObj)}\"\n            ></ha-icon>\n          </div>\n          <div class=\"header\">\n            <span class=\"name\"\n              >${this._config.name || computeStateName(stateObj)}</span\n            >\n          </div>\n        </div>\n        <div class=\"flex info\">\n          <span id=\"value\">${stateObj.state}</span>\n          <span id=\"measurement\"\n            >${this._config.unit ||\n              stateObj.attributes.unit_of_measurement}</span\n          >\n        </div>\n        <div class=\"graph\"><div>${graph}</div></div>\n      </ha-card>\n    `;\n  }\n\n  protected firstUpdated(): void {\n    this._date = new Date();\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_history\")) {\n      return true;\n    }\n\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n    if (!this._config || this._config.graph !== \"line\" || !this.hass) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config!.theme);\n    }\n\n    const minute = 60000;\n    if (changedProps.has(\"_config\")) {\n      this._getHistory();\n    } else if (Date.now() - this._date!.getTime() >= minute) {\n      this._getHistory();\n    }\n  }\n\n  private _handleClick(): void {\n    fireEvent(this, \"hass-more-info\", { entityId: this._config!.entity });\n  }\n\n  private async _getHistory(): Promise<void> {\n    const endTime = new Date();\n    const startTime = new Date();\n    startTime.setHours(endTime.getHours() - this._config!.hours_to_show!);\n\n    const stateHistory = await fetchRecent(\n      this.hass,\n      this._config!.entity,\n      startTime,\n      endTime\n    );\n\n    if (stateHistory.length < 1 || stateHistory[0].length < 1) {\n      return;\n    }\n\n    const coords = coordinates(\n      stateHistory[0],\n      this._config!.hours_to_show!,\n      500,\n      this._config!.detail!\n    );\n\n    this._history = getPath(coords);\n    this._date = new Date();\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        flex-direction: column;\n      }\n\n      ha-card {\n        display: flex;\n        flex-direction: column;\n        flex: 1;\n        padding: 16px;\n        position: relative;\n        cursor: pointer;\n      }\n\n      .flex {\n        display: flex;\n      }\n\n      .header {\n        align-items: center;\n        display: flex;\n        min-width: 0;\n        opacity: 0.8;\n        position: relative;\n      }\n\n      .name {\n        display: block;\n        display: -webkit-box;\n        font-size: 1.2rem;\n        font-weight: 500;\n        max-height: 1.4rem;\n        margin-top: 2px;\n        opacity: 0.8;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        -webkit-line-clamp: 1;\n        -webkit-box-orient: vertical;\n        word-wrap: break-word;\n        word-break: break-all;\n      }\n\n      .icon {\n        color: var(--paper-item-icon-color, #44739e);\n        display: inline-block;\n        flex: 0 0 40px;\n        line-height: 40px;\n        position: relative;\n        text-align: center;\n        width: 40px;\n      }\n\n      .info {\n        flex-wrap: wrap;\n        margin: 16px 0 16px 8px;\n      }\n\n      #value {\n        display: inline-block;\n        font-size: 2rem;\n        font-weight: 400;\n        line-height: 1em;\n        margin-right: 4px;\n      }\n\n      #measurement {\n        align-self: flex-end;\n        display: inline-block;\n        font-size: 1.3rem;\n        line-height: 1.2em;\n        margin-top: 0.1em;\n        opacity: 0.6;\n        vertical-align: bottom;\n      }\n\n      .graph {\n        align-self: flex-end;\n        margin: auto;\n        margin-bottom: 0px;\n        position: relative;\n        width: 100%;\n      }\n\n      .graph > div {\n        align-self: flex-end;\n        margin: auto 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-sensor-card\": HuiSensorCard;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport { repeat } from \"lit-html/directives/repeat\";\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\nimport \"@polymer/paper-checkbox/paper-checkbox\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport {\n  fetchItems,\n  updateItem,\n  ShoppingListItem,\n  clearItems,\n  addItem,\n} from \"../../../data/shopping-list\";\nimport { ShoppingListCardConfig } from \"./types\";\n\n@customElement(\"hui-shopping-list-card\")\nclass HuiShoppingListCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-shopping-list-editor\" */ \"../editor/config-elements/hui-shopping-list-editor\");\n    return document.createElement(\"hui-shopping-list-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return {};\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: ShoppingListCardConfig;\n\n  @property() private _uncheckedItems?: ShoppingListItem[];\n\n  @property() private _checkedItems?: ShoppingListItem[];\n\n  private _unsubEvents?: Promise<() => Promise<void>>;\n\n  public getCardSize(): number {\n    return (this._config ? (this._config.title ? 1 : 0) : 0) + 3;\n  }\n\n  public setConfig(config: ShoppingListCardConfig): void {\n    this._config = config;\n    this._uncheckedItems = [];\n    this._checkedItems = [];\n    this._fetchData();\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n\n    if (this.hass) {\n      this._unsubEvents = this.hass.connection.subscribeEvents(\n        () => this._fetchData(),\n        \"shopping_list_updated\"\n      );\n      this._fetchData();\n    }\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n\n    if (this._unsubEvents) {\n      this._unsubEvents.then((unsub) => unsub());\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=\"${this._config.title}\">\n        <div class=\"addRow\">\n          <ha-icon\n            class=\"addButton\"\n            @click=\"${this._addItem}\"\n            icon=\"hass:plus\"\n            .title=\"${this.hass!.localize(\n              \"ui.panel.lovelace.cards.shopping-list.add_item\"\n            )}\"\n          >\n          </ha-icon>\n          <paper-item-body>\n            <paper-input\n              no-label-float\n              class=\"addBox\"\n              placeholder=\"${this.hass!.localize(\n                \"ui.panel.lovelace.cards.shopping-list.add_item\"\n              )}\"\n              @keydown=\"${this._addKeyPress}\"\n            ></paper-input>\n          </paper-item-body>\n        </div>\n        ${repeat(\n          this._uncheckedItems!,\n          (item) => item.id,\n          (item, index) =>\n            html`\n              <div class=\"editRow\">\n                <paper-checkbox\n                  slot=\"item-icon\"\n                  id=\"${index}\"\n                  ?checked=\"${item.complete}\"\n                  .itemId=\"${item.id}\"\n                  @click=\"${this._completeItem}\"\n                  tabindex=\"0\"\n                ></paper-checkbox>\n                <paper-item-body>\n                  <paper-input\n                    no-label-float\n                    .value=\"${item.name}\"\n                    .itemId=\"${item.id}\"\n                    @change=\"${this._saveEdit}\"\n                  ></paper-input>\n                </paper-item-body>\n              </div>\n            `\n        )}\n        ${this._checkedItems!.length > 0\n          ? html`\n              <div class=\"divider\"></div>\n              <div class=\"checked\">\n                <span class=\"label\">\n                  ${this.hass!.localize(\n                    \"ui.panel.lovelace.cards.shopping-list.checked_items\"\n                  )}\n                </span>\n                <ha-icon\n                  class=\"clearall\"\n                  @click=\"${this._clearItems}\"\n                  icon=\"hass:notification-clear-all\"\n                  .title=\"${this.hass!.localize(\n                    \"ui.panel.lovelace.cards.shopping-list.clear_items\"\n                  )}\"\n                >\n                </ha-icon>\n              </div>\n              ${repeat(\n                this._checkedItems!,\n                (item) => item.id,\n                (item, index) =>\n                  html`\n                    <div class=\"editRow\">\n                      <paper-checkbox\n                        slot=\"item-icon\"\n                        id=\"${index}\"\n                        ?checked=\"${item.complete}\"\n                        .itemId=\"${item.id}\"\n                        @click=\"${this._completeItem}\"\n                        tabindex=\"0\"\n                      ></paper-checkbox>\n                      <paper-item-body>\n                        <paper-input\n                          no-label-float\n                          .value=\"${item.name}\"\n                          .itemId=\"${item.id}\"\n                          @change=\"${this._saveEdit}\"\n                        ></paper-input>\n                      </paper-item-body>\n                    </div>\n                  `\n              )}\n            `\n          : \"\"}\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .editRow,\n      .addRow {\n        display: flex;\n        flex-direction: row;\n      }\n\n      .addButton {\n        padding: 9px 15px 11px 15px;\n        cursor: pointer;\n      }\n\n      paper-item-body {\n        width: 75%;\n      }\n\n      paper-checkbox {\n        padding: 11px 11px 11px 18px;\n      }\n\n      paper-input {\n        --paper-input-container-underline: {\n          display: none;\n        }\n        --paper-input-container-underline-focus: {\n          display: none;\n        }\n        --paper-input-container-underline-disabled: {\n          display: none;\n        }\n        position: relative;\n        top: 1px;\n      }\n\n      .checked {\n        margin-left: 17px;\n        margin-bottom: 11px;\n        margin-top: 11px;\n      }\n\n      .label {\n        color: var(--primary-color);\n      }\n\n      .divider {\n        height: 1px;\n        background-color: var(--divider-color);\n        margin: 10px;\n      }\n\n      .clearall {\n        cursor: pointer;\n        margin-bottom: 3px;\n        float: right;\n        padding-right: 10px;\n      }\n\n      .addRow > ha-icon {\n        color: var(--secondary-text-color);\n      }\n    `;\n  }\n\n  private async _fetchData(): Promise<void> {\n    if (this.hass) {\n      const checkedItems: ShoppingListItem[] = [];\n      const uncheckedItems: ShoppingListItem[] = [];\n      const items = await fetchItems(this.hass);\n      for (const key in items) {\n        if (items[key].complete) {\n          checkedItems.push(items[key]);\n        } else {\n          uncheckedItems.push(items[key]);\n        }\n      }\n      this._checkedItems = checkedItems;\n      this._uncheckedItems = uncheckedItems;\n    }\n  }\n\n  private _completeItem(ev): void {\n    updateItem(this.hass!, ev.target.itemId, {\n      complete: ev.target.checked,\n    }).catch(() => this._fetchData());\n  }\n\n  private _saveEdit(ev): void {\n    updateItem(this.hass!, ev.target.itemId, {\n      name: ev.target.value,\n    }).catch(() => this._fetchData());\n\n    ev.target.blur();\n  }\n\n  private _clearItems(): void {\n    if (this.hass) {\n      clearItems(this.hass).catch(() => this._fetchData());\n    }\n  }\n\n  private get _newItem(): PaperInputElement {\n    return this.shadowRoot!.querySelector(\".addBox\") as PaperInputElement;\n  }\n\n  private _addItem(ev): void {\n    const newItem = this._newItem;\n\n    if (newItem.value!.length > 0) {\n      addItem(this.hass!, newItem.value!).catch(() => this._fetchData());\n    }\n\n    newItem.value = \"\";\n    if (ev) {\n      newItem.focus();\n    }\n  }\n\n  private _addKeyPress(ev): void {\n    if (ev.keyCode === 13) {\n      this._addItem(null);\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-shopping-list-card\": HuiShoppingListCard;\n  }\n}\n","import { html, LitElement, TemplateResult } from \"lit-element\";\n\nimport { createCardElement } from \"../common/create-card-element\";\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\nimport { HomeAssistant } from \"../../../types\";\nimport { StackCardConfig } from \"./types\";\n\nexport abstract class HuiStackCard extends LitElement implements LovelaceCard {\n  static get properties() {\n    return {\n      _config: {},\n    };\n  }\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n\n    if (!this._cards) {\n      return;\n    }\n\n    for (const element of this._cards) {\n      element.hass = this._hass;\n    }\n  }\n  protected _cards?: LovelaceCard[];\n  private _config?: StackCardConfig;\n  private _hass?: HomeAssistant;\n\n  public abstract getCardSize(): number;\n\n  public setConfig(config: StackCardConfig): void {\n    if (!config || !config.cards || !Array.isArray(config.cards)) {\n      throw new Error(\"Card config incorrect\");\n    }\n    this._config = config;\n    this._cards = config.cards.map((card) => {\n      const element = this._createCardElement(card) as LovelaceCard;\n      return element;\n    });\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      ${this.renderStyle()}\n      <div id=\"root\">${this._cards}</div>\n    `;\n  }\n\n  protected abstract renderStyle(): TemplateResult;\n\n  private _createCardElement(cardConfig: LovelaceCardConfig) {\n    const element = createCardElement(cardConfig) as LovelaceCard;\n    if (this._hass) {\n      element.hass = this._hass;\n    }\n    element.addEventListener(\n      \"ll-rebuild\",\n      (ev) => {\n        ev.stopPropagation();\n        this._rebuildCard(element, cardConfig);\n      },\n      { once: true }\n    );\n    return element;\n  }\n\n  private _rebuildCard(\n    cardElToReplace: LovelaceCard,\n    config: LovelaceCardConfig\n  ): void {\n    const newCardEl = this._createCardElement(config);\n    cardElToReplace.parentElement!.replaceChild(newCardEl, cardElToReplace);\n    this._cards = this._cards!.map((curCardEl) =>\n      curCardEl === cardElToReplace ? newCardEl : curCardEl\n    );\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport applyThemesOnElement from \"../../../common/dom/apply_themes_on_element\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { HomeAssistant, ClimateEntity } from \"../../../types\";\nimport { LovelaceCard, LovelaceCardEditor } from \"../types\";\nimport { loadRoundslider } from \"../../../resources/jquery.roundslider.ondemand\";\nimport { UNIT_F } from \"../../../common/const\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { ThermostatCardConfig } from \"./types\";\n\nconst thermostatConfig = {\n  radius: 150,\n  circleShape: \"pie\",\n  startAngle: 315,\n  width: 5,\n  lineCap: \"round\",\n  handleSize: \"+10\",\n  showTooltip: false,\n  animation: false,\n};\n\nconst modeIcons = {\n  auto: \"hass:autorenew\",\n  manual: \"hass:cursor-pointer\",\n  heat: \"hass:fire\",\n  cool: \"hass:snowflake\",\n  off: \"hass:power\",\n  fan_only: \"hass:fan\",\n  eco: \"hass:leaf\",\n  dry: \"hass:water-percent\",\n  idle: \"hass:power-sleep\",\n};\n\n@customElement(\"hui-thermostat-card\")\nexport class HuiThermostatCard extends LitElement implements LovelaceCard {\n  public static async getConfigElement(): Promise<LovelaceCardEditor> {\n    await import(/* webpackChunkName: \"hui-thermostat-card-editor\" */ \"../editor/config-elements/hui-thermostat-card-editor\");\n    return document.createElement(\"hui-thermostat-card-editor\");\n  }\n\n  public static getStubConfig(): object {\n    return { entity: \"\" };\n  }\n\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: ThermostatCardConfig;\n\n  @property() private _roundSliderStyle?: TemplateResult;\n\n  @property() private _jQuery?: any;\n\n  private _broadCard?: boolean;\n\n  private _loaded?: boolean;\n\n  private _updated?: boolean;\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: ThermostatCardConfig): void {\n    if (!config.entity || config.entity.split(\".\")[0] !== \"climate\") {\n      throw new Error(\"Specify an entity from within the climate domain.\");\n    }\n\n    this._config = { theme: \"default\", ...config };\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (this._updated && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n    const stateObj = this.hass.states[this._config.entity] as ClimateEntity;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    const mode = modeIcons[stateObj.attributes.operation_mode || \"\"]\n      ? stateObj.attributes.operation_mode!\n      : \"unknown-mode\";\n    return html`\n      ${this.renderStyle()}\n      <ha-card\n        class=\"${classMap({\n          [mode]: true,\n          large: this._broadCard!,\n          small: !this._broadCard,\n        })}\">\n        <div id=\"root\">\n          <paper-icon-button\n            icon=\"hass:dots-vertical\"\n            class=\"more-info\"\n            @click=\"${this._handleMoreInfo}\"\n          ></paper-icon-button>\n          <div id=\"thermostat\"></div>\n          <div id=\"tooltip\">\n            <div class=\"title\">${this._config.name ||\n              computeStateName(stateObj)}</div>\n            <div class=\"current-temperature\">\n              <span class=\"current-temperature-text\">\n                ${stateObj.attributes.current_temperature}\n                ${\n                  stateObj.attributes.current_temperature\n                    ? html`\n                        <span class=\"uom\"\n                          >${this.hass.config.unit_system.temperature}</span\n                        >\n                      `\n                    : \"\"\n                }\n              </span>\n            </div>\n            <div class=\"climate-info\">\n            <div id=\"set-temperature\"></div>\n            <div class=\"current-mode\">${this.hass!.localize(\n              `state.climate.${stateObj.state}`\n            )}</div>\n            <div class=\"modes\">\n              ${(stateObj.attributes.operation_list || []).map((modeItem) =>\n                this._renderIcon(modeItem, mode)\n              )}\n            </div>\n          </div>\n        </div>\n      </ha-card>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected firstUpdated(): void {\n    this._updated = true;\n    if (this.isConnected && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass || !changedProps.has(\"hass\")) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n\n    if (!oldHass || oldHass.themes !== this.hass.themes) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as ClimateEntity;\n\n    if (!stateObj) {\n      return;\n    }\n\n    if (\n      this._jQuery &&\n      // If jQuery changed, we just rendered in firstUpdated\n      !changedProps.has(\"_jQuery\") &&\n      (!oldHass || oldHass.states[this._config.entity] !== stateObj)\n    ) {\n      const [sliderValue, uiValue] = this._genSliderValue(stateObj);\n\n      this._jQuery(\"#thermostat\", this.shadowRoot).roundSlider({\n        value: sliderValue,\n      });\n      this._updateSetTemp(uiValue);\n    }\n  }\n\n  private get _stepSize(): number {\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (stateObj.attributes.target_temp_step) {\n      return stateObj.attributes.target_temp_step;\n    }\n    return this.hass!.config.unit_system.temperature === UNIT_F ? 1 : 0.5;\n  }\n\n  private async _initialLoad(): Promise<void> {\n    const stateObj = this.hass!.states[this._config!.entity] as ClimateEntity;\n\n    if (!stateObj) {\n      // Card will require refresh to work again\n      return;\n    }\n\n    this._loaded = true;\n\n    await this.updateComplete;\n\n    let radius = this.clientWidth / 3.2;\n    this._broadCard = this.clientWidth > 390;\n\n    if (radius === 0) {\n      radius = 100;\n    }\n\n    (this.shadowRoot!.querySelector(\n      \"#thermostat\"\n    ) as HTMLElement)!.style.height = radius * 2 + \"px\";\n\n    const loaded = await loadRoundslider();\n\n    this._roundSliderStyle = loaded.roundSliderStyle;\n    this._jQuery = loaded.jQuery;\n\n    const _sliderType =\n      stateObj.attributes.target_temp_low &&\n      stateObj.attributes.target_temp_high\n        ? \"range\"\n        : \"min-range\";\n\n    const [sliderValue, uiValue] = this._genSliderValue(stateObj);\n\n    this._jQuery(\"#thermostat\", this.shadowRoot).roundSlider({\n      ...thermostatConfig,\n      radius,\n      min: stateObj.attributes.min_temp,\n      max: stateObj.attributes.max_temp,\n      sliderType: _sliderType,\n      change: (value) => this._setTemperature(value),\n      drag: (value) => this._dragEvent(value),\n      value: sliderValue,\n      step: this._stepSize,\n    });\n    this._updateSetTemp(uiValue);\n  }\n\n  private _genSliderValue(stateObj: ClimateEntity): [string | number, string] {\n    let sliderValue: string | number;\n    let uiValue: string;\n\n    if (\n      stateObj.attributes.target_temp_low &&\n      stateObj.attributes.target_temp_high\n    ) {\n      sliderValue = `${stateObj.attributes.target_temp_low}, ${\n        stateObj.attributes.target_temp_high\n      }`;\n      uiValue = this.formatTemp(\n        [\n          String(stateObj.attributes.target_temp_low),\n          String(stateObj.attributes.target_temp_high),\n        ],\n        false\n      );\n    } else {\n      sliderValue = stateObj.attributes.temperature;\n      uiValue =\n        stateObj.attributes.temperature !== null\n          ? String(stateObj.attributes.temperature)\n          : \"\";\n    }\n\n    return [sliderValue, uiValue];\n  }\n\n  private _updateSetTemp(value: string): void {\n    this.shadowRoot!.querySelector(\"#set-temperature\")!.innerHTML = value;\n  }\n\n  private _dragEvent(e): void {\n    this._updateSetTemp(this.formatTemp(String(e.value).split(\",\"), true));\n  }\n\n  private _setTemperature(e): void {\n    const stateObj = this.hass!.states[this._config!.entity] as ClimateEntity;\n    if (\n      stateObj.attributes.target_temp_low &&\n      stateObj.attributes.target_temp_high\n    ) {\n      if (e.handle.index === 1) {\n        this.hass!.callService(\"climate\", \"set_temperature\", {\n          entity_id: this._config!.entity,\n          target_temp_low: e.handle.value,\n          target_temp_high: stateObj.attributes.target_temp_high,\n        });\n      } else {\n        this.hass!.callService(\"climate\", \"set_temperature\", {\n          entity_id: this._config!.entity,\n          target_temp_low: stateObj.attributes.target_temp_low,\n          target_temp_high: e.handle.value,\n        });\n      }\n    } else {\n      this.hass!.callService(\"climate\", \"set_temperature\", {\n        entity_id: this._config!.entity,\n        temperature: e.value,\n      });\n    }\n  }\n\n  private _renderIcon(mode: string, currentMode: string): TemplateResult {\n    if (!modeIcons[mode]) {\n      return html``;\n    }\n    return html`\n      <ha-icon\n        class=\"${classMap({ \"selected-icon\": currentMode === mode })}\"\n        .mode=\"${mode}\"\n        .icon=\"${modeIcons[mode]}\"\n        @click=\"${this._handleModeClick}\"\n      ></ha-icon>\n    `;\n  }\n\n  private _handleMoreInfo() {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this._config!.entity,\n    });\n  }\n\n  private _handleModeClick(e: MouseEvent): void {\n    this.hass!.callService(\"climate\", \"set_operation_mode\", {\n      entity_id: this._config!.entity,\n      operation_mode: (e.currentTarget as any).mode,\n    });\n  }\n\n  private formatTemp(temps: string[], spaceStepSize: boolean): string {\n    temps = temps.filter(Boolean);\n\n    // If we are sliding the slider, append 0 to the temperatures if we're\n    // having a 0.5 step size, so that the text doesn't jump while sliding\n    if (spaceStepSize) {\n      const stepSize = this._stepSize;\n      temps = temps.map((val) =>\n        val.includes(\".\") || stepSize === 1 ? val : `${val}.0`\n      );\n    }\n\n    return temps.join(\"-\");\n  }\n\n  private renderStyle(): TemplateResult {\n    return html`\n      ${this._roundSliderStyle}\n      <style>\n        :host {\n          display: block;\n        }\n        ha-card {\n          overflow: hidden;\n          --rail-border-color: transparent;\n          --auto-color: green;\n          --eco-color: springgreen;\n          --cool-color: #2b9af9;\n          --heat-color: #ff8100;\n          --manual-color: #44739e;\n          --off-color: #8a8a8a;\n          --fan_only-color: #8a8a8a;\n          --dry-color: #efbd07;\n          --idle-color: #8a8a8a;\n          --unknown-color: #bac;\n        }\n        #root {\n          position: relative;\n          overflow: hidden;\n        }\n        .auto {\n          --mode-color: var(--auto-color);\n        }\n        .cool {\n          --mode-color: var(--cool-color);\n        }\n        .heat {\n          --mode-color: var(--heat-color);\n        }\n        .manual {\n          --mode-color: var(--manual-color);\n        }\n        .off {\n          --mode-color: var(--off-color);\n        }\n        .fan_only {\n          --mode-color: var(--fan_only-color);\n        }\n        .eco {\n          --mode-color: var(--eco-color);\n        }\n        .dry {\n          --mode-color: var(--dry-color);\n        }\n        .idle {\n          --mode-color: var(--idle-color);\n        }\n        .unknown-mode {\n          --mode-color: var(--unknown-color);\n        }\n        .no-title {\n          --title-position-top: 33% !important;\n        }\n        .large {\n          --thermostat-padding-top: 25px;\n          --thermostat-margin-bottom: 25px;\n          --title-font-size: 28px;\n          --title-position-top: 27%;\n          --climate-info-position-top: 81%;\n          --set-temperature-font-size: 25px;\n          --current-temperature-font-size: 71px;\n          --current-temperature-position-top: 10%;\n          --current-temperature-text-padding-left: 15px;\n          --uom-font-size: 20px;\n          --uom-margin-left: -18px;\n          --current-mode-font-size: 18px;\n          --set-temperature-margin-bottom: -5px;\n        }\n        .small {\n          --thermostat-padding-top: 15px;\n          --thermostat-margin-bottom: 15px;\n          --title-font-size: 18px;\n          --title-position-top: 28%;\n          --climate-info-position-top: 79%;\n          --set-temperature-font-size: 16px;\n          --current-temperature-font-size: 25px;\n          --current-temperature-position-top: 5%;\n          --current-temperature-text-padding-left: 7px;\n          --uom-font-size: 12px;\n          --uom-margin-left: -5px;\n          --current-mode-font-size: 14px;\n          --set-temperature-margin-bottom: 0px;\n        }\n        #thermostat {\n          margin: 0 auto var(--thermostat-margin-bottom);\n          padding-top: var(--thermostat-padding-top);\n        }\n        #thermostat .rs-range-color {\n          background-color: var(--mode-color, var(--disabled-text-color));\n        }\n        #thermostat .rs-path-color {\n          background-color: var(--disabled-text-color);\n        }\n        #thermostat .rs-handle {\n          background-color: var(--paper-card-background-color, white);\n          padding: 7px;\n          border: 2px solid var(--disabled-text-color);\n        }\n        #thermostat .rs-handle.rs-focus {\n          border-color: var(--mode-color, var(--disabled-text-color));\n        }\n        #thermostat .rs-handle:after {\n          border-color: var(--mode-color, var(--disabled-text-color));\n          background-color: var(--mode-color, var(--disabled-text-color));\n        }\n        #thermostat .rs-border {\n          border-color: var(--rail-border-color);\n        }\n        #thermostat .rs-bar.rs-transition.rs-first,\n        .rs-bar.rs-transition.rs-second {\n          z-index: 20 !important;\n        }\n        #thermostat .rs-inner.rs-bg-color.rs-border,\n        #thermostat .rs-overlay.rs-transition.rs-bg-color {\n          background-color: var(--paper-card-background-color, white);\n        }\n        #tooltip {\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 100%;\n          text-align: center;\n          z-index: 15;\n          color: var(--primary-text-color);\n        }\n        #set-temperature {\n          font-size: var(--set-temperature-font-size);\n          margin-bottom: var(--set-temperature-margin-bottom);\n        }\n        .title {\n          font-size: var(--title-font-size);\n          position: absolute;\n          top: var(--title-position-top);\n          left: 50%;\n          transform: translate(-50%, -50%);\n        }\n        .climate-info {\n          position: absolute;\n          top: var(--climate-info-position-top);\n          left: 50%;\n          transform: translate(-50%, -50%);\n          width: 100%;\n        }\n        .current-mode {\n          font-size: var(--current-mode-font-size);\n          color: var(--secondary-text-color);\n        }\n        .modes {\n          margin-top: 16px;\n        }\n        .modes ha-icon {\n          color: var(--disabled-text-color);\n          cursor: pointer;\n          display: inline-block;\n          margin: 0 10px;\n        }\n        .modes ha-icon.selected-icon {\n          color: var(--mode-color);\n        }\n        .current-temperature {\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          font-size: var(--current-temperature-font-size);\n        }\n        .current-temperature-text {\n          padding-left: var(--current-temperature-text-padding-left);\n        }\n        .uom {\n          font-size: var(--uom-font-size);\n          vertical-align: top;\n          margin-left: var(--uom-margin-left);\n        }\n        .more-info {\n          position: absolute;\n          cursor: pointer;\n          top: 0;\n          right: 0;\n          z-index: 25;\n          color: var(--secondary-text-color);\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-thermostat-card\": HuiThermostatCard;\n  }\n}\n","import { html, TemplateResult } from \"lit-element\";\n\nimport { computeCardSize } from \"../common/compute-card-size\";\nimport { HuiStackCard } from \"./hui-stack-card\";\n\nclass HuiVerticalStackCard extends HuiStackCard {\n  public getCardSize() {\n    let totalSize = 0;\n\n    if (!this._cards) {\n      return totalSize;\n    }\n\n    for (const element of this._cards) {\n      totalSize += computeCardSize(element);\n    }\n\n    return totalSize;\n  }\n\n  protected renderStyle(): TemplateResult {\n    return html`\n      <style>\n        #root {\n          display: flex;\n          flex-direction: column;\n        }\n        #root > * {\n          margin: 4px 0 4px 0;\n        }\n        #root > *:first-child {\n          margin-top: 0;\n        }\n        #root > *:last-child {\n          margin-bottom: 0;\n        }\n      </style>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-vertical-stack-card\": HuiVerticalStackCard;\n  }\n}\n\ncustomElements.define(\"hui-vertical-stack-card\", HuiVerticalStackCard);\n","import \"../../../cards/ha-weather-card\";\n\nimport LegacyWrapperCard from \"./hui-legacy-wrapper-card\";\n\nclass HuiWeatherForecastCard extends LegacyWrapperCard {\n  static async getConfigElement() {\n    await import(/* webpackChunkName: \"hui-weather-forecast-card-editor\" */ \"../editor/config-elements/hui-weather-forecast-card-editor\");\n    return document.createElement(\"hui-weather-forecast-card-editor\");\n  }\n\n  static getStubConfig() {\n    return {};\n  }\n\n  constructor() {\n    super(\"ha-weather-card\", \"weather\");\n  }\n\n  getCardSize() {\n    return 4;\n  }\n}\n\ncustomElements.define(\"hui-weather-forecast-card\", HuiWeatherForecastCard);\n","import { LovelaceElement, LovelaceElementConfig } from \"../../elements/types\";\nimport { createHuiElement } from \"../../common/create-hui-element\";\n\nexport function createStyledHuiElement(\n  elementConfig: LovelaceElementConfig\n): LovelaceElement {\n  const element = createHuiElement(elementConfig) as LovelaceElement;\n  // keep conditional card as a transparent container so let its position remain static\n  if (element.tagName !== \"HUI-CONDITIONAL-ELEMENT\") {\n    element.classList.add(\"element\");\n  }\n\n  if (elementConfig.style) {\n    Object.keys(elementConfig.style).forEach((prop) => {\n      element.style.setProperty(prop, elementConfig.style[prop]);\n    });\n  }\n\n  return element;\n}\n","import { HomeAssistant } from \"../../../types\";\nimport { CallServiceConfig } from \"../entity-rows/types\";\n\nexport const callService = (\n  config: CallServiceConfig,\n  hass: HomeAssistant\n): void => {\n  const entityId = config.entity;\n  const [domain, service] = config.service.split(\".\", 2);\n  const serviceData = { entity_id: entityId, ...config.service_data };\n  hass.callService(domain, service, serviceData);\n};\n","import { LovelaceCard } from \"../types\";\n\nexport const computeCardSize = (card: LovelaceCard): number => {\n  return typeof card.getCardSize === \"function\" ? card.getCardSize() : 1;\n};\n","import { HassEntities, HassEntity } from \"home-assistant-js-websocket\";\n\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nexport const computeNotifications = (states: HassEntities): HassEntity[] => {\n  return Object.keys(states)\n    .filter((entityId) => computeDomain(entityId) === \"configurator\")\n    .map((entityId) => states[entityId]);\n};\n","import computeStateName from \"../../../common/entity/compute_state_name\";\nimport { HomeAssistant } from \"../../../types\";\nimport { LovelaceElementConfig } from \"../elements/types\";\nimport { ActionConfig } from \"../../../data/lovelace\";\n\ninterface Config extends LovelaceElementConfig {\n  entity?: string;\n  title?: string;\n  tap_action?: ActionConfig;\n  hold_action?: ActionConfig;\n}\n\nexport const computeTooltip = (hass: HomeAssistant, config: Config): string => {\n  if (config.title === null) {\n    return \"\";\n  }\n\n  if (config.title) {\n    return config.title;\n  }\n\n  let stateName = \"\";\n  let tooltip = \"\";\n\n  if (config.entity) {\n    stateName =\n      config.entity in hass.states\n        ? computeStateName(hass.states[config.entity])\n        : config.entity;\n  }\n\n  const tapTooltip = config.tap_action\n    ? computeActionTooltip(hass, stateName, config.tap_action, false)\n    : \"\";\n  const holdTooltip = config.hold_action\n    ? computeActionTooltip(hass, stateName, config.hold_action, true)\n    : \"\";\n\n  const newline = tapTooltip && holdTooltip ? \"\\n\" : \"\";\n\n  tooltip = tapTooltip + newline + holdTooltip;\n\n  return tooltip;\n};\n\nfunction computeActionTooltip(\n  hass: HomeAssistant,\n  state: string,\n  config: ActionConfig,\n  isHold: boolean\n) {\n  if (!config || !config.action || config.action === \"none\") {\n    return \"\";\n  }\n\n  let tooltip =\n    (isHold\n      ? hass.localize(\"ui.panel.lovelace.cards.picture-elements.hold\")\n      : hass.localize(\"ui.panel.lovelace.cards.picture-elements.tap\")) + \" \";\n\n  switch (config.action) {\n    case \"navigate\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.navigate_to\",\n        \"location\",\n        config.navigation_path\n      )}`;\n      break;\n    case \"toggle\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.toggle\",\n        \"name\",\n        state\n      )}`;\n      break;\n    case \"call-service\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.call_service\",\n        \"name\",\n        config.service\n      )}`;\n      break;\n    case \"more-info\":\n      tooltip += `${hass.localize(\n        \"ui.panel.lovelace.cards.picture-elements.more_info\",\n        \"name\",\n        state\n      )}`;\n      break;\n  }\n\n  return tooltip;\n}\n","import deepClone from \"deep-clone-simple\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\n\nimport \"../cards/hui-alarm-panel-card\";\nimport \"../cards/hui-conditional-card\";\nimport \"../cards/hui-entities-card\";\nimport \"../cards/hui-entity-button-card\";\nimport \"../cards/hui-entity-filter-card\";\nimport {\n  createErrorCardElement,\n  createErrorCardConfig,\n  HuiErrorCard,\n} from \"../cards/hui-error-card\";\nimport \"../cards/hui-glance-card\";\nimport \"../cards/hui-history-graph-card\";\nimport \"../cards/hui-horizontal-stack-card\";\nimport \"../cards/hui-iframe-card\";\nimport \"../cards/hui-light-card\";\nimport \"../cards/hui-map-card\";\nimport \"../cards/hui-markdown-card\";\nimport \"../cards/hui-media-control-card\";\nimport \"../cards/hui-picture-card\";\nimport \"../cards/hui-picture-elements-card\";\nimport \"../cards/hui-picture-entity-card\";\nimport \"../cards/hui-picture-glance-card\";\nimport \"../cards/hui-plant-status-card\";\nimport \"../cards/hui-sensor-card\";\nimport \"../cards/hui-vertical-stack-card\";\nimport \"../cards/hui-shopping-list-card\";\nimport \"../cards/hui-thermostat-card\";\nimport \"../cards/hui-weather-forecast-card\";\nimport \"../cards/hui-gauge-card\";\nimport { LovelaceCard } from \"../types\";\nimport { LovelaceCardConfig } from \"../../../data/lovelace\";\n\nconst CARD_TYPES = new Set([\n  \"alarm-panel\",\n  \"conditional\",\n  \"entities\",\n  \"entity-button\",\n  \"entity-filter\",\n  \"error\",\n  \"gauge\",\n  \"glance\",\n  \"history-graph\",\n  \"horizontal-stack\",\n  \"iframe\",\n  \"light\",\n  \"map\",\n  \"markdown\",\n  \"media-control\",\n  \"picture\",\n  \"picture-elements\",\n  \"picture-entity\",\n  \"picture-glance\",\n  \"plant-status\",\n  \"sensor\",\n  \"shopping-list\",\n  \"thermostat\",\n  \"vertical-stack\",\n  \"weather-forecast\",\n]);\nconst CUSTOM_TYPE_PREFIX = \"custom:\";\nconst TIMEOUT = 2000;\n\nconst _createElement = (\n  tag: string,\n  config: LovelaceCardConfig\n): LovelaceCard | HuiErrorCard => {\n  const element = document.createElement(tag) as LovelaceCard;\n  try {\n    element.setConfig(deepClone(config));\n  } catch (err) {\n    // tslint:disable-next-line\n    console.error(tag, err);\n    return _createErrorElement(err.message, config);\n  }\n  return element;\n};\n\nconst _createErrorElement = (\n  error: string,\n  config: LovelaceCardConfig\n): HuiErrorCard => createErrorCardElement(createErrorCardConfig(error, config));\n\nexport const createCardElement = (\n  config: LovelaceCardConfig\n): LovelaceCard | HuiErrorCard => {\n  if (!config || typeof config !== \"object\" || !config.type) {\n    return _createErrorElement(\"No card type configured.\", config);\n  }\n\n  if (config.type.startsWith(CUSTOM_TYPE_PREFIX)) {\n    const tag = config.type.substr(CUSTOM_TYPE_PREFIX.length);\n\n    if (customElements.get(tag)) {\n      return _createElement(tag, config);\n    }\n    const element = _createErrorElement(\n      `Custom element doesn't exist: ${tag}.`,\n      config\n    );\n    element.style.display = \"None\";\n    const timer = window.setTimeout(() => {\n      element.style.display = \"\";\n    }, TIMEOUT);\n\n    customElements.whenDefined(tag).then(() => {\n      clearTimeout(timer);\n      fireEvent(element, \"ll-rebuild\");\n    });\n\n    return element;\n  }\n\n  if (!CARD_TYPES.has(config.type)) {\n    return _createErrorElement(\n      `Unknown card type encountered: ${config.type}.`,\n      config\n    );\n  }\n\n  return _createElement(`hui-${config.type}-card`, config);\n};\n","import deepClone from \"deep-clone-simple\";\n\nimport \"../elements/hui-conditional-element\";\nimport \"../elements/hui-icon-element\";\nimport \"../elements/hui-image-element\";\nimport \"../elements/hui-service-button-element\";\nimport \"../elements/hui-state-badge-element\";\nimport \"../elements/hui-state-icon-element\";\nimport \"../elements/hui-state-label-element\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport {\n  createErrorCardElement,\n  createErrorCardConfig,\n  HuiErrorCard,\n} from \"../cards/hui-error-card\";\nimport { LovelaceElementConfig, LovelaceElement } from \"../elements/types\";\n\nconst CUSTOM_TYPE_PREFIX = \"custom:\";\nconst ELEMENT_TYPES = new Set([\n  \"conditional\",\n  \"icon\",\n  \"image\",\n  \"service-button\",\n  \"state-badge\",\n  \"state-icon\",\n  \"state-label\",\n]);\nconst TIMEOUT = 2000;\n\nconst _createElement = (\n  tag: string,\n  config: LovelaceElementConfig\n): LovelaceElement | HuiErrorCard => {\n  const element = document.createElement(tag) as LovelaceElement;\n  try {\n    element.setConfig(deepClone(config));\n  } catch (err) {\n    // tslint:disable-next-line\n    console.error(tag, err);\n    return _createErrorElement(err.message, config);\n  }\n  return element;\n};\n\nconst _createErrorElement = (\n  error: string,\n  config: LovelaceElementConfig\n): HuiErrorCard => createErrorCardElement(createErrorCardConfig(error, config));\n\nfunction _hideErrorElement(element) {\n  element.style.display = \"None\";\n  return window.setTimeout(() => {\n    element.style.display = \"\";\n  }, TIMEOUT);\n}\n\nexport const createHuiElement = (\n  config: LovelaceElementConfig\n): LovelaceElement | HuiErrorCard => {\n  if (!config || typeof config !== \"object\" || !config.type) {\n    return _createErrorElement(\"No element type configured.\", config);\n  }\n\n  if (config.type.startsWith(CUSTOM_TYPE_PREFIX)) {\n    const tag = config.type.substr(CUSTOM_TYPE_PREFIX.length);\n\n    if (customElements.get(tag)) {\n      return _createElement(tag, config);\n    }\n    const element = _createErrorElement(\n      `Custom element doesn't exist: ${tag}.`,\n      config\n    );\n    const timer = _hideErrorElement(element);\n\n    customElements.whenDefined(tag).then(() => {\n      clearTimeout(timer);\n      fireEvent(element, \"ll-rebuild\");\n    });\n\n    return element;\n  }\n\n  if (!ELEMENT_TYPES.has(config.type)) {\n    return _createErrorElement(\n      `Unknown element type encountered: ${config.type}.`,\n      config\n    );\n  }\n\n  return _createElement(`hui-${config.type}-element`, config);\n};\n","import deepClone from \"deep-clone-simple\";\n\nimport { fireEvent } from \"../../../common/dom/fire_event\";\n\nimport {\n  createErrorCardElement,\n  createErrorCardConfig,\n  HuiErrorCard,\n} from \"../cards/hui-error-card\";\nimport \"../entity-rows/hui-climate-entity-row\";\nimport \"../entity-rows/hui-cover-entity-row\";\nimport \"../entity-rows/hui-group-entity-row\";\nimport \"../entity-rows/hui-input-datetime-entity-row\";\nimport \"../entity-rows/hui-input-number-entity-row\";\nimport \"../entity-rows/hui-input-select-entity-row\";\nimport \"../entity-rows/hui-input-text-entity-row\";\nimport \"../entity-rows/hui-lock-entity-row\";\nimport \"../entity-rows/hui-media-player-entity-row\";\nimport \"../entity-rows/hui-scene-entity-row\";\nimport \"../entity-rows/hui-script-entity-row\";\nimport \"../entity-rows/hui-sensor-entity-row\";\nimport \"../entity-rows/hui-text-entity-row\";\nimport \"../entity-rows/hui-timer-entity-row\";\nimport \"../entity-rows/hui-toggle-entity-row\";\nimport \"../special-rows/hui-call-service-row\";\nimport \"../special-rows/hui-divider-row\";\nimport \"../special-rows/hui-section-row\";\nimport \"../special-rows/hui-weblink-row\";\nimport { EntityConfig, EntityRow } from \"../entity-rows/types\";\n\nconst CUSTOM_TYPE_PREFIX = \"custom:\";\nconst SPECIAL_TYPES = new Set([\n  \"call-service\",\n  \"divider\",\n  \"section\",\n  \"weblink\",\n]);\nconst DOMAIN_TO_ELEMENT_TYPE = {\n  alert: \"toggle\",\n  automation: \"toggle\",\n  climate: \"climate\",\n  cover: \"cover\",\n  fan: \"toggle\",\n  group: \"group\",\n  input_boolean: \"toggle\",\n  input_number: \"input-number\",\n  input_select: \"input-select\",\n  input_text: \"input-text\",\n  light: \"toggle\",\n  lock: \"lock\",\n  media_player: \"media-player\",\n  remote: \"toggle\",\n  scene: \"scene\",\n  script: \"script\",\n  sensor: \"sensor\",\n  timer: \"timer\",\n  switch: \"toggle\",\n  vacuum: \"toggle\",\n  // Temporary. Once climate is rewritten,\n  // water heater should get it's own row.\n  water_heater: \"climate\",\n  input_datetime: \"input-datetime\",\n};\nconst TIMEOUT = 2000;\n\nconst _createElement = (\n  tag: string,\n  config: EntityConfig\n): EntityRow | HuiErrorCard => {\n  const element = document.createElement(tag) as EntityRow;\n  try {\n    element.setConfig(deepClone(config));\n  } catch (err) {\n    // tslint:disable-next-line\n    console.error(tag, err);\n    return _createErrorElement(err.message, config);\n  }\n\n  return element;\n};\n\nconst _createErrorElement = (\n  error: string,\n  config: EntityConfig\n): HuiErrorCard => createErrorCardElement(createErrorCardConfig(error, config));\n\nconst _hideErrorElement = (element) => {\n  element.style.display = \"None\";\n  return window.setTimeout(() => {\n    element.style.display = \"\";\n  }, TIMEOUT);\n};\n\nexport const createRowElement = (\n  config: EntityConfig\n): EntityRow | HuiErrorCard => {\n  let tag;\n\n  if (\n    !config ||\n    typeof config !== \"object\" ||\n    (!config.entity && !config.type)\n  ) {\n    return _createErrorElement(\"Invalid config given.\", config);\n  }\n\n  const type = config.type || \"default\";\n  if (SPECIAL_TYPES.has(type)) {\n    return _createElement(`hui-${type}-row`, config);\n  }\n\n  if (type.startsWith(CUSTOM_TYPE_PREFIX)) {\n    tag = type.substr(CUSTOM_TYPE_PREFIX.length);\n\n    if (customElements.get(tag)) {\n      return _createElement(tag, config);\n    }\n    const element = _createErrorElement(\n      `Custom element doesn't exist: ${tag}.`,\n      config\n    );\n    const timer = _hideErrorElement(element);\n\n    customElements.whenDefined(tag).then(() => {\n      clearTimeout(timer);\n      fireEvent(element, \"ll-rebuild\");\n    });\n\n    return element;\n  }\n\n  const domain = config.entity.split(\".\", 1)[0];\n  tag = `hui-${DOMAIN_TO_ELEMENT_TYPE[domain] || \"text\"}-entity-row`;\n\n  return _createElement(tag, config);\n};\n","import { directive, PropertyPart } from \"lit-html\";\n// See https://github.com/home-assistant/home-assistant-polymer/pull/2457\n// on how to undo mwc -> paper migration\n// import \"@material/mwc-ripple\";\nimport \"@polymer/paper-ripple\";\n\nconst isTouch =\n  \"ontouchstart\" in window ||\n  navigator.maxTouchPoints > 0 ||\n  navigator.msMaxTouchPoints > 0;\n\ninterface LongPress extends HTMLElement {\n  holdTime: number;\n  bind(element: Element): void;\n}\ninterface LongPressElement extends Element {\n  longPress?: boolean;\n}\n\nclass LongPress extends HTMLElement implements LongPress {\n  public holdTime: number;\n  protected ripple: any;\n  protected timer: number | undefined;\n  protected held: boolean;\n  protected cooldownStart: boolean;\n  protected cooldownEnd: boolean;\n\n  constructor() {\n    super();\n    this.holdTime = 500;\n    this.ripple = document.createElement(\"paper-ripple\");\n    this.timer = undefined;\n    this.held = false;\n    this.cooldownStart = false;\n    this.cooldownEnd = false;\n  }\n\n  public connectedCallback() {\n    Object.assign(this.style, {\n      borderRadius: \"50%\", // paper-ripple\n      position: \"absolute\",\n      width: isTouch ? \"100px\" : \"50px\",\n      height: isTouch ? \"100px\" : \"50px\",\n      transform: \"translate(-50%, -50%)\",\n      pointerEvents: \"none\",\n    });\n\n    this.appendChild(this.ripple);\n    this.ripple.style.color = \"#03a9f4\"; // paper-ripple\n    this.ripple.style.color = \"var(--primary-color)\"; // paper-ripple\n    // this.ripple.primary = true;\n\n    [\n      \"touchcancel\",\n      \"mouseout\",\n      \"mouseup\",\n      \"touchmove\",\n      \"mousewheel\",\n      \"wheel\",\n      \"scroll\",\n    ].forEach((ev) => {\n      document.addEventListener(\n        ev,\n        () => {\n          clearTimeout(this.timer);\n          this.stopAnimation();\n          this.timer = undefined;\n        },\n        { passive: true }\n      );\n    });\n  }\n\n  public bind(element: LongPressElement) {\n    if (element.longPress) {\n      return;\n    }\n    element.longPress = true;\n\n    element.addEventListener(\"contextmenu\", (ev: Event) => {\n      const e = ev || window.event;\n      if (e.preventDefault) {\n        e.preventDefault();\n      }\n      if (e.stopPropagation) {\n        e.stopPropagation();\n      }\n      e.cancelBubble = true;\n      e.returnValue = false;\n      return false;\n    });\n\n    const clickStart = (ev: Event) => {\n      if (this.cooldownStart) {\n        return;\n      }\n      this.held = false;\n      let x;\n      let y;\n      if ((ev as TouchEvent).touches) {\n        x = (ev as TouchEvent).touches[0].pageX;\n        y = (ev as TouchEvent).touches[0].pageY;\n      } else {\n        x = (ev as MouseEvent).pageX;\n        y = (ev as MouseEvent).pageY;\n      }\n      this.timer = window.setTimeout(() => {\n        this.startAnimation(x, y);\n        this.held = true;\n      }, this.holdTime);\n\n      this.cooldownStart = true;\n      window.setTimeout(() => (this.cooldownStart = false), 100);\n    };\n\n    const clickEnd = (ev: Event) => {\n      if (\n        this.cooldownEnd ||\n        ([\"touchend\", \"touchcancel\"].includes(ev.type) &&\n          this.timer === undefined)\n      ) {\n        return;\n      }\n      clearTimeout(this.timer);\n      this.stopAnimation();\n      this.timer = undefined;\n      if (this.held) {\n        element.dispatchEvent(new Event(\"ha-hold\"));\n      } else {\n        element.dispatchEvent(new Event(\"ha-click\"));\n      }\n      this.cooldownEnd = true;\n      window.setTimeout(() => (this.cooldownEnd = false), 100);\n    };\n\n    element.addEventListener(\"touchstart\", clickStart, { passive: true });\n    element.addEventListener(\"touchend\", clickEnd);\n    element.addEventListener(\"touchcancel\", clickEnd);\n    element.addEventListener(\"mousedown\", clickStart, { passive: true });\n    element.addEventListener(\"click\", clickEnd);\n  }\n\n  private startAnimation(x: number, y: number) {\n    Object.assign(this.style, {\n      left: `${x}px`,\n      top: `${y}px`,\n      display: null,\n    });\n    this.ripple.holdDown = true; // paper-ripple\n    this.ripple.simulatedRipple(); // paper-ripple\n    // this.ripple.disabled = false;\n    // this.ripple.active = true;\n    // this.ripple.unbounded = true;\n  }\n\n  private stopAnimation() {\n    this.ripple.holdDown = false; // paper-ripple\n    // this.ripple.active = false;\n    // this.ripple.disabled = true;\n    this.style.display = \"none\";\n  }\n}\n\ncustomElements.define(\"long-press\", LongPress);\n\nconst getLongPress = (): LongPress => {\n  const body = document.body;\n  if (body.querySelector(\"long-press\")) {\n    return body.querySelector(\"long-press\") as LongPress;\n  }\n\n  const longpress = document.createElement(\"long-press\");\n  body.appendChild(longpress);\n\n  return longpress as LongPress;\n};\n\nexport const longPressBind = (element: LongPressElement) => {\n  const longpress: LongPress = getLongPress();\n  if (!longpress) {\n    return;\n  }\n  longpress.bind(element);\n};\n\nexport const longPress = directive(() => (part: PropertyPart) => {\n  longPressBind(part.committer.element);\n});\n","import { STATES_OFF } from \"../../../../common/const\";\nimport { turnOnOffEntity } from \"./turn-on-off-entity\";\nimport { HomeAssistant } from \"../../../../types\";\nexport const toggleEntity = (\n  hass: HomeAssistant,\n  entityId: string\n): Promise<void> => {\n  const turnOn = STATES_OFF.includes(hass.states[entityId].state);\n  return turnOnOffEntity(hass, entityId, turnOn);\n};\n","import computeDomain from \"../../../../common/entity/compute_domain\";\nimport { STATES_OFF } from \"../../../../common/const\";\nimport { HomeAssistant } from \"../../../../types\";\n\nexport const turnOnOffEntities = (\n  hass: HomeAssistant,\n  entityIds: string[],\n  turnOn = true\n): void => {\n  const domainsToCall = {};\n  entityIds.forEach((entityId) => {\n    if (STATES_OFF.includes(hass.states[entityId].state) === turnOn) {\n      const stateDomain = computeDomain(entityId);\n      const serviceDomain = [\"cover\", \"lock\"].includes(stateDomain)\n        ? stateDomain\n        : \"homeassistant\";\n\n      if (!(serviceDomain in domainsToCall)) {\n        domainsToCall[serviceDomain] = [];\n      }\n      domainsToCall[serviceDomain].push(entityId);\n    }\n  });\n\n  Object.keys(domainsToCall).forEach((domain) => {\n    let service;\n    switch (domain) {\n      case \"lock\":\n        service = turnOn ? \"unlock\" : \"lock\";\n        break;\n      case \"cover\":\n        service = turnOn ? \"open_cover\" : \"close_cover\";\n        break;\n      default:\n        service = turnOn ? \"turn_on\" : \"turn_off\";\n    }\n\n    const entities = domainsToCall[domain];\n    hass.callService(domain, service, { entity_id: entities });\n  });\n};\n","import computeDomain from \"../../../../common/entity/compute_domain\";\nimport { HomeAssistant } from \"../../../../types\";\n\nexport const turnOnOffEntity = (\n  hass: HomeAssistant,\n  entityId: string,\n  turnOn = true\n): Promise<void> => {\n  const stateDomain = computeDomain(entityId);\n  const serviceDomain = stateDomain === \"group\" ? \"homeassistant\" : stateDomain;\n\n  let service;\n  switch (stateDomain) {\n    case \"lock\":\n      service = turnOn ? \"unlock\" : \"lock\";\n      break;\n    case \"cover\":\n      service = turnOn ? \"open_cover\" : \"close_cover\";\n      break;\n    default:\n      service = turnOn ? \"turn_on\" : \"turn_off\";\n  }\n\n  return hass.callService(serviceDomain, service, { entity_id: entityId });\n};\n","import { HomeAssistant, GroupEntity } from \"../../../types\";\nimport {\n  LovelaceConfig,\n  LovelaceCardConfig,\n  LovelaceViewConfig,\n} from \"../../../data/lovelace\";\nimport { HassEntity, HassEntities } from \"home-assistant-js-websocket\";\n\nimport extractViews from \"../../../common/entity/extract_views\";\nimport getViewEntities from \"../../../common/entity/get_view_entities\";\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport splitByGroups from \"../../../common/entity/split_by_groups\";\nimport computeObjectId from \"../../../common/entity/compute_object_id\";\nimport computeStateDomain from \"../../../common/entity/compute_state_domain\";\nimport computeDomain from \"../../../common/entity/compute_domain\";\n\nimport { EntityRowConfig, WeblinkConfig } from \"../entity-rows/types\";\nimport { LocalizeFunc } from \"../../../common/translations/localize\";\nimport { EntitiesCardConfig } from \"../cards/types\";\nimport {\n  subscribeAreaRegistry,\n  AreaRegistryEntry,\n} from \"../../../data/area_registry\";\nimport { subscribeOne } from \"../../../common/util/subscribe-one\";\nimport {\n  subscribeDeviceRegistry,\n  DeviceRegistryEntry,\n} from \"../../../data/device_registry\";\nimport {\n  subscribeEntityRegistry,\n  EntityRegistryEntry,\n} from \"../../../data/entity_registry\";\n\nconst DEFAULT_VIEW_ENTITY_ID = \"group.default_view\";\nconst DOMAINS_BADGES = [\n  \"binary_sensor\",\n  \"person\",\n  \"device_tracker\",\n  \"mailbox\",\n  \"sensor\",\n  \"sun\",\n  \"timer\",\n];\nconst HIDE_DOMAIN = new Set([\n  \"persistent_notification\",\n  \"configurator\",\n  \"geo_location\",\n]);\n\ninterface Registries {\n  areas: AreaRegistryEntry[];\n  devices: DeviceRegistryEntry[];\n  entities: EntityRegistryEntry[];\n}\n\nlet subscribedRegistries = false;\n\ninterface SplittedByAreas {\n  areasWithEntities: Array<[AreaRegistryEntry, HassEntity[]]>;\n  otherEntities: HassEntities;\n}\n\nconst splitByAreas = (\n  registries: Registries,\n  entities: HassEntities\n): SplittedByAreas => {\n  const allEntities = { ...entities };\n  const areasWithEntities: SplittedByAreas[\"areasWithEntities\"] = [];\n\n  for (const area of registries.areas) {\n    const areaEntities: HassEntity[] = [];\n    const areaDevices = new Set(\n      registries.devices\n        .filter((device) => device.area_id === area.area_id)\n        .map((device) => device.id)\n    );\n    for (const entity of registries.entities) {\n      if (\n        areaDevices.has(\n          // @ts-ignore\n          entity.device_id\n        ) &&\n        entity.entity_id in allEntities\n      ) {\n        areaEntities.push(allEntities[entity.entity_id]);\n        delete allEntities[entity.entity_id];\n      }\n    }\n    if (areaEntities.length > 0) {\n      areasWithEntities.push([area, areaEntities]);\n    }\n  }\n  return {\n    areasWithEntities,\n    otherEntities: allEntities,\n  };\n};\n\nconst computeCards = (\n  states: Array<[string, HassEntity]>,\n  entityCardOptions: Partial<EntitiesCardConfig>\n): LovelaceCardConfig[] => {\n  const cards: LovelaceCardConfig[] = [];\n\n  // For entity card\n  const entities: Array<string | EntityRowConfig> = [];\n\n  for (const [entityId, stateObj] of states) {\n    const domain = computeDomain(entityId);\n\n    if (domain === \"alarm_control_panel\") {\n      cards.push({\n        type: \"alarm-panel\",\n        entity: entityId,\n      });\n    } else if (domain === \"camera\") {\n      cards.push({\n        type: \"picture-entity\",\n        entity: entityId,\n      });\n    } else if (domain === \"climate\") {\n      cards.push({\n        type: \"thermostat\",\n        entity: entityId,\n      });\n    } else if (domain === \"history_graph\" && stateObj) {\n      cards.push({\n        type: \"history-graph\",\n        entities: stateObj.attributes.entity_id,\n        hours_to_show: stateObj.attributes.hours_to_show,\n        title: stateObj.attributes.friendly_name,\n        refresh_interval: stateObj.attributes.refresh,\n      });\n    } else if (domain === \"media_player\") {\n      cards.push({\n        type: \"media-control\",\n        entity: entityId,\n      });\n    } else if (domain === \"plant\") {\n      cards.push({\n        type: \"plant-status\",\n        entity: entityId,\n      });\n    } else if (domain === \"weather\") {\n      cards.push({\n        type: \"weather-forecast\",\n        entity: entityId,\n      });\n    } else if (domain === \"weblink\" && stateObj) {\n      const conf: WeblinkConfig = {\n        type: \"weblink\",\n        url: stateObj.state,\n        name: computeStateName(stateObj),\n      };\n      if (\"icon\" in stateObj.attributes) {\n        conf.icon = stateObj.attributes.icon;\n      }\n      entities.push(conf);\n    } else {\n      entities.push(entityId);\n    }\n  }\n\n  if (entities.length > 0) {\n    cards.unshift({\n      type: \"entities\",\n      entities,\n      ...entityCardOptions,\n    });\n  }\n\n  return cards;\n};\n\nconst computeDefaultViewStates = (hass: HomeAssistant): HassEntities => {\n  const states = {};\n  Object.keys(hass.states).forEach((entityId) => {\n    const stateObj = hass.states[entityId];\n    if (\n      !stateObj.attributes.hidden &&\n      !HIDE_DOMAIN.has(computeStateDomain(stateObj))\n    ) {\n      states[entityId] = hass.states[entityId];\n    }\n  });\n  return states;\n};\n\nconst generateDefaultViewConfig = (\n  hass: HomeAssistant,\n  registries: Registries\n): LovelaceViewConfig => {\n  const states = computeDefaultViewStates(hass);\n  const path = \"default_view\";\n  const title = \"Home\";\n  const icon = undefined;\n\n  // In the case of a default view, we want to use the group order attribute\n  const groupOrders = {};\n  Object.keys(states).forEach((entityId) => {\n    const stateObj = states[entityId];\n    if (stateObj.attributes.order) {\n      groupOrders[entityId] = stateObj.attributes.order;\n    }\n  });\n\n  const splittedByAreas = splitByAreas(registries, states);\n\n  const config = generateViewConfig(\n    hass.localize,\n    path,\n    title,\n    icon,\n    splittedByAreas.otherEntities,\n    groupOrders\n  );\n\n  const areaCards: LovelaceCardConfig[] = [];\n\n  splittedByAreas.areasWithEntities.forEach(([area, entities]) => {\n    areaCards.push(\n      ...computeCards(entities.map((entity) => [entity.entity_id, entity]), {\n        title: area.name,\n        show_header_toggle: true,\n      })\n    );\n  });\n\n  config.cards!.unshift(...areaCards);\n\n  return config;\n};\n\nconst generateViewConfig = (\n  localize: LocalizeFunc,\n  path: string,\n  title: string | undefined,\n  icon: string | undefined,\n  entities: HassEntities,\n  groupOrders: { [entityId: string]: number }\n): LovelaceViewConfig => {\n  const splitted = splitByGroups(entities);\n  splitted.groups.sort(\n    (gr1, gr2) => groupOrders[gr1.entity_id] - groupOrders[gr2.entity_id]\n  );\n\n  const badgeEntities: { [domain: string]: string[] } = {};\n  const ungroupedEntitites: { [domain: string]: string[] } = {};\n\n  // Organize ungrouped entities in badges/ungrouped things\n  Object.keys(splitted.ungrouped).forEach((entityId) => {\n    const state = splitted.ungrouped[entityId];\n    const domain = computeStateDomain(state);\n\n    const coll = DOMAINS_BADGES.includes(domain)\n      ? badgeEntities\n      : ungroupedEntitites;\n\n    if (!(domain in coll)) {\n      coll[domain] = [];\n    }\n\n    coll[domain].push(state.entity_id);\n  });\n\n  let badges: string[] = [];\n  DOMAINS_BADGES.forEach((domain) => {\n    if (domain in badgeEntities) {\n      badges = badges.concat(badgeEntities[domain]);\n    }\n  });\n\n  let cards: LovelaceCardConfig[] = [];\n\n  splitted.groups.forEach((groupEntity) => {\n    cards = cards.concat(\n      computeCards(\n        groupEntity.attributes.entity_id.map(\n          (entityId): [string, HassEntity] => [entityId, entities[entityId]]\n        ),\n        {\n          title: computeStateName(groupEntity),\n          show_header_toggle: groupEntity.attributes.control !== \"hidden\",\n        }\n      )\n    );\n  });\n\n  Object.keys(ungroupedEntitites)\n    .sort()\n    .forEach((domain) => {\n      cards = cards.concat(\n        computeCards(\n          ungroupedEntitites[domain].map(\n            (entityId): [string, HassEntity] => [entityId, entities[entityId]]\n          ),\n          {\n            title: localize(`domain.${domain}`),\n          }\n        )\n      );\n    });\n\n  const view: LovelaceViewConfig = {\n    path,\n    title,\n    badges,\n    cards,\n  };\n\n  if (icon) {\n    view.icon = icon;\n  }\n\n  return view;\n};\n\nexport const generateLovelaceConfig = async (\n  hass: HomeAssistant,\n  localize: LocalizeFunc\n): Promise<LovelaceConfig> => {\n  const viewEntities = extractViews(hass.states);\n\n  const views = viewEntities.map((viewEntity: GroupEntity) => {\n    const states = getViewEntities(hass.states, viewEntity);\n\n    // In the case of a normal view, we use group order as specified in view\n    const groupOrders = {};\n    Object.keys(states).forEach((entityId, idx) => {\n      groupOrders[entityId] = idx;\n    });\n\n    return generateViewConfig(\n      localize,\n      computeObjectId(viewEntity.entity_id),\n      computeStateName(viewEntity),\n      viewEntity.attributes.icon,\n      states,\n      groupOrders\n    );\n  });\n\n  let title = hass.config.location_name;\n\n  // User can override default view. If they didn't, we will add one\n  // that contains all entities.\n  if (\n    viewEntities.length === 0 ||\n    viewEntities[0].entity_id !== DEFAULT_VIEW_ENTITY_ID\n  ) {\n    // We want to keep the registry subscriptions alive after generating the UI\n    // so that we don't serve up stale data after changing areas.\n    if (!subscribedRegistries) {\n      subscribedRegistries = true;\n      subscribeAreaRegistry(hass.connection, () => undefined);\n      subscribeDeviceRegistry(hass.connection, () => undefined);\n      subscribeEntityRegistry(hass.connection, () => undefined);\n    }\n\n    const [areas, devices, entities] = await Promise.all([\n      subscribeOne(hass.connection, subscribeAreaRegistry),\n      subscribeOne(hass.connection, subscribeDeviceRegistry),\n      subscribeOne(hass.connection, subscribeEntityRegistry),\n    ]);\n    const registries = { areas, devices, entities };\n\n    views.unshift(generateDefaultViewConfig(hass, registries));\n\n    // Add map of geo locations to default view if loaded\n    if (hass.config.components.includes(\"geo_location\")) {\n      if (views[0] && views[0].cards) {\n        views[0].cards.push({\n          type: \"map\",\n          geo_location_sources: [\"all\"],\n        });\n      }\n    }\n\n    // Make sure we don't have Home as title and first tab.\n    if (views.length > 1 && title === \"Home\") {\n      title = \"Home Assistant\";\n    }\n  }\n\n  if (__DEMO__) {\n    views[0].cards!.unshift({\n      type: \"custom:ha-demo-card\",\n    });\n  }\n\n  // User has no entities\n  if (views.length === 1 && views[0].cards!.length === 0) {\n    import(/* webpackChunkName: \"hui-empty-state-card\" */ \"../cards/hui-empty-state-card\");\n    views[0].cards!.push({\n      type: \"custom:hui-empty-state-card\",\n    });\n  }\n\n  return {\n    title,\n    views,\n  };\n};\n","import { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { navigate } from \"../../../common/navigate\";\nimport { toggleEntity } from \"../../../../src/panels/lovelace/common/entity/toggle-entity\";\nimport { ActionConfig } from \"../../../data/lovelace\";\n\nexport const handleClick = (\n  node: HTMLElement,\n  hass: HomeAssistant,\n  config: {\n    entity?: string;\n    camera_image?: string;\n    hold_action?: ActionConfig;\n    tap_action?: ActionConfig;\n  },\n  hold: boolean\n): void => {\n  let actionConfig: ActionConfig | undefined;\n\n  if (hold && config.hold_action) {\n    actionConfig = config.hold_action;\n  } else if (!hold && config.tap_action) {\n    actionConfig = config.tap_action;\n  }\n\n  if (!actionConfig) {\n    actionConfig = {\n      action: \"more-info\",\n    };\n  }\n\n  switch (actionConfig.action) {\n    case \"more-info\":\n      if (config.entity || config.camera_image) {\n        fireEvent(node, \"hass-more-info\", {\n          entityId: config.entity ? config.entity : config.camera_image!,\n        });\n      }\n      break;\n    case \"navigate\":\n      if (actionConfig.navigation_path) {\n        navigate(node, actionConfig.navigation_path);\n      }\n      break;\n    case \"toggle\":\n      if (config.entity) {\n        toggleEntity(hass, config.entity!);\n      }\n      break;\n    case \"call-service\": {\n      if (!actionConfig.service) {\n        return;\n      }\n      const [domain, service] = actionConfig.service.split(\".\", 2);\n      hass.callService(domain, service, actionConfig.service_data);\n    }\n  }\n};\n","import { HomeAssistant } from \"../../../types\";\nimport { PropertyValues } from \"lit-element\";\n\n// Check if config or Entity changed\nexport function hasConfigOrEntityChanged(\n  element: any,\n  changedProps: PropertyValues\n): boolean {\n  if (changedProps.has(\"_config\")) {\n    return true;\n  }\n\n  const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n  if (oldHass) {\n    return (\n      oldHass.states[element._config!.entity] !==\n      element.hass!.states[element._config!.entity]\n    );\n  }\n\n  return true;\n}\n","// Parse array of entity objects from config\nimport isValidEntityId from \"../../../common/entity/valid_entity_id\";\nimport { EntityConfig } from \"../entity-rows/types\";\n\nexport const processConfigEntities = <T extends EntityConfig>(\n  entities: Array<T | string>\n): T[] => {\n  if (!entities || !Array.isArray(entities)) {\n    throw new Error(\"Entities need to be an array\");\n  }\n\n  return entities.map(\n    (entityConf, index): T => {\n      if (\n        typeof entityConf === \"object\" &&\n        !Array.isArray(entityConf) &&\n        entityConf.type\n      ) {\n        return entityConf;\n      }\n\n      let config: T;\n\n      if (typeof entityConf === \"string\") {\n        // tslint:disable-next-line:no-object-literal-type-assertion\n        config = { entity: entityConf } as T;\n      } else if (typeof entityConf === \"object\" && !Array.isArray(entityConf)) {\n        if (!entityConf.entity) {\n          throw new Error(\n            `Entity object at position ${index} is missing entity field.`\n          );\n        }\n        config = entityConf as T;\n      } else {\n        throw new Error(`Invalid entity specified at position ${index}.`);\n      }\n\n      if (!isValidEntityId(config.entity)) {\n        throw new Error(\n          `Invalid entity ID at position ${index}: ${config.entity}`\n        );\n      }\n\n      return config;\n    }\n  );\n};\n","import { HomeAssistant } from \"../../../types\";\n\nexport interface Condition {\n  entity: string;\n  state?: string;\n  state_not?: string;\n}\n\nexport function checkConditionsMet(\n  conditions: Condition[],\n  hass: HomeAssistant\n): boolean {\n  return conditions.every((c) => {\n    const state = hass.states[c.entity]\n      ? hass!.states[c.entity].state\n      : \"unavailable\";\n\n    return c.state ? state === c.state : state !== c.state_not;\n  });\n}\n\nexport function validateConditionalConfig(conditions: Condition[]): boolean {\n  return conditions.every(\n    (c) => ((c.entity && (c.state || c.state_not)) as unknown) as boolean\n  );\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport { PaperToggleButtonElement } from \"@polymer/paper-toggle-button/paper-toggle-button\";\n\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { turnOnOffEntities } from \"../common/entity/turn-on-off-entities\";\nimport { HomeAssistant } from \"../../../types\";\nimport { forwardHaptic } from \"../../../data/haptics\";\n\n@customElement(\"hui-entities-toggle\")\nclass HuiEntitiesToggle extends LitElement {\n  @property() public entities?: string[];\n\n  @property() protected hass?: HomeAssistant;\n\n  @property() private _toggleEntities?: string[];\n\n  public updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (changedProperties.has(\"entities\")) {\n      this._toggleEntities = this.entities!.filter(\n        (entityId) =>\n          entityId in this.hass!.states &&\n          DOMAINS_TOGGLE.has(entityId.split(\".\", 1)[0])\n      );\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._toggleEntities) {\n      return html``;\n    }\n\n    return html`\n      <paper-toggle-button\n        ?checked=\"${this._toggleEntities!.some((entityId) => {\n          const stateObj = this.hass!.states[entityId];\n          return stateObj && stateObj.state === \"on\";\n        })}\"\n        @change=\"${this._callService}\"\n      ></paper-toggle-button>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        width: 38px;\n        display: block;\n      }\n      paper-toggle-button {\n        cursor: pointer;\n        --paper-toggle-button-label-spacing: 0;\n        padding: 13px 5px;\n        margin: -4px -5px;\n      }\n    `;\n  }\n\n  private _callService(ev: MouseEvent): void {\n    forwardHaptic(\"light\");\n    const turnOn = (ev.target as PaperToggleButtonElement).checked;\n    turnOnOffEntities(this.hass!, this._toggleEntities!, turnOn!);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-entities-toggle\": HuiEntitiesToggle;\n  }\n}\n","import computeStateName from \"../../../common/entity/compute_state_name\";\nimport {\n  LitElement,\n  html,\n  css,\n  CSSResult,\n  PropertyValues,\n  property,\n  TemplateResult,\n} from \"lit-element\";\n\nimport \"../../../components/entity/state-badge\";\nimport \"../../../components/ha-relative-time\";\nimport \"../../../components/ha-icon\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { computeRTL } from \"../../../common/util/compute_rtl\";\nimport { EntitiesCardEntityConfig } from \"../cards/types\";\n\nclass HuiGenericEntityRow extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public config?: EntitiesCardEntityConfig;\n\n  @property() public showSecondary: boolean = true;\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this.config) {\n      return html``;\n    }\n    const stateObj = this.config.entity\n      ? this.hass.states[this.config.entity]\n      : undefined;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this.config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <state-badge\n        .stateObj=\"${stateObj}\"\n        .overrideIcon=\"${this.config.icon}\"\n      ></state-badge>\n      <div class=\"flex\">\n        <div class=\"info\">\n          ${this.config.name || computeStateName(stateObj)}\n          <div class=\"secondary\">\n            ${!this.showSecondary\n              ? html`\n                  <slot name=\"secondary\"></slot>\n                `\n              : this.config.secondary_info === \"entity-id\"\n              ? stateObj.entity_id\n              : this.config.secondary_info === \"last-changed\"\n              ? html`\n                  <ha-relative-time\n                    .hass=\"${this.hass}\"\n                    .datetime=\"${stateObj.last_changed}\"\n                  ></ha-relative-time>\n                `\n              : \"\"}\n          </div>\n        </div>\n\n        <slot></slot>\n      </div>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (changedProps.has(\"hass\")) {\n      this.toggleAttribute(\"rtl\", computeRTL(this.hass!));\n    }\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      .flex {\n        flex: 1;\n        margin-left: 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        min-width: 0;\n      }\n      .info {\n        flex: 1 0 60px;\n      }\n      .info,\n      .info > * {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      .flex ::slotted(*) {\n        margin-left: 8px;\n        min-width: 0;\n      }\n      .flex ::slotted([slot=\"secondary\"]) {\n        margin-left: 0;\n      }\n      .secondary,\n      ha-relative-time {\n        display: block;\n        color: var(--secondary-text-color);\n      }\n      state-badge {\n        flex: 0 0 40px;\n      }\n      :host([rtl]) .flex {\n        margin-left: 0;\n        margin-right: 16px;\n      }\n      :host([rtl]) .flex ::slotted(*) {\n        margin-left: 0;\n        margin-right: 8px;\n      }\n    `;\n  }\n}\ncustomElements.define(\"hui-generic-entity-row\", HuiGenericEntityRow);\n","import \"@polymer/paper-toggle-button/paper-toggle-button\";\n\nimport { STATES_OFF } from \"../../../common/const\";\n\nimport parseAspectRatio from \"../../../common/util/parse-aspect-ratio\";\nimport {\n  LitElement,\n  TemplateResult,\n  html,\n  property,\n  CSSResult,\n  css,\n  PropertyValues,\n  query,\n  customElement,\n} from \"lit-element\";\nimport { HomeAssistant, CameraEntity } from \"../../../types\";\nimport { styleMap } from \"lit-html/directives/style-map\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport { fetchThumbnailUrlWithCache } from \"../../../data/camera\";\n\nconst UPDATE_INTERVAL = 10000;\nconst DEFAULT_FILTER = \"grayscale(100%)\";\n\nexport interface StateSpecificConfig {\n  [state: string]: string;\n}\n\n@customElement(\"hui-image\")\nexport class HuiImage extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public entity?: string;\n\n  @property() public image?: string;\n\n  @property() public stateImage?: StateSpecificConfig;\n\n  @property() public cameraImage?: string;\n\n  @property() public cameraView?: \"live\" | \"auto\";\n\n  @property() public aspectRatio?: string;\n\n  @property() public filter?: string;\n\n  @property() public stateFilter?: StateSpecificConfig;\n\n  @property() private _loadError?: boolean;\n\n  @property() private _cameraImageSrc?: string;\n\n  @query(\"img\") private _image!: HTMLImageElement;\n\n  private _lastImageHeight?: number;\n\n  private _cameraUpdater?: number;\n\n  private _attached?: boolean;\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._attached = true;\n    if (this.cameraImage && this.cameraView !== \"live\") {\n      this._startUpdateCameraInterval();\n    }\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._attached = false;\n    this._stopUpdateCameraInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    const ratio = this.aspectRatio ? parseAspectRatio(this.aspectRatio) : null;\n    const stateObj =\n      this.hass && this.entity ? this.hass.states[this.entity] : undefined;\n    const state = stateObj ? stateObj.state : \"unavailable\";\n\n    // Figure out image source to use\n    let imageSrc: string | undefined;\n    let cameraObj: CameraEntity | undefined;\n    // Track if we are we using a fallback image, used for filter.\n    let imageFallback = !this.stateImage;\n\n    if (this.cameraImage) {\n      if (this.cameraView === \"live\") {\n        cameraObj =\n          this.hass && (this.hass.states[this.cameraImage] as CameraEntity);\n      } else {\n        imageSrc = this._cameraImageSrc;\n      }\n    } else if (this.stateImage) {\n      const stateImage = this.stateImage[state];\n\n      if (stateImage) {\n        imageSrc = stateImage;\n      } else {\n        imageSrc = this.image;\n        imageFallback = true;\n      }\n    } else {\n      imageSrc = this.image;\n    }\n\n    // Figure out filter to use\n    let filter = this.filter || \"\";\n\n    if (this.stateFilter && this.stateFilter[state]) {\n      filter = this.stateFilter[state];\n    }\n\n    if (!filter && this.entity) {\n      const isOff = !stateObj || STATES_OFF.includes(state);\n      filter = isOff && imageFallback ? DEFAULT_FILTER : \"\";\n    }\n\n    return html`\n      <div\n        style=${styleMap({\n          paddingBottom:\n            ratio && ratio.w > 0 && ratio.h > 0\n              ? `${((100 * ratio.h) / ratio.w).toFixed(2)}%`\n              : \"\",\n        })}\n        class=${classMap({\n          ratio: Boolean(ratio && ratio.w > 0 && ratio.h > 0),\n        })}\n      >\n        ${this.cameraImage && this.cameraView === \"live\"\n          ? html`\n              <ha-camera-stream\n                .hass=\"${this.hass}\"\n                .stateObj=\"${cameraObj}\"\n              ></ha-camera-stream>\n            `\n          : html`\n              <img\n                id=\"image\"\n                src=${imageSrc}\n                @error=${this._onImageError}\n                @load=${this._onImageLoad}\n                style=${styleMap({\n                  filter,\n                  display: this._loadError ? \"none\" : \"block\",\n                })}\n              />\n            `}\n        <div\n          id=\"brokenImage\"\n          style=${styleMap({\n            height: `${this._lastImageHeight || \"100\"}px`,\n            display: this._loadError ? \"block\" : \"none\",\n          })}\n        ></div>\n      </div>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    if (changedProps.has(\"cameraImage\") && this.cameraView !== \"live\") {\n      this._updateCameraImageSrc();\n      this._startUpdateCameraInterval();\n      return;\n    }\n  }\n\n  private _startUpdateCameraInterval(): void {\n    this._stopUpdateCameraInterval();\n    if (this.cameraImage && this._attached) {\n      this._cameraUpdater = window.setInterval(\n        () => this._updateCameraImageSrc(),\n        UPDATE_INTERVAL\n      );\n    }\n  }\n\n  private _stopUpdateCameraInterval(): void {\n    if (this._cameraUpdater) {\n      clearInterval(this._cameraUpdater);\n    }\n  }\n\n  private _onImageError(): void {\n    this._loadError = true;\n  }\n\n  private async _onImageLoad(): Promise<void> {\n    this._loadError = false;\n    await this.updateComplete;\n    this._lastImageHeight = this._image.offsetHeight;\n  }\n\n  private async _updateCameraImageSrc(): Promise<void> {\n    if (!this.hass || !this.cameraImage) {\n      return;\n    }\n\n    const cameraState = this.hass.states[this.cameraImage] as\n      | CameraEntity\n      | undefined;\n\n    if (!cameraState) {\n      this._onImageError();\n      return;\n    }\n\n    this._cameraImageSrc = await fetchThumbnailUrlWithCache(\n      this.hass,\n      this.cameraImage\n    );\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      img {\n        display: block;\n        height: auto;\n        transition: filter 0.2s linear;\n        width: 100%;\n      }\n\n      .ratio {\n        position: relative;\n        width: 100%;\n        height: 0;\n      }\n\n      .ratio img,\n      .ratio div {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n      }\n\n      #brokenImage {\n        background: grey url(\"/static/images/image-broken.svg\") center/36px\n          no-repeat;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-image\": HuiImage;\n  }\n}\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport format_date from \"../../../common/datetime/format_date\";\nimport format_date_time from \"../../../common/datetime/format_date_time\";\nimport format_time from \"../../../common/datetime/format_time\";\nimport relativeTime from \"../../../common/datetime/relative_time\";\n\nconst FORMATS: { [key: string]: (ts: Date, lang: string) => string } = {\n  date: format_date,\n  datetime: format_date_time,\n  time: format_time,\n};\nconst INTERVAL_FORMAT = [\"relative\", \"total\"];\n\n@customElement(\"hui-timestamp-display\")\nclass HuiTimestampDisplay extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public ts?: Date;\n\n  @property() public format?:\n    | \"relative\"\n    | \"total\"\n    | \"date\"\n    | \"datetime\"\n    | \"time\";\n\n  @property() private _relative?: string;\n\n  private _connected?: boolean;\n\n  private _interval?: number;\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._connected = true;\n    this._startInterval();\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._connected = false;\n    this._clearInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.ts || !this.hass) {\n      return html``;\n    }\n\n    if (isNaN(this.ts.getTime())) {\n      return html`\n        Invalid date\n      `;\n    }\n\n    const format = this._format;\n\n    if (INTERVAL_FORMAT.includes(format)) {\n      return html`\n        ${this._relative}\n      `;\n    }\n    if (format in FORMATS) {\n      return html`\n        ${FORMATS[format](this.ts, this.hass.language)}\n      `;\n    }\n    return html`\n      Invalid format\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n    if (!changedProperties.has(\"format\") || !this._connected) {\n      return;\n    }\n\n    if (INTERVAL_FORMAT.includes(\"relative\")) {\n      this._startInterval();\n    } else {\n      this._clearInterval();\n    }\n  }\n\n  private get _format(): string {\n    return this.format || \"relative\";\n  }\n\n  private _startInterval(): void {\n    this._clearInterval();\n    if (this._connected && INTERVAL_FORMAT.includes(this._format)) {\n      this._updateRelative();\n      this._interval = window.setInterval(() => this._updateRelative(), 1000);\n    }\n  }\n\n  private _clearInterval(): void {\n    if (this._interval) {\n      clearInterval(this._interval);\n      this._interval = undefined;\n    }\n  }\n\n  private _updateRelative(): void {\n    if (this.ts && this.hass!.localize) {\n      this._relative =\n        this._format === \"relative\"\n          ? relativeTime(this.ts, this.hass!.localize)\n          : (this._relative = relativeTime(new Date(), this.hass!.localize, {\n              compareTime: this.ts,\n              includeTense: false,\n            }));\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-timestamp-display\": HuiTimestampDisplay;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResult,\n  css,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport \"../../../components/ha-icon\";\n\n@customElement(\"hui-warning-element\")\nexport class HuiWarningElement extends LitElement {\n  @property() public label?: string;\n\n  protected render(): TemplateResult | void {\n    return html`\n      <ha-icon icon=\"hass:alert\" .title=\"${this.label}\"></ha-icon>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-icon {\n        color: #fce588;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-warning-element\": HuiWarningElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResult,\n  css,\n  customElement,\n} from \"lit-element\";\n\n@customElement(\"hui-warning\")\nexport class HuiWarning extends LitElement {\n  protected render(): TemplateResult | void {\n    return html`\n      <slot></slot>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        color: black;\n        background-color: #fce588;\n        padding: 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-warning\": HuiWarning;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n} from \"lit-element\";\nimport \"@material/mwc-button\";\n\nimport \"./hui-notification-item-template\";\n\nimport { HomeAssistant } from \"../../../../types\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { HassNotification } from \"./types\";\n\n@customElement(\"hui-configurator-notification-item\")\nexport class HuiConfiguratorNotificationItem extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public notification?: HassNotification;\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this.notification) {\n      return html``;\n    }\n\n    return html`\n      <hui-notification-item-template>\n        <span slot=\"header\">${this.hass.localize(\"domain.configurator\")}</span>\n\n        <div>\n          ${this.hass.localize(\n            \"ui.notification_drawer.click_to_configure\",\n            \"entity\",\n            this.notification.attributes.friendly_name\n          )}\n        </div>\n\n        <mwc-button slot=\"actions\" @click=\"${this._handleClick}\"\n          >${this.hass.localize(\n            `state.configurator.${this.notification.state}`\n          )}</mwc-button\n        >\n      </hui-notification-item-template>\n    `;\n  }\n\n  private _handleClick(): void {\n    fireEvent(this, \"hass-more-info\", {\n      entityId: this.notification!.entity_id,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-configurator-notification-item\": HuiConfiguratorNotificationItem;\n  }\n}\n","import \"@material/mwc-button\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar\";\n\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"./hui-notification-item\";\nimport \"../../../../components/ha-paper-icon-button-next\";\n\nimport { EventsMixin } from \"../../../../mixins/events-mixin\";\nimport LocalizeMixin from \"../../../../mixins/localize-mixin\";\nimport { computeRTL } from \"../../../../common/util/compute_rtl\";\n\n/*\n * @appliesMixin EventsMixin\n * @appliesMixin LocalizeMixin\n */\nexport class HuiNotificationDrawer extends EventsMixin(\n  LocalizeMixin(PolymerElement)\n) {\n  static get template() {\n    return html`\n    <style include=\"paper-material-styles\">\n      :host {\n        bottom: 0;\n        left: 0;\n        position: absolute;\n        right: 0;\n        top: 0;\n      }\n\n      :host([hidden]) {\n        display: none;\n      }\n\n      .container {\n        align-items: stretch;\n        background: var(--sidebar-background-color, var(--primary-background-color));\n        bottom: 0;\n        box-shadow: var(--paper-material-elevation-1_-_box-shadow);\n        display: flex;\n        flex-direction: column;\n        overflow-y: hidden;\n        position: fixed;\n        top: 0;\n        transition: right .2s ease-in;\n        width: 500px;\n        z-index: 10;\n      }\n\n      :host([rtl]) .container {\n        transition: left .2s ease-in !important;\n      }\n\n      :host(:not(narrow)) .container {\n        right: -500px;\n      }\n\n      :host([rtl]:not(narrow)) .container {\n        left: -500px;\n      }\n\n      :host([narrow]) .container {\n        right: -100%;\n        width: 100%;\n      }\n\n      :host([rtl][narrow]) .container {\n        left: -100%;\n        width: 100%;\n      }\n\n      :host(.open) .container,\n      :host(.open[narrow]) .container {\n        right: 0;\n      }\n\n      :host([rtl].open) .container,\n      :host([rtl].open[narrow]) .container {\n        left: 0;\n      }\n\n      app-toolbar {\n        color: var(--primary-text-color);\n        border-bottom: 1px solid var(--divider-color);\n        background-color: var(--primary-background-color);\n        min-height: 64px;\n        width: calc(100% - 32px);\n        z-index: 11;\n      }\n\n      .overlay {\n        display: none;\n      }\n\n      :host(.open) .overlay {\n        bottom: 0;\n        display: block;\n        left: 0;\n        position: absolute;\n        right: 0;\n        top: 0;\n        z-index: 5;\n      }\n\n      .notifications {\n        overflow-y: auto;\n        padding-top: 16px;\n      }\n\n      .notification {\n        padding: 0 16px 16px;\n      }\n\n      .empty {\n        padding: 16px;\n        text-align: center;\n      }\n    </style>\n    <div class=\"overlay\" on-click=\"_closeDrawer\"></div>\n    <div class=\"container\">\n      <app-toolbar>\n        <div main-title>[[localize('ui.notification_drawer.title')]]</div>\n        <ha-paper-icon-button-next on-click=\"_closeDrawer\"></paper-icon-button>\n      </app-toolbar>\n      <div class=\"notifications\">\n        <template is=\"dom-if\" if=\"[[!_empty(notifications)]]\">\n          <dom-repeat items=\"[[notifications]]\">\n            <template>\n              <div class=\"notification\">\n                <hui-notification-item hass=\"[[hass]]\" notification=\"[[item]]\"></hui-notification-item>\n              </div>\n            </template>\n          </dom-repeat>\n        </template>\n        <template is=\"dom-if\" if=\"[[_empty(notifications)]]\">\n          <div class=\"empty\">[[localize('ui.notification_drawer.empty')]]<div>\n        </template>\n      </div>\n    </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      narrow: {\n        type: Boolean,\n        reflectToAttribute: true,\n      },\n      open: {\n        type: Boolean,\n        notify: true,\n        observer: \"_openChanged\",\n      },\n      hidden: {\n        type: Boolean,\n        value: true,\n        reflectToAttribute: true,\n      },\n      notifications: {\n        type: Array,\n        value: [],\n      },\n      rtl: {\n        type: Boolean,\n        reflectToAttribute: true,\n        computed: \"_computeRTL(hass)\",\n      },\n    };\n  }\n\n  _closeDrawer(ev) {\n    ev.stopPropagation();\n    this.open = false;\n  }\n\n  _empty(notifications) {\n    return notifications.length === 0;\n  }\n\n  _openChanged(open) {\n    clearTimeout(this._openTimer);\n    if (open) {\n      // Render closed then animate open\n      this.hidden = false;\n      this._openTimer = setTimeout(() => {\n        this.classList.add(\"open\");\n      }, 50);\n    } else {\n      // Animate closed then hide\n      this.classList.remove(\"open\");\n      this._openTimer = setTimeout(() => {\n        this.hidden = true;\n      }, 250);\n    }\n  }\n\n  _computeRTL(hass) {\n    return computeRTL(hass);\n  }\n}\ncustomElements.define(\"hui-notification-drawer\", HuiNotificationDrawer);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../../../../components/ha-card\";\n\n@customElement(\"hui-notification-item-template\")\nexport class HuiNotificationItemTemplate extends LitElement {\n  protected render(): TemplateResult | void {\n    return html`\n      <ha-card>\n        <div class=\"header\"><slot name=\"header\"></slot></div>\n        <div class=\"contents\"><slot></slot></div>\n        <div class=\"actions\"><slot name=\"actions\"></slot></div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .contents {\n        padding: 16px;\n      }\n\n      ha-card .header {\n        /* start paper-font-headline style */\n        font-family: \"Roboto\", \"Noto\", sans-serif;\n        -webkit-font-smoothing: antialiased; /* OS X subpixel AA bleed bug */\n        text-rendering: optimizeLegibility;\n        font-size: 24px;\n        font-weight: 400;\n        letter-spacing: -0.012em;\n        line-height: 32px;\n        /* end paper-font-headline style */\n\n        color: var(--primary-text-color);\n        padding: 16px 16px 0;\n      }\n\n      .actions {\n        border-top: 1px solid #e8e8e8;\n        padding: 5px 16px;\n      }\n\n      ::slotted(.primary) {\n        color: var(--primary-color);\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-notification-item-template\": HuiNotificationItemTemplate;\n  }\n}\n","import {\n  LitElement,\n  property,\n  customElement,\n  PropertyValues,\n  TemplateResult,\n  html,\n} from \"lit-element\";\n\nimport \"./hui-configurator-notification-item\";\nimport \"./hui-persistent-notification-item\";\n\nimport { HomeAssistant } from \"../../../../types\";\nimport { HassNotification } from \"./types\";\n\n@customElement(\"hui-notification-item\")\nexport class HuiNotificationItem extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public notification?: HassNotification;\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (!this.hass || !this.notification || changedProps.has(\"notification\")) {\n      return true;\n    }\n\n    return false;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this.notification) {\n      return html``;\n    }\n\n    return this.notification.entity_id\n      ? html`\n          <hui-configurator-notification-item\n            .hass=\"${this.hass}\"\n            .notification=\"${this.notification}\"\n          ></hui-configurator-notification-item>\n        `\n      : html`\n          <hui-persistent-notification-item\n            .hass=\"${this.hass}\"\n            .notification=\"${this.notification}\"\n          ></hui-persistent-notification-item>\n        `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-notification-item\": HuiNotificationItem;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n} from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\n\ndeclare global {\n  // tslint:disable-next-line\n  interface HASSDomEvents {\n    \"opened-changed\": { value: boolean };\n  }\n}\n\nclass HuiNotificationsButton extends LitElement {\n  @property() public notifications?: string[];\n  @property() public opened?: boolean;\n\n  protected render(): TemplateResult | void {\n    return html`\n      <paper-icon-button\n        icon=\"hass:bell\"\n        @click=\"${this._clicked}\"\n      ></paper-icon-button>\n      ${this.notifications && this.notifications.length > 0\n        ? html`\n            <span class=\"indicator\">\n              <div>${this.notifications.length}</div>\n            </span>\n          `\n        : \"\"}\n    `;\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      css`\n        :host {\n          position: relative;\n        }\n\n        .indicator {\n          position: absolute;\n          top: 0px;\n          right: -3px;\n          width: 20px;\n          height: 20px;\n          border-radius: 50%;\n          background: var(--accent-color);\n          pointer-events: none;\n          z-index: 1;\n        }\n\n        .indicator > div {\n          right: 7px;\n          top: 3px;\n          position: absolute;\n          font-size: 0.55em;\n        }\n      `,\n    ];\n  }\n\n  private _clicked() {\n    this.opened = true;\n    fireEvent(this, \"opened-changed\", { value: this.opened });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-notifications-button\": HuiNotificationsButton;\n  }\n}\n\ncustomElements.define(\"hui-notifications-button\", HuiNotificationsButton);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport \"@material/mwc-button\";\nimport \"@polymer/paper-tooltip/paper-tooltip\";\n\nimport \"../../../../components/ha-relative-time\";\nimport \"../../../../components/ha-markdown\";\nimport \"./hui-notification-item-template\";\n\nimport { HomeAssistant } from \"../../../../types\";\nimport { HassNotification } from \"./types\";\n\n@customElement(\"hui-persistent-notification-item\")\nexport class HuiPersistentNotificationItem extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() public notification?: HassNotification;\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this.notification) {\n      return html``;\n    }\n\n    return html`\n      <hui-notification-item-template>\n        <span slot=\"header\">${this._computeTitle(this.notification)}</span>\n\n        <ha-markdown content=\"${this.notification.message}\"></ha-markdown>\n\n        <div class=\"time\">\n          <span>\n            <ha-relative-time\n              .hass=\"${this.hass}\"\n              .datetime=\"${this.notification.created_at}\"\n            ></ha-relative-time>\n            <paper-tooltip\n              >${this._computeTooltip(\n                this.hass,\n                this.notification\n              )}</paper-tooltip\n            >\n          </span>\n        </div>\n\n        <mwc-button slot=\"actions\" @click=\"${this._handleDismiss}\"\n          >${this.hass.localize(\n            \"ui.card.persistent_notification.dismiss\"\n          )}</mwc-button\n        >\n      </hui-notification-item-template>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .time {\n        display: flex;\n        justify-content: flex-end;\n        margin-top: 6px;\n      }\n      ha-relative-time {\n        color: var(--secondary-text-color);\n      }\n      a {\n        color: var(--primary-color);\n      }\n    `;\n  }\n\n  private _handleDismiss(): void {\n    this.hass!.callService(\"persistent_notification\", \"dismiss\", {\n      notification_id: this.notification!.notification_id,\n    });\n  }\n\n  private _computeTitle(notification: HassNotification): string | undefined {\n    return notification.title || notification.notification_id;\n  }\n\n  private _computeTooltip(\n    hass: HomeAssistant,\n    notification: HassNotification\n  ): string | undefined {\n    if (!hass || !notification) {\n      return undefined;\n    }\n\n    const d = new Date(notification.created_at!);\n    return d.toLocaleDateString(hass.language, {\n      year: \"numeric\",\n      month: \"short\",\n      day: \"numeric\",\n      minute: \"numeric\",\n      hour: \"numeric\",\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-persistent-notification-item\": HuiPersistentNotificationItem;\n  }\n}\n","import { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { Lovelace } from \"../../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"show-edit-card\": EditCardDialogParams;\n  }\n}\n\nlet registeredDialog = false;\nconst dialogShowEvent = \"show-edit-card\";\nconst dialogTag = \"hui-dialog-edit-card\";\n\nexport interface EditCardDialogParams {\n  lovelace: Lovelace;\n  path: [number] | [number, number];\n}\n\nconst registerEditCardDialog = (element: HTMLElement): Event =>\n  fireEvent(element, \"register-dialog\", {\n    dialogShowEvent,\n    dialogTag,\n    dialogImport: () =>\n      import(/* webpackChunkName: \"hui-dialog-edit-card\" */ \"./hui-dialog-edit-card\"),\n  });\n\nexport const showEditCardDialog = (\n  element: HTMLElement,\n  editCardDialogParams: EditCardDialogParams\n): void => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    registerEditCardDialog(element);\n  }\n  fireEvent(element, dialogShowEvent, editCardDialogParams);\n};\n","import {\n  LovelaceConfig,\n  LovelaceCardConfig,\n  LovelaceViewConfig,\n} from \"../../../data/lovelace\";\n\nexport const addCard = (\n  config: LovelaceConfig,\n  path: [number],\n  cardConfig: LovelaceCardConfig\n): LovelaceConfig => {\n  const [viewIndex] = path;\n  const views: LovelaceViewConfig[] = [];\n\n  config.views.forEach((viewConf, index) => {\n    if (index !== viewIndex) {\n      views.push(config.views[index]);\n      return;\n    }\n\n    const cards = viewConf.cards\n      ? [...viewConf.cards, cardConfig]\n      : [cardConfig];\n\n    views.push({\n      ...viewConf,\n      cards,\n    });\n  });\n\n  return {\n    ...config,\n    views,\n  };\n};\n\nexport const replaceCard = (\n  config: LovelaceConfig,\n  path: [number, number],\n  cardConfig: LovelaceCardConfig\n): LovelaceConfig => {\n  const [viewIndex, cardIndex] = path;\n  const views: LovelaceViewConfig[] = [];\n\n  config.views.forEach((viewConf, index) => {\n    if (index !== viewIndex) {\n      views.push(config.views[index]);\n      return;\n    }\n\n    views.push({\n      ...viewConf,\n      cards: (viewConf.cards || []).map((origConf, ind) =>\n        ind === cardIndex ? cardConfig : origConf\n      ),\n    });\n  });\n\n  return {\n    ...config,\n    views,\n  };\n};\n\nexport const deleteCard = (\n  config: LovelaceConfig,\n  path: [number, number]\n): LovelaceConfig => {\n  const [viewIndex, cardIndex] = path;\n  const views: LovelaceViewConfig[] = [];\n\n  config.views.forEach((viewConf, index) => {\n    if (index !== viewIndex) {\n      views.push(config.views[index]);\n      return;\n    }\n\n    views.push({\n      ...viewConf,\n      cards: (viewConf.cards || []).filter(\n        (_origConf, ind) => ind !== cardIndex\n      ),\n    });\n  });\n\n  return {\n    ...config,\n    views,\n  };\n};\n\nexport const swapCard = (\n  config: LovelaceConfig,\n  path1: [number, number],\n  path2: [number, number]\n): LovelaceConfig => {\n  const card1 = config.views[path1[0]].cards![path1[1]];\n  const card2 = config.views[path2[0]].cards![path2[1]];\n\n  const origView1 = config.views[path1[0]];\n  const newView1 = {\n    ...origView1,\n    cards: origView1.cards!.map((origCard, index) =>\n      index === path1[1] ? card2 : origCard\n    ),\n  };\n\n  const origView2 = path1[0] === path2[0] ? newView1 : config.views[path2[0]];\n  const newView2 = {\n    ...origView2,\n    cards: origView2.cards!.map((origCard, index) =>\n      index === path2[1] ? card1 : origCard\n    ),\n  };\n\n  return {\n    ...config,\n    views: config.views.map((origView, index) =>\n      index === path2[0] ? newView2 : index === path1[0] ? newView1 : origView\n    ),\n  };\n};\n\nexport const moveCard = (\n  config: LovelaceConfig,\n  fromPath: [number, number],\n  toPath: [number]\n): LovelaceConfig => {\n  if (fromPath[0] === toPath[0]) {\n    throw new Error(\"You can not move a card to the view it is in.\");\n  }\n  const fromView = config.views[fromPath[0]];\n  const card = fromView.cards![fromPath[1]];\n\n  const newView1 = {\n    ...fromView,\n    cards: (fromView.cards || []).filter(\n      (_origConf, ind) => ind !== fromPath[1]\n    ),\n  };\n\n  const toView = config.views[toPath[0]];\n  const cards = toView.cards ? [...toView.cards, card] : [card];\n\n  const newView2 = {\n    ...toView,\n    cards,\n  };\n\n  return {\n    ...config,\n    views: config.views.map((origView, index) =>\n      index === toPath[0]\n        ? newView2\n        : index === fromPath[0]\n        ? newView1\n        : origView\n    ),\n  };\n};\n\nexport const addView = (\n  config: LovelaceConfig,\n  viewConfig: LovelaceViewConfig\n): LovelaceConfig => ({\n  ...config,\n  views: config.views.concat(viewConfig),\n});\n\nexport const replaceView = (\n  config: LovelaceConfig,\n  viewIndex: number,\n  viewConfig: LovelaceViewConfig\n): LovelaceConfig => ({\n  ...config,\n  views: config.views.map((origView, index) =>\n    index === viewIndex ? viewConfig : origView\n  ),\n});\n\nexport const swapView = (\n  config: LovelaceConfig,\n  path1: number,\n  path2: number\n): LovelaceConfig => {\n  const view1 = config.views[path1];\n  const view2 = config.views[path2];\n\n  return {\n    ...config,\n    views: config.views.map((origView, index) =>\n      index === path2 ? view1 : index === path1 ? view2 : origView\n    ),\n  };\n};\n\nexport const deleteView = (\n  config: LovelaceConfig,\n  viewIndex: number\n): LovelaceConfig => ({\n  ...config,\n  views: config.views.filter((_origView, index) => index !== viewIndex),\n});\n","import { fireEvent } from \"../../../../common/dom/fire_event\";\nimport { Lovelace } from \"../../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"show-edit-lovelace\": Lovelace;\n  }\n}\n\nlet registeredDialog = false;\nconst dialogShowEvent = \"show-edit-lovelace\";\nconst dialogTag = \"hui-dialog-edit-lovelace\";\n\nconst registerEditLovelaceDialog = (element: HTMLElement): Event =>\n  fireEvent(element, \"register-dialog\", {\n    dialogShowEvent,\n    dialogTag,\n    dialogImport: () =>\n      import(/* webpackChunkName: \"hui-dialog-edit-lovelace\" */ \"./hui-dialog-edit-lovelace\"),\n  });\n\nexport const showEditLovelaceDialog = (\n  element: HTMLElement,\n  lovelace: Lovelace\n): void => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    registerEditLovelaceDialog(element);\n  }\n  fireEvent(element, dialogShowEvent, lovelace);\n};\n","import { fireEvent } from \"../../../common/dom/fire_event\";\nimport { Lovelace } from \"../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"show-save-config\": SaveDialogParams;\n  }\n}\n\nconst dialogShowEvent = \"show-save-config\";\nconst dialogTag = \"hui-dialog-save-config\";\n\nexport interface SaveDialogParams {\n  lovelace: Lovelace;\n}\n\nlet registeredDialog = false;\n\nexport const showSaveDialog = (\n  element: HTMLElement,\n  saveDialogParams: SaveDialogParams\n) => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    fireEvent(element, \"register-dialog\", {\n      dialogShowEvent,\n      dialogTag,\n      dialogImport: () =>\n        import(/* webpackChunkName: \"hui-dialog-save-config\" */ \"./hui-dialog-save-config\"),\n    });\n  }\n  fireEvent(element, dialogShowEvent, saveDialogParams);\n};\n","import { HASSDomEvent, fireEvent } from \"../../../../common/dom/fire_event\";\nimport { Lovelace } from \"../../types\";\n\ndeclare global {\n  // for fire event\n  interface HASSDomEvents {\n    \"reload-lovelace\": undefined;\n    \"show-edit-view\": EditViewDialogParams;\n  }\n  // for add event listener\n  interface HTMLElementEventMap {\n    \"reload-lovelace\": HASSDomEvent<undefined>;\n  }\n}\n\nlet registeredDialog = false;\nconst dialogShowEvent = \"show-edit-view\";\nconst dialogTag = \"hui-dialog-edit-view\";\n\nexport interface EditViewDialogParams {\n  lovelace: Lovelace;\n  viewIndex?: number;\n}\n\nconst registerEditViewDialog = (element: HTMLElement): Event =>\n  fireEvent(element, \"register-dialog\", {\n    dialogShowEvent,\n    dialogTag,\n    dialogImport: () =>\n      import(/* webpackChunkName: \"hui-dialog-edit-view\" */ \"./hui-dialog-edit-view\"),\n  });\n\nexport const showEditViewDialog = (\n  element: HTMLElement,\n  editViewDialogParams: EditViewDialogParams\n): void => {\n  if (!registeredDialog) {\n    registeredDialog = true;\n    registerEditViewDialog(element);\n  }\n  fireEvent(element, dialogShowEvent, editViewDialogParams);\n};\n","import {\n  checkConditionsMet,\n  validateConditionalConfig,\n} from \"../../lovelace/common/validate-condition\";\nimport { createStyledHuiElement } from \"../cards/picture-elements/create-styled-hui-element\";\nimport {\n  LovelaceElement,\n  LovelaceElementConfig,\n  ConditionalElementConfig,\n} from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\nclass HuiConditionalElement extends HTMLElement implements LovelaceElement {\n  public _hass?: HomeAssistant;\n  private _config?: ConditionalElementConfig;\n  private _elements: LovelaceElement[] = [];\n\n  public setConfig(config: ConditionalElementConfig): void {\n    if (\n      !config.conditions ||\n      !Array.isArray(config.conditions) ||\n      !config.elements ||\n      !Array.isArray(config.elements) ||\n      !validateConditionalConfig(config.conditions)\n    ) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    if (this._elements.length > 0) {\n      this._elements.map((el: LovelaceElement) => {\n        if (el.parentElement) {\n          el.parentElement.removeChild(el);\n        }\n      });\n\n      this._elements = [];\n    }\n\n    this._config = config;\n\n    this._config.elements.map((elementConfig: LovelaceElementConfig) => {\n      this._elements.push(createStyledHuiElement(elementConfig));\n    });\n\n    this.updateElements();\n  }\n\n  set hass(hass: HomeAssistant) {\n    this._hass = hass;\n\n    this.updateElements();\n  }\n\n  private updateElements() {\n    if (!this._hass || !this._config) {\n      return;\n    }\n\n    const visible = checkConditionsMet(this._config.conditions, this._hass);\n\n    this._elements.map((el: LovelaceElement) => {\n      if (visible) {\n        el.hass = this._hass;\n        if (!el.parentElement) {\n          this.appendChild(el);\n        }\n      } else if (el.parentElement) {\n        el.parentElement.removeChild(el);\n      }\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-conditional-element\": HuiConditionalElement;\n  }\n}\n\ncustomElements.define(\"hui-conditional-element\", HuiConditionalElement);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n} from \"lit-element\";\n\nimport \"../../../components/ha-icon\";\n\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, IconElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-icon-element\")\nexport class HuiIconElement extends LitElement implements LovelaceElement {\n  public hass?: HomeAssistant;\n  @property() private _config?: IconElementConfig;\n\n  public setConfig(config: IconElementConfig): void {\n    if (!config.icon) {\n      throw Error(\"Invalid Configuration: 'icon' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-icon\n        .icon=\"${this._config.icon}\"\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      ></ha-icon>\n    `;\n  }\n\n  private _handleTap(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-icon-element\": HuiIconElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport \"../components/hui-image\";\n\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, ImageElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-image-element\")\nexport class HuiImageElement extends LitElement implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: ImageElementConfig;\n\n  public setConfig(config: ImageElementConfig): void {\n    if (!config) {\n      throw Error(\"Error in element configuration\");\n    }\n\n    this.classList.toggle(\n      \"clickable\",\n      config.tap_action && config.tap_action.action !== \"none\"\n    );\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <hui-image\n        .hass=\"${this.hass}\"\n        .entity=\"${this._config.entity}\"\n        .image=\"${this._config.image}\"\n        .stateImage=\"${this._config.state_image}\"\n        .cameraImage=\"${this._config.camera_image}\"\n        .filter=\"${this._config.filter}\"\n        .stateFilter=\"${this._config.state_filter}\"\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        .aspectRatio=\"${this._config.aspect_ratio}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      ></hui-image>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host(.clickable) {\n        cursor: pointer;\n        overflow: hidden;\n        -webkit-touch-callout: none !important;\n      }\n      hui-image {\n        -webkit-user-select: none !important;\n      }\n    `;\n  }\n\n  private _handleTap(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-image-element\": HuiImageElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  CSSResult,\n  css,\n} from \"lit-element\";\n\nimport \"../../../components/buttons/ha-call-service-button\";\n\nimport { LovelaceElement, ServiceButtonElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-service-button-element\")\nexport class HuiServiceButtonElement extends LitElement\n  implements LovelaceElement {\n  public hass?: HomeAssistant;\n  @property() private _config?: ServiceButtonElementConfig;\n  private _domain?: string;\n  private _service?: string;\n\n  static get properties() {\n    return { _config: {} };\n  }\n\n  public setConfig(config: ServiceButtonElementConfig): void {\n    if (!config || !config.service) {\n      throw Error(\"Invalid Configuration: 'service' required\");\n    }\n\n    [this._domain, this._service] = config.service.split(\".\", 2);\n\n    if (!this._domain) {\n      throw Error(\"Invalid Configuration: 'service' does not have a domain\");\n    }\n\n    if (!this._service) {\n      throw Error(\n        \"Invalid Configuration: 'service' does not have a service name\"\n      );\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    return html`\n      <ha-call-service-button\n        .hass=\"${this.hass}\"\n        .domain=\"${this._domain}\"\n        .service=\"${this._service}\"\n        .serviceData=\"${this._config.service_data}\"\n        >${this._config.title}</ha-call-service-button\n      >\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-call-service-button {\n        color: var(--primary-color);\n        white-space: nowrap;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-service-button-element\": HuiServiceButtonElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/entity/ha-state-label-badge\";\nimport \"../components/hui-warning-element\";\n\nimport computeStateName from \"../../../common/entity/compute_state_name\";\nimport { LovelaceElement, StateBadgeElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-state-badge-element\")\nexport class HuiStateBadgeElement extends LitElement\n  implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: StateBadgeElementConfig;\n\n  public setConfig(config: StateBadgeElementConfig): void {\n    if (!config.entity) {\n      throw Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity!];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=\"${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}\"\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <ha-state-label-badge\n        .hass=\"${this.hass}\"\n        .state=\"${stateObj}\"\n        .title=\"${this._config.title === undefined\n          ? computeStateName(stateObj)\n          : this._config.title === null\n          ? \"\"\n          : this._config.title}\"\n      ></ha-state-label-badge>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-state-badge-element\": HuiStateBadgeElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/entity/state-badge\";\nimport \"../components/hui-warning-element\";\n\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, StateIconElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-state-icon-element\")\nexport class HuiStateIconElement extends LitElement implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: StateIconElementConfig;\n\n  public setConfig(config: StateIconElementConfig): void {\n    if (!config.entity) {\n      throw Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity!];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <state-badge\n        .stateObj=\"${stateObj}\"\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        @ha-click=\"${this._handleClick}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n        .overrideIcon=${this._config.icon}\n      ></state-badge>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n    `;\n  }\n\n  private _handleClick(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-state-icon-element\": HuiStateIconElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/entity/ha-state-label-badge\";\nimport \"../components/hui-warning-element\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\nimport { computeTooltip } from \"../common/compute-tooltip\";\nimport { handleClick } from \"../common/handle-click\";\nimport { longPress } from \"../common/directives/long-press-directive\";\nimport { LovelaceElement, StateLabelElementConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-state-label-element\")\nclass HuiStateLabelElement extends LitElement implements LovelaceElement {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: StateLabelElementConfig;\n\n  public setConfig(config: StateLabelElementConfig): void {\n    if (!config.entity) {\n      throw Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity!];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning-element\n          label=${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}\n        ></hui-warning-element>\n      `;\n    }\n\n    return html`\n      <div\n        .title=\"${computeTooltip(this.hass, this._config)}\"\n        @ha-click=\"${this._handleTap}\"\n        @ha-hold=\"${this._handleHold}\"\n        .longPress=\"${longPress()}\"\n      >\n        ${this._config.prefix}${stateObj\n          ? computeStateDisplay(\n              this.hass.localize,\n              stateObj,\n              this.hass.language\n            )\n          : \"-\"}${this._config.suffix}\n      </div>\n    `;\n  }\n\n  private _handleTap(): void {\n    handleClick(this, this.hass!, this._config!, false);\n  }\n\n  private _handleHold(): void {\n    handleClick(this, this.hass!, this._config!, true);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        cursor: pointer;\n      }\n      div {\n        padding: 8px;\n        white-space: nowrap;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-state-label-element\": HuiStateLabelElement;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../../../components/ha-climate-state\";\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-climate-entity-row\")\nclass HuiClimateEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <ha-climate-state\n          .hass=\"${this.hass}\"\n          .stateObj=\"${stateObj}\"\n        ></ha-climate-state>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-climate-state {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-climate-entity-row\": HuiClimateEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/ha-cover-controls\";\nimport \"../../../components/ha-cover-tilt-controls\";\nimport \"../components/hui-warning\";\n\nimport { isTiltOnly } from \"../../../util/cover-model\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-cover-entity-row\")\nclass HuiCoverEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${isTiltOnly(stateObj)\n          ? html`\n              <ha-cover-tilt-controls\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-cover-tilt-controls>\n            `\n          : html`\n              <ha-cover-controls\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-cover-controls>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      ha-cover-controls,\n      ha-cover-tilt-controls {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-cover-entity-row\": HuiCoverEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\nimport { DOMAINS_TOGGLE } from \"../../../common/const\";\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-group-entity-row\")\nclass HuiGroupEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${this._computeCanToggle(stateObj.attributes.entity_id)\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <div>\n                ${computeStateDisplay(\n                  this.hass!.localize,\n                  stateObj,\n                  this.hass.language\n                )}\n              </div>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  private _computeCanToggle(entityIds): boolean {\n    return entityIds.some((entityId) =>\n      DOMAINS_TOGGLE.has(entityId.split(\".\", 1)[0])\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-group-entity-row\": HuiGroupEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  PropertyValues,\n  customElement,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/paper-time-input.js\";\n// tslint:disable-next-line:no-duplicate-imports\nimport { PaperTimeInput } from \"../../../components/paper-time-input.js\";\nimport \"../../../components/ha-date-input\";\n// tslint:disable-next-line:no-duplicate-imports\nimport { HaDateInput } from \"../../../components/ha-date-input\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { setInputDateTimeValue } from \"../../../data/input_datetime\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-input-datetime-entity-row\")\nclass HuiInputDatetimeEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.attributes.has_date\n          ? html`\n              <ha-date-input\n                .year=${stateObj.attributes.year}\n                .month=${(\"0\" + stateObj.attributes.month).slice(-2)}\n                .day=${(\"0\" + stateObj.attributes.day).slice(-2)}\n                @change=${this._selectedValueChanged}\n                @click=${this._stopEventPropagation}\n              ></ha-date-input>\n              ${stateObj.attributes.has_time ? \",\" : \"\"}\n            `\n          : ``}\n        ${stateObj.attributes.has_time\n          ? html`\n              <paper-time-input\n                .hour=${stateObj.state === \"unknown\"\n                  ? \"\"\n                  : (\"0\" + stateObj.attributes.hour).slice(-2)}\n                .min=${stateObj.state === \"unknown\"\n                  ? \"\"\n                  : (\"0\" + stateObj.attributes.minute).slice(-2)}\n                .amPm=${false}\n                @change=${this._selectedValueChanged}\n                @click=${this._stopEventPropagation}\n                hide-label\n                format=\"24\"\n              ></paper-time-input>\n            `\n          : ``}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  private _stopEventPropagation(ev: Event): void {\n    ev.stopPropagation();\n  }\n\n  private get _timeInputEl(): PaperTimeInput {\n    return this.shadowRoot!.querySelector(\"paper-time-input\")!;\n  }\n\n  private get _dateInputEl(): HaDateInput {\n    return this.shadowRoot!.querySelector(\"ha-date-input\")!;\n  }\n\n  private _selectedValueChanged(ev): void {\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    const time =\n      this._timeInputEl !== null\n        ? this._timeInputEl.value.trim() + \":00\"\n        : undefined;\n\n    const date =\n      this._dateInputEl !== null ? this._dateInputEl.value : undefined;\n\n    if (time !== stateObj.state) {\n      setInputDateTimeValue(this.hass!, stateObj.entity_id, time, date);\n    }\n\n    ev.target.blur();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-datetime-entity-row\": HuiInputDatetimeEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  css,\n  CSSResult,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/ha-slider\";\nimport \"../components/hui-warning\";\n\nimport { computeRTLDirection } from \"../../../common/util/compute_rtl\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { setValue } from \"../../../data/input_text\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-input-number-entity-row\")\nclass HuiInputNumberEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  private _loaded?: boolean;\n\n  private _updated?: boolean;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (this._updated && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected firstUpdated(): void {\n    this._updated = true;\n    if (this.isConnected && !this._loaded) {\n      this._initialLoad();\n    }\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>\n          ${stateObj.attributes.mode === \"slider\"\n            ? html`\n                <div class=\"flex\">\n                  <ha-slider\n                    .dir=\"${computeRTLDirection(this.hass!)}\"\n                    .step=\"${Number(stateObj.attributes.step)}\"\n                    .min=\"${Number(stateObj.attributes.min)}\"\n                    .max=\"${Number(stateObj.attributes.max)}\"\n                    .value=\"${Number(stateObj.state)}\"\n                    pin\n                    @change=\"${this._selectedValueChanged}\"\n                    ignore-bar-touch\n                    id=\"input\"\n                  ></ha-slider>\n                  <span class=\"state\">\n                    ${Number(stateObj.state)}\n                    ${stateObj.attributes.unit_of_measurement}\n                  </span>\n                </div>\n              `\n            : html`\n                <paper-input\n                  no-label-float\n                  auto-validate\n                  .pattern=\"[0-9]+([\\\\.][0-9]+)?\"\n                  .step=\"${Number(stateObj.attributes.step)}\"\n                  .min=\"${Number(stateObj.attributes.min)}\"\n                  .max=\"${Number(stateObj.attributes.max)}\"\n                  .value=\"${Number(stateObj.state)}\"\n                  type=\"number\"\n                  @change=\"${this._selectedValueChanged}\"\n                  id=\"input\"\n                ></paper-input>\n              `}\n        </div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .flex {\n        display: flex;\n        align-items: center;\n      }\n      .state {\n        min-width: 45px;\n        text-align: end;\n      }\n      paper-input {\n        text-align: end;\n      }\n    `;\n  }\n\n  private async _initialLoad(): Promise<void> {\n    this._loaded = true;\n    await this.updateComplete;\n    const element = this.shadowRoot!.querySelector(\".state\") as HTMLElement;\n\n    if (!element || !this.parentElement) {\n      return;\n    }\n\n    element.hidden = this.parentElement.clientWidth <= 350;\n  }\n\n  private get _inputElement(): { value: string } {\n    // linter recommended the following syntax\n    return (this.shadowRoot!.getElementById(\"input\") as unknown) as {\n      value: string;\n    };\n  }\n\n  private _selectedValueChanged(): void {\n    const element = this._inputElement;\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (element.value !== stateObj.state) {\n      setValue(this.hass!, stateObj.entity_id, element.value!);\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-number-entity-row\": HuiInputNumberEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-listbox/paper-listbox\";\n\nimport \"../../../components/ha-paper-dropdown-menu\";\nimport \"../../../components/entity/state-badge\";\nimport \"../components/hui-warning\";\n\nimport computeStateName from \"../../../common/entity/compute_state_name\";\n\nimport { HomeAssistant, InputSelectEntity } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { setInputSelectOption } from \"../../../data/input-select\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\nimport { forwardHaptic } from \"../../../data/haptics\";\nimport { stopPropagation } from \"../../../common/dom/stop_propagation\";\n\n@customElement(\"hui-input-select-entity-row\")\nclass HuiInputSelectEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as\n      | InputSelectEntity\n      | undefined;\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <state-badge .stateObj=\"${stateObj}\"></state-badge>\n      <ha-paper-dropdown-menu\n        .label=${this._config.name || computeStateName(stateObj)}\n        .value=${stateObj.state}\n        @iron-select=${this._selectedChanged}\n        @click=${stopPropagation}\n      >\n        <paper-listbox slot=\"dropdown-content\">\n          ${stateObj.attributes.options.map(\n            (option) => html`\n              <paper-item>${option}</paper-item>\n            `\n          )}\n        </paper-listbox>\n      </ha-paper-dropdown-menu>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n\n    if (!this.hass || !this._config) {\n      return;\n    }\n\n    const stateObj = this.hass.states[this._config.entity] as\n      | InputSelectEntity\n      | undefined;\n\n    if (!stateObj) {\n      return;\n    }\n\n    // Update selected after rendering the items or else it won't work in Firefox\n    this.shadowRoot!.querySelector(\n      \"paper-listbox\"\n    )!.selected = stateObj.attributes.options.indexOf(stateObj.state);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      ha-paper-dropdown-menu {\n        margin-left: 16px;\n        flex: 1;\n      }\n\n      paper-item {\n        cursor: pointer;\n        min-width: 200px;\n      }\n    `;\n  }\n\n  private _selectedChanged(ev): void {\n    const stateObj = this.hass!.states[this._config!.entity];\n    const option = ev.target.selectedItem.innerText.trim();\n    if (option === stateObj.state) {\n      return;\n    }\n\n    forwardHaptic(\"light\");\n\n    setInputSelectOption(this.hass!, stateObj.entity_id, option);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-select-entity-row\": HuiInputSelectEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport { PaperInputElement } from \"@polymer/paper-input/paper-input\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { setValue } from \"../../../data/input_text\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-input-text-entity-row\")\nclass HuiInputTextEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <paper-input\n          no-label-float\n          .value=\"${stateObj.state}\"\n          .minlength=\"${stateObj.attributes.min}\"\n          .maxlength=\"${stateObj.attributes.max}\"\n          .autoValidate=\"${stateObj.attributes.pattern}\"\n          .pattern=\"${stateObj.attributes.pattern}\"\n          .type=\"${stateObj.attributes.mode}\"\n          @change=\"${this._selectedValueChanged}\"\n          placeholder=\"(empty value)\"\n        ></paper-input>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  private get _inputEl(): PaperInputElement {\n    return this.shadowRoot!.querySelector(\"paper-input\") as PaperInputElement;\n  }\n\n  private _selectedValueChanged(ev): void {\n    const element = this._inputEl;\n    const stateObj = this.hass!.states[this._config!.entity];\n\n    if (element.value !== stateObj.state) {\n      setValue(this.hass!, stateObj.entity_id, element.value!);\n    }\n\n    ev.target.blur();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-input-text-entity-row\": HuiInputTextEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  css,\n  CSSResult,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-lock-entity-row\")\nclass HuiLockEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <mwc-button @click=\"${this._callService}\">\n          ${stateObj.state === \"locked\"\n            ? this.hass!.localize(\"ui.card.lock.unlock\")\n            : this.hass!.localize(\"ui.card.lock.lock\")}\n        </mwc-button>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService(ev): void {\n    ev.stopPropagation();\n    const stateObj = this.hass!.states[this._config!.entity];\n    this.hass!.callService(\n      \"lock\",\n      stateObj.state === \"locked\" ? \"unlock\" : \"lock\",\n      { entity_id: stateObj.entity_id }\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-lock-entity-row\": HuiLockEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  css,\n  CSSResult,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { HomeAssistant } from \"../../../types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { supportsFeature } from \"../../../common/entity/supports-feature\";\nimport {\n  SUPPORTS_PLAY,\n  SUPPORT_NEXT_TRACK,\n  OFF_STATES,\n  SUPPORT_PAUSE,\n} from \"../../../data/media-player\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-media-player-entity-row\")\nclass HuiMediaPlayerEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config || !config.entity) {\n      throw new Error(\"Invalid Configuration: 'entity' required\");\n    }\n\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row\n        .hass=\"${this.hass}\"\n        .config=\"${this._config}\"\n        .showSecondary=\"false\"\n      >\n        ${OFF_STATES.includes(stateObj.state)\n          ? html`\n              <div>\n                ${this.hass!.localize(`state.media_player.${stateObj.state}`) ||\n                  this.hass!.localize(`state.default.${stateObj.state}`) ||\n                  stateObj.state}\n              </div>\n            `\n          : html`\n              <div class=\"controls\">\n                ${stateObj.state !== \"playing\" &&\n                !supportsFeature(stateObj, SUPPORTS_PLAY)\n                  ? \"\"\n                  : html`\n                      <paper-icon-button\n                        icon=\"${this._computeControlIcon(stateObj)}\"\n                        @click=\"${this._playPause}\"\n                      ></paper-icon-button>\n                    `}\n                ${supportsFeature(stateObj, SUPPORT_NEXT_TRACK)\n                  ? html`\n                      <paper-icon-button\n                        icon=\"hass:skip-next\"\n                        @click=\"${this._nextTrack}\"\n                      ></paper-icon-button>\n                    `\n                  : \"\"}\n              </div>\n              <div slot=\"secondary\">${this._computeMediaTitle(stateObj)}</div>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .controls {\n        white-space: nowrap;\n      }\n    `;\n  }\n\n  private _computeControlIcon(stateObj: HassEntity): string {\n    if (stateObj.state !== \"playing\") {\n      return \"hass:play\";\n    }\n\n    // tslint:disable-next-line:no-bitwise\n    return supportsFeature(stateObj, SUPPORT_PAUSE)\n      ? \"hass:pause\"\n      : \"hass:stop\";\n  }\n\n  private _computeMediaTitle(stateObj: HassEntity): string {\n    let prefix;\n    let suffix;\n\n    switch (stateObj.attributes.media_content_type) {\n      case \"music\":\n        prefix = stateObj.attributes.media_artist;\n        suffix = stateObj.attributes.media_title;\n        break;\n      case \"tvshow\":\n        prefix = stateObj.attributes.media_series_title;\n        suffix = stateObj.attributes.media_title;\n        break;\n      default:\n        prefix =\n          stateObj.attributes.media_title ||\n          stateObj.attributes.app_name ||\n          stateObj.state;\n        suffix = \"\";\n    }\n\n    return prefix && suffix ? `${prefix}: ${suffix}` : prefix || suffix || \"\";\n  }\n\n  private _playPause(ev: MouseEvent): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"media_player\", \"media_play_pause\", {\n      entity_id: this._config!.entity,\n    });\n  }\n\n  private _nextTrack(ev: MouseEvent): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"media_player\", \"media_next_track\", {\n      entity_id: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-media-player-entity-row\": HuiMediaPlayerEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResult,\n  css,\n  property,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-scene-entity-row\")\nclass HuiSceneEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.attributes.can_cancel\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <mwc-button @click=\"${this._callService}\">\n                ${this.hass!.localize(\"ui.card.scene.activate\")}\n              </mwc-button>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService(ev): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"scene\", \"turn_on\", {\n      entity_id: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-scene-entity-row\": HuiSceneEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-script-entity-row\")\nclass HuiScriptEntityRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.attributes.can_cancel\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <mwc-button @click=\"${this._callService}\">\n                ${this.hass!.localize(\"ui.card.script.execute\")}\n              </mwc-button>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService(ev): void {\n    ev.stopPropagation();\n    this.hass!.callService(\"script\", \"turn_on\", {\n      entity_id: this._config!.entity,\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-script-entity-row\": HuiScriptEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-timestamp-display\";\nimport \"../components/hui-warning\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\ninterface SensorEntityConfig extends EntityConfig {\n  format?: \"relative\" | \"date\" | \"time\" | \"datetime\";\n}\n\n@customElement(\"hui-sensor-entity-row\")\nclass HuiSensorEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: SensorEntityConfig;\n\n  public setConfig(config: SensorEntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>\n          ${stateObj.attributes.device_class === \"timestamp\"\n            ? html`\n                <hui-timestamp-display\n                  .hass=\"${this.hass}\"\n                  .ts=\"${new Date(stateObj.state)}\"\n                  .format=\"${this._config.format}\"\n                ></hui-timestamp-display>\n              `\n            : computeStateDisplay(\n                this.hass!.localize,\n                stateObj,\n                this.hass.language\n              )}\n        </div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      div {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-sensor-entity-row\": HuiSensorEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-text-entity-row\")\nclass HuiTextEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>\n          ${computeStateDisplay(\n            this.hass!.localize,\n            stateObj,\n            this.hass.language\n          )}\n        </div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      div {\n        text-align: right;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-text-entity-row\": HuiTextEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  property,\n  PropertyValues,\n  customElement,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../components/hui-warning\";\n\nimport timerTimeRemaining from \"../../../common/entity/timer_time_remaining\";\nimport secondsToDuration from \"../../../common/datetime/seconds_to_duration\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityConfig } from \"./types\";\nimport { HassEntity } from \"home-assistant-js-websocket\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-timer-entity-row\")\nclass HuiTimerEntityRow extends LitElement {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  @property() private _timeRemaining?: number;\n\n  private _interval?: number;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    this._clearInterval();\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        <div>${this._computeDisplay(stateObj)}</div>\n      </hui-generic-entity-row>\n    `;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    if (changedProps.has(\"_timeRemaining\")) {\n      return true;\n    }\n\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n\n    if (changedProps.has(\"hass\")) {\n      const stateObj = this.hass!.states[this._config!.entity];\n      const oldHass = changedProps.get(\"hass\") as this[\"hass\"];\n      const oldStateObj = oldHass\n        ? oldHass.states[this._config!.entity]\n        : undefined;\n\n      if (oldStateObj !== stateObj) {\n        this._startInterval(stateObj);\n      } else if (!stateObj) {\n        this._clearInterval();\n      }\n    }\n  }\n\n  private _clearInterval(): void {\n    if (this._interval) {\n      window.clearInterval(this._interval);\n      this._interval = undefined;\n    }\n  }\n\n  private _startInterval(stateObj: HassEntity): void {\n    this._clearInterval();\n    this._calculateRemaining(stateObj);\n\n    if (stateObj.state === \"active\") {\n      this._interval = window.setInterval(\n        () => this._calculateRemaining(stateObj),\n        1000\n      );\n    }\n  }\n\n  private _calculateRemaining(stateObj: HassEntity): void {\n    this._timeRemaining = timerTimeRemaining(stateObj);\n  }\n\n  private _computeDisplay(stateObj: HassEntity): string | null {\n    if (!stateObj) {\n      return null;\n    }\n\n    if (stateObj.state === \"idle\" || this._timeRemaining === 0) {\n      return this.hass!.localize(\"state.timer.\" + stateObj.state);\n    }\n\n    let display = secondsToDuration(this._timeRemaining || 0);\n\n    if (stateObj.state === \"paused\") {\n      display += ` (${this.hass!.localize(\"state.timer.paused\")})`;\n    }\n\n    return display;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-timer-entity-row\": HuiTimerEntityRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  PropertyValues,\n} from \"lit-element\";\n\nimport \"../components/hui-generic-entity-row\";\nimport \"../../../components/entity/ha-entity-toggle\";\nimport \"../components/hui-warning\";\n\nimport computeStateDisplay from \"../../../common/entity/compute_state_display\";\n\nimport { HomeAssistant } from \"../../../types\";\nimport { EntityRow, EntityConfig } from \"./types\";\nimport { hasConfigOrEntityChanged } from \"../common/has-changed\";\n\n@customElement(\"hui-toggle-entity-row\")\nclass HuiToggleEntityRow extends LitElement implements EntityRow {\n  @property() public hass?: HomeAssistant;\n\n  @property() private _config?: EntityConfig;\n\n  public setConfig(config: EntityConfig): void {\n    if (!config) {\n      throw new Error(\"Configuration error\");\n    }\n    this._config = config;\n  }\n\n  protected shouldUpdate(changedProps: PropertyValues): boolean {\n    return hasConfigOrEntityChanged(this, changedProps);\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config || !this.hass) {\n      return html``;\n    }\n\n    const stateObj = this.hass.states[this._config.entity];\n\n    if (!stateObj) {\n      return html`\n        <hui-warning\n          >${this.hass.localize(\n            \"ui.panel.lovelace.warning.entity_not_found\",\n            \"entity\",\n            this._config.entity\n          )}</hui-warning\n        >\n      `;\n    }\n\n    return html`\n      <hui-generic-entity-row .hass=\"${this.hass}\" .config=\"${this._config}\">\n        ${stateObj.state === \"on\" || stateObj.state === \"off\"\n          ? html`\n              <ha-entity-toggle\n                .hass=\"${this.hass}\"\n                .stateObj=\"${stateObj}\"\n              ></ha-entity-toggle>\n            `\n          : html`\n              <div>\n                ${computeStateDisplay(\n                  this.hass!.localize,\n                  stateObj,\n                  this.hass!.language\n                )}\n              </div>\n            `}\n      </hui-generic-entity-row>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-toggle-entity-row\": HuiToggleEntityRow;\n  }\n}\n","import \"@material/mwc-button\";\n\nimport {\n  fetchConfig,\n  LovelaceConfig,\n  saveConfig,\n  subscribeLovelaceUpdates,\n} from \"../../data/lovelace\";\nimport \"../../layouts/hass-loading-screen\";\nimport \"../../layouts/hass-error-screen\";\nimport \"./hui-root\";\nimport { HomeAssistant, PanelInfo, Route } from \"../../types\";\nimport { Lovelace } from \"./types\";\nimport {\n  LitElement,\n  html,\n  PropertyValues,\n  TemplateResult,\n  property,\n} from \"lit-element\";\nimport { showSaveDialog } from \"./editor/show-save-config-dialog\";\nimport { generateLovelaceConfig } from \"./common/generate-lovelace-config\";\nimport { showToast } from \"../../util/toast\";\n\ninterface LovelacePanelConfig {\n  mode: \"yaml\" | \"storage\";\n}\n\nlet editorLoaded = false;\n\nclass LovelacePanel extends LitElement {\n  @property() public panel?: PanelInfo<LovelacePanelConfig>;\n\n  @property() public hass?: HomeAssistant;\n\n  @property() public narrow?: boolean;\n\n  @property() public route?: Route;\n\n  @property() private _columns?: number;\n\n  @property()\n  private _state?: \"loading\" | \"loaded\" | \"error\" | \"yaml-editor\" = \"loading\";\n\n  @property() private _errorMsg?: string;\n\n  @property() private lovelace?: Lovelace;\n\n  private mqls?: MediaQueryList[];\n\n  private _saving: boolean = false;\n\n  constructor() {\n    super();\n    this._closeEditor = this._closeEditor.bind(this);\n  }\n\n  public render(): TemplateResult | void {\n    const state = this._state!;\n\n    if (state === \"loaded\") {\n      return html`\n        <hui-root\n          .hass=\"${this.hass}\"\n          .lovelace=\"${this.lovelace}\"\n          .route=\"${this.route}\"\n          .columns=\"${this._columns}\"\n          .narrow=${this.narrow}\n          @config-refresh=\"${this._forceFetchConfig}\"\n        ></hui-root>\n      `;\n    }\n\n    if (state === \"error\") {\n      return html`\n        <hass-error-screen title=\"Lovelace\" .error=\"${this._errorMsg}\">\n          <mwc-button on-click=\"_forceFetchConfig\"\n            >${this.hass!.localize(\n              \"ui.panel.lovelace.reload_lovelace\"\n            )}</mwc-button\n          >\n        </hass-error-screen>\n      `;\n    }\n\n    if (state === \"yaml-editor\") {\n      return html`\n        <hui-editor\n          .hass=\"${this.hass}\"\n          .lovelace=\"${this.lovelace}\"\n          .closeEditor=\"${this._closeEditor}\"\n        ></hui-editor>\n      `;\n    }\n\n    return html`\n      <hass-loading-screen rootnav></hass-loading-screen>\n    `;\n  }\n\n  public updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    if (changedProps.has(\"narrow\")) {\n      this._updateColumns();\n      return;\n    }\n\n    if (!changedProps.has(\"hass\")) {\n      return;\n    }\n\n    const oldHass = changedProps.get(\"hass\") as this[\"hass\"];\n\n    if (oldHass && this.hass!.dockedSidebar !== oldHass.dockedSidebar) {\n      this._updateColumns();\n    }\n  }\n\n  public firstUpdated() {\n    this._fetchConfig(false);\n    // we don't want to unsub as we want to stay informed of updates\n    subscribeLovelaceUpdates(this.hass!.connection, () =>\n      this._lovelaceChanged()\n    );\n    // reload lovelace on reconnect so we are sure we have the latest config\n    window.addEventListener(\"connection-status\", (ev) => {\n      if (ev.detail === \"connected\") {\n        this._fetchConfig(false);\n      }\n    });\n    this._updateColumns = this._updateColumns.bind(this);\n    this.mqls = [300, 600, 900, 1200].map((width) => {\n      const mql = matchMedia(`(min-width: ${width}px)`);\n      mql.addListener(this._updateColumns);\n      return mql;\n    });\n    this._updateColumns();\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    if (\n      this.lovelace &&\n      this.hass &&\n      this.lovelace.language !== this.hass.language\n    ) {\n      // language has been changed, rebuild UI\n      this._setLovelaceConfig(this.lovelace.config, this.lovelace.mode);\n    } else if (this.lovelace && this.lovelace.mode === \"generated\") {\n      // When lovelace is generated, we re-generate each time a user goes\n      // to the states panel to make sure new entities are shown.\n      this._state = \"loading\";\n      this._regenerateConfig();\n    }\n  }\n\n  private async _regenerateConfig() {\n    const conf = await generateLovelaceConfig(this.hass!, this.hass!.localize);\n    this._setLovelaceConfig(conf, \"generated\");\n    this._state = \"loaded\";\n  }\n\n  private _closeEditor() {\n    this._state = \"loaded\";\n  }\n\n  private _updateColumns() {\n    const matchColumns = this.mqls!.reduce(\n      (cols, mql) => cols + Number(mql.matches),\n      0\n    );\n    // Do -1 column if the menu is docked and open\n    this._columns = Math.max(\n      1,\n      matchColumns - Number(!this.narrow && this.hass!.dockedSidebar)\n    );\n  }\n\n  private _lovelaceChanged() {\n    if (this._saving) {\n      this._saving = false;\n    } else {\n      showToast(this, {\n        message: this.hass!.localize(\"ui.panel.lovelace.changed_toast.message\"),\n        action: {\n          action: () => this._fetchConfig(false),\n          text: this.hass!.localize(\"ui.panel.lovelace.changed_toast.refresh\"),\n        },\n        duration: 0,\n        dismissable: false,\n      });\n    }\n  }\n\n  private _forceFetchConfig() {\n    this._fetchConfig(true);\n  }\n\n  private async _fetchConfig(forceDiskRefresh) {\n    let conf: LovelaceConfig;\n    let confMode: Lovelace[\"mode\"] = this.panel!.config.mode;\n\n    try {\n      conf = await fetchConfig(this.hass!, forceDiskRefresh);\n    } catch (err) {\n      if (err.code !== \"config_not_found\") {\n        // tslint:disable-next-line\n        console.log(err);\n        this._state = \"error\";\n        this._errorMsg = err.message;\n        return;\n      }\n      conf = await generateLovelaceConfig(this.hass!, this.hass!.localize);\n      confMode = \"generated\";\n    }\n\n    this._state = \"loaded\";\n    this._setLovelaceConfig(conf, confMode);\n  }\n\n  private _setLovelaceConfig(config: LovelaceConfig, mode: Lovelace[\"mode\"]) {\n    this.lovelace = {\n      config,\n      mode,\n      editMode: this.lovelace ? this.lovelace.editMode : false,\n      language: this.hass!.language,\n      enableFullEditMode: () => {\n        if (!editorLoaded) {\n          editorLoaded = true;\n          import(/* webpackChunkName: \"lovelace-yaml-editor\" */ \"./hui-editor\");\n        }\n        this._state = \"yaml-editor\";\n      },\n      setEditMode: (editMode: boolean) => {\n        if (!editMode || this.lovelace!.mode !== \"generated\") {\n          this._updateLovelace({ editMode });\n          return;\n        }\n        showSaveDialog(this, {\n          lovelace: this.lovelace!,\n        });\n      },\n      saveConfig: async (newConfig: LovelaceConfig): Promise<void> => {\n        const { config: previousConfig, mode: previousMode } = this.lovelace!;\n        try {\n          // Optimistic update\n          this._updateLovelace({\n            config: newConfig,\n            mode: \"storage\",\n          });\n          this._saving = true;\n          await saveConfig(this.hass!, newConfig);\n        } catch (err) {\n          // tslint:disable-next-line\n          console.error(err);\n          // Rollback the optimistic update\n          this._updateLovelace({\n            config: previousConfig,\n            mode: previousMode,\n          });\n          throw err;\n        }\n      },\n    };\n  }\n\n  private _updateLovelace(props: Partial<Lovelace>) {\n    this.lovelace = {\n      ...this.lovelace!,\n      ...props,\n    };\n  }\n}\n\ncustomElements.define(\"ha-panel-lovelace\", LovelacePanel);\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n  CSSResult,\n  css,\n  property,\n} from \"lit-element\";\nimport { classMap } from \"lit-html/directives/class-map\";\nimport \"@polymer/app-layout/app-header-layout/app-header-layout\";\nimport \"@polymer/app-layout/app-header/app-header\";\nimport \"@polymer/app-layout/app-scroll-effects/effects/waterfall\";\nimport \"@polymer/app-layout/app-toolbar/app-toolbar\";\nimport \"@polymer/app-route/app-route\";\nimport \"@polymer/paper-icon-button/paper-icon-button\";\nimport \"@material/mwc-button\";\nimport \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-listbox/paper-listbox\";\nimport \"@polymer/paper-menu-button/paper-menu-button\";\nimport \"@polymer/paper-tabs/paper-tab\";\nimport \"@polymer/paper-tabs/paper-tabs\";\nimport { HassEntities } from \"home-assistant-js-websocket\";\n\nimport scrollToTarget from \"../../common/dom/scroll-to-target\";\n\nimport \"../../layouts/ha-app-layout\";\nimport \"../../components/ha-start-voice-button\";\nimport \"../../components/ha-paper-icon-button-arrow-next\";\nimport \"../../components/ha-paper-icon-button-arrow-prev\";\nimport \"../../components/ha-icon\";\nimport { loadModule, loadCSS, loadJS } from \"../../common/dom/load_resource\";\nimport { subscribeNotifications } from \"../../data/ws-notifications\";\nimport { debounce } from \"../../common/util/debounce\";\nimport { HomeAssistant } from \"../../types\";\nimport { LovelaceConfig } from \"../../data/lovelace\";\nimport { navigate } from \"../../common/navigate\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { computeNotifications } from \"./common/compute-notifications\";\nimport { swapView } from \"./editor/config-util\";\n\nimport \"./components/notifications/hui-notification-drawer\";\nimport \"./components/notifications/hui-notifications-button\";\nimport \"./hui-view\";\n// Not a duplicate import, this one is for type\n// tslint:disable-next-line\nimport { HUIView } from \"./hui-view\";\nimport { createCardElement } from \"./common/create-card-element\";\nimport { showEditViewDialog } from \"./editor/view-editor/show-edit-view-dialog\";\nimport { showEditLovelaceDialog } from \"./editor/lovelace-editor/show-edit-lovelace-dialog\";\nimport { Lovelace } from \"./types\";\nimport { afterNextRender } from \"../../common/util/render-status\";\nimport { haStyle } from \"../../resources/styles\";\nimport { computeRTLDirection } from \"../../common/util/compute_rtl\";\n\n// CSS and JS should only be imported once. Modules and HTML are safe.\nconst CSS_CACHE = {};\nconst JS_CACHE = {};\n\nlet loadedUnusedEntities = false;\n\nclass HUIRoot extends LitElement {\n  @property() public hass?: HomeAssistant;\n  @property() public lovelace?: Lovelace;\n  @property() public columns?: number;\n  @property() public narrow?: boolean;\n  @property() public route?: { path: string; prefix: string };\n  @property() private _routeData?: { view: string };\n  @property() private _curView?: number | \"hass-unused-entities\";\n  @property() private _notificationsOpen = false;\n  @property() private _persistentNotifications?: Notification[];\n  private _viewCache?: { [viewId: string]: HUIView };\n\n  private _debouncedConfigChanged: () => void;\n  private _unsubNotifications?: () => void;\n\n  constructor() {\n    super();\n    // The view can trigger a re-render when it knows that certain\n    // web components have been loaded.\n    this._debouncedConfigChanged = debounce(\n      () => this._selectView(this._curView, true),\n      100,\n      false\n    );\n  }\n\n  public connectedCallback(): void {\n    super.connectedCallback();\n    this._unsubNotifications = subscribeNotifications(\n      this.hass!.connection,\n      (notifications) => {\n        this._persistentNotifications = notifications;\n      }\n    );\n  }\n\n  public disconnectedCallback(): void {\n    super.disconnectedCallback();\n    if (this._unsubNotifications) {\n      this._unsubNotifications();\n    }\n  }\n\n  protected render(): TemplateResult | void {\n    return html`\n    <app-route .route=\"${this.route}\" pattern=\"/:view\" data=\"${\n      this._routeData\n    }\" @data-changed=\"${this._routeDataChanged}\"></app-route>\n    <hui-notification-drawer\n      .hass=\"${this.hass}\"\n      .notifications=\"${this._notifications}\"\n      .open=\"${this._notificationsOpen}\"\n      @open-changed=\"${this._handleNotificationsOpenChanged}\"\n      .narrow=\"${this.narrow}\"\n    ></hui-notification-drawer>\n    <ha-app-layout id=\"layout\">\n      <app-header slot=\"header\" effects=\"waterfall\" class=\"${classMap({\n        \"edit-mode\": this._editMode,\n      })}\" fixed condenses>\n        ${\n          this._editMode\n            ? html`\n                <app-toolbar class=\"edit-mode\">\n                  <paper-icon-button\n                    icon=\"hass:close\"\n                    @click=\"${this._editModeDisable}\"\n                  ></paper-icon-button>\n                  <div main-title>\n                    ${this.config.title ||\n                      this.hass!.localize(\"ui.panel.lovelace.editor.header\")}\n                    <paper-icon-button\n                      icon=\"hass:pencil\"\n                      class=\"edit-icon\"\n                      @click=\"${this._editLovelace}\"\n                    ></paper-icon-button>\n                  </div>\n                  <paper-icon-button\n                    icon=\"hass:help-circle\"\n                    title=\"Help\"\n                    @click=\"${this._handleHelp}\"\n                  ></paper-icon-button>\n                  <paper-menu-button\n                    no-animations\n                    horizontal-align=\"right\"\n                    horizontal-offset=\"-5\"\n                  >\n                    <paper-icon-button\n                      icon=\"hass:dots-vertical\"\n                      slot=\"dropdown-trigger\"\n                    ></paper-icon-button>\n                    <paper-listbox\n                      @iron-select=\"${this._deselect}\"\n                      slot=\"dropdown-content\"\n                    >\n                      <paper-item @click=\"${this.lovelace!.enableFullEditMode}\"\n                        >${this.hass!.localize(\n                          \"ui.panel.lovelace.editor.menu.raw_editor\"\n                        )}</paper-item\n                      >\n                    </paper-listbox>\n                  </paper-menu-button>\n                </app-toolbar>\n              `\n            : html`\n                <app-toolbar>\n                  <ha-menu-button></ha-menu-button>\n                  <div main-title>${this.config.title || \"Home Assistant\"}</div>\n                  <hui-notifications-button\n                    .hass=\"${this.hass}\"\n                    .opened=\"${this._notificationsOpen}\"\n                    @opened-changed=\"${this._handleNotificationsOpenChanged}\"\n                    .notifications=\"${this._notifications}\"\n                  ></hui-notifications-button>\n                  <ha-start-voice-button\n                    .hass=\"${this.hass}\"\n                  ></ha-start-voice-button>\n                  <paper-menu-button\n                    no-animations\n                    horizontal-align=\"right\"\n                    horizontal-offset=\"-5\"\n                  >\n                    <paper-icon-button\n                      icon=\"hass:dots-vertical\"\n                      slot=\"dropdown-trigger\"\n                    ></paper-icon-button>\n                    <paper-listbox\n                      @iron-select=\"${this._deselect}\"\n                      slot=\"dropdown-content\"\n                    >\n                      ${this._yamlMode\n                        ? html`\n                            <paper-item @click=\"${this._handleRefresh}\"\n                              >${this.hass!.localize(\n                                \"ui.panel.lovelace.menu.refresh\"\n                              )}</paper-item\n                            >\n                          `\n                        : \"\"}\n                      <paper-item @click=\"${this._handleUnusedEntities}\"\n                        >${this.hass!.localize(\n                          \"ui.panel.lovelace.menu.unused_entities\"\n                        )}</paper-item\n                      >\n                      <paper-item @click=\"${this._editModeEnable}\"\n                        >${this.hass!.localize(\n                          \"ui.panel.lovelace.menu.configure_ui\"\n                        )}</paper-item\n                      >\n                      <paper-item @click=\"${this._handleHelp}\"\n                        >${this.hass!.localize(\n                          \"ui.panel.lovelace.menu.help\"\n                        )}</paper-item\n                      >\n                    </paper-listbox>\n                  </paper-menu-button>\n                </app-toolbar>\n              `\n        }\n\n        ${\n          this.lovelace!.config.views.length > 1 || this._editMode\n            ? html`\n                <div sticky>\n                  <paper-tabs\n                    scrollable\n                    .selected=\"${this._curView}\"\n                    @iron-activate=\"${this._handleViewSelected}\"\n                    dir=\"${computeRTLDirection(this.hass!)}\"\n                  >\n                    ${this.lovelace!.config.views.map(\n                      (view) => html`\n                        <paper-tab>\n                          ${this._editMode\n                            ? html`\n                                <ha-paper-icon-button-arrow-prev\n                                  title=\"Move view left\"\n                                  class=\"edit-icon view\"\n                                  @click=\"${this._moveViewLeft}\"\n                                  ?disabled=\"${this._curView === 0}\"\n                                ></ha-paper-icon-button-arrow-prev>\n                              `\n                            : \"\"}\n                          ${view.icon\n                            ? html`\n                                <ha-icon\n                                  title=\"${view.title}\"\n                                  .icon=\"${view.icon}\"\n                                ></ha-icon>\n                              `\n                            : view.title || \"Unnamed view\"}\n                          ${this._editMode\n                            ? html`\n                                <ha-icon\n                                  title=\"Edit view\"\n                                  class=\"edit-icon view\"\n                                  icon=\"hass:pencil\"\n                                  @click=\"${this._editView}\"\n                                ></ha-icon>\n                                <ha-paper-icon-button-arrow-next\n                                  title=\"Move view right\"\n                                  class=\"edit-icon view\"\n                                  @click=\"${this._moveViewRight}\"\n                                  ?disabled=\"${(this._curView! as number) +\n                                    1 ===\n                                    this.lovelace!.config.views.length}\"\n                                ></ha-paper-icon-button-arrow-next>\n                              `\n                            : \"\"}\n                        </paper-tab>\n                      `\n                    )}\n                    ${this._editMode\n                      ? html`\n                          <paper-icon-button\n                            id=\"add-view\"\n                            @click=\"${this._addView}\"\n                            title=\"${this.hass!.localize(\n                              \"ui.panel.lovelace.editor.edit_view.add\"\n                            )}\"\n                            icon=\"hass:plus\"\n                          ></paper-icon-button>\n                        `\n                      : \"\"}\n                  </paper-tabs>\n                </div>\n              `\n            : \"\"\n        }\n      </app-header>\n      <div id='view' class=\"${classMap({\n        \"tabs-hidden\": this.lovelace!.config.views.length < 2,\n      })}\" @ll-rebuild='${this._debouncedConfigChanged}'></div>\n    </app-header-layout>\n    `;\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      haStyle,\n      css`\n        :host {\n          -ms-user-select: none;\n          -webkit-user-select: none;\n          -moz-user-select: none;\n          --dark-color: #455a64;\n          --text-dark-color: #fff;\n        }\n\n        ha-app-layout {\n          min-height: 100%;\n        }\n        paper-menu-button {\n          padding: 0;\n        }\n        paper-tabs {\n          margin-left: 12px;\n          --paper-tabs-selection-bar-color: var(--text-primary-color, #fff);\n          text-transform: uppercase;\n        }\n        .edit-mode {\n          background-color: var(--dark-color, #455a64);\n          color: var(--text-dark-color);\n        }\n        .edit-mode div[main-title] {\n          pointer-events: auto;\n        }\n        paper-tab.iron-selected .edit-icon {\n          display: inline-flex;\n        }\n        .edit-icon {\n          color: var(--accent-color);\n          padding-left: 8px;\n        }\n        .edit-icon[disabled] {\n          color: var(--disabled-text-color);\n        }\n        .edit-icon.view {\n          display: none;\n        }\n        #add-view {\n          position: absolute;\n          height: 44px;\n        }\n        #add-view ha-icon {\n          background-color: var(--accent-color);\n          border-radius: 5px;\n          margin-top: 4px;\n        }\n        app-toolbar a {\n          color: var(--text-primary-color, white);\n        }\n        mwc-button.warning:not([disabled]) {\n          color: var(--google-red-500);\n        }\n        #view {\n          min-height: calc(100vh - 112px);\n          /**\n         * Since we only set min-height, if child nodes need percentage\n         * heights they must use absolute positioning so we need relative\n         * positioning here.\n         *\n         * https://www.w3.org/TR/CSS2/visudet.html#the-height-property\n         */\n          position: relative;\n        }\n        #view.tabs-hidden {\n          min-height: calc(100vh - 64px);\n        }\n        paper-item {\n          cursor: pointer;\n        }\n      `,\n    ];\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    const view = this._viewRoot;\n    const huiView = view.lastChild as HUIView;\n\n    if (changedProperties.has(\"columns\") && huiView) {\n      huiView.columns = this.columns;\n    }\n\n    if (changedProperties.has(\"hass\") && huiView) {\n      huiView.hass = this.hass;\n    }\n\n    let newSelectView;\n    let force = false;\n\n    if (changedProperties.has(\"route\")) {\n      const views = this.config && this.config.views;\n      if (\n        this.route!.path === \"\" &&\n        this.route!.prefix === \"/lovelace\" &&\n        views\n      ) {\n        navigate(this, `/lovelace/${views[0].path || 0}`, true);\n        newSelectView = 0;\n      } else if (this._routeData!.view === \"hass-unused-entities\") {\n        newSelectView = \"hass-unused-entities\";\n      } else if (this._routeData!.view) {\n        const selectedView = this._routeData!.view;\n        const selectedViewInt = parseInt(selectedView, 10);\n        let index = 0;\n        for (let i = 0; i < views.length; i++) {\n          if (views[i].path === selectedView || i === selectedViewInt) {\n            index = i;\n            break;\n          }\n        }\n        newSelectView = index;\n      }\n    }\n\n    if (changedProperties.has(\"lovelace\")) {\n      const oldLovelace = changedProperties.get(\"lovelace\") as\n        | Lovelace\n        | undefined;\n\n      if (!oldLovelace || oldLovelace.config !== this.lovelace!.config) {\n        this._loadResources(this.lovelace!.config.resources || []);\n        // On config change, recreate the current view from scratch.\n        force = true;\n        // Recalculate to see if we need to adjust content area for tab bar\n        fireEvent(this, \"iron-resize\");\n      }\n\n      if (!oldLovelace || oldLovelace.editMode !== this.lovelace!.editMode) {\n        // On edit mode change, recreate the current view from scratch\n        force = true;\n        // Recalculate to see if we need to adjust content area for tab bar\n        fireEvent(this, \"iron-resize\");\n      }\n    }\n\n    if (newSelectView !== undefined || force) {\n      if (force && newSelectView === undefined) {\n        newSelectView = this._curView;\n      }\n      this._selectView(newSelectView, force);\n    }\n  }\n\n  private get _notifications() {\n    return this._updateNotifications(\n      this.hass!.states,\n      this._persistentNotifications! || []\n    );\n  }\n\n  private get config(): LovelaceConfig {\n    return this.lovelace!.config;\n  }\n\n  private get _yamlMode(): boolean {\n    return this.lovelace!.mode === \"yaml\";\n  }\n\n  private get _editMode() {\n    return this.lovelace!.editMode;\n  }\n\n  private get _layout(): any {\n    return this.shadowRoot!.getElementById(\"layout\");\n  }\n\n  private get _viewRoot(): HTMLDivElement {\n    return this.shadowRoot!.getElementById(\"view\") as HTMLDivElement;\n  }\n\n  private _routeDataChanged(ev): void {\n    this._routeData = ev.detail.value;\n  }\n\n  private _handleNotificationsOpenChanged(ev): void {\n    this._notificationsOpen = ev.detail.value;\n  }\n\n  private _updateNotifications(\n    states: HassEntities,\n    persistent: unknown[]\n  ): unknown[] {\n    const configurator = computeNotifications(states);\n    return persistent.concat(configurator);\n  }\n\n  private _handleRefresh(): void {\n    fireEvent(this, \"config-refresh\");\n  }\n\n  private _handleUnusedEntities(): void {\n    navigate(this, `/lovelace/hass-unused-entities`);\n  }\n\n  private _deselect(ev): void {\n    ev.target.selected = null;\n  }\n\n  private _handleHelp(): void {\n    window.open(\"https://www.home-assistant.io/lovelace/\", \"_blank\");\n  }\n\n  private _editModeEnable(): void {\n    if (this._yamlMode) {\n      window.alert(\"The edit UI is not available when in YAML mode.\");\n      return;\n    }\n    this.lovelace!.setEditMode(true);\n    if (this.config.views.length < 2) {\n      fireEvent(this, \"iron-resize\");\n    }\n  }\n\n  private _editModeDisable(): void {\n    this.lovelace!.setEditMode(false);\n    if (this.config.views.length < 2) {\n      fireEvent(this, \"iron-resize\");\n    }\n  }\n\n  private _editLovelace() {\n    showEditLovelaceDialog(this, this.lovelace!);\n  }\n\n  private _editView() {\n    showEditViewDialog(this, {\n      lovelace: this.lovelace!,\n      viewIndex: this._curView as number,\n    });\n  }\n\n  private _moveViewLeft() {\n    const lovelace = this.lovelace!;\n    const oldIndex = this._curView as number;\n    const newIndex = (this._curView as number) - 1;\n    this._curView = newIndex;\n    lovelace.saveConfig(swapView(lovelace.config, oldIndex, newIndex));\n  }\n\n  private _moveViewRight() {\n    const lovelace = this.lovelace!;\n    const oldIndex = this._curView as number;\n    const newIndex = (this._curView as number) + 1;\n    this._curView = newIndex;\n    lovelace.saveConfig(swapView(lovelace.config, oldIndex, newIndex));\n  }\n\n  private _addView() {\n    showEditViewDialog(this, {\n      lovelace: this.lovelace!,\n    });\n  }\n\n  private _handleViewSelected(ev) {\n    const viewIndex = ev.detail.selected as number;\n\n    if (viewIndex !== this._curView) {\n      const path = this.config.views[viewIndex].path || viewIndex;\n      navigate(this, `/lovelace/${path}`);\n    }\n    scrollToTarget(this, this._layout.header.scrollTarget);\n  }\n\n  private async _selectView(\n    viewIndex: HUIRoot[\"_curView\"],\n    force: boolean\n  ): Promise<void> {\n    if (!force && this._curView === viewIndex) {\n      return;\n    }\n\n    viewIndex = viewIndex === undefined ? 0 : viewIndex;\n\n    this._curView = viewIndex;\n\n    if (force) {\n      this._viewCache = {};\n    }\n\n    // Recreate a new element to clear the applied themes.\n    const root = this._viewRoot;\n\n    if (root.lastChild) {\n      root.removeChild(root.lastChild);\n    }\n\n    if (viewIndex === \"hass-unused-entities\") {\n      if (!loadedUnusedEntities) {\n        loadedUnusedEntities = true;\n        await import(/* webpackChunkName: \"hui-unused-entities\" */ \"./hui-unused-entities\");\n      }\n      const unusedEntities = document.createElement(\"hui-unused-entities\");\n      unusedEntities.setConfig(this.config);\n      unusedEntities.hass = this.hass!;\n      root.style.background = this.config.background || \"\";\n      root.appendChild(unusedEntities);\n      return;\n    }\n\n    let view;\n    const viewConfig = this.config.views[viewIndex];\n\n    if (!viewConfig) {\n      this._editModeEnable();\n      return;\n    }\n\n    if (!force && this._viewCache![viewIndex]) {\n      view = this._viewCache![viewIndex];\n    } else {\n      await new Promise((resolve) => afterNextRender(resolve));\n\n      if (viewConfig.panel && viewConfig.cards && viewConfig.cards.length > 0) {\n        view = createCardElement(viewConfig.cards[0]);\n        view.isPanel = true;\n      } else {\n        view = document.createElement(\"hui-view\");\n        view.lovelace = this.lovelace;\n        view.columns = this.columns;\n        view.index = viewIndex;\n      }\n      this._viewCache![viewIndex] = view;\n    }\n\n    view.hass = this.hass;\n    root.style.background =\n      viewConfig.background || this.config.background || \"\";\n    root.appendChild(view);\n  }\n\n  private _loadResources(resources) {\n    resources.forEach((resource) => {\n      switch (resource.type) {\n        case \"css\":\n          if (resource.url in CSS_CACHE) {\n            break;\n          }\n          CSS_CACHE[resource.url] = loadCSS(resource.url);\n          break;\n\n        case \"js\":\n          if (resource.url in JS_CACHE) {\n            break;\n          }\n          JS_CACHE[resource.url] = loadJS(resource.url);\n          break;\n\n        case \"module\":\n          loadModule(resource.url);\n          break;\n\n        case \"html\":\n          import(/* webpackChunkName: \"import-href-polyfill\" */ \"../../resources/html-import/import-href\").then(\n            ({ importHref }) => importHref(resource.url)\n          );\n          break;\n\n        default:\n          // tslint:disable-next-line\n          console.warn(`Unknown resource type specified: ${resource.type}`);\n      }\n    });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-root\": HUIRoot;\n  }\n}\n\ncustomElements.define(\"hui-root\", HUIRoot);\n","import {\n  html,\n  LitElement,\n  PropertyValues,\n  property,\n  PropertyDeclarations,\n  TemplateResult,\n} from \"lit-element\";\n\nimport \"../../components/entity/ha-state-label-badge\";\n// This one is for types\n// tslint:disable-next-line\nimport { HaStateLabelBadge } from \"../../components/entity/ha-state-label-badge\";\n\nimport applyThemesOnElement from \"../../common/dom/apply_themes_on_element\";\n\nimport { LovelaceViewConfig, LovelaceCardConfig } from \"../../data/lovelace\";\nimport { HomeAssistant } from \"../../types\";\nimport { classMap } from \"lit-html/directives/class-map\";\n\nimport { Lovelace, LovelaceCard } from \"./types\";\nimport { createCardElement } from \"./common/create-card-element\";\nimport { computeCardSize } from \"./common/compute-card-size\";\nimport { showEditCardDialog } from \"./editor/card-editor/show-edit-card-dialog\";\nimport { HuiErrorCard } from \"./cards/hui-error-card\";\n\nimport { computeRTL } from \"../../common/util/compute_rtl\";\n\nlet editCodeLoaded = false;\n\n// Find column with < 5 entities, else column with lowest count\nconst getColumnIndex = (columnEntityCount: number[], size: number) => {\n  let minIndex = 0;\n  for (let i = 0; i < columnEntityCount.length; i++) {\n    if (columnEntityCount[i] < 5) {\n      minIndex = i;\n      break;\n    }\n    if (columnEntityCount[i] < columnEntityCount[minIndex]) {\n      minIndex = i;\n    }\n  }\n\n  columnEntityCount[minIndex] += size;\n\n  return minIndex;\n};\n\nexport class HUIView extends LitElement {\n  @property() public hass?: HomeAssistant;\n  @property() public lovelace?: Lovelace;\n  @property() public columns?: number;\n  @property() public index?: number;\n  private _cards: Array<LovelaceCard | HuiErrorCard>;\n  private _badges: Array<{ element: HaStateLabelBadge; entityId: string }>;\n\n  static get properties(): PropertyDeclarations {\n    return {\n      hass: {},\n      lovelace: {},\n      columns: {},\n      index: {},\n      _cards: {},\n      _badges: {},\n    };\n  }\n\n  constructor() {\n    super();\n    this._cards = [];\n    this._badges = [];\n  }\n\n  // Public to make demo happy\n  public createCardElement(cardConfig: LovelaceCardConfig) {\n    const element = createCardElement(cardConfig) as LovelaceCard;\n    element.hass = this.hass;\n    element.addEventListener(\n      \"ll-rebuild\",\n      (ev) => {\n        // In edit mode let it go to hui-root and rebuild whole view.\n        if (!this.lovelace!.editMode) {\n          ev.stopPropagation();\n          this._rebuildCard(element, cardConfig);\n        }\n      },\n      { once: true }\n    );\n    return element;\n  }\n\n  protected render(): TemplateResult | void {\n    return html`\n      ${this.renderStyles()}\n      <div id=\"badges\"></div>\n      <div id=\"columns\"></div>\n      ${this.lovelace!.editMode\n        ? html`\n            <paper-fab\n              elevated=\"2\"\n              icon=\"hass:plus\"\n              title=\"${this.hass!.localize(\n                \"ui.panel.lovelace.editor.edit_card.add\"\n              )}\"\n              @click=\"${this._addCard}\"\n              class=\"${classMap({\n                rtl: computeRTL(this.hass!),\n              })}\"\n            ></paper-fab>\n          `\n        : \"\"}\n    `;\n  }\n\n  protected renderStyles(): TemplateResult {\n    return html`\n      <style>\n        :host {\n          display: block;\n          padding: 4px 4px 0;\n          transform: translateZ(0);\n          position: relative;\n          min-height: calc(100vh - 155px);\n        }\n\n        #badges {\n          margin: 8px 16px;\n          font-size: 85%;\n          text-align: center;\n        }\n\n        #columns {\n          display: flex;\n          flex-direction: row;\n          justify-content: center;\n        }\n\n        .column {\n          flex-basis: 0;\n          flex-grow: 1;\n          max-width: 500px;\n          overflow-x: hidden;\n        }\n\n        .column > * {\n          display: block;\n          margin: 4px 4px 8px;\n        }\n\n        paper-fab {\n          position: sticky;\n          float: right;\n          bottom: 16px;\n          right: 16px;\n          z-index: 1;\n        }\n\n        paper-fab.rtl {\n          float: left;\n          right: auto;\n          left: 16px;\n        }\n\n        @media (max-width: 500px) {\n          :host {\n            padding-left: 0;\n            padding-right: 0;\n          }\n\n          .column > * {\n            margin-left: 0;\n            margin-right: 0;\n          }\n        }\n\n        @media (max-width: 599px) {\n          .column {\n            max-width: 600px;\n          }\n        }\n      </style>\n    `;\n  }\n\n  protected updated(changedProperties: PropertyValues): void {\n    super.updated(changedProperties);\n\n    const lovelace = this.lovelace!;\n\n    if (lovelace.editMode && !editCodeLoaded) {\n      editCodeLoaded = true;\n      import(/* webpackChunkName: \"hui-view-editable\" */ \"./hui-view-editable\");\n    }\n\n    let editModeChanged = false;\n    let configChanged = false;\n\n    if (changedProperties.has(\"lovelace\")) {\n      const oldLovelace = changedProperties.get(\"lovelace\") as Lovelace;\n      editModeChanged =\n        !oldLovelace || lovelace.editMode !== oldLovelace.editMode;\n      configChanged = !oldLovelace || lovelace.config !== oldLovelace.config;\n    }\n\n    if (configChanged) {\n      this._createBadges(lovelace.config.views[this.index!]);\n    } else if (changedProperties.has(\"hass\")) {\n      this._badges.forEach((badge) => {\n        const { element, entityId } = badge;\n        element.hass = this.hass!;\n        element.state = this.hass!.states[entityId];\n      });\n    }\n\n    if (configChanged || editModeChanged || changedProperties.has(\"columns\")) {\n      this._createCards(lovelace.config.views[this.index!]);\n    } else if (changedProperties.has(\"hass\")) {\n      this._cards.forEach((element) => {\n        element.hass = this.hass;\n      });\n    }\n  }\n\n  private _addCard(): void {\n    showEditCardDialog(this, {\n      lovelace: this.lovelace!,\n      path: [this.index!],\n    });\n  }\n\n  private _createBadges(config: LovelaceViewConfig): void {\n    const root = this.shadowRoot!.getElementById(\"badges\")!;\n\n    while (root.lastChild) {\n      root.removeChild(root.lastChild);\n    }\n\n    if (!config || !config.badges || !Array.isArray(config.badges)) {\n      root.style.display = \"none\";\n      this._badges = [];\n      return;\n    }\n\n    const elements: HUIView[\"_badges\"] = [];\n    for (const entityId of config.badges) {\n      const element = document.createElement(\"ha-state-label-badge\");\n      element.hass = this.hass;\n      element.state = this.hass!.states[entityId];\n      elements.push({ element, entityId });\n      root.appendChild(element);\n    }\n    this._badges = elements;\n    root.style.display = elements.length > 0 ? \"block\" : \"none\";\n  }\n\n  private _createCards(config: LovelaceViewConfig): void {\n    const root = this.shadowRoot!.getElementById(\"columns\")!;\n\n    while (root.lastChild) {\n      root.removeChild(root.lastChild);\n    }\n\n    if (!config || !config.cards || !Array.isArray(config.cards)) {\n      this._cards = [];\n      return;\n    }\n\n    const elements: LovelaceCard[] = [];\n    const elementsToAppend: HTMLElement[] = [];\n    config.cards.forEach((cardConfig, cardIndex) => {\n      const element = this.createCardElement(cardConfig);\n      elements.push(element);\n\n      if (!this.lovelace!.editMode) {\n        elementsToAppend.push(element);\n        return;\n      }\n\n      const wrapper = document.createElement(\"hui-card-options\");\n      wrapper.hass = this.hass;\n      wrapper.lovelace = this.lovelace;\n      wrapper.path = [this.index!, cardIndex];\n      wrapper.appendChild(element);\n      elementsToAppend.push(wrapper);\n    });\n\n    let columns: HTMLElement[][] = [];\n    const columnEntityCount: number[] = [];\n    for (let i = 0; i < this.columns!; i++) {\n      columns.push([]);\n      columnEntityCount.push(0);\n    }\n\n    elements.forEach((el, index) => {\n      const cardSize = computeCardSize(el);\n      // Element to append might be the wrapped card when we're editing.\n      columns[getColumnIndex(columnEntityCount, cardSize)].push(\n        elementsToAppend[index]\n      );\n    });\n\n    // Remove empty columns\n    columns = columns.filter((val) => val.length > 0);\n\n    columns.forEach((column) => {\n      const columnEl = document.createElement(\"div\");\n      columnEl.classList.add(\"column\");\n      column.forEach((el) => columnEl.appendChild(el));\n      root.appendChild(columnEl);\n    });\n\n    this._cards = elements;\n\n    if (\"theme\" in config) {\n      applyThemesOnElement(root, this.hass!.themes, config.theme);\n    }\n  }\n\n  private _rebuildCard(\n    cardElToReplace: LovelaceCard,\n    config: LovelaceCardConfig\n  ): void {\n    const newCardEl = this.createCardElement(config);\n    cardElToReplace.parentElement!.replaceChild(newCardEl, cardElToReplace);\n    this._cards = this._cards!.map((curCardEl) =>\n      curCardEl === cardElToReplace ? newCardEl : curCardEl\n    );\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-view\": HUIView;\n  }\n}\n\ncustomElements.define(\"hui-view\", HUIView);\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\nimport \"@material/mwc-button\";\n\nimport \"../../../components/ha-icon\";\n\nimport { callService } from \"../common/call-service\";\nimport { EntityRow, CallServiceConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-call-service-row\")\nclass HuiCallServiceRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: CallServiceConfig;\n\n  public setConfig(config: CallServiceConfig): void {\n    if (!config || !config.name || !config.service) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    this._config = { icon: \"hass:remote\", action_name: \"Run\", ...config };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-icon .icon=\"${this._config.icon}\"></ha-icon>\n      <div class=\"flex\">\n        <div>${this._config.name}</div>\n        <mwc-button @click=\"${this._callService}\"\n          >${this._config.action_name}</mwc-button\n        >\n      </div>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: flex;\n        align-items: center;\n      }\n      ha-icon {\n        padding: 8px;\n        color: var(--paper-item-icon-color);\n      }\n      .flex {\n        flex: 1;\n        overflow: hidden;\n        margin-left: 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n      .flex div {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n      mwc-button {\n        margin-right: -0.57em;\n      }\n    `;\n  }\n\n  private _callService() {\n    callService(this._config!, this.hass!);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-call-service-row\": HuiCallServiceRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n} from \"lit-element\";\n\nimport { EntityRow, DividerConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\n@customElement(\"hui-divider-row\")\nclass HuiDividerRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: DividerConfig;\n\n  public setConfig(config): void {\n    if (!config) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    this._config = {\n      style: {\n        height: \"1px\",\n        \"background-color\": \"var(--secondary-text-color)\",\n      },\n      ...config,\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    const el = document.createElement(\"div\");\n\n    Object.keys(this._config.style).forEach((prop) => {\n      el.style.setProperty(prop, this._config!.style[prop]);\n    });\n\n    return html`\n      ${el}\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-divider-row\": HuiDividerRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { EntityRow, SectionConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\nimport \"../../../components/ha-icon\";\n\n@customElement(\"hui-section-row\")\nclass HuiSectionRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: SectionConfig;\n\n  public setConfig(config: SectionConfig): void {\n    if (!config) {\n      throw new Error(\"Error in card configuration.\");\n    }\n\n    this._config = config;\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <div class=\"divider\"></div>\n      ${this._config.label\n        ? html`\n            <div class=\"label\">${this._config.label}</div>\n          `\n        : html``}\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      .label {\n        color: var(--primary-color);\n        margin-left: 8px;\n        margin-bottom: 16px;\n        margin-top: 16px;\n      }\n      .divider {\n        height: 1px;\n        background-color: var(--secondary-text-color);\n        opacity: 0.25;\n        margin-left: -16px;\n        margin-right: -16px;\n        margin-top: 8px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-section-row\": HuiSectionRow;\n  }\n}\n","import {\n  html,\n  LitElement,\n  TemplateResult,\n  customElement,\n  property,\n  css,\n  CSSResult,\n} from \"lit-element\";\n\nimport { EntityRow, WeblinkConfig } from \"../entity-rows/types\";\nimport { HomeAssistant } from \"../../../types\";\n\nimport \"../../../components/ha-icon\";\n\n@customElement(\"hui-weblink-row\")\nclass HuiWeblinkRow extends LitElement implements EntityRow {\n  public hass?: HomeAssistant;\n\n  @property() private _config?: WeblinkConfig;\n\n  public setConfig(config: WeblinkConfig): void {\n    if (!config || !config.url) {\n      throw new Error(\"Invalid Configuration: 'url' required\");\n    }\n\n    this._config = {\n      icon: \"hass:link\",\n      name: config.url,\n      ...config,\n    };\n  }\n\n  protected render(): TemplateResult | void {\n    if (!this._config) {\n      return html``;\n    }\n\n    return html`\n      <a href=\"${this._config.url}\" target=\"_blank\">\n        <ha-icon .icon=\"${this._config.icon}\"></ha-icon>\n        <div>${this._config.name}</div>\n      </a>\n    `;\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      a {\n        display: flex;\n        align-items: center;\n        color: var(--primary-color);\n      }\n      ha-icon {\n        padding: 8px;\n        color: var(--paper-item-icon-color);\n      }\n      div {\n        flex: 1;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        margin-left: 16px;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-weblink-row\": HuiWeblinkRow;\n  }\n}\n","import \"@polymer/iron-image/iron-image\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport { EventsMixin } from \"../../mixins/events-mixin\";\n\n/*\n * @appliesMixin EventsMixin\n */\nclass HaEntityMarker extends EventsMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <style include=\"iron-positioning\"></style>\n      <style>\n        .marker {\n          vertical-align: top;\n          position: relative;\n          display: block;\n          margin: 0 auto;\n          width: 2.5em;\n          text-align: center;\n          height: 2.5em;\n          line-height: 2.5em;\n          font-size: 1.5em;\n          border-radius: 50%;\n          border: 0.1em solid\n            var(--ha-marker-color, var(--default-primary-color));\n          color: rgb(76, 76, 76);\n          background-color: white;\n        }\n        iron-image {\n          border-radius: 50%;\n        }\n      </style>\n\n      <div class=\"marker\">\n        <template is=\"dom-if\" if=\"[[entityName]]\"\n          >[[entityName]]</template\n        >\n        <template is=\"dom-if\" if=\"[[entityPicture]]\">\n          <iron-image\n            sizing=\"cover\"\n            class=\"fit\"\n            src=\"[[entityPicture]]\"\n          ></iron-image>\n        </template>\n      </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: {\n        type: Object,\n      },\n\n      entityId: {\n        type: String,\n        value: \"\",\n      },\n\n      entityName: {\n        type: String,\n        value: null,\n      },\n\n      entityPicture: {\n        type: String,\n        value: null,\n      },\n    };\n  }\n\n  ready() {\n    super.ready();\n    this.addEventListener(\"click\", (ev) => this.badgeTap(ev));\n  }\n\n  badgeTap(ev) {\n    ev.stopPropagation();\n    if (this.entityId) {\n      this.fire(\"hass-more-info\", { entityId: this.entityId });\n    }\n  }\n}\n\ncustomElements.define(\"ha-entity-marker\", HaEntityMarker);\n","import { TemplateResult } from \"lit-element\";\n\ntype LoadedRoundSlider = Promise<{\n  roundSliderStyle: TemplateResult;\n  jQuery: any;\n}>;\n\nlet loaded: LoadedRoundSlider;\n\nexport const loadRoundslider = async (): LoadedRoundSlider => {\n  if (!loaded) {\n    loaded = import(/* webpackChunkName: \"jquery-roundslider\" */ \"./jquery.roundslider\");\n  }\n  return loaded;\n};\n"],"sourceRoot":""}