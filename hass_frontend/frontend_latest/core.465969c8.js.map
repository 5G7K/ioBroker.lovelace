{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/home-assistant-js-websocket/dist/haws.es.js","webpack:///./src/data/lovelace.ts","webpack:///./src/entrypoints/core.ts","webpack:///./src/data/ws-user.ts","webpack:///./src/data/auth.ts","webpack:///./src/common/auth/token_storage.ts","webpack:///./src/data/ws-themes.ts","webpack:///./src/data/ws-panels.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","installedModules","13","__webpack_require__","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","17","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","request","undefined","setTimeout","head","appendChild","all","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","self","oldJsonpFunction","slice","s","then","__webpack_exports__","x","u","f","v","S","L","R","k","_","iterator","asyncIterator","subscription","this","options","commandId","commands","Map","eventListeners","closeRequested","setSocket","socket","addEventListener","_handleMessage","_handleClose","forEach","subscribe","unsubscribe","fireEvent","set","removeEventListener","indexOf","splice","close","subscribeEvents","subscribeMessage","event_type","ping","sendMessagePromise","sendMessage","_genCmdId","id","send","JSON","stringify","callback","delete","parse","warn","success","result","code","assign","setupRetry","createSocket","Math","min","saveTokens","includes","location","href","encodeURIComponent","redirectUrl","protocol","host","pathname","search","btoa","hassUrl","clientId","loadTokens","substr","split","decodeURIComponent","atob","state","h","authCode","a","hostname","FormData","append","keys","fetch","method","credentials","body","ok","status","json","expires","expires_in","Date","now","grant_type","_saveTokens","wsUrl","configurable","accessToken","expired","access_token","refreshAccessToken","refresh_token","revoke","defineProperties","action","arguments","apply","setState","catch","readyState","OPEN","refresh","domain","service","service_data","P","components","concat","component","E","g","w","j","description","fields","T","I","y","M","O","b","entity_id","U","new_state","C","N","auth","WebSocket","fetchConfig","saveConfig","subscribeLovelaceUpdates","conn","force","hass","config","callWS","onChange","home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_0__","_common_auth_token_storage__WEBPACK_IMPORTED_MODULE_1__","_data_ws_panels__WEBPACK_IMPORTED_MODULE_2__","_data_ws_themes__WEBPACK_IMPORTED_MODULE_3__","_data_ws_user__WEBPACK_IMPORTED_MODULE_4__","_data_auth__WEBPACK_IMPORTED_MODULE_5__","_data_lovelace__WEBPACK_IMPORTED_MODULE_6__","isExternal","authProm","createExternalAuth","window","hassNoAuth","hassConnection","async","history","replaceState","noop","startsWith","llConfProm","homeAssistant","querySelector","callService","logger","replace","filename","lineno","colno","userCollection","subscribeUser","getSignedPath","fetchAuthProviders","path","askWrite","enableWrite","storage","localStorage","tokenCache","__tokenCache","tokens","writeEnabled","hassTokens","subscribeThemes","fetchThemes","subscribeUpdates","store","subscribePanels","fetchPanels","panels"],"mappings":"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","file":"core.465969c8.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t};\n\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t13: 0\n \t};\n\n\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"chunk.\" + {\"17\":\"d418f8a164e8ba51aac5\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/frontend_latest/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = self[\"webpackJsonp\"] = self[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 160);\n","function e(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}\"undefined\"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol(\"Symbol.iterator\"))),\"undefined\"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol(\"Symbol.asyncIterator\")));var t=1,n=2,r=3,o=4,s=5;function i(e){return{type:\"unsubscribe_events\",subscription:e}}var c=function(e,t){this.options=t,this.commandId=1,this.commands=new Map,this.eventListeners=new Map,this.closeRequested=!1,this.setSocket(e)};c.prototype.setSocket=function(e){var t=this,n=this.socket;if(this.socket=e,e.addEventListener(\"message\",function(e){return t._handleMessage(e)}),e.addEventListener(\"close\",function(e){return t._handleClose(e)}),n){var r=this.commands;this.commandId=1,this.commands=new Map,r.forEach(function(e){\"subscribe\"in e&&e.subscribe().then(function(t){e.unsubscribe=t,e.resolve()})}),this.fireEvent(\"ready\")}},c.prototype.addEventListener=function(e,t){var n=this.eventListeners.get(e);n||this.eventListeners.set(e,n=[]),n.push(t)},c.prototype.removeEventListener=function(e,t){var n=this.eventListeners.get(e);if(n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}},c.prototype.fireEvent=function(e,t){var n=this;(this.eventListeners.get(e)||[]).forEach(function(e){return e(n,t)})},c.prototype.close=function(){this.closeRequested=!0,this.socket.close()},c.prototype.subscribeEvents=function(e,t){try{return this.subscribeMessage(e,function(e){var t={type:\"subscribe_events\"};return e&&(t.event_type=e),t}(t))}catch(e){return Promise.reject(e)}},c.prototype.ping=function(){return this.sendMessagePromise({type:\"ping\"})},c.prototype.sendMessage=function(e,t){t||(t=this._genCmdId()),e.id=t,this.socket.send(JSON.stringify(e))},c.prototype.sendMessagePromise=function(e){var t=this;return new Promise(function(n,r){var o=t._genCmdId();t.commands.set(o,{resolve:n,reject:r}),t.sendMessage(e,o)})},c.prototype.subscribeMessage=function(e,t){try{var n,r=this,o=r._genCmdId();return Promise.resolve(new Promise(function(s,c){n={resolve:s,reject:c,callback:e,subscribe:function(){return r.subscribeMessage(e,t)},unsubscribe:function(){try{return Promise.resolve(r.sendMessagePromise(i(o))).then(function(){r.commands.delete(o)})}catch(e){return Promise.reject(e)}}},r.commands.set(o,n);try{r.sendMessage(t,o)}catch(e){}})).then(function(){return function(){return n.unsubscribe()}})}catch(e){return Promise.reject(e)}},c.prototype._handleMessage=function(e){var t=JSON.parse(e.data),n=this.commands.get(t.id);switch(t.type){case\"event\":n?n.callback(t.event):(console.warn(\"Received event for unknown subscription \"+t.id+\". Unsubscribing.\"),this.sendMessagePromise(i(t.id)));break;case\"result\":n&&(t.success?(n.resolve(t.result),\"subscribe\"in n||this.commands.delete(t.id)):(n.reject(t.error),this.commands.delete(t.id)));break;case\"pong\":n?(n.resolve(),this.commands.delete(t.id)):console.warn(\"Received unknown pong response \"+t.id)}},c.prototype._handleClose=function(t){var n=this;if(this.commands.forEach(function(e){\"subscribe\"in e||e.reject({type:\"result\",success:!1,error:{code:3,message:\"Connection lost\"}})}),!this.closeRequested){this.fireEvent(\"disconnected\");var r=Object.assign({},this.options,{setupRetry:0}),o=function(t){var s=n;setTimeout(function(){try{var n=e(function(){return Promise.resolve(r.createSocket(r)).then(function(e){s.setSocket(e)})},function(e){2===e?s.fireEvent(\"reconnect-error\",e):o(t+1)});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},1e3*Math.min(t,5))};o(0)}},c.prototype._genCmdId=function(){return++this.commandId};var u=function(e){void 0===e&&(e={});try{function t(){function t(){function t(){if(n)return new v(n,e.saveTokens);if(void 0===r)throw o;return function(e,t,n,r){n+=(n.includes(\"?\")?\"&\":\"?\")+\"auth_callback=1\",document.location.href=function(e,t,n,r){var o=e+\"/auth/authorize?response_type=code&redirect_uri=\"+encodeURIComponent(n);return null!==t&&(o+=\"&client_id=\"+encodeURIComponent(t)),r&&(o+=\"&state=\"+encodeURIComponent(r)),o}(e,t,n,r)}(r,s,e.redirectUrl||location.protocol+\"//\"+location.host+location.pathname+location.search,btoa(JSON.stringify({hassUrl:r,clientId:s}))),new Promise(function(){})}var i=function(){if(!n&&e.loadTokens)return Promise.resolve(e.loadTokens()).then(function(e){n=e})}();return i&&i.then?i.then(t):t()}var i=function(){if(!n){var t=function(e){for(var t={},n=location.search.substr(1).split(\"&\"),r=0;r<n.length;r++){var o=n[r].split(\"=\"),s=decodeURIComponent(o[0]),i=o.length>1?decodeURIComponent(o[1]):void 0;t[s]=i}return t}(),r=function(){if(\"auth_callback\"in t){var r=JSON.parse(atob(t.state));return Promise.resolve(h(r.hassUrl,r.clientId,t.code)).then(function(t){n=t,e.saveTokens&&e.saveTokens(n)})}}();if(r&&r.then)return r.then(function(){})}}();return i&&i.then?i.then(t):t()}var n,r=e.hassUrl;r&&\"/\"===r[r.length-1]&&(r=r.substr(0,r.length-1));var s=void 0!==e.clientId?e.clientId:f(),i=function(){if(!n&&e.authCode&&r)return Promise.resolve(h(r,s,e.authCode)).then(function(t){n=t,e.saveTokens&&e.saveTokens(n)})}();return Promise.resolve(i&&i.then?i.then(t):t())}catch(e){return Promise.reject(e)}},a=function(e,t,n){try{var r=\"undefined\"!=typeof location&&location;if(r&&\"https:\"===r.protocol){var o=document.createElement(\"a\");if(o.href=e,\"http:\"===o.protocol&&\"localhost\"!==o.hostname)throw 5}var s=new FormData;return null!==t&&s.append(\"client_id\",t),Object.keys(n).forEach(function(e){s.append(e,n[e])}),Promise.resolve(fetch(e+\"/auth/token\",{method:\"POST\",credentials:\"same-origin\",body:s})).then(function(n){if(!n.ok)throw 400===n.status||403===n.status?2:new Error(\"Unable to fetch tokens\");return Promise.resolve(n.json()).then(function(n){return n.hassUrl=e,n.clientId=t,n.expires=d(n.expires_in),n})})}catch(e){return Promise.reject(e)}},f=function(){return location.protocol+\"//\"+location.host+\"/\"},d=function(e){return 1e3*e+Date.now()};function h(e,t,n){return a(e,t,{code:n,grant_type:\"authorization_code\"})}var v=function(e,t){this.data=e,this._saveTokens=t},l={wsUrl:{configurable:!0},accessToken:{configurable:!0},expired:{configurable:!0}};l.wsUrl.get=function(){return\"ws\"+this.data.hassUrl.substr(4)+\"/api/websocket\"},l.accessToken.get=function(){return this.data.access_token},l.expired.get=function(){return Date.now()>this.data.expires},v.prototype.refreshAccessToken=function(){try{var e=this;return Promise.resolve(a(e.data.hassUrl,e.data.clientId,{grant_type:\"refresh_token\",refresh_token:e.data.refresh_token})).then(function(t){t.refresh_token=e.data.refresh_token,e.data=t,e._saveTokens&&e._saveTokens(t)})}catch(e){return Promise.reject(e)}},v.prototype.revoke=function(){try{var e=this,t=new FormData;return t.append(\"action\",\"revoke\"),t.append(\"token\",e.data.refresh_token),Promise.resolve(fetch(e.data.hassUrl+\"/auth/token\",{method:\"POST\",credentials:\"same-origin\",body:t})).then(function(){e._saveTokens&&e._saveTokens(null)})}catch(e){return Promise.reject(e)}},Object.defineProperties(v.prototype,l);var m=function(e,t,n,r){if(e[t])return e[t];var o,s=0,i=function(e){var t=[];function n(n,r){e=r?n:Object.assign({},e,n);for(var o=t,s=0;s<o.length;s++)o[s](e)}return{get state(){return e},action:function(t){function r(e){n(e,!1)}return function(){for(var n=arguments,o=[e],s=0;s<arguments.length;s++)o.push(n[s]);var i=t.apply(this,o);if(null!=i)return i.then?i.then(r):r(i)}},setState:n,subscribe:function(e){return t.push(e),function(){!function(e){for(var n=[],r=0;r<t.length;r++)t[r]===e?e=null:n.push(t[r]);t=n}(e)}}}}(),c=function(){return n(e).then(function(e){return i.setState(e,!0)})},u=function(){return c().catch(function(t){if(e.socket.readyState==e.socket.OPEN)throw t})};return e[t]={get state(){return i.state},refresh:c,subscribe:function(t){1==++s&&(r&&(o=r(e,i)),e.addEventListener(\"ready\",u),u());var n=i.subscribe(t);return void 0!==i.state&&setTimeout(function(){return t(i.state)},0),function(){n(),--s||(o&&o.then(function(e){e()}),e.removeEventListener(\"ready\",c))}}},e[t]},p=function(e,t,n,r,o){return m(r,e,t,n).subscribe(o)},b=function(e){return e.sendMessagePromise({type:\"get_states\"})},y=function(e){return e.sendMessagePromise({type:\"get_services\"})},g=function(e){return e.sendMessagePromise({type:\"get_config\"})},k=function(e){return e.sendMessagePromise({type:\"auth/current_user\"})},_=function(e,t,n,r){return e.sendMessagePromise(function(e,t,n){var r={type:\"call_service\",domain:e,service:t};return n&&(r.service_data=n),r}(t,n,r))};function P(e,t){return void 0===e?null:{components:e.components.concat(t.data.component)}}var E=function(e){return g(e)},w=function(e,t){return Promise.all([e.subscribeEvents(t.action(P),\"component_loaded\"),e.subscribeEvents(function(){return E(e).then(function(e){return t.setState(e,!0)})},\"core_config_updated\")]).then(function(e){return function(){return e.forEach(function(e){return e()})}})},S=function(e,t){return function(e){return m(e,\"_cnf\",E,w)}(e).subscribe(t)};function j(e,t){var n,r;if(void 0===e)return null;var o=t.data,s=o.domain,i=Object.assign({},e[s],((n={})[o.service]={description:\"\",fields:{}},n));return(r={})[s]=i,r}function T(e,t){var n;if(void 0===e)return null;var r=t.data,o=r.domain,s=r.service,i=e[o];if(!(i&&s in i))return null;var c={};return Object.keys(i).forEach(function(e){e!==s&&(c[e]=i[e])}),(n={})[o]=c,n}var I=function(e){return y(e)},M=function(e,t){return Promise.all([e.subscribeEvents(t.action(j),\"service_registered\"),e.subscribeEvents(t.action(T),\"service_removed\")]).then(function(e){return function(){return e.forEach(function(e){return e()})}})},L=function(e,t){return function(e){return m(e,\"_srv\",I,M)}(e).subscribe(t)},O=function(e){try{return Promise.resolve(b(e)).then(function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];t[r.entity_id]=r}return t})}catch(e){return Promise.reject(e)}},U=function(e,t){return e.subscribeEvents(function(e){return function(t,n){var r,o=t.state;if(void 0!==o){var s=e.data,i=s.entity_id,c=s.new_state;if(c)t.setState(((r={})[c.entity_id]=c,r));else{var u=Object.assign({},o);delete u[i],t.setState(u,!0)}}}(t)},\"state_changed\")},C=function(e){return m(e,\"_ent\",O,U)},R=function(e,t){return C(e).subscribe(t)},x=function(e){try{var t=Object.assign({},N,e);return Promise.resolve(t.createSocket(t)).then(function(e){return new c(e,t)})}catch(e){return Promise.reject(e)}},N={setupRetry:0,createSocket:function(t){if(!t.auth)throw o;var n=t.auth,r=n.expired?n.refreshAccessToken().then(function(){r=void 0},function(){r=void 0}):void 0,s=n.wsUrl;return new Promise(function(o,i){return function t(o,i,c){var u=new WebSocket(s),a=!1,f=function(){if(u.removeEventListener(\"close\",f),a)c(2);else if(0!==o){var e=-1===o?-1:o-1;setTimeout(function(){return t(e,i,c)},1e3)}else c(1)},d=function(t){try{var o=e(function(){function e(){u.send(JSON.stringify({type:\"auth\",access_token:n.accessToken}))}var t=function(){if(n.expired)return Promise.resolve(r||n.refreshAccessToken()).then(function(){})}();return t&&t.then?t.then(e):e()},function(e){a=2===e,u.close()});return Promise.resolve(o&&o.then?o.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},h=function(e){try{switch(JSON.parse(e.data).type){case\"auth_invalid\":a=!0,u.close();break;case\"auth_ok\":u.removeEventListener(\"open\",d),u.removeEventListener(\"message\",h),u.removeEventListener(\"close\",f),u.removeEventListener(\"error\",f),i(u)}return Promise.resolve()}catch(e){return Promise.reject(e)}};u.addEventListener(\"open\",d),u.addEventListener(\"message\",h),u.addEventListener(\"close\",f),u.addEventListener(\"error\",f)}(t.setupRetry,o,i)})}};export{x as createConnection,u as getAuth,f as genClientId,d as genExpires,v as Auth,m as getCollection,p as createCollection,c as Connection,S as subscribeConfig,L as subscribeServices,C as entitiesColl,R as subscribeEntities,t as ERR_CANNOT_CONNECT,n as ERR_INVALID_AUTH,r as ERR_CONNECTION_LOST,o as ERR_HASS_HOST_REQUIRED,s as ERR_INVALID_HTTPS_TO_HTTP,b as getStates,y as getServices,g as getConfig,k as getUser,_ as callService};\n//# sourceMappingURL=haws.es.js.map\n","import { HomeAssistant } from \"../types\";\nimport { Connection, getCollection } from \"home-assistant-js-websocket\";\n\nexport interface LovelaceConfig {\n  title?: string;\n  hideToolbar?: boolean; // IoB\n  views: LovelaceViewConfig[];\n  background?: string;\n  resources?: Array<{ type: \"css\" | \"js\" | \"module\" | \"html\"; url: string }>;\n}\n\nexport interface LovelaceViewConfig {\n  index?: number;\n  title?: string;\n  badges?: string[];\n  cards?: LovelaceCardConfig[];\n  path?: string;\n  icon?: string;\n  theme?: string;\n  panel?: boolean;\n  background?: string;\n}\n\nexport interface LovelaceCardConfig {\n  index?: number;\n  view_index?: number;\n  type: string;\n  [key: string]: any;\n}\n\nexport interface ToggleActionConfig {\n  action: \"toggle\";\n}\n\nexport interface CallServiceActionConfig {\n  action: \"call-service\";\n  service: string;\n  service_data?: {\n    entity_id?: string | [string];\n    [key: string]: any;\n  };\n}\n\nexport interface NavigateActionConfig {\n  action: \"navigate\";\n  navigation_path: string;\n}\n\nexport interface MoreInfoActionConfig {\n  action: \"more-info\";\n}\n\nexport interface NoActionConfig {\n  action: \"none\";\n}\n\nexport type ActionConfig =\n  | ToggleActionConfig\n  | CallServiceActionConfig\n  | NavigateActionConfig\n  | MoreInfoActionConfig\n  | NoActionConfig;\n\nexport const fetchConfig = (\n  conn: Connection,\n  force: boolean\n): Promise<LovelaceConfig> =>\n  conn.sendMessagePromise({\n    type: \"lovelace/config\",\n    force,\n  });\n\nexport const saveConfig = (\n  hass: HomeAssistant,\n  config: LovelaceConfig\n): Promise<void> =>\n  hass.callWS({\n    type: \"lovelace/config/save\",\n    config,\n  });\n\nexport const subscribeLovelaceUpdates = (\n  conn: Connection,\n  onChange: () => void\n) => conn.subscribeEvents(onChange, \"lovelace_updated\");\n\nexport const getLovelaceCollection = (conn: Connection) =>\n  getCollection(\n    conn,\n    \"_lovelace\",\n    (conn2) => fetchConfig(conn2, false),\n    (_conn, store) =>\n      subscribeLovelaceUpdates(conn, () =>\n        fetchConfig(conn, false).then((config) => store.setState(config, true))\n      )\n  );\n\nexport interface WindowWithLovelaceProm extends Window {\n  llConfProm?: Promise<LovelaceConfig>;\n}\n","import {\n  getAuth,\n  createConnection,\n  subscribeConfig,\n  subscribeEntities,\n  subscribeServices,\n  ERR_INVALID_AUTH,\n  Auth,\n  Connection,\n} from \"home-assistant-js-websocket\";\n\nimport { loadTokens, saveTokens } from \"../common/auth/token_storage\";\nimport { subscribePanels } from \"../data/ws-panels\";\nimport { subscribeThemes } from \"../data/ws-themes\";\nimport { subscribeUser } from \"../data/ws-user\";\nimport { HomeAssistant } from \"../types\";\nimport { hassUrl } from \"../data/auth\";\nimport { fetchConfig, WindowWithLovelaceProm } from \"../data/lovelace\";\n\ndeclare global {\n  interface Window {\n    hassConnection: Promise<{ auth: Auth; conn: Connection }>;\n    hassNoAuth: string;\n  }\n}\n\nconst isExternal = location.search.includes(\"external_auth=1\");\n\nconst authProm = isExternal\n  ? () =>\n      import(\n        /* webpackChunkName: \"external_auth\" */ \"../external_app/external_auth\"\n      ).then(({ createExternalAuth }) => createExternalAuth(hassUrl))\n  : () =>\n      getAuth({\n        hassUrl,\n        saveTokens,\n        loadTokens: () => Promise.resolve(loadTokens()),\n        authCode: window.hassNoAuth, // for IoB\n      });\n\nconst connProm = async (auth) => {\n  try {\n    const conn = await createConnection({ auth });\n\n    // Clear url if we have been able to establish a connection\n    if (location.search.includes(\"auth_callback=1\")) {\n      history.replaceState(null, \"\", location.pathname);\n    }\n\n    return { auth, conn };\n  } catch (err) {\n    if (err !== ERR_INVALID_AUTH) {\n      throw err;\n    }\n    // We can get invalid auth if auth tokens were stored that are no longer valid\n    // Clear stored tokens.\n    if (!isExternal) {\n      saveTokens(null);\n    }\n    auth = await authProm();\n    const conn = await createConnection({ auth });\n    return { auth, conn };\n  }\n};\n\nif (__DEV__) {\n  performance.mark(\"hass-start\");\n}\nwindow.hassConnection = authProm().then(connProm);\n\n// Start fetching some of the data that we will need.\nwindow.hassConnection.then(({ conn }) => {\n  const noop = () => {\n    // do nothing\n  };\n  subscribeEntities(conn, noop);\n  subscribeConfig(conn, noop);\n  subscribeServices(conn, noop);\n  subscribePanels(conn, noop);\n  subscribeThemes(conn, noop);\n  subscribeUser(conn, noop);\n\n  if (location.pathname === \"/\" || location.pathname.startsWith(\"/lovelace/\")) {\n    (window as WindowWithLovelaceProm).llConfProm = fetchConfig(conn, false);\n  }\n});\n\nwindow.addEventListener(\"error\", (e) => {\n  const homeAssistant = document.querySelector(\"home-assistant\") as any;\n  if (\n    homeAssistant &&\n    homeAssistant.hass &&\n    (homeAssistant.hass as HomeAssistant).callService\n  ) {\n    homeAssistant.hass.callService(\"system_log\", \"write\", {\n      logger: `frontend.${\n        __DEV__ ? \"js_dev\" : \"js\"\n      }.${__BUILD__}.${__VERSION__.replace(\".\", \"\")}`,\n      message: `${e.filename}:${e.lineno}:${e.colno} ${e.message}`,\n    });\n  }\n});\n","import {\n  getUser,\n  Connection,\n  getCollection,\n} from \"home-assistant-js-websocket\";\nimport { CurrentUser } from \"../types\";\n\nexport const userCollection = (conn: Connection) =>\n  getCollection(\n    conn,\n    \"_usr\",\n    () => getUser(conn) as Promise<CurrentUser>,\n    undefined\n  );\n\nexport const subscribeUser = (\n  conn: Connection,\n  onChange: (user: CurrentUser) => void\n) => userCollection(conn).subscribe(onChange);\n","import { HomeAssistant } from \"../types\";\n\nexport interface AuthProvider {\n  name: string;\n  id: string;\n  type: string;\n}\n\nexport interface Credential {\n  type: string;\n}\n\nexport interface SignedPath {\n  path: string;\n}\n\nexport const hassUrl = `${location.protocol}//${location.host}`;\n\nexport const getSignedPath = (\n  hass: HomeAssistant,\n  path: string\n): Promise<SignedPath> => hass.callWS({ type: \"auth/sign_path\", path });\n\nexport const fetchAuthProviders = () =>\n  fetch(\"/auth/providers\", {\n    credentials: \"same-origin\",\n  });\n","import { AuthData } from \"home-assistant-js-websocket\";\n\nconst storage = window.localStorage || {};\n\ndeclare global {\n  interface Window {\n    __tokenCache: {\n      // undefined: we haven't loaded yet\n      // null: none stored\n      tokens?: AuthData | null;\n      writeEnabled?: boolean;\n    };\n  }\n}\n\n// So that core.js and main app hit same shared object.\nlet tokenCache = window.__tokenCache;\nif (!tokenCache) {\n  tokenCache = window.__tokenCache = {\n    tokens: undefined,\n    writeEnabled: undefined,\n  };\n}\n\nexport function askWrite() {\n  return (\n    tokenCache.tokens !== undefined && tokenCache.writeEnabled === undefined\n  );\n}\n\nexport function saveTokens(tokens: AuthData | null) {\n  tokenCache.tokens = tokens;\n  if (tokenCache.writeEnabled) {\n    try {\n      storage.hassTokens = JSON.stringify(tokens);\n    } catch (err) {\n      // write failed, ignore it. Happens if storage is full or private mode.\n    }\n  }\n}\n\nexport function enableWrite() {\n  tokenCache.writeEnabled = true;\n  if (tokenCache.tokens) {\n    saveTokens(tokenCache.tokens);\n  }\n}\n\nexport function loadTokens() {\n  if (tokenCache.tokens === undefined) {\n    try {\n      // Delete the old token cache.\n      delete storage.tokens;\n      const tokens = storage.hassTokens;\n      if (tokens) {\n        tokenCache.tokens = JSON.parse(tokens);\n        tokenCache.writeEnabled = true;\n      } else {\n        tokenCache.tokens = null;\n      }\n    } catch (err) {\n      tokenCache.tokens = null;\n    }\n  }\n  return tokenCache.tokens;\n}\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { Themes } from \"../types\";\n\nconst fetchThemes = (conn) =>\n  conn.sendMessagePromise({\n    type: \"frontend/get_themes\",\n  });\n\nconst subscribeUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    (event) => store.setState(event.data, true),\n    \"themes_updated\"\n  );\n\nexport const subscribeThemes = (\n  conn: Connection,\n  onChange: (themes: Themes) => void\n) =>\n  createCollection<Themes>(\n    \"_thm\",\n    fetchThemes,\n    subscribeUpdates,\n    conn,\n    onChange\n  );\n","import { createCollection, Connection } from \"home-assistant-js-websocket\";\nimport { Panels } from \"../types\";\n\nconst fetchPanels = (conn) =>\n  conn.sendMessagePromise({\n    type: \"get_panels\",\n  });\n\nconst subscribeUpdates = (conn, store) =>\n  conn.subscribeEvents(\n    () => fetchPanels(conn).then((panels) => store.setState(panels, true)),\n    \"panels_updated\"\n  );\n\nexport const subscribePanels = (\n  conn: Connection,\n  onChange: (panels: Panels) => void\n) =>\n  createCollection<Panels>(\n    \"_pnl\",\n    fetchPanels,\n    subscribeUpdates,\n    conn,\n    onChange\n  );\n"],"sourceRoot":""}